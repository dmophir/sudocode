
> sudocode@0.1.15 test
> vitest run


 RUN  v3.2.4 /Users/randy/sudocodeai/sudocode

stdout | tests/unit/workflow/sequential-engine.test.ts > SequentialWorkflowEngine > startWorkflow > should update workflow status to running
[BaseWorkflowEngine] Created workflow worktree for wf-test123: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/sequential-engine.test.ts > SequentialWorkflowEngine > startWorkflow > should emit workflow_started event
[BaseWorkflowEngine] Created workflow worktree for wf-test123: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/sequential-engine.test.ts > SequentialWorkflowEngine > pauseWorkflow > should cancel current execution when pausing but keep executionId for resume
[SequentialWorkflowEngine] Reset step step-1 to pending after pause (keeping executionId for resume)

stdout | tests/unit/workflow/sequential-engine.test.ts > SequentialWorkflowEngine > pauseWorkflow > should resume session when step has previous execution with session_id
[SequentialWorkflowEngine] Reset step step-1 to pending after pause (keeping executionId for resume)

stdout | tests/unit/workflow/sequential-engine.test.ts > SequentialWorkflowEngine > pauseWorkflow > should resume session when step has previous execution with session_id
[SequentialWorkflowEngine] Resuming step step-1 with session session-abc123 (parent: exec-1)

stdout | tests/unit/workflow/sequential-engine.test.ts > SequentialWorkflowEngine > pauseWorkflow > should create fresh execution if step has no previous session_id
[SequentialWorkflowEngine] Reset step step-1 to pending after pause (keeping executionId for resume)

stdout | tests/unit/workflow/sequential-engine.test.ts > SequentialWorkflowEngine > parallel execution > should execute multiple ready steps in parallel mode
[BaseWorkflowEngine] Created workflow worktree for wf-test123: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/sequential-engine.test.ts > SequentialWorkflowEngine > parallel execution > should respect maxConcurrency limit
[BaseWorkflowEngine] Created workflow worktree for wf-test123: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/sequential-engine.test.ts > SequentialWorkflowEngine > parallel execution > should continue with other steps when one fails in continue mode
[BaseWorkflowEngine] Created workflow worktree for wf-test123: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/sequential-engine.test.ts > SequentialWorkflowEngine > parallel execution > should stop immediately when step fails in stop mode
[BaseWorkflowEngine] Created workflow worktree for wf-test123: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/sequential-engine.test.ts > SequentialWorkflowEngine > failure handling strategies > stop strategy should fail workflow immediately on step failure
[BaseWorkflowEngine] Created workflow worktree for wf-test123: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/sequential-engine.test.ts > SequentialWorkflowEngine > failure handling strategies > pause strategy should pause workflow on step failure
[BaseWorkflowEngine] Created workflow worktree for wf-test123: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/sequential-engine.test.ts > SequentialWorkflowEngine > failure handling strategies > skip_dependents strategy should skip dependent steps on failure
[BaseWorkflowEngine] Created workflow worktree for wf-test123: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/sequential-engine.test.ts > SequentialWorkflowEngine > failure handling strategies > continue strategy should block dependents and continue with others
[BaseWorkflowEngine] Created workflow worktree for wf-test123: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/sequential-engine.test.ts > SequentialWorkflowEngine > auto-commit > should update issue in worktree JSONL after successful step completion
[BaseWorkflowEngine] Created workflow worktree for wf-test123: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/sequential-engine.test.ts > SequentialWorkflowEngine > auto-commit > should update issue in worktree JSONL after successful step completion
[SequentialWorkflowEngine] Updated issue i-1 in worktree JSONL: { status: [32m'closed'[39m }

stdout | tests/unit/workflow/sequential-engine.test.ts > SequentialWorkflowEngine > auto-commit > should fall back to database when no worktree exists
[BaseWorkflowEngine] Created workflow worktree for wf-test123: null (branch: null)

stdout | tests/unit/workflow/sequential-engine.test.ts > SequentialWorkflowEngine > auto-commit > should not close issue when step fails
[BaseWorkflowEngine] Created workflow worktree for wf-test123: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/sequential-engine.test.ts > SequentialWorkflowEngine > auto-commit > should emit step_completed event with correct data after success
[BaseWorkflowEngine] Created workflow worktree for wf-test123: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/sequential-engine.test.ts > SequentialWorkflowEngine > auto-commit > should emit step_completed event with correct data after success
[SequentialWorkflowEngine] Updated issue i-1 in worktree JSONL: { status: [32m'closed'[39m }

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/watcher.test.ts > File Watcher > startWatcher > should start watching files and return control object
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > E2E Execution with Worktree > should create execution with worktree and cleanup after completion
[ExecutionLifecycle] Captured before_commit: b9939ffc5941d320c6f454dd56d7b696a20f85a7

stdout | tests/unit/watcher.test.ts > File Watcher > startWatcher > should detect new markdown files
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > E2E Execution with Worktree > should create execution with worktree and cleanup after completion
[WorktreeManager] Setting up isolated worktree environment {
  repoPath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo'[39m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/749ec655-d349-4cd1-a084-2a034d3a402e'[39m
}
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/749ec655-d349-4cd1-a084-2a034d3a402e/.sudocode'[39m
}
[WorktreeManager] Created .sudocode directory in worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/749ec655-d349-4cd1-a084-2a034d3a402e/.sudocode
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/749ec655-d349-4cd1-a084-2a034d3a402e/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/issues.jsonl
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/749ec655-d349-4cd1-a084-2a034d3a402e/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/specs.jsonl
[WorktreeManager] No config.json to copy from main repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > E2E Execution with Worktree > should create execution with worktree and cleanup after completion
[WorktreeManager] Successfully initialized local database in worktree at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/749ec655-d349-4cd1-a084-2a034d3a402e/.sudocode/cache.db
[WorktreeManager] Database file created {
  path: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/749ec655-d349-4cd1-a084-2a034d3a402e/.sudocode/cache.db'[39m,
  size: [33m4096[39m
}
[WorktreeManager] Worktree environment setup complete

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > constructor > should create service instance
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/local-server| tests/unit/workflow/sequential-engine.test.ts (37 tests) 2888ms
stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > E2E Execution with Worktree > should create execution with worktree and cleanup after completion
Successfully cleaned up worktree for execution 749ec655-d349-4cd1-a084-2a034d3a402e

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > loadAndValidateExecution > should load execution from database
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/watcher.test.ts > File Watcher > startWatcher > should NOT delete spec from database when file is deleted (DB is source of truth)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > E2E Execution with Worktree > should work with existing branch when autoCreateBranches is false
[ExecutionLifecycle] Captured before_commit: b9939ffc5941d320c6f454dd56d7b696a20f85a7

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > E2E Execution with Worktree > should work with existing branch when autoCreateBranches is false
[WorktreeManager] Setting up isolated worktree environment {
  repoPath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo'[39m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/8d6adf7e-96f1-4745-814b-d37b140e2b56'[39m
}
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/8d6adf7e-96f1-4745-814b-d37b140e2b56/.sudocode'[39m
}
[WorktreeManager] Created .sudocode directory in worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/8d6adf7e-96f1-4745-814b-d37b140e2b56/.sudocode
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/8d6adf7e-96f1-4745-814b-d37b140e2b56/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/issues.jsonl
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/8d6adf7e-96f1-4745-814b-d37b140e2b56/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/specs.jsonl
[WorktreeManager] No config.json to copy from main repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > E2E Execution with Worktree > should work with existing branch when autoCreateBranches is false
[WorktreeManager] Successfully initialized local database in worktree at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/8d6adf7e-96f1-4745-814b-d37b140e2b56/.sudocode/cache.db
[WorktreeManager] Database file created {
  path: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/8d6adf7e-96f1-4745-814b-d37b140e2b56/.sudocode/cache.db'[39m,
  size: [33m4096[39m
}
[WorktreeManager] Worktree environment setup complete

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > E2E Execution with Worktree > should work with existing branch when autoCreateBranches is false
Successfully cleaned up worktree for execution 8d6adf7e-96f1-4745-814b-d37b140e2b56

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > loadAndValidateExecution > should throw EXECUTION_NOT_FOUND for missing execution
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Cleanup on Failure > should cleanup worktree when execution fails
[ExecutionLifecycle] Captured before_commit: b9939ffc5941d320c6f454dd56d7b696a20f85a7

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > _validateSyncPreconditions > should pass validation for valid execution
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Cleanup on Failure > should cleanup worktree when execution fails
[WorktreeManager] Setting up isolated worktree environment {
  repoPath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo'[39m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/14f550ae-2ee4-4fd7-a502-062858afa99a'[39m
}
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/14f550ae-2ee4-4fd7-a502-062858afa99a/.sudocode'[39m
}
[WorktreeManager] Created .sudocode directory in worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/14f550ae-2ee4-4fd7-a502-062858afa99a/.sudocode
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/14f550ae-2ee4-4fd7-a502-062858afa99a/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/issues.jsonl
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/14f550ae-2ee4-4fd7-a502-062858afa99a/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/specs.jsonl
[WorktreeManager] No config.json to copy from main repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Cleanup on Failure > should cleanup worktree when execution fails
[WorktreeManager] Successfully initialized local database in worktree at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/14f550ae-2ee4-4fd7-a502-062858afa99a/.sudocode/cache.db
[WorktreeManager] Database file created {
  path: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/14f550ae-2ee4-4fd7-a502-062858afa99a/.sudocode/cache.db'[39m,
  size: [33m4096[39m
}
[WorktreeManager] Worktree environment setup complete

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Cleanup on Failure > should cleanup worktree when execution fails
Successfully cleaned up worktree for execution 14f550ae-2ee4-4fd7-a502-062858afa99a

stdout | tests/unit/watcher.test.ts > File Watcher > startWatcher > should delete orphaned markdown file without frontmatter (no corresponding DB entry)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > _validateSyncPreconditions > should throw NO_WORKTREE if worktree_path is null
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Cleanup on Cancellation > should cleanup worktree when execution is stopped
[ExecutionLifecycle] Captured before_commit: b9939ffc5941d320c6f454dd56d7b696a20f85a7

stdout | tests/unit/watcher.test.ts > File Watcher > startWatcher > should stop cleanly
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Cleanup on Cancellation > should cleanup worktree when execution is stopped
[WorktreeManager] Setting up isolated worktree environment {
  repoPath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo'[39m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/170a12f3-fb42-4ae9-ae05-446f1339cc92'[39m
}
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/170a12f3-fb42-4ae9-ae05-446f1339cc92/.sudocode'[39m
}
[WorktreeManager] Created .sudocode directory in worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/170a12f3-fb42-4ae9-ae05-446f1339cc92/.sudocode
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/170a12f3-fb42-4ae9-ae05-446f1339cc92/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/issues.jsonl
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/170a12f3-fb42-4ae9-ae05-446f1339cc92/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/specs.jsonl
[WorktreeManager] No config.json to copy from main repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Cleanup on Cancellation > should cleanup worktree when execution is stopped
[WorktreeManager] Successfully initialized local database in worktree at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/170a12f3-fb42-4ae9-ae05-446f1339cc92/.sudocode/cache.db
[WorktreeManager] Database file created {
  path: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/170a12f3-fb42-4ae9-ae05-446f1339cc92/.sudocode/cache.db'[39m,
  size: [33m4096[39m
}
[WorktreeManager] Worktree environment setup complete

stdout | tests/unit/watcher.test.ts > File Watcher > Reverse Sync (JSONL â†’ Markdown) > should sync JSONL changes to markdown when enabled
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Cleanup on Cancellation > should cleanup worktree when execution is stopped
Successfully cleaned up worktree for execution 170a12f3-fb42-4ae9-ae05-446f1339cc92

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > _validateSyncPreconditions > should throw WORKTREE_MISSING if worktree directory does not exist
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Startup Orphaned Cleanup > should cleanup orphaned worktrees on startup
[ExecutionLifecycle] Captured before_commit: b9939ffc5941d320c6f454dd56d7b696a20f85a7

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Startup Orphaned Cleanup > should cleanup orphaned worktrees on startup
[WorktreeManager] Setting up isolated worktree environment {
  repoPath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo'[39m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/44aefa41-d9de-41da-a324-582bd68bb9d9'[39m
}
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/44aefa41-d9de-41da-a324-582bd68bb9d9/.sudocode'[39m
}
[WorktreeManager] Created .sudocode directory in worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/44aefa41-d9de-41da-a324-582bd68bb9d9/.sudocode
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/44aefa41-d9de-41da-a324-582bd68bb9d9/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/issues.jsonl
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/44aefa41-d9de-41da-a324-582bd68bb9d9/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/specs.jsonl
[WorktreeManager] No config.json to copy from main repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Startup Orphaned Cleanup > should cleanup orphaned worktrees on startup
[WorktreeManager] Successfully initialized local database in worktree at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/44aefa41-d9de-41da-a324-582bd68bb9d9/.sudocode/cache.db
[WorktreeManager] Database file created {
  path: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/44aefa41-d9de-41da-a324-582bd68bb9d9/.sudocode/cache.db'[39m,
  size: [33m4096[39m
}
[WorktreeManager] Worktree environment setup complete

stdout | tests/unit/watcher.test.ts > File Watcher > Reverse Sync (JSONL â†’ Markdown) > should NOT sync JSONL changes to markdown when disabled
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > _validateSyncPreconditions > should throw BRANCH_MISSING if worktree branch does not exist
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Startup Orphaned Cleanup > should cleanup orphaned worktrees on startup
[ExecutionLifecycle] Captured before_commit: b9939ffc5941d320c6f454dd56d7b696a20f85a7

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Startup Orphaned Cleanup > should cleanup orphaned worktrees on startup
[WorktreeManager] Setting up isolated worktree environment {
  repoPath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo'[39m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/683af2a5-5243-4f30-aecc-97e5c873a2ca'[39m
}
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/683af2a5-5243-4f30-aecc-97e5c873a2ca/.sudocode'[39m
}
[WorktreeManager] Created .sudocode directory in worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/683af2a5-5243-4f30-aecc-97e5c873a2ca/.sudocode
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/683af2a5-5243-4f30-aecc-97e5c873a2ca/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/issues.jsonl
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/683af2a5-5243-4f30-aecc-97e5c873a2ca/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/specs.jsonl
[WorktreeManager] No config.json to copy from main repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Startup Orphaned Cleanup > should cleanup orphaned worktrees on startup
[WorktreeManager] Successfully initialized local database in worktree at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/683af2a5-5243-4f30-aecc-97e5c873a2ca/.sudocode/cache.db
[WorktreeManager] Database file created {
  path: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/683af2a5-5243-4f30-aecc-97e5c873a2ca/.sudocode/cache.db'[39m,
  size: [33m4096[39m
}
[WorktreeManager] Worktree environment setup complete

stdout | tests/unit/watcher.test.ts > File Watcher > Content Matching (Oscillation Prevention) > should skip markdown sync when content matches (prevents oscillation)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > _validateSyncPreconditions > should throw TARGET_BRANCH_MISSING if target branch does not exist
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Startup Orphaned Cleanup > should cleanup worktrees without execution records
[WorktreeManager] Setting up isolated worktree environment {
  repoPath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo'[39m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/orphaned-execution-id'[39m
}
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/orphaned-execution-id/.sudocode'[39m
}
[WorktreeManager] Created .sudocode directory in worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/orphaned-execution-id/.sudocode
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/orphaned-execution-id/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/issues.jsonl
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/orphaned-execution-id/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/specs.jsonl
[WorktreeManager] No config.json to copy from main repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Startup Orphaned Cleanup > should cleanup worktrees without execution records
[WorktreeManager] Successfully initialized local database in worktree at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/orphaned-execution-id/.sudocode/cache.db
[WorktreeManager] Database file created {
  path: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/orphaned-execution-id/.sudocode/cache.db'[39m,
  size: [33m4096[39m
}
[WorktreeManager] Worktree environment setup complete

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Startup Orphaned Cleanup > should cleanup worktrees without execution records
Cleaning up orphaned worktree: /private/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/orphaned-execution-id (no execution found)

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Startup Orphaned Cleanup > should not cleanup worktrees for running executions
[ExecutionLifecycle] Captured before_commit: b9939ffc5941d320c6f454dd56d7b696a20f85a7

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Startup Orphaned Cleanup > should not cleanup worktrees for running executions
[WorktreeManager] Setting up isolated worktree environment {
  repoPath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo'[39m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/9a742161-2b3b-4957-8aa8-c42fb26edc17'[39m
}
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/9a742161-2b3b-4957-8aa8-c42fb26edc17/.sudocode'[39m
}
[WorktreeManager] Created .sudocode directory in worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/9a742161-2b3b-4957-8aa8-c42fb26edc17/.sudocode
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/9a742161-2b3b-4957-8aa8-c42fb26edc17/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/issues.jsonl
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/9a742161-2b3b-4957-8aa8-c42fb26edc17/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/specs.jsonl
[WorktreeManager] No config.json to copy from main repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Startup Orphaned Cleanup > should not cleanup worktrees for running executions
[WorktreeManager] Successfully initialized local database in worktree at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/9a742161-2b3b-4957-8aa8-c42fb26edc17/.sudocode/cache.db
[WorktreeManager] Database file created {
  path: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/9a742161-2b3b-4957-8aa8-c42fb26edc17/.sudocode/cache.db'[39m,
  size: [33m4096[39m
}
[WorktreeManager] Worktree environment setup complete

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > _validateSyncPreconditions > should throw DIRTY_WORKING_TREE if local tree has uncommitted changes
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Startup Orphaned Cleanup > should not cleanup worktrees for running executions
Successfully cleaned up worktree for execution 9a742161-2b3b-4957-8aa8-c42fb26edc17

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Configuration-Driven Behavior > should respect autoCreateBranches config
[ExecutionLifecycle] Captured before_commit: b9939ffc5941d320c6f454dd56d7b696a20f85a7

stdout | tests/unit/watcher.test.ts > File Watcher > Content Matching (Oscillation Prevention) > should skip database sync when markdown content matches (prevents oscillation)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Configuration-Driven Behavior > should respect autoCreateBranches config
[WorktreeManager] Setting up isolated worktree environment {
  repoPath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo'[39m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/82756cc0-b64f-46bd-9c73-a099e5371100'[39m
}
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/82756cc0-b64f-46bd-9c73-a099e5371100/.sudocode'[39m
}
[WorktreeManager] Created .sudocode directory in worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/82756cc0-b64f-46bd-9c73-a099e5371100/.sudocode
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/82756cc0-b64f-46bd-9c73-a099e5371100/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/issues.jsonl
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/82756cc0-b64f-46bd-9c73-a099e5371100/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/specs.jsonl
[WorktreeManager] No config.json to copy from main repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Configuration-Driven Behavior > should respect autoCreateBranches config
[WorktreeManager] Successfully initialized local database in worktree at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/82756cc0-b64f-46bd-9c73-a099e5371100/.sudocode/cache.db
[WorktreeManager] Database file created {
  path: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/82756cc0-b64f-46bd-9c73-a099e5371100/.sudocode/cache.db'[39m,
  size: [33m4096[39m
}
[WorktreeManager] Worktree environment setup complete

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > _createSafetySnapshot > should create safety tag
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Configuration-Driven Behavior > should respect autoCreateBranches config
Successfully cleaned up worktree for execution 82756cc0-b64f-46bd-9c73-a099e5371100

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Configuration-Driven Behavior > should respect autoDeleteBranches config
[ExecutionLifecycle] Captured before_commit: b9939ffc5941d320c6f454dd56d7b696a20f85a7

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Configuration-Driven Behavior > should respect autoDeleteBranches config
[WorktreeManager] Setting up isolated worktree environment {
  repoPath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo'[39m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/3bb0967d-325b-4556-be82-db2750cf9cf1'[39m
}
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/3bb0967d-325b-4556-be82-db2750cf9cf1/.sudocode'[39m
}
[WorktreeManager] Created .sudocode directory in worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/3bb0967d-325b-4556-be82-db2750cf9cf1/.sudocode
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/3bb0967d-325b-4556-be82-db2750cf9cf1/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/issues.jsonl
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/3bb0967d-325b-4556-be82-db2750cf9cf1/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/specs.jsonl
[WorktreeManager] No config.json to copy from main repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Configuration-Driven Behavior > should respect autoDeleteBranches config
[WorktreeManager] Successfully initialized local database in worktree at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/3bb0967d-325b-4556-be82-db2750cf9cf1/.sudocode/cache.db
[WorktreeManager] Database file created {
  path: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/3bb0967d-325b-4556-be82-db2750cf9cf1/.sudocode/cache.db'[39m,
  size: [33m4096[39m
}
[WorktreeManager] Worktree environment setup complete

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > _isLocalTreeClean > should return true for clean working tree
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Configuration-Driven Behavior > should respect autoDeleteBranches config
Successfully cleaned up worktree for execution 3bb0967d-325b-4556-be82-db2750cf9cf1

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Configuration-Driven Behavior > should respect sparseCheckout config
[ExecutionLifecycle] Captured before_commit: b9939ffc5941d320c6f454dd56d7b696a20f85a7

stdout | tests/integration/round-trip-server.test.ts > Server Round-Trip Integration Tests
Initializing new database for test-project-7eefe4cc at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-roundtrip-server-qzp8XH/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/round-trip-server.test.ts > Server Round-Trip Integration Tests
Project context initialized: test-project-7eefe4cc at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-roundtrip-server-qzp8XH/test-project

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return 404 for non-existent execution
Initializing new database for test-project-933e8c4f at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-hV4gEx/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return 404 for non-existent execution
Project context initialized: test-project-933e8c4f at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-hV4gEx/test-project

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return 404 for non-existent execution
[project-manager] Starting workflow recovery for test-project-933e8c4f...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return 404 for non-existent execution
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return 404 for non-existent execution
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return 404 for non-existent execution
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return 404 for non-existent execution
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return 404 for non-existent execution
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return 404 for non-existent execution
[WakeupService] State recovery complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return 404 for non-existent execution
[project-manager] Workflow recovery complete for test-project-933e8c4f
[integration-sync] Starting for project test-project-933e8c4f
[integration-sync] No enabled integrations found

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return 404 for non-existent execution
Project opened successfully: test-project-933e8c4f at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-hV4gEx/test-project

stdout | tests/integration/round-trip-server.test.ts > Server Round-Trip Integration Tests
[project-manager] Starting workflow recovery for test-project-7eefe4cc...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/integration/round-trip-server.test.ts > Server Round-Trip Integration Tests
[OrchestratorEngine] Checking for stale executions...

stdout | tests/integration/round-trip-server.test.ts > Server Round-Trip Integration Tests
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/integration/round-trip-server.test.ts > Server Round-Trip Integration Tests
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/integration/round-trip-server.test.ts > Server Round-Trip Integration Tests
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/integration/round-trip-server.test.ts > Server Round-Trip Integration Tests
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/integration/round-trip-server.test.ts > Server Round-Trip Integration Tests
[WakeupService] State recovery complete

stdout | tests/integration/round-trip-server.test.ts > Server Round-Trip Integration Tests
[project-manager] Workflow recovery complete for test-project-7eefe4cc
[integration-sync] Starting for project test-project-7eefe4cc
[integration-sync] No enabled integrations found

stdout | tests/integration/round-trip-server.test.ts > Server Round-Trip Integration Tests
Project opened successfully: test-project-7eefe4cc at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-roundtrip-server-qzp8XH/test-project

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > _isLocalTreeClean > should return true for untracked files (ignored)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Configuration-Driven Behavior > should respect sparseCheckout config
[WorktreeManager] Setting up isolated worktree environment {
  repoPath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo'[39m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/a192d01c-cd2d-4622-9906-98cec16af37c'[39m
}
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/a192d01c-cd2d-4622-9906-98cec16af37c/.sudocode'[39m
}
[WorktreeManager] Created .sudocode directory in worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/a192d01c-cd2d-4622-9906-98cec16af37c/.sudocode
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/a192d01c-cd2d-4622-9906-98cec16af37c/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/issues.jsonl
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/a192d01c-cd2d-4622-9906-98cec16af37c/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/specs.jsonl
[WorktreeManager] No config.json to copy from main repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/watcher.test.ts > File Watcher > Content Matching (Oscillation Prevention) > should not oscillate between markdown and JSONL with bidirectional sync
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Configuration-Driven Behavior > should respect sparseCheckout config
[WorktreeManager] Successfully initialized local database in worktree at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/a192d01c-cd2d-4622-9906-98cec16af37c/.sudocode/cache.db
[WorktreeManager] Database file created {
  path: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/a192d01c-cd2d-4622-9906-98cec16af37c/.sudocode/cache.db'[39m,
  size: [33m4096[39m
}
[WorktreeManager] Worktree environment setup complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return 404 for non-existent execution
Shutting down ProjectManager...
Closing project: test-project-933e8c4f
Shutting down project context: test-project-933e8c4f

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return 404 for non-existent execution
[integration-sync] Stopping for project test-project-933e8c4f
[integration-sync] Service stopped for test-project-933e8c4f

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return 404 for non-existent execution
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-933e8c4f

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return 404 for non-existent execution
Project closed: test-project-933e8c4f

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return 404 for non-existent execution
ProjectManager shutdown complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return empty events for execution without logs
Initializing new database for test-project-0ce5391f at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-TJoUBa/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return empty events for execution without logs
Project context initialized: test-project-0ce5391f at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-TJoUBa/test-project

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return empty events for execution without logs
[project-manager] Starting workflow recovery for test-project-0ce5391f...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return empty events for execution without logs
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return empty events for execution without logs
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return empty events for execution without logs
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return empty events for execution without logs
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return empty events for execution without logs
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return empty events for execution without logs
[WakeupService] State recovery complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return empty events for execution without logs
[project-manager] Workflow recovery complete for test-project-0ce5391f
[integration-sync] Starting for project test-project-0ce5391f
[integration-sync] No enabled integrations found

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return empty events for execution without logs
Project opened successfully: test-project-0ce5391f at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-TJoUBa/test-project

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Configuration-Driven Behavior > should respect sparseCheckout config
Successfully cleaned up worktree for execution a192d01c-cd2d-4622-9906-98cec16af37c

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return empty events for execution without logs
Shutting down ProjectManager...
Closing project: test-project-0ce5391f
Shutting down project context: test-project-0ce5391f

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return empty events for execution without logs
[integration-sync] Stopping for project test-project-0ce5391f
[integration-sync] Service stopped for test-project-0ce5391f

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return empty events for execution without logs
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-0ce5391f

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return empty events for execution without logs
Project closed: test-project-0ce5391f

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return empty events for execution without logs
ProjectManager shutdown complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should convert NormalizedEntry to AG-UI events
Initializing new database for test-project-5f8e4e6f at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-Hq221r/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should convert NormalizedEntry to AG-UI events
Project context initialized: test-project-5f8e4e6f at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-Hq221r/test-project

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should convert NormalizedEntry to AG-UI events
[project-manager] Starting workflow recovery for test-project-5f8e4e6f...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should convert NormalizedEntry to AG-UI events
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should convert NormalizedEntry to AG-UI events
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should convert NormalizedEntry to AG-UI events
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should convert NormalizedEntry to AG-UI events
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should convert NormalizedEntry to AG-UI events
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should convert NormalizedEntry to AG-UI events
[WakeupService] State recovery complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should convert NormalizedEntry to AG-UI events
[project-manager] Workflow recovery complete for test-project-5f8e4e6f
[integration-sync] Starting for project test-project-5f8e4e6f
[integration-sync] No enabled integrations found

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should convert NormalizedEntry to AG-UI events
Project opened successfully: test-project-5f8e4e6f at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-Hq221r/test-project

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should convert NormalizedEntry to AG-UI events
Shutting down ProjectManager...
Closing project: test-project-5f8e4e6f
Shutting down project context: test-project-5f8e4e6f

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should convert NormalizedEntry to AG-UI events
[integration-sync] Stopping for project test-project-5f8e4e6f
[integration-sync] Service stopped for test-project-5f8e4e6f

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should convert NormalizedEntry to AG-UI events
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-5f8e4e6f

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > _isLocalTreeClean > should return false for modified tracked files
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should convert NormalizedEntry to AG-UI events
Project closed: test-project-5f8e4e6f

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should convert NormalizedEntry to AG-UI events
ProjectManager shutdown complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should convert tool_use entries to AG-UI tool events
Initializing new database for test-project-94c23281 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-V6KNRG/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should convert tool_use entries to AG-UI tool events
Project context initialized: test-project-94c23281 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-V6KNRG/test-project

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should convert tool_use entries to AG-UI tool events
[project-manager] Starting workflow recovery for test-project-94c23281...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should convert tool_use entries to AG-UI tool events
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should convert tool_use entries to AG-UI tool events
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should convert tool_use entries to AG-UI tool events
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should convert tool_use entries to AG-UI tool events
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should convert tool_use entries to AG-UI tool events
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should convert tool_use entries to AG-UI tool events
[WakeupService] State recovery complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should convert tool_use entries to AG-UI tool events
[project-manager] Workflow recovery complete for test-project-94c23281
[integration-sync] Starting for project test-project-94c23281
[integration-sync] No enabled integrations found

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should convert tool_use entries to AG-UI tool events
Project opened successfully: test-project-94c23281 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-V6KNRG/test-project

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should convert tool_use entries to AG-UI tool events
Shutting down ProjectManager...
Closing project: test-project-94c23281
Shutting down project context: test-project-94c23281

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should convert tool_use entries to AG-UI tool events
[integration-sync] Stopping for project test-project-94c23281
[integration-sync] Service stopped for test-project-94c23281

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should convert tool_use entries to AG-UI tool events
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-94c23281

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should convert tool_use entries to AG-UI tool events
Project closed: test-project-94c23281

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should convert tool_use entries to AG-UI tool events
ProjectManager shutdown complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return proper metadata structure
Initializing new database for test-project-ec8dea3e at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-UnQAb0/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return proper metadata structure
Project context initialized: test-project-ec8dea3e at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-UnQAb0/test-project

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return proper metadata structure
[project-manager] Starting workflow recovery for test-project-ec8dea3e...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return proper metadata structure
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return proper metadata structure
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return proper metadata structure
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return proper metadata structure
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return proper metadata structure
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return proper metadata structure
[WakeupService] State recovery complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return proper metadata structure
[project-manager] Workflow recovery complete for test-project-ec8dea3e
[integration-sync] Starting for project test-project-ec8dea3e
[integration-sync] No enabled integrations found

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return proper metadata structure
Project opened successfully: test-project-ec8dea3e at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-UnQAb0/test-project

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Race Condition Handling > should prevent duplicate executions for same issue
[ExecutionLifecycle] Captured before_commit: b9939ffc5941d320c6f454dd56d7b696a20f85a7

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Race Condition Handling > should prevent duplicate executions for same issue
[WorktreeManager] Setting up isolated worktree environment {
  repoPath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo'[39m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/87785ed9-54ec-462b-8127-ed62ce087138'[39m
}
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/87785ed9-54ec-462b-8127-ed62ce087138/.sudocode'[39m
}
[WorktreeManager] Created .sudocode directory in worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/87785ed9-54ec-462b-8127-ed62ce087138/.sudocode
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/87785ed9-54ec-462b-8127-ed62ce087138/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/issues.jsonl
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/87785ed9-54ec-462b-8127-ed62ce087138/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/specs.jsonl
[WorktreeManager] No config.json to copy from main repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Race Condition Handling > should prevent duplicate executions for same issue
[WorktreeManager] Successfully initialized local database in worktree at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/87785ed9-54ec-462b-8127-ed62ce087138/.sudocode/cache.db
[WorktreeManager] Database file created {
  path: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/87785ed9-54ec-462b-8127-ed62ce087138/.sudocode/cache.db'[39m,
  size: [33m4096[39m
}
[WorktreeManager] Worktree environment setup complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return proper metadata structure
Shutting down ProjectManager...
Closing project: test-project-ec8dea3e
Shutting down project context: test-project-ec8dea3e

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return proper metadata structure
[integration-sync] Stopping for project test-project-ec8dea3e
[integration-sync] Service stopped for test-project-ec8dea3e

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return proper metadata structure
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-ec8dea3e

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return proper metadata structure
Project closed: test-project-ec8dea3e

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return proper metadata structure
ProjectManager shutdown complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle large number of entries
Initializing new database for test-project-79cc6e58 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-04MfED/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle large number of entries
Project context initialized: test-project-79cc6e58 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-04MfED/test-project

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle large number of entries
[project-manager] Starting workflow recovery for test-project-79cc6e58...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle large number of entries
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle large number of entries
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle large number of entries
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle large number of entries
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle large number of entries
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle large number of entries
[WakeupService] State recovery complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle large number of entries
[project-manager] Workflow recovery complete for test-project-79cc6e58
[integration-sync] Starting for project test-project-79cc6e58
[integration-sync] No enabled integrations found

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle large number of entries
Project opened successfully: test-project-79cc6e58 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-04MfED/test-project

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle large number of entries
Shutting down ProjectManager...
Closing project: test-project-79cc6e58
Shutting down project context: test-project-79cc6e58

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle large number of entries
[integration-sync] Stopping for project test-project-79cc6e58
[integration-sync] Service stopped for test-project-79cc6e58

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle large number of entries
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-79cc6e58

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle large number of entries
Project closed: test-project-79cc6e58

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle large number of entries
ProjectManager shutdown complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should preserve AG-UI event structure
Initializing new database for test-project-c964f292 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-vAUsFd/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should preserve AG-UI event structure
Project context initialized: test-project-c964f292 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-vAUsFd/test-project

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should preserve AG-UI event structure
[project-manager] Starting workflow recovery for test-project-c964f292...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should preserve AG-UI event structure
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should preserve AG-UI event structure
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should preserve AG-UI event structure
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should preserve AG-UI event structure
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should preserve AG-UI event structure
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should preserve AG-UI event structure
[WakeupService] State recovery complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should preserve AG-UI event structure
[project-manager] Workflow recovery complete for test-project-c964f292
[integration-sync] Starting for project test-project-c964f292
[integration-sync] No enabled integrations found

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should preserve AG-UI event structure
Project opened successfully: test-project-c964f292 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-vAUsFd/test-project

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should preserve AG-UI event structure
Shutting down ProjectManager...
Closing project: test-project-c964f292
Shutting down project context: test-project-c964f292

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should preserve AG-UI event structure
[integration-sync] Stopping for project test-project-c964f292
[integration-sync] Service stopped for test-project-c964f292

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should preserve AG-UI event structure
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-c964f292

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should preserve AG-UI event structure
Project closed: test-project-c964f292

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should preserve AG-UI event structure
ProjectManager shutdown complete

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Race Condition Handling > should prevent duplicate executions for same issue
Successfully cleaned up worktree for execution 87785ed9-54ec-462b-8127-ed62ce087138

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > _getBranches > should return list of branches
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle UTF-8 characters in content
Initializing new database for test-project-2e91b64a at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-9tdOj2/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle UTF-8 characters in content
Project context initialized: test-project-2e91b64a at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-9tdOj2/test-project

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle UTF-8 characters in content
[project-manager] Starting workflow recovery for test-project-2e91b64a...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle UTF-8 characters in content
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle UTF-8 characters in content
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle UTF-8 characters in content
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle UTF-8 characters in content
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle UTF-8 characters in content
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle UTF-8 characters in content
[WakeupService] State recovery complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle UTF-8 characters in content
[project-manager] Workflow recovery complete for test-project-2e91b64a
[integration-sync] Starting for project test-project-2e91b64a
[integration-sync] No enabled integrations found

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle UTF-8 characters in content
Project opened successfully: test-project-2e91b64a at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-9tdOj2/test-project

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle UTF-8 characters in content
Shutting down ProjectManager...
Closing project: test-project-2e91b64a
Shutting down project context: test-project-2e91b64a

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle UTF-8 characters in content
[integration-sync] Stopping for project test-project-2e91b64a
[integration-sync] Service stopped for test-project-2e91b64a

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle UTF-8 characters in content
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-2e91b64a

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle UTF-8 characters in content
Project closed: test-project-2e91b64a

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle UTF-8 characters in content
ProjectManager shutdown complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle execution with metadata but no logs initialized
Initializing new database for test-project-049b5c4d at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-tAozwV/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle execution with metadata but no logs initialized
Project context initialized: test-project-049b5c4d at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-tAozwV/test-project

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle execution with metadata but no logs initialized
[project-manager] Starting workflow recovery for test-project-049b5c4d...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle execution with metadata but no logs initialized
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle execution with metadata but no logs initialized
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle execution with metadata but no logs initialized
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle execution with metadata but no logs initialized
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle execution with metadata but no logs initialized
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle execution with metadata but no logs initialized
[WakeupService] State recovery complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle execution with metadata but no logs initialized
[project-manager] Workflow recovery complete for test-project-049b5c4d
[integration-sync] Starting for project test-project-049b5c4d
[integration-sync] No enabled integrations found

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle execution with metadata but no logs initialized
Project opened successfully: test-project-049b5c4d at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-tAozwV/test-project

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle execution with metadata but no logs initialized
Shutting down ProjectManager...
Closing project: test-project-049b5c4d
Shutting down project context: test-project-049b5c4d

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle execution with metadata but no logs initialized
[integration-sync] Stopping for project test-project-049b5c4d
[integration-sync] Service stopped for test-project-049b5c4d

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle execution with metadata but no logs initialized
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-049b5c4d

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle execution with metadata but no logs initialized
Project closed: test-project-049b5c4d

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle execution with metadata but no logs initialized
ProjectManager shutdown complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle multiple entry types in single execution
Initializing new database for test-project-363883db at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-ESh9tn/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle multiple entry types in single execution
Project context initialized: test-project-363883db at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-ESh9tn/test-project

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle multiple entry types in single execution
[project-manager] Starting workflow recovery for test-project-363883db...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle multiple entry types in single execution
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle multiple entry types in single execution
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle multiple entry types in single execution
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle multiple entry types in single execution
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle multiple entry types in single execution
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle multiple entry types in single execution
[WakeupService] State recovery complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle multiple entry types in single execution
[project-manager] Workflow recovery complete for test-project-363883db
[integration-sync] Starting for project test-project-363883db
[integration-sync] No enabled integrations found

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle multiple entry types in single execution
Project opened successfully: test-project-363883db at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-ESh9tn/test-project

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle multiple entry types in single execution
Shutting down ProjectManager...
Closing project: test-project-363883db
Shutting down project context: test-project-363883db

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle multiple entry types in single execution
[integration-sync] Stopping for project test-project-363883db
[integration-sync] Service stopped for test-project-363883db

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle multiple entry types in single execution
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-363883db

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle multiple entry types in single execution
Project closed: test-project-363883db

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle multiple entry types in single execution
ProjectManager shutdown complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle multiple executions independently
Initializing new database for test-project-fe076112 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-8wNeW8/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle multiple executions independently
Project context initialized: test-project-fe076112 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-8wNeW8/test-project

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle multiple executions independently
[project-manager] Starting workflow recovery for test-project-fe076112...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle multiple executions independently
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle multiple executions independently
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle multiple executions independently
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle multiple executions independently
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle multiple executions independently
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle multiple executions independently
[WakeupService] State recovery complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle multiple executions independently
[project-manager] Workflow recovery complete for test-project-fe076112
[integration-sync] Starting for project test-project-fe076112
[integration-sync] No enabled integrations found

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle multiple executions independently
Project opened successfully: test-project-fe076112 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-8wNeW8/test-project

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Race Condition Handling > should handle concurrent executions for different issues
[ExecutionLifecycle] Captured before_commit: b9939ffc5941d320c6f454dd56d7b696a20f85a7
[ExecutionLifecycle] Captured before_commit: b9939ffc5941d320c6f454dd56d7b696a20f85a7

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > _getCurrentCommit > should return commit SHA for branch
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Race Condition Handling > should handle concurrent executions for different issues
[WorktreeManager] Setting up isolated worktree environment {
  repoPath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo'[39m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/9a2427d0-1b36-4401-9c28-a80f47399a0f'[39m
}
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/9a2427d0-1b36-4401-9c28-a80f47399a0f/.sudocode'[39m
}
[WorktreeManager] Created .sudocode directory in worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/9a2427d0-1b36-4401-9c28-a80f47399a0f/.sudocode
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/9a2427d0-1b36-4401-9c28-a80f47399a0f/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/issues.jsonl
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/9a2427d0-1b36-4401-9c28-a80f47399a0f/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/specs.jsonl
[WorktreeManager] No config.json to copy from main repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully
[WorktreeManager] Setting up isolated worktree environment {
  repoPath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo'[39m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/66ff28c0-8e5c-4d96-8b46-dfa0a2516de8'[39m
}
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/66ff28c0-8e5c-4d96-8b46-dfa0a2516de8/.sudocode'[39m
}
[WorktreeManager] Created .sudocode directory in worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/66ff28c0-8e5c-4d96-8b46-dfa0a2516de8/.sudocode
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/66ff28c0-8e5c-4d96-8b46-dfa0a2516de8/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/issues.jsonl
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/66ff28c0-8e5c-4d96-8b46-dfa0a2516de8/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/specs.jsonl
[WorktreeManager] No config.json to copy from main repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Race Condition Handling > should handle concurrent executions for different issues
[WorktreeManager] Successfully initialized local database in worktree at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/9a2427d0-1b36-4401-9c28-a80f47399a0f/.sudocode/cache.db
[WorktreeManager] Database file created {
  path: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/9a2427d0-1b36-4401-9c28-a80f47399a0f/.sudocode/cache.db'[39m,
  size: [33m4096[39m
}
[WorktreeManager] Worktree environment setup complete
[WorktreeManager] Successfully initialized local database in worktree at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/66ff28c0-8e5c-4d96-8b46-dfa0a2516de8/.sudocode/cache.db
[WorktreeManager] Database file created {
  path: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/66ff28c0-8e5c-4d96-8b46-dfa0a2516de8/.sudocode/cache.db'[39m,
  size: [33m4096[39m
}
[WorktreeManager] Worktree environment setup complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle multiple executions independently
Shutting down ProjectManager...
Closing project: test-project-fe076112
Shutting down project context: test-project-fe076112

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle multiple executions independently
[integration-sync] Stopping for project test-project-fe076112
[integration-sync] Service stopped for test-project-fe076112

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle multiple executions independently
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-fe076112

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle multiple executions independently
Project closed: test-project-fe076112

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle multiple executions independently
ProjectManager shutdown complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return 500 for database errors
Initializing new database for test-project-b9542ab5 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-hllEbg/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return 500 for database errors
Project context initialized: test-project-b9542ab5 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-hllEbg/test-project

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return 500 for database errors
[project-manager] Starting workflow recovery for test-project-b9542ab5...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return 500 for database errors
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return 500 for database errors
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return 500 for database errors
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return 500 for database errors
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return 500 for database errors
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return 500 for database errors
[WakeupService] State recovery complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return 500 for database errors
[project-manager] Workflow recovery complete for test-project-b9542ab5
[integration-sync] Starting for project test-project-b9542ab5
[integration-sync] No enabled integrations found

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return 500 for database errors
Project opened successfully: test-project-b9542ab5 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-hllEbg/test-project

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return 500 for database errors
Shutting down ProjectManager...
Closing project: test-project-b9542ab5
Shutting down project context: test-project-b9542ab5

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return 500 for database errors
[integration-sync] Stopping for project test-project-b9542ab5
[integration-sync] Service stopped for test-project-b9542ab5

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return 500 for database errors
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-b9542ab5

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return 500 for database errors
Project closed: test-project-b9542ab5

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should return 500 for database errors
ProjectManager shutdown complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle special characters in execution ID
Initializing new database for test-project-752fa1bf at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-reLbB0/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle special characters in execution ID
Project context initialized: test-project-752fa1bf at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-reLbB0/test-project

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle special characters in execution ID
[project-manager] Starting workflow recovery for test-project-752fa1bf...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle special characters in execution ID
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle special characters in execution ID
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle special characters in execution ID
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle special characters in execution ID
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle special characters in execution ID
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle special characters in execution ID
[WakeupService] State recovery complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle special characters in execution ID
[project-manager] Workflow recovery complete for test-project-752fa1bf
[integration-sync] Starting for project test-project-752fa1bf
[integration-sync] No enabled integrations found

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle special characters in execution ID
Project opened successfully: test-project-752fa1bf at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-reLbB0/test-project

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle special characters in execution ID
Shutting down ProjectManager...
Closing project: test-project-752fa1bf
Shutting down project context: test-project-752fa1bf

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle special characters in execution ID
[integration-sync] Stopping for project test-project-752fa1bf
[integration-sync] Service stopped for test-project-752fa1bf

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle special characters in execution ID
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-752fa1bf

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle special characters in execution ID
Project closed: test-project-752fa1bf

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should handle special characters in execution ID
ProjectManager shutdown complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should preserve entry order in AG-UI events
Initializing new database for test-project-3bf5c621 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-RGWnpI/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should preserve entry order in AG-UI events
Project context initialized: test-project-3bf5c621 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-RGWnpI/test-project

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should preserve entry order in AG-UI events
[project-manager] Starting workflow recovery for test-project-3bf5c621...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should preserve entry order in AG-UI events
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should preserve entry order in AG-UI events
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should preserve entry order in AG-UI events
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should preserve entry order in AG-UI events
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should preserve entry order in AG-UI events
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should preserve entry order in AG-UI events
[WakeupService] State recovery complete

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should preserve entry order in AG-UI events
[project-manager] Workflow recovery complete for test-project-3bf5c621
[integration-sync] Starting for project test-project-3bf5c621
[integration-sync] No enabled integrations found

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should preserve entry order in AG-UI events
Project opened successfully: test-project-3bf5c621 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-logs-RGWnpI/test-project

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should preserve entry order in AG-UI events
Shutting down ProjectManager...
Closing project: test-project-3bf5c621
Shutting down project context: test-project-3bf5c621

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should preserve entry order in AG-UI events
[integration-sync] Stopping for project test-project-3bf5c621
[integration-sync] Service stopped for test-project-3bf5c621

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should preserve entry order in AG-UI events
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-3bf5c621

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should preserve entry order in AG-UI events
Project closed: test-project-3bf5c621

stdout | tests/unit/routes/executions-logs.test.ts > Execution Logs Routes > GET /api/executions/:executionId/logs > should preserve entry order in AG-UI events
ProjectManager shutdown complete

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > _getCurrentCommit > should throw for nonexistent branch
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Race Condition Handling > should handle concurrent executions for different issues
Successfully cleaned up worktree for execution 9a2427d0-1b36-4401-9c28-a80f47399a0f
Successfully cleaned up worktree for execution 66ff28c0-8e5c-4d96-8b46-dfa0a2516de8

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Error Recovery > should cleanup worktree if execution creation fails after worktree created
[ExecutionLifecycle] Captured before_commit: b9939ffc5941d320c6f454dd56d7b696a20f85a7

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > previewSync > should preview clean merge with no conflicts
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Error Recovery > should cleanup worktree if execution creation fails after worktree created
[WorktreeManager] Setting up isolated worktree environment {
  repoPath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo'[39m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/908077fb-a004-4d4e-8bad-af3061497a67'[39m
}
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/908077fb-a004-4d4e-8bad-af3061497a67/.sudocode'[39m
}
[WorktreeManager] Created .sudocode directory in worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/908077fb-a004-4d4e-8bad-af3061497a67/.sudocode
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/908077fb-a004-4d4e-8bad-af3061497a67/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/issues.jsonl
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/908077fb-a004-4d4e-8bad-af3061497a67/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/specs.jsonl
[WorktreeManager] No config.json to copy from main repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Error Recovery > should cleanup worktree if execution creation fails after worktree created
[WorktreeManager] Successfully initialized local database in worktree at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/908077fb-a004-4d4e-8bad-af3061497a67/.sudocode/cache.db
[WorktreeManager] Database file created {
  path: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-worktree-integration-luZNh5/test-repo/.sudocode/worktrees/908077fb-a004-4d4e-8bad-af3061497a67/.sudocode/cache.db'[39m,
  size: [33m4096[39m
}
[WorktreeManager] Worktree environment setup complete

stdout | tests/unit/watcher.test.ts > File Watcher > Content Matching (Oscillation Prevention) > should not create loop when CLI updates issue (simulating MCP operation)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/worktree-integration.test.ts > Worktree Integration Tests > Error Recovery > should cleanup worktree if execution creation fails after worktree created
Successfully cleaned up worktree for execution 908077fb-a004-4d4e-8bad-af3061497a67

 âœ“ |@sudocode-ai/local-server| tests/unit/routes/executions-logs.test.ts (14 tests) 3332ms
   âœ“ Execution Logs Routes > GET /api/executions/:executionId/logs > should return 404 for non-existent execution  388ms
   âœ“ Execution Logs Routes > GET /api/executions/:executionId/logs > should return empty events for execution without logs  360ms
   âœ“ Execution Logs Routes > GET /api/executions/:executionId/logs > should handle multiple executions independently  425ms
 âœ“ |@sudocode-ai/local-server| tests/integration/execution/worktree-integration.test.ts (15 tests) 13999ms
   âœ“ Worktree Integration Tests > E2E Execution with Worktree > should create execution with worktree and cleanup after completion  1088ms
   âœ“ Worktree Integration Tests > E2E Execution with Worktree > should work with existing branch when autoCreateBranches is false  673ms
   âœ“ Worktree Integration Tests > Cleanup on Failure > should cleanup worktree when execution fails  1305ms
   âœ“ Worktree Integration Tests > Cleanup on Cancellation > should cleanup worktree when execution is stopped  1299ms
   âœ“ Worktree Integration Tests > Startup Orphaned Cleanup > should cleanup orphaned worktrees on startup  1588ms
   âœ“ Worktree Integration Tests > Startup Orphaned Cleanup > should cleanup worktrees without execution records  714ms
   âœ“ Worktree Integration Tests > Startup Orphaned Cleanup > should not cleanup worktrees for running executions  775ms
   âœ“ Worktree Integration Tests > Configuration-Driven Behavior > should respect autoCreateBranches config  661ms
   âœ“ Worktree Integration Tests > Configuration-Driven Behavior > should respect autoDeleteBranches config  780ms
   âœ“ Worktree Integration Tests > Configuration-Driven Behavior > should respect sparseCheckout config  972ms
   âœ“ Worktree Integration Tests > Race Condition Handling > should prevent duplicate executions for same issue  702ms
   âœ“ Worktree Integration Tests > Race Condition Handling > should handle concurrent executions for different issues  1046ms
   âœ“ Worktree Integration Tests > Error Recovery > should cleanup worktree if execution creation fails after worktree created  551ms
stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > previewSync > should detect code conflicts and set canSync=false
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > previewSync > should detect uncommitted JSONL files
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/watcher.test.ts > File Watcher > Content Matching (Oscillation Prevention) > should produce same hash regardless of array element order (relationships, tags)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/watcher.test.ts > File Watcher > Smart JSONL Operations (Regression Prevention) > should skip JSONL write when content is identical
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > previewSync > should warn when execution is running
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/watcher.test.ts > File Watcher > Smart JSONL Operations (Regression Prevention) > should import JSONL when content actually differs from database
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/watcher.test.ts > File Watcher > Timestamp Behavior (File Modification Time) > should use file modification time as database updated_at when syncing from markdown
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > previewSync > should return error when validation fails
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/refresh-api.test.ts > Refresh API Integration Tests
Initializing new database for test-project-821d8ce5 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-refresh-api-tbvuU6/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/refresh-api.test.ts > Refresh API Integration Tests
Project context initialized: test-project-821d8ce5 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-refresh-api-tbvuU6/test-project

stdout | tests/unit/watcher.test.ts > File Watcher > Timestamp Behavior (File Modification Time) > should allow multiple consecutive edits to be synced (not skipped due to timestamps)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/refresh-api.test.ts > Refresh API Integration Tests
[project-manager] Starting workflow recovery for test-project-821d8ce5...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/integration/refresh-api.test.ts > Refresh API Integration Tests
[OrchestratorEngine] Checking for stale executions...

stdout | tests/integration/refresh-api.test.ts > Refresh API Integration Tests
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/integration/refresh-api.test.ts > Refresh API Integration Tests
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/integration/refresh-api.test.ts > Refresh API Integration Tests
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/integration/refresh-api.test.ts > Refresh API Integration Tests
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/integration/refresh-api.test.ts > Refresh API Integration Tests
[WakeupService] State recovery complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects > should return empty array when no projects registered
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/integration/refresh-api.test.ts > Refresh API Integration Tests
[project-manager] Workflow recovery complete for test-project-821d8ce5
[integration-sync] Starting for project test-project-821d8ce5
[integration-sync] No enabled integrations found

stdout | tests/integration/refresh-api.test.ts > Refresh API Integration Tests
Project opened successfully: test-project-821d8ce5 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-refresh-api-tbvuU6/test-project

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects > should return all registered projects
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/open > should return empty array when no projects open
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > previewSync > should handle JSONL conflicts as auto-resolvable
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/open > should return all open projects with context
Initializing new database for test-project-1-c5dcb686 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-VhfjCJ/test-project-1/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/open > should return all open projects with context
Project context initialized: test-project-1-c5dcb686 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-VhfjCJ/test-project-1

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/open > should return all open projects with context
[project-manager] Starting workflow recovery for test-project-1-c5dcb686...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/open > should return all open projects with context
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/open > should return all open projects with context
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/open > should return all open projects with context
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/open > should return all open projects with context
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/open > should return all open projects with context
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/open > should return all open projects with context
[WakeupService] State recovery complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/open > should return all open projects with context
[project-manager] Workflow recovery complete for test-project-1-c5dcb686
[integration-sync] Starting for project test-project-1-c5dcb686
[integration-sync] No enabled integrations found

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/open > should return all open projects with context
Project opened successfully: test-project-1-c5dcb686 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-VhfjCJ/test-project-1

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/open > should return all open projects with context
Shutting down ProjectManager...
Closing project: test-project-1-c5dcb686
Shutting down project context: test-project-1-c5dcb686

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/open > should return all open projects with context
[integration-sync] Stopping for project test-project-1-c5dcb686
[integration-sync] Service stopped for test-project-1-c5dcb686

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/open > should return all open projects with context
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-1-c5dcb686

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/open > should return all open projects with context
Project closed: test-project-1-c5dcb686

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/open > should return all open projects with context
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/recent > should return empty array when no recent projects
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/recent > should return recent projects in order
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/integration/refresh-api.test.ts > Refresh API Integration Tests
Shutting down ProjectManager...
Closing project: test-project-821d8ce5
Shutting down project context: test-project-821d8ce5

stdout | tests/integration/refresh-api.test.ts > Refresh API Integration Tests
[integration-sync] Stopping for project test-project-821d8ce5
[integration-sync] Service stopped for test-project-821d8ce5

stdout | tests/integration/refresh-api.test.ts > Refresh API Integration Tests
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-821d8ce5

stdout | tests/integration/refresh-api.test.ts > Refresh API Integration Tests
Project closed: test-project-821d8ce5

stdout | tests/integration/refresh-api.test.ts > Refresh API Integration Tests
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/validate > should return 400 when path is missing
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/validate > should return invalid for non-existent path
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/validate > should return invalid for path without .sudocode
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/validate > should return valid for valid project path
Initializing new database for test-project-1-17a19d10 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-muiyl9/test-project-1/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/validate > should return valid for valid project path
Project context initialized: test-project-1-17a19d10 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-muiyl9/test-project-1

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/validate > should return valid for valid project path
[project-manager] Starting workflow recovery for test-project-1-17a19d10...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/validate > should return valid for valid project path
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/validate > should return valid for valid project path
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/validate > should return valid for valid project path
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/validate > should return valid for valid project path
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/validate > should return valid for valid project path
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/validate > should return valid for valid project path
[WakeupService] State recovery complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/validate > should return valid for valid project path
[project-manager] Workflow recovery complete for test-project-1-17a19d10
[integration-sync] Starting for project test-project-1-17a19d10
[integration-sync] No enabled integrations found

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/validate > should return valid for valid project path
Project opened successfully: test-project-1-17a19d10 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-muiyl9/test-project-1

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/validate > should return valid for valid project path
Closing project: test-project-1-17a19d10
Shutting down project context: test-project-1-17a19d10

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/validate > should return valid for valid project path
[integration-sync] Stopping for project test-project-1-17a19d10
[integration-sync] Service stopped for test-project-1-17a19d10

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/validate > should return valid for valid project path
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-1-17a19d10

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/validate > should return valid for valid project path
Project closed: test-project-1-17a19d10

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/validate > should return valid for valid project path
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/validate > should not keep project open after validation
Initializing new database for test-project-1-514d02f5 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-1sJXCS/test-project-1/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/validate > should not keep project open after validation
Project context initialized: test-project-1-514d02f5 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-1sJXCS/test-project-1

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/validate > should not keep project open after validation
[project-manager] Starting workflow recovery for test-project-1-514d02f5...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/validate > should not keep project open after validation
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/validate > should not keep project open after validation
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/validate > should not keep project open after validation
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/validate > should not keep project open after validation
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/validate > should not keep project open after validation
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/validate > should not keep project open after validation
[WakeupService] State recovery complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/validate > should not keep project open after validation
[project-manager] Workflow recovery complete for test-project-1-514d02f5
[integration-sync] Starting for project test-project-1-514d02f5
[integration-sync] No enabled integrations found

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/validate > should not keep project open after validation
Project opened successfully: test-project-1-514d02f5 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-1sJXCS/test-project-1

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/validate > should not keep project open after validation
Closing project: test-project-1-514d02f5
Shutting down project context: test-project-1-514d02f5

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/validate > should not keep project open after validation
[integration-sync] Stopping for project test-project-1-514d02f5
[integration-sync] Service stopped for test-project-1-514d02f5

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/validate > should not keep project open after validation
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-1-514d02f5

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/validate > should not keep project open after validation
Project closed: test-project-1-514d02f5

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/validate > should not keep project open after validation
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should return 400 when path is missing
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should return 404 for non-existent path
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should return 400 for invalid project
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should successfully open valid project
Initializing new database for test-project-1-6a8013db at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-P0T3nJ/test-project-1/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should successfully open valid project
Project context initialized: test-project-1-6a8013db at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-P0T3nJ/test-project-1

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should successfully open valid project
[project-manager] Starting workflow recovery for test-project-1-6a8013db...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should successfully open valid project
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should successfully open valid project
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should successfully open valid project
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should successfully open valid project
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should successfully open valid project
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should successfully open valid project
[WakeupService] State recovery complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should successfully open valid project
[project-manager] Workflow recovery complete for test-project-1-6a8013db
[integration-sync] Starting for project test-project-1-6a8013db
[integration-sync] No enabled integrations found

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should successfully open valid project
Project opened successfully: test-project-1-6a8013db at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-P0T3nJ/test-project-1

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should successfully open valid project
Shutting down ProjectManager...
Closing project: test-project-1-6a8013db
Shutting down project context: test-project-1-6a8013db

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should successfully open valid project
[integration-sync] Stopping for project test-project-1-6a8013db
[integration-sync] Service stopped for test-project-1-6a8013db

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should successfully open valid project
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-1-6a8013db

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should successfully open valid project
Project closed: test-project-1-6a8013db

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should successfully open valid project
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should register project in registry
Initializing new database for test-project-1-33804770 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-OxvKlw/test-project-1/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should register project in registry
Project context initialized: test-project-1-33804770 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-OxvKlw/test-project-1

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should register project in registry
[project-manager] Starting workflow recovery for test-project-1-33804770...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should register project in registry
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should register project in registry
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should register project in registry
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should register project in registry
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should register project in registry
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should register project in registry
[WakeupService] State recovery complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should register project in registry
[project-manager] Workflow recovery complete for test-project-1-33804770
[integration-sync] Starting for project test-project-1-33804770
[integration-sync] No enabled integrations found

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should register project in registry
Project opened successfully: test-project-1-33804770 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-OxvKlw/test-project-1

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should register project in registry
Shutting down ProjectManager...
Closing project: test-project-1-33804770
Shutting down project context: test-project-1-33804770

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should register project in registry
[integration-sync] Stopping for project test-project-1-33804770
[integration-sync] Service stopped for test-project-1-33804770

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should register project in registry
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-1-33804770

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should register project in registry
Project closed: test-project-1-33804770

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should register project in registry
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should track project as open
Initializing new database for test-project-1-2464c8ba at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-nBK5KN/test-project-1/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should track project as open
Project context initialized: test-project-1-2464c8ba at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-nBK5KN/test-project-1

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should track project as open
[project-manager] Starting workflow recovery for test-project-1-2464c8ba...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should track project as open
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should track project as open
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should track project as open
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should track project as open
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should track project as open
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should track project as open
[WakeupService] State recovery complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should track project as open
[project-manager] Workflow recovery complete for test-project-1-2464c8ba
[integration-sync] Starting for project test-project-1-2464c8ba
[integration-sync] No enabled integrations found

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should track project as open
Project opened successfully: test-project-1-2464c8ba at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-nBK5KN/test-project-1

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should track project as open
Shutting down ProjectManager...
Closing project: test-project-1-2464c8ba
Shutting down project context: test-project-1-2464c8ba

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should track project as open
[integration-sync] Stopping for project test-project-1-2464c8ba
[integration-sync] Service stopped for test-project-1-2464c8ba

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should track project as open
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-1-2464c8ba

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should track project as open
Project closed: test-project-1-2464c8ba

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/open > should track project as open
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/:projectId/close > should return 404 when project is not open
Shutting down ProjectManager...
ProjectManager shutdown complete

 âœ“ |@sudocode-ai/local-server| tests/integration/refresh-api.test.ts (11 tests) 2311ms
stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/:projectId/close > should successfully close open project
Initializing new database for test-project-1-3d3d6e27 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-2c1zFy/test-project-1/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/:projectId/close > should successfully close open project
Project context initialized: test-project-1-3d3d6e27 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-2c1zFy/test-project-1

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/:projectId/close > should successfully close open project
[project-manager] Starting workflow recovery for test-project-1-3d3d6e27...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/:projectId/close > should successfully close open project
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/:projectId/close > should successfully close open project
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/:projectId/close > should successfully close open project
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/:projectId/close > should successfully close open project
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/:projectId/close > should successfully close open project
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/:projectId/close > should successfully close open project
[WakeupService] State recovery complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/:projectId/close > should successfully close open project
[project-manager] Workflow recovery complete for test-project-1-3d3d6e27
[integration-sync] Starting for project test-project-1-3d3d6e27
[integration-sync] No enabled integrations found

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/:projectId/close > should successfully close open project
Project opened successfully: test-project-1-3d3d6e27 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-2c1zFy/test-project-1

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/:projectId/close > should successfully close open project
Closing project: test-project-1-3d3d6e27
Shutting down project context: test-project-1-3d3d6e27

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/:projectId/close > should successfully close open project
[integration-sync] Stopping for project test-project-1-3d3d6e27
[integration-sync] Service stopped for test-project-1-3d3d6e27

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/:projectId/close > should successfully close open project
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-1-3d3d6e27

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/:projectId/close > should successfully close open project
Database cached for test-project-1-3d3d6e27 (TTL: 1800000ms)
Project closed: test-project-1-3d3d6e27

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > resolveJSONLConflicts > should resolve JSONL conflicts using three-way merge
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/:projectId/close > should successfully close open project
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > DELETE /api/projects/:projectId > should return 404 for non-existent project
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > DELETE /api/projects/:projectId > should successfully unregister project
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > DELETE /api/projects/:projectId > should close project if it is open before unregistering
Initializing new database for test-project-1-571dd00f at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-Fs3EBn/test-project-1/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > DELETE /api/projects/:projectId > should close project if it is open before unregistering
Project context initialized: test-project-1-571dd00f at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-Fs3EBn/test-project-1

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > DELETE /api/projects/:projectId > should close project if it is open before unregistering
[project-manager] Starting workflow recovery for test-project-1-571dd00f...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > DELETE /api/projects/:projectId > should close project if it is open before unregistering
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > DELETE /api/projects/:projectId > should close project if it is open before unregistering
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > DELETE /api/projects/:projectId > should close project if it is open before unregistering
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > DELETE /api/projects/:projectId > should close project if it is open before unregistering
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > DELETE /api/projects/:projectId > should close project if it is open before unregistering
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > DELETE /api/projects/:projectId > should close project if it is open before unregistering
[WakeupService] State recovery complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > DELETE /api/projects/:projectId > should close project if it is open before unregistering
[project-manager] Workflow recovery complete for test-project-1-571dd00f
[integration-sync] Starting for project test-project-1-571dd00f
[integration-sync] No enabled integrations found

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > DELETE /api/projects/:projectId > should close project if it is open before unregistering
Project opened successfully: test-project-1-571dd00f at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-Fs3EBn/test-project-1

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > DELETE /api/projects/:projectId > should close project if it is open before unregistering
Closing project: test-project-1-571dd00f
Shutting down project context: test-project-1-571dd00f

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > DELETE /api/projects/:projectId > should close project if it is open before unregistering
[integration-sync] Stopping for project test-project-1-571dd00f
[integration-sync] Service stopped for test-project-1-571dd00f

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > DELETE /api/projects/:projectId > should close project if it is open before unregistering
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-1-571dd00f

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > DELETE /api/projects/:projectId > should close project if it is open before unregistering
Project closed: test-project-1-571dd00f

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > DELETE /api/projects/:projectId > should close project if it is open before unregistering
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/:projectId > should return 404 for non-existent project
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/:projectId > should return project info for registered project
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/:projectId > should include context summary for open project
Initializing new database for test-project-1-146bae16 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-0AyZHe/test-project-1/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/:projectId > should include context summary for open project
Project context initialized: test-project-1-146bae16 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-0AyZHe/test-project-1

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/:projectId > should include context summary for open project
[project-manager] Starting workflow recovery for test-project-1-146bae16...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/:projectId > should include context summary for open project
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/:projectId > should include context summary for open project
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/:projectId > should include context summary for open project
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/:projectId > should include context summary for open project
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/:projectId > should include context summary for open project
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/:projectId > should include context summary for open project
[WakeupService] State recovery complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/:projectId > should include context summary for open project
[project-manager] Workflow recovery complete for test-project-1-146bae16
[integration-sync] Starting for project test-project-1-146bae16
[integration-sync] No enabled integrations found

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/:projectId > should include context summary for open project
Project opened successfully: test-project-1-146bae16 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-0AyZHe/test-project-1

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/:projectId > should include context summary for open project
Shutting down ProjectManager...
Closing project: test-project-1-146bae16
Shutting down project context: test-project-1-146bae16

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/:projectId > should include context summary for open project
[integration-sync] Stopping for project test-project-1-146bae16
[integration-sync] Service stopped for test-project-1-146bae16

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/:projectId > should include context summary for open project
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-1-146bae16

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/:projectId > should include context summary for open project
Project closed: test-project-1-146bae16

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/:projectId > should include context summary for open project
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should return 400 when path is missing
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should return 404 for non-existent path
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should return 400 for path that is not a directory
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should successfully initialize new project
Initializing new project at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-FaLgtI/new-project
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should successfully initialize new project
Initializing new database for new-project-a5dec5a6 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-FaLgtI/new-project/.sudocode/cache.db

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should successfully initialize new project
Project context initialized: new-project-a5dec5a6 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-FaLgtI/new-project

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should successfully initialize new project
[project-manager] Starting workflow recovery for new-project-a5dec5a6...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should successfully initialize new project
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should successfully initialize new project
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should successfully initialize new project
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should successfully initialize new project
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should successfully initialize new project
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should successfully initialize new project
[WakeupService] State recovery complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should successfully initialize new project
[project-manager] Workflow recovery complete for new-project-a5dec5a6
[integration-sync] Starting for project new-project-a5dec5a6
[integration-sync] No enabled integrations found

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should successfully initialize new project
Project opened successfully: new-project-a5dec5a6 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-FaLgtI/new-project

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should successfully initialize new project
Shutting down ProjectManager...
Closing project: new-project-a5dec5a6
Shutting down project context: new-project-a5dec5a6

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should successfully initialize new project
[integration-sync] Stopping for project new-project-a5dec5a6
[integration-sync] Service stopped for new-project-a5dec5a6

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should successfully initialize new project
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: new-project-a5dec5a6

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should successfully initialize new project
Project closed: new-project-a5dec5a6

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should successfully initialize new project
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should set project name when provided
Initializing new project at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-6siP3F/named-project
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should set project name when provided
Initializing new database for named-project-9b9cc3bc at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-6siP3F/named-project/.sudocode/cache.db

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should set project name when provided
Project context initialized: named-project-9b9cc3bc at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-6siP3F/named-project

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should set project name when provided
[project-manager] Starting workflow recovery for named-project-9b9cc3bc...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should set project name when provided
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should set project name when provided
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should set project name when provided
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should set project name when provided
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should set project name when provided
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should set project name when provided
[WakeupService] State recovery complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should set project name when provided
[project-manager] Workflow recovery complete for named-project-9b9cc3bc
[integration-sync] Starting for project named-project-9b9cc3bc
[integration-sync] No enabled integrations found

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should set project name when provided
Project opened successfully: named-project-9b9cc3bc at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-6siP3F/named-project

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should set project name when provided
Shutting down ProjectManager...
Closing project: named-project-9b9cc3bc
Shutting down project context: named-project-9b9cc3bc

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should set project name when provided
[integration-sync] Stopping for project named-project-9b9cc3bc
[integration-sync] Service stopped for named-project-9b9cc3bc

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should set project name when provided
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: named-project-9b9cc3bc

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should set project name when provided
Project closed: named-project-9b9cc3bc

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should set project name when provided
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should open already initialized project without reinitializing
Initializing new project at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-B1g61A/test-project-1
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should open already initialized project without reinitializing
Initializing new database for test-project-1-eb398b52 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-B1g61A/test-project-1/.sudocode/cache.db

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should open already initialized project without reinitializing
Project context initialized: test-project-1-eb398b52 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-B1g61A/test-project-1

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should open already initialized project without reinitializing
[project-manager] Starting workflow recovery for test-project-1-eb398b52...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should open already initialized project without reinitializing
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should open already initialized project without reinitializing
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should open already initialized project without reinitializing
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should open already initialized project without reinitializing
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should open already initialized project without reinitializing
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should open already initialized project without reinitializing
[WakeupService] State recovery complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should open already initialized project without reinitializing
[project-manager] Workflow recovery complete for test-project-1-eb398b52
[integration-sync] Starting for project test-project-1-eb398b52
[integration-sync] No enabled integrations found

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should open already initialized project without reinitializing
Project opened successfully: test-project-1-eb398b52 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-B1g61A/test-project-1

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should open already initialized project without reinitializing
Shutting down ProjectManager...
Closing project: test-project-1-eb398b52
Shutting down project context: test-project-1-eb398b52

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should open already initialized project without reinitializing
[integration-sync] Stopping for project test-project-1-eb398b52
[integration-sync] Service stopped for test-project-1-eb398b52

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should open already initialized project without reinitializing
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-1-eb398b52

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should open already initialized project without reinitializing
Project closed: test-project-1-eb398b52

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should open already initialized project without reinitializing
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should register initialized project in registry
Initializing new project at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-plPcLi/registered-project
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should register initialized project in registry
Initializing new database for registered-project-92f36437 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-plPcLi/registered-project/.sudocode/cache.db

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should register initialized project in registry
Project context initialized: registered-project-92f36437 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-plPcLi/registered-project

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should register initialized project in registry
[project-manager] Starting workflow recovery for registered-project-92f36437...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should register initialized project in registry
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should register initialized project in registry
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should register initialized project in registry
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should register initialized project in registry
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should register initialized project in registry
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should register initialized project in registry
[WakeupService] State recovery complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should register initialized project in registry
[project-manager] Workflow recovery complete for registered-project-92f36437
[integration-sync] Starting for project registered-project-92f36437
[integration-sync] No enabled integrations found

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should register initialized project in registry
Project opened successfully: registered-project-92f36437 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-plPcLi/registered-project

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should register initialized project in registry
Shutting down ProjectManager...
Closing project: registered-project-92f36437
Shutting down project context: registered-project-92f36437

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should register initialized project in registry
[integration-sync] Stopping for project registered-project-92f36437
[integration-sync] Service stopped for registered-project-92f36437

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should register initialized project in registry
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: registered-project-92f36437

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should register initialized project in registry
Project closed: registered-project-92f36437

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should register initialized project in registry
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should track initialized project as open
Initializing new project at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-4p4dY5/open-project
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should track initialized project as open
Initializing new database for open-project-062c5fa2 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-4p4dY5/open-project/.sudocode/cache.db

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should track initialized project as open
Project context initialized: open-project-062c5fa2 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-4p4dY5/open-project

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should track initialized project as open
[project-manager] Starting workflow recovery for open-project-062c5fa2...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should track initialized project as open
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should track initialized project as open
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should track initialized project as open
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should track initialized project as open
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should track initialized project as open
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should track initialized project as open
[WakeupService] State recovery complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should track initialized project as open
[project-manager] Workflow recovery complete for open-project-062c5fa2
[integration-sync] Starting for project open-project-062c5fa2
[integration-sync] No enabled integrations found

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should track initialized project as open
Project opened successfully: open-project-062c5fa2 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-routes-test-4p4dY5/open-project

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should track initialized project as open
Shutting down ProjectManager...
Closing project: open-project-062c5fa2
Shutting down project context: open-project-062c5fa2

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should track initialized project as open
[integration-sync] Stopping for project open-project-062c5fa2
[integration-sync] Service stopped for open-project-062c5fa2

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should track initialized project as open
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: open-project-062c5fa2

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should track initialized project as open
Project closed: open-project-062c5fa2

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > POST /api/projects/init > should track initialized project as open
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/browse > should return home directory contents when no path provided
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/browse > should return directory contents for valid path
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/browse > should include entry metadata
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/browse > should detect directories with .sudocode folder
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/browse > should return parentPath for non-root directories
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/browse > should return null parentPath for root directory
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/browse > should exclude hidden directories
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/browse > should return 404 for non-existent path
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/browse > should return 400 for path that is not a directory
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > GET /api/projects/browse > should return entries sorted alphabetically
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/routes/projects.test.ts > Projects API Routes > error handling > should handle internal errors gracefully
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > resolveJSONLConflicts > should handle empty conflict list
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > resolveJSONLConflicts > should throw error if file does not exist at revision
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > commitUncommittedJSONL > should commit uncommitted JSONL files
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/local-server| tests/unit/routes/projects.test.ts (44 tests) 4449ms
   âœ“ Projects API Routes > GET /api/projects > should return empty array when no projects registered  450ms
   âœ“ Projects API Routes > POST /api/projects/validate > should return 400 when path is missing  373ms
   âœ“ Projects API Routes > POST /api/projects/validate > should not keep project open after validation  384ms
 âœ“ |@sudocode-ai/local-server| tests/integration/execution/worktree-sync-conflicts.test.ts (21 tests) 25517ms
   âœ“ ConflictDetector Integration > Scenario 1: Clean Merge (No Conflicts) > should detect no conflicts when branches merge cleanly  881ms
   âœ“ ConflictDetector Integration > Scenario 2: JSONL Conflicts Only > should detect and classify JSONL conflicts as auto-resolvable  1361ms
   âœ“ ConflictDetector Integration > Scenario 2: JSONL Conflicts Only > should classify specs.jsonl as spec entity type  1078ms
   âœ“ ConflictDetector Integration > Scenario 3: Code Conflicts Only > should detect code conflicts requiring manual resolution  1591ms
   âœ“ ConflictDetector Integration > Scenario 4: Mixed Conflicts > should handle both JSONL and code conflicts  2809ms
   âœ“ ConflictDetector Integration > Scenario 5: Multiple Files > should detect conflicts across multiple files  3540ms
   âœ“ ConflictDetector Integration > Scenario 6: Binary File Conflict > should handle binary file conflicts  1257ms
   âœ“ ConflictDetector Integration > Scenario 7: Nested Directories > should handle conflicts in nested directory structures  1479ms
   âœ“ ConflictDetector Integration > Scenario 8: .sudocode directory at different paths > should detect JSONL conflicts in .sudocode directory  962ms
   âœ“ GitSyncCli Integration > getMergeBase > should find merge base correctly  1270ms
   âœ“ GitSyncCli Integration > getMergeBase > should find same merge base for main and feature branch  538ms
   âœ“ GitSyncCli Integration > getDiff > should get diff between commits  725ms
   âœ“ GitSyncCli Integration > getCommitList > should get commit list between refs  752ms
   âœ“ GitSyncCli Integration > isWorkingTreeClean > should detect clean working tree  368ms
   âœ“ GitSyncCli Integration > isWorkingTreeClean > should detect dirty working tree  811ms
   âœ“ GitSyncCli Integration > isWorkingTreeClean > should ignore untracked files  600ms
   âœ“ GitSyncCli Integration > getUncommittedFiles > should detect uncommitted JSONL changes  1019ms
   âœ“ GitSyncCli Integration > getUncommittedFiles > should filter uncommitted files by pattern  928ms
   âœ“ GitSyncCli Integration > createSafetyTag > should create a safety tag  788ms
   âœ“ GitSyncCli Integration > checkMergeConflicts > should detect no conflicts for clean merge  879ms
   âœ“ GitSyncCli Integration > checkMergeConflicts > should detect conflicts for conflicting changes  795ms
stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > commitUncommittedJSONL > should handle empty file list
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > commitUncommittedJSONL > should handle multiple files
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should return 400 when X-Project-ID header is missing
Initializing new database for test-project-283fea7e at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-bbijCO/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should return 400 when X-Project-ID header is missing
Project context initialized: test-project-283fea7e at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-bbijCO/test-project

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should return 400 when X-Project-ID header is missing
[project-manager] Starting workflow recovery for test-project-283fea7e...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should return 400 when X-Project-ID header is missing
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should return 400 when X-Project-ID header is missing
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should return 400 when X-Project-ID header is missing
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should return 400 when X-Project-ID header is missing
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should return 400 when X-Project-ID header is missing
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should return 400 when X-Project-ID header is missing
[WakeupService] State recovery complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should return 400 when X-Project-ID header is missing
[project-manager] Workflow recovery complete for test-project-283fea7e
[integration-sync] Starting for project test-project-283fea7e
[integration-sync] No enabled integrations found

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should return 400 when X-Project-ID header is missing
Project opened successfully: test-project-283fea7e at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-bbijCO/test-project

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should return 400 when X-Project-ID header is missing
Shutting down ProjectManager...
Closing project: test-project-283fea7e
Shutting down project context: test-project-283fea7e

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should return 400 when X-Project-ID header is missing
[integration-sync] Stopping for project test-project-283fea7e
[integration-sync] Service stopped for test-project-283fea7e

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should return 400 when X-Project-ID header is missing
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-283fea7e

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should return 400 when X-Project-ID header is missing
Project closed: test-project-283fea7e

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should return 400 when X-Project-ID header is missing
ProjectManager shutdown complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should return 404 when project is not found
Initializing new database for test-project-4c535e3b at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-b3U7VD/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should return 404 when project is not found
Project context initialized: test-project-4c535e3b at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-b3U7VD/test-project

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should return 404 when project is not found
[project-manager] Starting workflow recovery for test-project-4c535e3b...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should return 404 when project is not found
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should return 404 when project is not found
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should return 404 when project is not found
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should return 404 when project is not found
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should return 404 when project is not found
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should return 404 when project is not found
[WakeupService] State recovery complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should return 404 when project is not found
[project-manager] Workflow recovery complete for test-project-4c535e3b
[integration-sync] Starting for project test-project-4c535e3b
[integration-sync] No enabled integrations found

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should return 404 when project is not found
Project opened successfully: test-project-4c535e3b at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-b3U7VD/test-project

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should return 404 when project is not found
Shutting down ProjectManager...
Closing project: test-project-4c535e3b
Shutting down project context: test-project-4c535e3b

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should return 404 when project is not found
[integration-sync] Stopping for project test-project-4c535e3b
[integration-sync] Service stopped for test-project-4c535e3b

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should return 404 when project is not found
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-4c535e3b

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should return 404 when project is not found
Project closed: test-project-4c535e3b

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should return 404 when project is not found
ProjectManager shutdown complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should inject project context when project exists
Initializing new database for test-project-722c5a13 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-g5sFAu/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should inject project context when project exists
Project context initialized: test-project-722c5a13 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-g5sFAu/test-project

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should inject project context when project exists
[project-manager] Starting workflow recovery for test-project-722c5a13...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should inject project context when project exists
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should inject project context when project exists
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should inject project context when project exists
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should inject project context when project exists
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should inject project context when project exists
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should inject project context when project exists
[WakeupService] State recovery complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should inject project context when project exists
[project-manager] Workflow recovery complete for test-project-722c5a13
[integration-sync] Starting for project test-project-722c5a13
[integration-sync] No enabled integrations found

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should inject project context when project exists
Project opened successfully: test-project-722c5a13 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-g5sFAu/test-project

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should inject project context when project exists
Shutting down ProjectManager...
Closing project: test-project-722c5a13
Shutting down project context: test-project-722c5a13

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should inject project context when project exists
[integration-sync] Stopping for project test-project-722c5a13
[integration-sync] Service stopped for test-project-722c5a13

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should inject project context when project exists
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-722c5a13

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should inject project context when project exists
Project closed: test-project-722c5a13

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should inject project context when project exists
ProjectManager shutdown complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle lowercase x-project-id header
Initializing new database for test-project-8bac06a9 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-Srztmf/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle lowercase x-project-id header
Project context initialized: test-project-8bac06a9 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-Srztmf/test-project

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle lowercase x-project-id header
[project-manager] Starting workflow recovery for test-project-8bac06a9...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle lowercase x-project-id header
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle lowercase x-project-id header
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle lowercase x-project-id header
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle lowercase x-project-id header
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle lowercase x-project-id header
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle lowercase x-project-id header
[WakeupService] State recovery complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle lowercase x-project-id header
[project-manager] Workflow recovery complete for test-project-8bac06a9
[integration-sync] Starting for project test-project-8bac06a9
[integration-sync] No enabled integrations found

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle lowercase x-project-id header
Project opened successfully: test-project-8bac06a9 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-Srztmf/test-project

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle lowercase x-project-id header
Shutting down ProjectManager...
Closing project: test-project-8bac06a9
Shutting down project context: test-project-8bac06a9

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle lowercase x-project-id header
[integration-sync] Stopping for project test-project-8bac06a9
[integration-sync] Service stopped for test-project-8bac06a9

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle lowercase x-project-id header
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-8bac06a9

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > stageSync > should stage changes without committing
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle lowercase x-project-id header
Project closed: test-project-8bac06a9

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle lowercase x-project-id header
ProjectManager shutdown complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle case variations of header name
Initializing new database for test-project-0e77b210 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-iB8pE4/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle case variations of header name
Project context initialized: test-project-0e77b210 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-iB8pE4/test-project

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle case variations of header name
[project-manager] Starting workflow recovery for test-project-0e77b210...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle case variations of header name
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle case variations of header name
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle case variations of header name
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle case variations of header name
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle case variations of header name
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle case variations of header name
[WakeupService] State recovery complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle case variations of header name
[project-manager] Workflow recovery complete for test-project-0e77b210
[integration-sync] Starting for project test-project-0e77b210
[integration-sync] No enabled integrations found

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle case variations of header name
Project opened successfully: test-project-0e77b210 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-iB8pE4/test-project

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle case variations of header name
Shutting down ProjectManager...
Closing project: test-project-0e77b210
Shutting down project context: test-project-0e77b210

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle case variations of header name
[integration-sync] Stopping for project test-project-0e77b210
[integration-sync] Service stopped for test-project-0e77b210

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle case variations of header name
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-0e77b210

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle case variations of header name
Project closed: test-project-0e77b210

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle case variations of header name
ProjectManager shutdown complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle string header values correctly
Initializing new database for test-project-9539fcb5 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-4gP2p5/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle string header values correctly
Project context initialized: test-project-9539fcb5 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-4gP2p5/test-project

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle string header values correctly
[project-manager] Starting workflow recovery for test-project-9539fcb5...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle string header values correctly
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle string header values correctly
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle string header values correctly
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle string header values correctly
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle string header values correctly
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle string header values correctly
[WakeupService] State recovery complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle string header values correctly
[project-manager] Workflow recovery complete for test-project-9539fcb5
[integration-sync] Starting for project test-project-9539fcb5
[integration-sync] No enabled integrations found

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle string header values correctly
Project opened successfully: test-project-9539fcb5 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-4gP2p5/test-project

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle string header values correctly
Shutting down ProjectManager...
Closing project: test-project-9539fcb5
Shutting down project context: test-project-9539fcb5

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle string header values correctly
[integration-sync] Stopping for project test-project-9539fcb5
[integration-sync] Service stopped for test-project-9539fcb5

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle string header values correctly
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-9539fcb5

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle string header values correctly
Project closed: test-project-9539fcb5

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should handle string header values correctly
ProjectManager shutdown complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should reject requests after project is closed
Initializing new database for test-project-3d69da3d at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-hxJdEP/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should reject requests after project is closed
Project context initialized: test-project-3d69da3d at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-hxJdEP/test-project

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should reject requests after project is closed
[project-manager] Starting workflow recovery for test-project-3d69da3d...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should reject requests after project is closed
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should reject requests after project is closed
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should reject requests after project is closed
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should reject requests after project is closed
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should reject requests after project is closed
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should reject requests after project is closed
[WakeupService] State recovery complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should reject requests after project is closed
[project-manager] Workflow recovery complete for test-project-3d69da3d
[integration-sync] Starting for project test-project-3d69da3d
[integration-sync] No enabled integrations found

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should reject requests after project is closed
Project opened successfully: test-project-3d69da3d at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-hxJdEP/test-project

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should reject requests after project is closed
Closing project: test-project-3d69da3d
Shutting down project context: test-project-3d69da3d

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should reject requests after project is closed
[integration-sync] Stopping for project test-project-3d69da3d
[integration-sync] Service stopped for test-project-3d69da3d

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should reject requests after project is closed
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-3d69da3d

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should reject requests after project is closed
Database cached for test-project-3d69da3d (TTL: 1800000ms)
Project closed: test-project-3d69da3d

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should reject requests after project is closed
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should work with multiple routes using same middleware
Initializing new database for test-project-8464918e at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-gvEtHF/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should work with multiple routes using same middleware
Project context initialized: test-project-8464918e at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-gvEtHF/test-project

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should work with multiple routes using same middleware
[project-manager] Starting workflow recovery for test-project-8464918e...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should work with multiple routes using same middleware
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should work with multiple routes using same middleware
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should work with multiple routes using same middleware
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should work with multiple routes using same middleware
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should work with multiple routes using same middleware
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should work with multiple routes using same middleware
[WakeupService] State recovery complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should work with multiple routes using same middleware
[project-manager] Workflow recovery complete for test-project-8464918e
[integration-sync] Starting for project test-project-8464918e
[integration-sync] No enabled integrations found

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should work with multiple routes using same middleware
Project opened successfully: test-project-8464918e at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-gvEtHF/test-project

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should work with multiple routes using same middleware
Shutting down ProjectManager...
Closing project: test-project-8464918e
Shutting down project context: test-project-8464918e

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should work with multiple routes using same middleware
[integration-sync] Stopping for project test-project-8464918e
[integration-sync] Service stopped for test-project-8464918e

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should work with multiple routes using same middleware
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-8464918e

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should work with multiple routes using same middleware
Project closed: test-project-8464918e

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > requireProject middleware > should work with multiple routes using same middleware
ProjectManager shutdown complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should allow requests without X-Project-ID header
Initializing new database for test-project-be059b8a at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-Cg9sI4/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should allow requests without X-Project-ID header
Project context initialized: test-project-be059b8a at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-Cg9sI4/test-project

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should allow requests without X-Project-ID header
[project-manager] Starting workflow recovery for test-project-be059b8a...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should allow requests without X-Project-ID header
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should allow requests without X-Project-ID header
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should allow requests without X-Project-ID header
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should allow requests without X-Project-ID header
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should allow requests without X-Project-ID header
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should allow requests without X-Project-ID header
[WakeupService] State recovery complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should allow requests without X-Project-ID header
[project-manager] Workflow recovery complete for test-project-be059b8a
[integration-sync] Starting for project test-project-be059b8a
[integration-sync] No enabled integrations found

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should allow requests without X-Project-ID header
Project opened successfully: test-project-be059b8a at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-Cg9sI4/test-project

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should allow requests without X-Project-ID header
Shutting down ProjectManager...
Closing project: test-project-be059b8a
Shutting down project context: test-project-be059b8a

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should allow requests without X-Project-ID header
[integration-sync] Stopping for project test-project-be059b8a
[integration-sync] Service stopped for test-project-be059b8a

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should allow requests without X-Project-ID header
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-be059b8a

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should allow requests without X-Project-ID header
Project closed: test-project-be059b8a

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should allow requests without X-Project-ID header
ProjectManager shutdown complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should inject project when valid header is provided
Initializing new database for test-project-5099a4c4 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-RH3pax/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should inject project when valid header is provided
Project context initialized: test-project-5099a4c4 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-RH3pax/test-project

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should inject project when valid header is provided
[project-manager] Starting workflow recovery for test-project-5099a4c4...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should inject project when valid header is provided
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should inject project when valid header is provided
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should inject project when valid header is provided
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should inject project when valid header is provided
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should inject project when valid header is provided
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should inject project when valid header is provided
[WakeupService] State recovery complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should inject project when valid header is provided
[project-manager] Workflow recovery complete for test-project-5099a4c4
[integration-sync] Starting for project test-project-5099a4c4
[integration-sync] No enabled integrations found

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should inject project when valid header is provided
Project opened successfully: test-project-5099a4c4 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-RH3pax/test-project

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should inject project when valid header is provided
Shutting down ProjectManager...
Closing project: test-project-5099a4c4
Shutting down project context: test-project-5099a4c4

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should inject project when valid header is provided
[integration-sync] Stopping for project test-project-5099a4c4
[integration-sync] Service stopped for test-project-5099a4c4

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should inject project when valid header is provided
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-5099a4c4

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should inject project when valid header is provided
Project closed: test-project-5099a4c4

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should inject project when valid header is provided
ProjectManager shutdown complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should not error when project is not found
Initializing new database for test-project-b143179a at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-UrNHqx/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should not error when project is not found
Project context initialized: test-project-b143179a at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-UrNHqx/test-project

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should not error when project is not found
[project-manager] Starting workflow recovery for test-project-b143179a...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should not error when project is not found
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should not error when project is not found
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should not error when project is not found
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should not error when project is not found
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should not error when project is not found
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should not error when project is not found
[WakeupService] State recovery complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should not error when project is not found
[project-manager] Workflow recovery complete for test-project-b143179a
[integration-sync] Starting for project test-project-b143179a
[integration-sync] No enabled integrations found

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should not error when project is not found
Project opened successfully: test-project-b143179a at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-UrNHqx/test-project

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should not error when project is not found
Shutting down ProjectManager...
Closing project: test-project-b143179a
Shutting down project context: test-project-b143179a

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should not error when project is not found
[integration-sync] Stopping for project test-project-b143179a
[integration-sync] Service stopped for test-project-b143179a

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should not error when project is not found
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-b143179a

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should not error when project is not found
Project closed: test-project-b143179a

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should not error when project is not found
ProjectManager shutdown complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should handle lowercase header name
Initializing new database for test-project-18ac412e at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-ruaRN5/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should handle lowercase header name
Project context initialized: test-project-18ac412e at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-ruaRN5/test-project

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should handle lowercase header name
[project-manager] Starting workflow recovery for test-project-18ac412e...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should handle lowercase header name
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should handle lowercase header name
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should handle lowercase header name
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should handle lowercase header name
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should handle lowercase header name
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should handle lowercase header name
[WakeupService] State recovery complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should handle lowercase header name
[project-manager] Workflow recovery complete for test-project-18ac412e
[integration-sync] Starting for project test-project-18ac412e
[integration-sync] No enabled integrations found

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should handle lowercase header name
Project opened successfully: test-project-18ac412e at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-ruaRN5/test-project

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should handle lowercase header name
Shutting down ProjectManager...
Closing project: test-project-18ac412e
Shutting down project context: test-project-18ac412e

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should handle lowercase header name
[integration-sync] Stopping for project test-project-18ac412e
[integration-sync] Service stopped for test-project-18ac412e

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should handle lowercase header name
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-18ac412e

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should handle lowercase header name
Project closed: test-project-18ac412e

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should handle lowercase header name
ProjectManager shutdown complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should work with routes that handle both cases
Initializing new database for test-project-041d9f2e at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-HBYPyZ/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should work with routes that handle both cases
Project context initialized: test-project-041d9f2e at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-HBYPyZ/test-project

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should work with routes that handle both cases
[project-manager] Starting workflow recovery for test-project-041d9f2e...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should work with routes that handle both cases
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should work with routes that handle both cases
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should work with routes that handle both cases
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should work with routes that handle both cases
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should work with routes that handle both cases
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should work with routes that handle both cases
[WakeupService] State recovery complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should work with routes that handle both cases
[project-manager] Workflow recovery complete for test-project-041d9f2e
[integration-sync] Starting for project test-project-041d9f2e
[integration-sync] No enabled integrations found

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should work with routes that handle both cases
Project opened successfully: test-project-041d9f2e at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-HBYPyZ/test-project

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should work with routes that handle both cases
Shutting down ProjectManager...
Closing project: test-project-041d9f2e
Shutting down project context: test-project-041d9f2e

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should work with routes that handle both cases
[integration-sync] Stopping for project test-project-041d9f2e
[integration-sync] Service stopped for test-project-041d9f2e

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should work with routes that handle both cases
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-041d9f2e

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > sudocode-mcp detection and error handling > should throw error with helpful message when detectSudocodeMcp() returns false
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should work with routes that handle both cases
Project closed: test-project-041d9f2e

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > optionalProject middleware > should work with routes that handle both cases
ProjectManager shutdown complete

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > sudocode-mcp detection and error handling > should include github.com/sudocode-ai/sudocode link in error message
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > sudocode-mcp detection and error handling > should include installation instructions in error message
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > MCP server auto-injection > should add sudocode-mcp to mcpServers when detectAgentMcp() returns false
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > MCP server auto-injection > should add sudocode-mcp to mcpServers when detectAgentMcp() returns false
[ExecutionService] sudocode-mcp not detected for claude-code (plugin not enabled)

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > MCP server auto-injection > should add sudocode-mcp to mcpServers when detectAgentMcp() returns false
[ExecutionService] Adding sudocode-mcp to mcpServers (auto-injection)

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > MCP server auto-injection > should skip injection when detectAgentMcp() returns true (plugin already configured)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > MCP server auto-injection > should skip injection when detectAgentMcp() returns true (plugin already configured)
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > MCP server auto-injection > should skip injection when detectAgentMcp() returns true (plugin already configured)
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > MCP server auto-injection > should remove sudocode-mcp from userConfig when plugin is detected
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > middleware integration > should allow mixing requireProject and optionalProject
Initializing new database for test-project-26b62a26 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-P9A1Ny/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > middleware integration > should allow mixing requireProject and optionalProject
Project context initialized: test-project-26b62a26 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-P9A1Ny/test-project

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > middleware integration > should allow mixing requireProject and optionalProject
[project-manager] Starting workflow recovery for test-project-26b62a26...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > middleware integration > should allow mixing requireProject and optionalProject
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > middleware integration > should allow mixing requireProject and optionalProject
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > middleware integration > should allow mixing requireProject and optionalProject
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > middleware integration > should allow mixing requireProject and optionalProject
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > middleware integration > should allow mixing requireProject and optionalProject
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > middleware integration > should allow mixing requireProject and optionalProject
[WakeupService] State recovery complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > middleware integration > should allow mixing requireProject and optionalProject
[project-manager] Workflow recovery complete for test-project-26b62a26
[integration-sync] Starting for project test-project-26b62a26
[integration-sync] No enabled integrations found

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > middleware integration > should allow mixing requireProject and optionalProject
Project opened successfully: test-project-26b62a26 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-P9A1Ny/test-project

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > MCP server auto-injection > should set mcpServers to undefined when only sudocode-mcp is removed
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > MCP server auto-injection > should preserve user-provided MCP servers when auto-injecting
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > MCP server auto-injection > should not duplicate sudocode-mcp if user already provided it
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > middleware integration > should allow mixing requireProject and optionalProject
Shutting down ProjectManager...
Closing project: test-project-26b62a26
Shutting down project context: test-project-26b62a26

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > middleware integration > should allow mixing requireProject and optionalProject
[integration-sync] Stopping for project test-project-26b62a26
[integration-sync] Service stopped for test-project-26b62a26

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > middleware integration > should allow mixing requireProject and optionalProject
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-26b62a26

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > middleware integration > should allow mixing requireProject and optionalProject
Project closed: test-project-26b62a26

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > middleware integration > should allow mixing requireProject and optionalProject
ProjectManager shutdown complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > middleware integration > should provide type-safe access to req.project
Initializing new database for test-project-6ce45327 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-rlyrrN/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > middleware integration > should provide type-safe access to req.project
Project context initialized: test-project-6ce45327 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-rlyrrN/test-project

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > middleware integration > should provide type-safe access to req.project
[project-manager] Starting workflow recovery for test-project-6ce45327...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > middleware integration > should provide type-safe access to req.project
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > middleware integration > should provide type-safe access to req.project
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > middleware integration > should provide type-safe access to req.project
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > middleware integration > should provide type-safe access to req.project
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > middleware integration > should provide type-safe access to req.project
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > middleware integration > should provide type-safe access to req.project
[WakeupService] State recovery complete

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > config merging and structure > should handle empty/undefined userConfig.mcpServers gracefully
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > middleware integration > should provide type-safe access to req.project
[project-manager] Workflow recovery complete for test-project-6ce45327
[integration-sync] Starting for project test-project-6ce45327
[integration-sync] No enabled integrations found

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > middleware integration > should provide type-safe access to req.project
Project opened successfully: test-project-6ce45327 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-rlyrrN/test-project

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > middleware integration > should provide type-safe access to req.project
Shutting down ProjectManager...
Closing project: test-project-6ce45327
Shutting down project context: test-project-6ce45327

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > middleware integration > should provide type-safe access to req.project
[integration-sync] Stopping for project test-project-6ce45327
[integration-sync] Service stopped for test-project-6ce45327

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > middleware integration > should provide type-safe access to req.project
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-6ce45327

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > middleware integration > should provide type-safe access to req.project
Project closed: test-project-6ce45327

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > middleware integration > should provide type-safe access to req.project
ProjectManager shutdown complete

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > config merging and structure > should return proper merged config structure
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should handle errors from projectManager gracefully
Initializing new database for test-project-e1a1f8e4 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-AowEFR/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should handle errors from projectManager gracefully
Project context initialized: test-project-e1a1f8e4 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-AowEFR/test-project

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should handle errors from projectManager gracefully
[project-manager] Starting workflow recovery for test-project-e1a1f8e4...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should handle errors from projectManager gracefully
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should handle errors from projectManager gracefully
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should handle errors from projectManager gracefully
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should handle errors from projectManager gracefully
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should handle errors from projectManager gracefully
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should handle errors from projectManager gracefully
[WakeupService] State recovery complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should handle errors from projectManager gracefully
[project-manager] Workflow recovery complete for test-project-e1a1f8e4
[integration-sync] Starting for project test-project-e1a1f8e4
[integration-sync] No enabled integrations found

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should handle errors from projectManager gracefully
Project opened successfully: test-project-e1a1f8e4 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-AowEFR/test-project

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should handle errors from projectManager gracefully
Shutting down ProjectManager...
Closing project: test-project-e1a1f8e4
Shutting down project context: test-project-e1a1f8e4

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should handle errors from projectManager gracefully
[integration-sync] Stopping for project test-project-e1a1f8e4
[integration-sync] Service stopped for test-project-e1a1f8e4

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should handle errors from projectManager gracefully
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-e1a1f8e4

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should handle errors from projectManager gracefully
Project closed: test-project-e1a1f8e4

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should handle errors from projectManager gracefully
ProjectManager shutdown complete

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > config merging and structure > should not mutate original userConfig object
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should not call next() on error responses
Initializing new database for test-project-50fad680 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-o9fGrt/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should not call next() on error responses
Project context initialized: test-project-50fad680 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-o9fGrt/test-project

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should not call next() on error responses
[project-manager] Starting workflow recovery for test-project-50fad680...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should not call next() on error responses
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should not call next() on error responses
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should not call next() on error responses
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should not call next() on error responses
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should not call next() on error responses
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should not call next() on error responses
[WakeupService] State recovery complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should not call next() on error responses
[project-manager] Workflow recovery complete for test-project-50fad680
[integration-sync] Starting for project test-project-50fad680
[integration-sync] No enabled integrations found

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should not call next() on error responses
Project opened successfully: test-project-50fad680 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-o9fGrt/test-project

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should not call next() on error responses
Shutting down ProjectManager...
Closing project: test-project-50fad680
Shutting down project context: test-project-50fad680

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should not call next() on error responses
[integration-sync] Stopping for project test-project-50fad680
[integration-sync] Service stopped for test-project-50fad680

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should not call next() on error responses
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-50fad680

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should not call next() on error responses
Project closed: test-project-50fad680

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should not call next() on error responses
ProjectManager shutdown complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should call next() on success
Initializing new database for test-project-aed23308 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-DoFOrr/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should call next() on success
Project context initialized: test-project-aed23308 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-DoFOrr/test-project

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should call next() on success
[project-manager] Starting workflow recovery for test-project-aed23308...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should call next() on success
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should call next() on success
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should call next() on success
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should call next() on success
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should call next() on success
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should call next() on success
[WakeupService] State recovery complete

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should call next() on success
[project-manager] Workflow recovery complete for test-project-aed23308
[integration-sync] Starting for project test-project-aed23308
[integration-sync] No enabled integrations found

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should call next() on success
Project opened successfully: test-project-aed23308 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-middleware-test-DoFOrr/test-project

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should call next() on success
Shutting down ProjectManager...
Closing project: test-project-aed23308
Shutting down project context: test-project-aed23308

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should call next() on success
[integration-sync] Stopping for project test-project-aed23308
[integration-sync] Service stopped for test-project-aed23308

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should call next() on success
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-aed23308

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should call next() on success
Project closed: test-project-aed23308

stdout | tests/unit/middleware/project-context.test.ts > Project Context Middleware > error handling > should call next() on success
ProjectManager shutdown complete

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > stageSync > should return error when code conflicts exist
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent type handling > should work with claude-code agent type
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent type handling > should work with other agent types (extensibility)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > config preservation across execution runs > should preserve manually configured sudocode-mcp when plugin not installed
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > config preservation across execution runs > should handle multiple follow-up runs with plugin installed
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > config preservation across execution runs > should preserve other config fields during MCP server modification
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > complex MCP server configurations > should preserve non-sudocode MCP servers when plugin is present
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > complex MCP server configurations > should preserve non-sudocode MCP servers when plugin is not present
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > complex MCP server configurations > should handle complex MCP server configurations with env and args
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent defaults merging > should merge agent default config with user config
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent defaults merging > should merge agent default config with user config
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent defaults merging > should merge agent default config with user config
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent defaults merging > should merge agent default config with user config
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent defaults merging > should merge agent default config with user config
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent defaults merging > should merge agent default config with user config
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent defaults merging > should merge agent default config with user config
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent defaults merging > should merge agent default config with user config
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent defaults merging > should merge agent default config with user config
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent defaults merging > should merge agent default config with user config
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent defaults merging > should merge agent default config with user config
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent defaults merging > should merge agent default config with user config
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent defaults merging > should allow user config to override defaults
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent defaults merging > should allow user config to override defaults
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent defaults merging > should allow user config to override defaults
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent defaults merging > should allow user config to override defaults
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent defaults merging > should allow user config to override defaults
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent defaults merging > should allow user config to override defaults
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent defaults merging > should allow user config to override defaults
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent defaults merging > should allow user config to override defaults
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent defaults merging > should allow user config to override defaults
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent defaults merging > should allow user config to override defaults
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent defaults merging > should allow user config to override defaults
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent defaults merging > should allow user config to override defaults
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent defaults merging > should filter undefined values from user config so they don't override defaults
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent defaults merging > should filter undefined values from user config so they don't override defaults
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent defaults merging > should filter undefined values from user config so they don't override defaults
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent defaults merging > should filter undefined values from user config so they don't override defaults
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent defaults merging > should filter undefined values from user config so they don't override defaults
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent defaults merging > should filter undefined values from user config so they don't override defaults
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent defaults merging > should filter undefined values from user config so they don't override defaults
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent defaults merging > should filter undefined values from user config so they don't override defaults
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent defaults merging > should filter undefined values from user config so they don't override defaults
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent defaults merging > should filter undefined values from user config so they don't override defaults
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent defaults merging > should filter undefined values from user config so they don't override defaults
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > agent defaults merging > should filter undefined values from user config so they don't override defaults
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > error scenarios > should provide clear error message when sudocode-mcp package is missing
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-build-config.test.ts > ExecutionService.buildExecutionConfig > error scenarios > should handle detection errors gracefully
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/watcher.test.ts > File Watcher > Timestamp Behavior (File Modification Time) > should sync DB to markdown when database is genuinely newer than file (via direct DB update)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/local-server| tests/unit/middleware/project-context.test.ts (18 tests) 3206ms
   âœ“ Project Context Middleware > requireProject middleware > should return 400 when X-Project-ID header is missing  425ms
 â¯ |@sudocode-ai/local-server| tests/unit/services/execution-service-build-config.test.ts (25 tests | 3 failed) 1855ms
   âœ“ ExecutionService.buildExecutionConfig > sudocode-mcp detection and error handling > should throw error with helpful message when detectSudocodeMcp() returns false 33ms
   âœ“ ExecutionService.buildExecutionConfig > sudocode-mcp detection and error handling > should include github.com/sudocode-ai/sudocode link in error message 2ms
   âœ“ ExecutionService.buildExecutionConfig > sudocode-mcp detection and error handling > should include installation instructions in error message 3ms
   âœ“ ExecutionService.buildExecutionConfig > MCP server auto-injection > should add sudocode-mcp to mcpServers when detectAgentMcp() returns false 2ms
   âœ“ ExecutionService.buildExecutionConfig > MCP server auto-injection > should skip injection when detectAgentMcp() returns true (plugin already configured) 2ms
   âœ“ ExecutionService.buildExecutionConfig > MCP server auto-injection > should remove sudocode-mcp from userConfig when plugin is detected 136ms
   âœ“ ExecutionService.buildExecutionConfig > MCP server auto-injection > should set mcpServers to undefined when only sudocode-mcp is removed 17ms
   âœ“ ExecutionService.buildExecutionConfig > MCP server auto-injection > should preserve user-provided MCP servers when auto-injecting 15ms
   âœ“ ExecutionService.buildExecutionConfig > MCP server auto-injection > should not duplicate sudocode-mcp if user already provided it 22ms
   âœ“ ExecutionService.buildExecutionConfig > config merging and structure > should handle empty/undefined userConfig.mcpServers gracefully 39ms
   âœ“ ExecutionService.buildExecutionConfig > config merging and structure > should return proper merged config structure 15ms
   âœ“ ExecutionService.buildExecutionConfig > config merging and structure > should not mutate original userConfig object 142ms
   âœ“ ExecutionService.buildExecutionConfig > agent type handling > should work with claude-code agent type 114ms
   âœ“ ExecutionService.buildExecutionConfig > agent type handling > should work with other agent types (extensibility) 59ms
   âœ“ ExecutionService.buildExecutionConfig > config preservation across execution runs > should preserve manually configured sudocode-mcp when plugin not installed 7ms
   âœ“ ExecutionService.buildExecutionConfig > config preservation across execution runs > should handle multiple follow-up runs with plugin installed 12ms
   âœ“ ExecutionService.buildExecutionConfig > config preservation across execution runs > should preserve other config fields during MCP server modification 7ms
   âœ“ ExecutionService.buildExecutionConfig > complex MCP server configurations > should preserve non-sudocode MCP servers when plugin is present 2ms
   âœ“ ExecutionService.buildExecutionConfig > complex MCP server configurations > should preserve non-sudocode MCP servers when plugin is not present 4ms
   âœ“ ExecutionService.buildExecutionConfig > complex MCP server configurations > should handle complex MCP server configurations with env and args 12ms
   Ã— ExecutionService.buildExecutionConfig > agent defaults merging > should merge agent default config with user config 100ms (retry x3)
     â†’ expected undefined to be defined
     â†’ expected undefined to be defined
     â†’ expected undefined to be defined
     â†’ expected undefined to be defined
   Ã— ExecutionService.buildExecutionConfig > agent defaults merging > should allow user config to override defaults 16ms (retry x3)
     â†’ expected undefined to be true // Object.is equality
     â†’ expected undefined to be true // Object.is equality
     â†’ expected undefined to be true // Object.is equality
     â†’ expected undefined to be true // Object.is equality
   Ã— ExecutionService.buildExecutionConfig > agent defaults merging > should filter undefined values from user config so they don't override defaults 26ms (retry x3)
     â†’ the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string
     â†’ the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string
     â†’ the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string
     â†’ the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string
   âœ“ ExecutionService.buildExecutionConfig > error scenarios > should provide clear error message when sudocode-mcp package is missing 4ms
   âœ“ ExecutionService.buildExecutionConfig > error scenarios > should handle detection errors gracefully 2ms
stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > stageSync > should handle uncommitted JSONL files
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/local-server| tests/unit/routes/executions.test.ts (54 tests) 2783ms
   âœ“ Executions API Routes - Agent Type Validation > POST /api/executions - Adhoc Executions (no issue) > should return 501 when agentType is not implemented  305ms
stdout | tests/unit/routes/import.test.ts > Import Router > POST / > should import comments as IssueFeedback when includeComments requested
[import] Created placeholder issue i-import1 for 2 comments
[import] Successfully imported 2 of 2 comments as feedback

stdout | tests/unit/routes/import.test.ts > Import Router > POST / > should preserve comment timestamps in feedback
[import] Created placeholder issue i-import1 for 1 comments
[import] Successfully imported 1 of 1 comments as feedback

stdout | tests/unit/routes/import.test.ts > Import Router > POST / > should format comment content with author attribution
[import] Created placeholder issue i-import1 for 1 comments
[import] Successfully imported 1 of 1 comments as feedback

stdout | tests/unit/watcher.test.ts > File Watcher > Timestamp Behavior (File Modification Time) > should preserve correct timestamps across markdown â†’ database â†’ JSONL sync chain
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > stageSync > should throw error for non-existent execution
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > stageSync > should throw error when worktree path is missing
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > stageSync > should leave changes staged for manual commit
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/local-server| tests/unit/routes/import.test.ts (19 tests) 1337ms
 â¯ |@sudocode-ai/local-server| tests/integration/worker-isolation.test.ts (9 tests | 3 failed) 32556ms
   Ã— Worker Isolation Integration Tests > crash isolation > should not crash main process when worker crashes 8307ms (retry x3)
     â†’ expected 1 to be +0 // Object.is equality
     â†’ expected 1 to be +0 // Object.is equality
     â†’ expected 1 to be +0 // Object.is equality
     â†’ expected 1 to be +0 // Object.is equality
   âœ“ Worker Isolation Integration Tests > crash isolation > should handle multiple worker crashes independently  9555ms (retry x2)
   âœ“ Worker Isolation Integration Tests > concurrency control > should enforce max concurrent workers limit 36ms
   âœ“ Worker Isolation Integration Tests > graceful shutdown > should terminate all workers on shutdown 33ms
   âœ“ Worker Isolation Integration Tests > graceful shutdown > should force kill workers after graceful timeout 5ms
   âœ“ Worker Isolation Integration Tests > worker lifecycle > should transition worker through states correctly  9062ms (retry x2)
   Ã— Worker Isolation Integration Tests > event forwarding > should forward log events from worker to main process 2198ms (retry x3)
     â†’ expected "spy" to be called at least once
     â†’ expected "spy" to be called at least once
     â†’ expected "spy" to be called at least once
     â†’ expected "spy" to be called at least once
   Ã— Worker Isolation Integration Tests > event forwarding > should forward completion events from worker to main process 2229ms (retry x3)
     â†’ expected false to be true // Object.is equality
     â†’ expected false to be true // Object.is equality
     â†’ expected false to be true // Object.is equality
     â†’ expected false to be true // Object.is equality
   âœ“ Worker Isolation Integration Tests > cancellation > should cancel running worker 5ms
stdout | tests/integration/import-flow.test.ts > Import Flow Integration > POST /api/import > should count comments when includeComments requested
[import] Created placeholder issue i-placeholder for 3 comments
[import] Successfully imported 3 of 3 comments as feedback

stdout | tests/integration/import-flow.test.ts > Import Flow Integration > Complete Import Flow > should handle complete preview -> import flow
[import] Created placeholder issue i-placeholder for 1 comments
[import] Successfully imported 1 of 1 comments as feedback

stdout | tests/unit/watcher.test.ts > File Watcher > Comprehensive Field Detection > should detect feedback changes in issues
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/local-server| tests/integration/import-flow.test.ts (14 tests) 2362ms
   âœ“ Import Flow Integration > POST /api/import > should count comments when includeComments requested  389ms
stdout | tests/unit/watcher.test.ts > File Watcher > Comprehensive Field Detection > should detect new feedback added to issues
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > End-to-end execution tests > should auto-inject sudocode-mcp when package is installed but plugin not configured
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > End-to-end execution tests > should auto-inject sudocode-mcp when package is installed but plugin not configured
[ExecutionService] sudocode-mcp not detected for claude-code (plugin not enabled)

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > End-to-end execution tests > should auto-inject sudocode-mcp when package is installed but plugin not configured
[ExecutionService] Adding sudocode-mcp to mcpServers (auto-injection)

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > preserveSync > should merge commits preserving history
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > End-to-end execution tests > should auto-inject sudocode-mcp when package is installed but plugin not configured
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mtrue[39m,
  mcpServerNames: [ [32m'sudocode-mcp'[39m ],
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mtrue[39m,
  mcpServerNames: [ [32m'sudocode-mcp'[39m ],
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: [ [32m'mcpServers'[39m ]
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mtrue[39m, mcpServerNames: [ [32m'sudocode-mcp'[39m ] }

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > End-to-end execution tests > should skip injection when plugin already configured
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > End-to-end execution tests > should skip injection when plugin already configured
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > End-to-end execution tests > should skip injection when plugin already configured
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > End-to-end execution tests > should skip injection when plugin already configured
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > End-to-end execution tests > should fail with clear error when sudocode-mcp package not installed
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > End-to-end execution tests > should verify sudocode MCP tools would be available after auto-injection
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > End-to-end execution tests > should verify sudocode MCP tools would be available after auto-injection
[ExecutionService] sudocode-mcp not detected for claude-code (plugin not enabled)

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > End-to-end execution tests > should verify sudocode MCP tools would be available after auto-injection
[ExecutionService] Adding sudocode-mcp to mcpServers (auto-injection)

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > End-to-end execution tests > should verify sudocode MCP tools would be available after auto-injection
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mtrue[39m,
  mcpServerNames: [ [32m'sudocode-mcp'[39m ],
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mtrue[39m,
  mcpServerNames: [ [32m'sudocode-mcp'[39m ],
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: [ [32m'mcpServers'[39m ]
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mtrue[39m, mcpServerNames: [ [32m'sudocode-mcp'[39m ] }

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > End-to-end execution tests > should preserve user-provided MCP servers alongside auto-injected one
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > End-to-end execution tests > should preserve user-provided MCP servers alongside auto-injected one
[ExecutionService] sudocode-mcp not detected for claude-code (plugin not enabled)

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > End-to-end execution tests > should preserve user-provided MCP servers alongside auto-injected one
[ExecutionService] Adding sudocode-mcp to mcpServers (auto-injection)

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > End-to-end execution tests > should preserve user-provided MCP servers alongside auto-injected one
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mtrue[39m,
  mcpServerNames: [ [32m'custom-mcp'[39m, [32m'sudocode-mcp'[39m ],
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mtrue[39m,
  mcpServerNames: [ [32m'custom-mcp'[39m, [32m'sudocode-mcp'[39m ],
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: [ [32m'mcpServers'[39m ]
}
[ExecutionService] Task metadata mcpServers: {
  hasMcpServers: [33mtrue[39m,
  mcpServerNames: [ [32m'custom-mcp'[39m, [32m'sudocode-mcp'[39m ]
}

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > Error scenario tests > should fail with informative error when sudocode-mcp not in PATH
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > Error scenario tests > should include link to github.com/sudocode-ai/sudocode in error message
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > Error scenario tests > should not block execution when detection fails (settings.json read errors)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > Error scenario tests > should not block execution when detection fails (settings.json read errors)
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > Error scenario tests > should not block execution when detection fails (settings.json read errors)
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/relationships.test.ts > Relationships API
Initializing new database for test-project-fa6b8723 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-relationships-m9M4vy/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/relationships.test.ts > Relationships API
Project context initialized: test-project-fa6b8723 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-relationships-m9M4vy/test-project

stdout | tests/unit/relationships.test.ts > Relationships API
[project-manager] Starting workflow recovery for test-project-fa6b8723...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/relationships.test.ts > Relationships API
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/relationships.test.ts > Relationships API
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > Multi-execution type tests > should auto-inject for adhoc executions (no issue)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > Multi-execution type tests > should auto-inject for adhoc executions (no issue)
[ExecutionService] sudocode-mcp not detected for claude-code (plugin not enabled)

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > Multi-execution type tests > should auto-inject for adhoc executions (no issue)
[ExecutionService] Adding sudocode-mcp to mcpServers (auto-injection)

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > Multi-execution type tests > should auto-inject for adhoc executions (no issue)
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mtrue[39m,
  mcpServerNames: [ [32m'sudocode-mcp'[39m ],
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mtrue[39m,
  mcpServerNames: [ [32m'sudocode-mcp'[39m ],
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: [ [32m'mcpServers'[39m ]
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mtrue[39m, mcpServerNames: [ [32m'sudocode-mcp'[39m ] }

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > Multi-execution type tests > should auto-inject for issue-based executions
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > Multi-execution type tests > should auto-inject for issue-based executions
[ExecutionService] sudocode-mcp not detected for claude-code (plugin not enabled)

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > Multi-execution type tests > should auto-inject for issue-based executions
[ExecutionService] Adding sudocode-mcp to mcpServers (auto-injection)

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > Multi-execution type tests > should auto-inject for issue-based executions
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mtrue[39m,
  mcpServerNames: [ [32m'sudocode-mcp'[39m ],
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mtrue[39m,
  mcpServerNames: [ [32m'sudocode-mcp'[39m ],
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: [ [32m'mcpServers'[39m ]
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mtrue[39m, mcpServerNames: [ [32m'sudocode-mcp'[39m ] }

stdout | tests/unit/relationships.test.ts > Relationships API
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/relationships.test.ts > Relationships API
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/watcher.test.ts > File Watcher > Comprehensive Field Detection > should detect relationship changes in issues
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > Multi-execution type tests > should auto-inject for workflow sub-executions
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/relationships.test.ts > Relationships API
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/relationships.test.ts > Relationships API
[WakeupService] State recovery complete

stdout | tests/unit/relationships.test.ts > Relationships API
[project-manager] Workflow recovery complete for test-project-fa6b8723
[integration-sync] Starting for project test-project-fa6b8723
[integration-sync] No enabled integrations found

stdout | tests/unit/relationships.test.ts > Relationships API
Project opened successfully: test-project-fa6b8723 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-relationships-m9M4vy/test-project

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > Multi-execution type tests > should auto-inject for workflow sub-executions
[ExecutionService] sudocode-mcp not detected for claude-code (plugin not enabled)

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > Multi-execution type tests > should auto-inject for workflow sub-executions
[ExecutionService] Adding sudocode-mcp to mcpServers (auto-injection)

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > Multi-execution type tests > should auto-inject for workflow sub-executions
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mtrue[39m,
  mcpServerNames: [ [32m'sudocode-mcp'[39m ],
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mtrue[39m,
  mcpServerNames: [ [32m'sudocode-mcp'[39m ],
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: [ [32m'mcpServers'[39m ]
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mtrue[39m, mcpServerNames: [ [32m'sudocode-mcp'[39m ] }

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > Config structure verification > should pass properly structured config to agent adapter
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > Config structure verification > should pass properly structured config to agent adapter
[ExecutionService] sudocode-mcp not detected for claude-code (plugin not enabled)

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > Config structure verification > should pass properly structured config to agent adapter
[ExecutionService] Adding sudocode-mcp to mcpServers (auto-injection)

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > Config structure verification > should pass properly structured config to agent adapter
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mtrue[39m,
  mcpServerNames: [ [32m'sudocode-mcp'[39m ],
  hasAppendSystemPrompt: [33mtrue[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mtrue[39m,
  mcpServerNames: [ [32m'sudocode-mcp'[39m ],
  hasAppendSystemPrompt: [33mtrue[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: [ [32m'model'[39m, [32m'timeout'[39m, [32m'appendSystemPrompt'[39m, [32m'mcpServers'[39m ]
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mtrue[39m, mcpServerNames: [ [32m'sudocode-mcp'[39m ] }

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > Config structure verification > should not duplicate sudocode-mcp if user already provided it
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > Config structure verification > should not duplicate sudocode-mcp if user already provided it
[ExecutionService] sudocode-mcp not detected for claude-code (plugin not enabled)

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > Config structure verification > should not duplicate sudocode-mcp if user already provided it
[ExecutionService] Skipping sudocode-mcp injection (user provided in config)

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > Config structure verification > should not duplicate sudocode-mcp if user already provided it
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mtrue[39m,
  mcpServerNames: [ [32m'sudocode-mcp'[39m ],
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mtrue[39m,
  mcpServerNames: [ [32m'sudocode-mcp'[39m ],
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: [ [32m'mcpServers'[39m ]
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mtrue[39m, mcpServerNames: [ [32m'sudocode-mcp'[39m ] }

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > Agent type handling > should work with claude-code agent type
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > Agent type handling > should work with claude-code agent type
[ExecutionService] sudocode-mcp not detected for claude-code (plugin not enabled)

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > Agent type handling > should work with claude-code agent type
[ExecutionService] Adding sudocode-mcp to mcpServers (auto-injection)

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > Agent type handling > should work with claude-code agent type
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mtrue[39m,
  mcpServerNames: [ [32m'sudocode-mcp'[39m ],
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mtrue[39m,
  mcpServerNames: [ [32m'sudocode-mcp'[39m ],
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: [ [32m'mcpServers'[39m ]
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mtrue[39m, mcpServerNames: [ [32m'sudocode-mcp'[39m ] }

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > Agent type handling > should handle other agent types gracefully (extensibility)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > Agent type handling > should handle other agent types gracefully (extensibility)
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > Agent type handling > should handle other agent types gracefully (extensibility)
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > Agent type handling > should handle other agent types gracefully (extensibility)
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > Agent type handling > should handle other agent types gracefully (extensibility)
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > Agent type handling > should handle other agent types gracefully (extensibility)
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/execution-mcp-injection.test.ts > MCP Auto-Injection Integration Tests > Agent type handling > should handle other agent types gracefully (extensibility)
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/watcher.test.ts > File Watcher > Comprehensive Field Detection > should detect tag changes in issues
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/jsonl-change-broadcasts.test.ts > JSONL File Changes - WebSocket Broadcasts > should broadcast issue updates via onEntitySync callback with entity data
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/jsonl-change-broadcasts.test.ts > JSONL File Changes - WebSocket Broadcasts > should broadcast issue updates via onEntitySync callback with entity data
[watcher] Starting file watcher for /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-jsonl-broadcast-test-h8jG78
[watch] Watching directories: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-jsonl-broadcast-test-h8jG78/specs, /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-jsonl-broadcast-test-h8jG78/issues and JSONL files

 âœ“ |@sudocode-ai/local-server| tests/integration/execution-mcp-injection.test.ts (15 tests) 2818ms
stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > preserveSync > should return error when code conflicts exist
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/jsonl-change-broadcasts.test.ts > JSONL File Changes - WebSocket Broadcasts > should broadcast issue updates via onEntitySync callback with entity data
[watch] Watching 4 files in /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-jsonl-broadcast-test-h8jG78
[watch] Initialized cache for specs.jsonl (0 entities)
[watch] Initialized cache for issues.jsonl (1 entities)

stdout | tests/integration/export.test.ts > JSONL Export Integration
Initializing new database for test-project-0507d9dd at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-export-vp9drp/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/export.test.ts > JSONL Export Integration
Project context initialized: test-project-0507d9dd at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-export-vp9drp/test-project

stdout | tests/integration/jsonl-change-broadcasts.test.ts > JSONL File Changes - WebSocket Broadcasts > should broadcast issue updates via onEntitySync callback with entity data
[watch] change issues.jsonl
[watch] Detected 1 changed issue(s) in JSONL

stdout | tests/integration/export.test.ts > JSONL Export Integration
[project-manager] Starting workflow recovery for test-project-0507d9dd...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/integration/export.test.ts > JSONL Export Integration
[OrchestratorEngine] Checking for stale executions...

stdout | tests/integration/jsonl-change-broadcasts.test.ts > JSONL File Changes - WebSocket Broadcasts > should broadcast issue updates via onEntitySync callback with entity data
[watch] Imported JSONL changes to database
[watch] Synced issue i-jsonl1 (updated)
[watcher] Entity synced: issue i-jsonl1 (updated)

stdout | tests/integration/export.test.ts > JSONL Export Integration
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/integration/export.test.ts > JSONL Export Integration
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/integration/export.test.ts > JSONL Export Integration
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/integration/export.test.ts > JSONL Export Integration
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/integration/export.test.ts > JSONL Export Integration
[WakeupService] State recovery complete

stdout | tests/integration/export.test.ts > JSONL Export Integration
[project-manager] Workflow recovery complete for test-project-0507d9dd
[integration-sync] Starting for project test-project-0507d9dd
[integration-sync] No enabled integrations found

stdout | tests/integration/export.test.ts > JSONL Export Integration
Project opened successfully: test-project-0507d9dd at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-export-vp9drp/test-project

stdout | tests/unit/watcher.test.ts > File Watcher > Comprehensive Field Detection > should detect spec file_path changes
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/watcher.test.ts > File Watcher > Comprehensive Field Detection > should detect archived field changes
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/jsonl-change-broadcasts.test.ts > JSONL File Changes - WebSocket Broadcasts > should broadcast issue updates via onEntitySync callback with entity data
[watcher] Stopping file watcher...
[watch] Stopping watcher...

stdout | tests/integration/jsonl-change-broadcasts.test.ts > JSONL File Changes - WebSocket Broadcasts > should broadcast issue updates via onEntitySync callback with entity data
[watch] Watcher stopped

stdout | tests/integration/jsonl-change-broadcasts.test.ts > JSONL File Changes - WebSocket Broadcasts > should handle multiple entities changed in JSONL
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/jsonl-change-broadcasts.test.ts > JSONL File Changes - WebSocket Broadcasts > should handle multiple entities changed in JSONL
[watcher] Starting file watcher for /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-jsonl-broadcast-test-y3PaJF
[watch] Watching directories: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-jsonl-broadcast-test-y3PaJF/specs, /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-jsonl-broadcast-test-y3PaJF/issues and JSONL files

stdout | tests/integration/jsonl-change-broadcasts.test.ts > JSONL File Changes - WebSocket Broadcasts > should handle multiple entities changed in JSONL
[watch] Watching 4 files in /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-jsonl-broadcast-test-y3PaJF
[watch] Initialized cache for specs.jsonl (0 entities)
[watch] Initialized cache for issues.jsonl (2 entities)

stdout | tests/unit/watcher.test.ts > File Watcher > Comprehensive Field Detection > should detect parent_id changes
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > preserveSync > should auto-resolve JSONL conflicts
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/jsonl-change-broadcasts.test.ts > JSONL File Changes - WebSocket Broadcasts > should handle multiple entities changed in JSONL
[watch] change issues.jsonl
[watch] Detected 2 changed issue(s) in JSONL

stdout | tests/integration/jsonl-change-broadcasts.test.ts > JSONL File Changes - WebSocket Broadcasts > should handle multiple entities changed in JSONL
[watch] Imported JSONL changes to database
[watch] Synced issue i-multi-jsonl1 (updated)
[watcher] Entity synced: issue i-multi-jsonl1 (updated)

stdout | tests/integration/jsonl-change-broadcasts.test.ts > JSONL File Changes - WebSocket Broadcasts > should handle multiple entities changed in JSONL
[watch] Synced issue i-multi-jsonl2 (updated)
[watcher] Entity synced: issue i-multi-jsonl2 (updated)

 âœ“ |@sudocode-ai/cli| tests/unit/watcher.test.ts (31 tests | 6 skipped) 37408ms
   âœ“ File Watcher > startWatcher > should detect new markdown files  861ms
   âœ“ File Watcher > startWatcher > should NOT delete spec from database when file is deleted (DB is source of truth)  1629ms
   âœ“ File Watcher > startWatcher > should delete orphaned markdown file without frontmatter (no corresponding DB entry)  818ms
   âœ“ File Watcher > Reverse Sync (JSONL â†’ Markdown) > should sync JSONL changes to markdown when enabled  1061ms
   âœ“ File Watcher > Reverse Sync (JSONL â†’ Markdown) > should NOT sync JSONL changes to markdown when disabled  1034ms
   âœ“ File Watcher > Content Matching (Oscillation Prevention) > should skip markdown sync when content matches (prevents oscillation)  1683ms
   âœ“ File Watcher > Content Matching (Oscillation Prevention) > should skip database sync when markdown content matches (prevents oscillation)  1627ms
   âœ“ File Watcher > Content Matching (Oscillation Prevention) > should not oscillate between markdown and JSONL with bidirectional sync  2760ms
   âœ“ File Watcher > Content Matching (Oscillation Prevention) > should not create loop when CLI updates issue (simulating MCP operation)  2515ms
   âœ“ File Watcher > Content Matching (Oscillation Prevention) > should produce same hash regardless of array element order (relationships, tags)  1041ms
   âœ“ File Watcher > Smart JSONL Operations (Regression Prevention) > should import JSONL when content actually differs from database  1107ms
   âœ“ File Watcher > Timestamp Behavior (File Modification Time) > should use file modification time as database updated_at when syncing from markdown  824ms
   âœ“ File Watcher > Timestamp Behavior (File Modification Time) > should allow multiple consecutive edits to be synced (not skipped due to timestamps)  8073ms
   âœ“ File Watcher > Timestamp Behavior (File Modification Time) > should sync DB to markdown when database is genuinely newer than file (via direct DB update)  2036ms
   âœ“ File Watcher > Timestamp Behavior (File Modification Time) > should preserve correct timestamps across markdown â†’ database â†’ JSONL sync chain  2089ms
   âœ“ File Watcher > Comprehensive Field Detection > should detect feedback changes in issues  1177ms
   âœ“ File Watcher > Comprehensive Field Detection > should detect new feedback added to issues  1128ms
   âœ“ File Watcher > Comprehensive Field Detection > should detect relationship changes in issues  1035ms
   âœ“ File Watcher > Comprehensive Field Detection > should detect tag changes in issues  1020ms
   âœ“ File Watcher > Comprehensive Field Detection > should detect spec file_path changes  1062ms
   âœ“ File Watcher > Comprehensive Field Detection > should detect archived field changes  1069ms
   âœ“ File Watcher > Comprehensive Field Detection > should detect parent_id changes  1027ms
stdout | tests/integration/jsonl-change-broadcasts.test.ts > JSONL File Changes - WebSocket Broadcasts > should handle multiple entities changed in JSONL
[watcher] Stopping file watcher...
[watch] Stopping watcher...

stdout | tests/integration/jsonl-change-broadcasts.test.ts > JSONL File Changes - WebSocket Broadcasts > should handle multiple entities changed in JSONL
[watch] Watcher stopped

stdout | tests/integration/jsonl-change-broadcasts.test.ts > JSONL File Changes - WebSocket Broadcasts > should broadcast spec updates via onEntitySync callback
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/jsonl-change-broadcasts.test.ts > JSONL File Changes - WebSocket Broadcasts > should broadcast spec updates via onEntitySync callback
[watcher] Starting file watcher for /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-jsonl-broadcast-test-euXSPU
[watch] Watching directories: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-jsonl-broadcast-test-euXSPU/specs, /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-jsonl-broadcast-test-euXSPU/issues and JSONL files

stdout | tests/integration/jsonl-change-broadcasts.test.ts > JSONL File Changes - WebSocket Broadcasts > should broadcast spec updates via onEntitySync callback
[watch] Watching 4 files in /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-jsonl-broadcast-test-euXSPU
[watch] Initialized cache for specs.jsonl (1 entities)
[watch] Initialized cache for issues.jsonl (0 entities)

stdout | tests/unit/relationships.test.ts > Relationships API
Shutting down ProjectManager...
Closing project: test-project-fa6b8723
Shutting down project context: test-project-fa6b8723

stdout | tests/unit/relationships.test.ts > Relationships API
[integration-sync] Stopping for project test-project-fa6b8723
[integration-sync] Service stopped for test-project-fa6b8723

stdout | tests/unit/relationships.test.ts > Relationships API
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-fa6b8723

stdout | tests/unit/relationships.test.ts > Relationships API
Project closed: test-project-fa6b8723

stdout | tests/unit/relationships.test.ts > Relationships API
ProjectManager shutdown complete

stdout | tests/integration/jsonl-change-broadcasts.test.ts > JSONL File Changes - WebSocket Broadcasts > should broadcast spec updates via onEntitySync callback
[watch] change specs.jsonl
[watch] Detected 1 changed spec(s) in JSONL

stdout | tests/integration/jsonl-change-broadcasts.test.ts > JSONL File Changes - WebSocket Broadcasts > should broadcast spec updates via onEntitySync callback
[watch] Imported JSONL changes to database
[watch] Synced spec s-jsonl1 (updated)
[watcher] Entity synced: spec s-jsonl1 (updated)

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > preserveSync > should throw error for non-existent execution
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > preserveSync > should throw error when worktree path is missing
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/local-server| tests/unit/relationships.test.ts (23 tests) 8093ms
   âœ“ Relationships API > DELETE /api/relationships > should trigger JSONL export after deleting relationship  5092ms
   âœ“ Relationships API > Integration tests > should handle bidirectional relationships correctly  356ms
stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > preserveSync > should return error when no commits to merge
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/services/worktree-sync-full.test.ts > Full squash sync workflow - happy path > should complete full sync from preview to database update
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/jsonl-change-broadcasts.test.ts > JSONL File Changes - WebSocket Broadcasts > should broadcast spec updates via onEntitySync callback
[watcher] Stopping file watcher...
[watch] Stopping watcher...

stdout | tests/integration/jsonl-change-broadcasts.test.ts > JSONL File Changes - WebSocket Broadcasts > should broadcast spec updates via onEntitySync callback
[watch] Watcher stopped

stdout | tests/integration/jsonl-change-broadcasts.test.ts > JSONL File Changes - WebSocket Broadcasts > should broadcast fresh content when JSONL changes without timestamp update
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/jsonl-change-broadcasts.test.ts > JSONL File Changes - WebSocket Broadcasts > should broadcast fresh content when JSONL changes without timestamp update
[watcher] Starting file watcher for /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-jsonl-broadcast-test-u6YDMH
[watch] Watching directories: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-jsonl-broadcast-test-u6YDMH/specs, /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-jsonl-broadcast-test-u6YDMH/issues and JSONL files

stdout | tests/integration/jsonl-change-broadcasts.test.ts > JSONL File Changes - WebSocket Broadcasts > should broadcast fresh content when JSONL changes without timestamp update
[watch] Watching 4 files in /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-jsonl-broadcast-test-u6YDMH
[watch] Initialized cache for specs.jsonl (0 entities)
[watch] Initialized cache for issues.jsonl (1 entities)

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > preserveSync > should throw DIRTY_WORKING_TREE if local tree has uncommitted changes
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/jsonl-change-broadcasts.test.ts > JSONL File Changes - WebSocket Broadcasts > should broadcast fresh content when JSONL changes without timestamp update
[watch] change issues.jsonl
[watch] Detected 1 changed issue(s) in JSONL

stdout | tests/integration/jsonl-change-broadcasts.test.ts > JSONL File Changes - WebSocket Broadcasts > should broadcast fresh content when JSONL changes without timestamp update
[watch] Imported JSONL changes to database
[watch] Synced issue i-fresh-content (updated)
[watcher] Entity synced: issue i-fresh-content (updated)

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > _readJSONLVersion > should read JSONL file at specific revision
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > _readJSONLVersion > should return empty array for non-existent file
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getChanges - Scenario A: Committed Changes > should calculate committed changes between two commits
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/jsonl-change-broadcasts.test.ts > JSONL File Changes - WebSocket Broadcasts > should broadcast fresh content when JSONL changes without timestamp update
[watcher] Stopping file watcher...
[watch] Stopping watcher...

stdout | tests/integration/jsonl-change-broadcasts.test.ts > JSONL File Changes - WebSocket Broadcasts > should broadcast fresh content when JSONL changes without timestamp update
[watch] Watcher stopped

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > _readJSONLVersion > should read file at specific commit
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/local-server| tests/integration/jsonl-change-broadcasts.test.ts (4 tests) 10827ms
   âœ“ JSONL File Changes - WebSocket Broadcasts > should broadcast issue updates via onEntitySync callback with entity data  2417ms
   âœ“ JSONL File Changes - WebSocket Broadcasts > should handle multiple entities changed in JSONL  2385ms
   âœ“ JSONL File Changes - WebSocket Broadcasts > should broadcast spec updates via onEntitySync callback  2461ms
   âœ“ JSONL File Changes - WebSocket Broadcasts > should broadcast fresh content when JSONL changes without timestamp update  2412ms
stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getChanges - Scenario A: Committed Changes > should calculate committed changes between two commits
[ExecutionChangesService] Execution exec-1: {
  status: [32m'completed'[39m,
  before_commit: [32m'954b37c255732c06b312be3e840268c4205b32c4'[39m,
  after_commit: [32m'5db34bda25e08deecd3bd7649e962376989ccaa6'[39m,
  parent_execution_id: [1mnull[22m
}
[ExecutionChangesService] Root execution exec-1: {
  before_commit: [32m'954b37c255732c06b312be3e840268c4205b32c4'[39m,
  after_commit: [32m'5db34bda25e08deecd3bd7649e962376989ccaa6'[39m
}
[ExecutionChangesService] Computed beforeCommit: 954b37c255732c06b312be3e840268c4205b32c4

stdout | tests/integration/services/worktree-sync-full.test.ts > JSONL conflict resolution > should auto-resolve JSONL conflicts during squash
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > _hasLocalUncommittedChanges > should return false for file without changes
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getChanges - Scenario A: Committed Changes > should handle modified files
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > _hasLocalUncommittedChanges > should return true for file with uncommitted changes
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getChanges - Scenario A: Committed Changes > should handle modified files
[ExecutionChangesService] Execution exec-2: {
  status: [32m'completed'[39m,
  before_commit: [32m'08133a7b2e60cbd649dfb738c904f59b06687433'[39m,
  after_commit: [32m'f56ad918f8491de1115652ecec00c8a78102dbce'[39m,
  parent_execution_id: [1mnull[22m
}
[ExecutionChangesService] Root execution exec-2: {
  before_commit: [32m'08133a7b2e60cbd649dfb738c904f59b06687433'[39m,
  after_commit: [32m'f56ad918f8491de1115652ecec00c8a78102dbce'[39m
}
[ExecutionChangesService] Computed beforeCommit: 08133a7b2e60cbd649dfb738c904f59b06687433

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > _hasLocalUncommittedChanges > should return false for new untracked file (not in HEAD)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getChanges - Scenario A: Committed Changes > should handle deleted files
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > _isFileUntracked > should return true for untracked file
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > _isFileUntracked > should return false for tracked file
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getChanges - Scenario A: Committed Changes > should handle deleted files
[ExecutionChangesService] Execution exec-3: {
  status: [32m'completed'[39m,
  before_commit: [32m'089f9897db29ef0d4f9c4a4ab5d0378ed0e56e4f'[39m,
  after_commit: [32m'21b891d1a60477c0d5d571154de0b5322dd6d316'[39m,
  parent_execution_id: [1mnull[22m
}
[ExecutionChangesService] Root execution exec-3: {
  before_commit: [32m'089f9897db29ef0d4f9c4a4ab5d0378ed0e56e4f'[39m,
  after_commit: [32m'21b891d1a60477c0d5d571154de0b5322dd6d316'[39m
}
[ExecutionChangesService] Computed beforeCommit: 089f9897db29ef0d4f9c4a4ab5d0378ed0e56e4f

stdout | tests/integration/services/worktree-sync-full.test.ts > Uncommitted JSONL handling > should include uncommitted JSONL changes in sync
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/local-server| tests/unit/services/file-search/git-ls-files-strategy.test.ts (26 tests) 11038ms
   âœ“ GitLsFilesStrategy > search > should find prefix matches on path  391ms
   âœ“ GitLsFilesStrategy > caching > should invalidate cache after TTL  5308ms
   âœ“ GitLsFilesStrategy > error handling > should clear cache on error  5148ms
stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > _isFileUntracked > should return false for staged file
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/watcher.test.ts > File Watcher Service
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/watcher.test.ts > File Watcher Service > Watcher Initialization > should start watcher successfully
[watcher] Starting file watcher for /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA
[watch] Watching directories: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA/specs, /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA/issues and JSONL files

stdout | tests/unit/watcher.test.ts > File Watcher Service > Watcher Initialization > should start watcher successfully
[watch] Watching 0 files in /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA

stdout | tests/unit/watcher.test.ts > File Watcher Service > Watcher Initialization > should start watcher successfully
[watch] Watching 2 files in /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA

stdout | tests/unit/watcher.test.ts > File Watcher Service > Watcher Initialization > should start watcher successfully
[watch] Watching 2 files in /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA

stdout | tests/unit/watcher.test.ts > File Watcher Service > Watcher Initialization > should start watcher successfully
[watcher] Stopping file watcher...
[watch] Stopping watcher...

stdout | tests/unit/watcher.test.ts > File Watcher Service > Watcher Initialization > should start watcher successfully
[watch] Watcher stopped

stdout | tests/unit/watcher.test.ts > File Watcher Service > Watcher Initialization > should watch correct directories
[watcher] Starting file watcher for /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA
[watch] Watching directories: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA/specs, /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA/issues and JSONL files

stdout | tests/unit/watcher.test.ts > File Watcher Service > Watcher Initialization > should watch correct directories
[watch] Watching 0 files in /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getChanges - Scenario A: Committed Changes > should handle binary files
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/watcher.test.ts > File Watcher Service > Watcher Initialization > should watch correct directories
[watch] Watching 2 files in /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA

stdout | tests/unit/watcher.test.ts > File Watcher Service > Watcher Initialization > should watch correct directories
[watch] Watching 2 files in /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA

stdout | tests/unit/watcher.test.ts > File Watcher Service > Watcher Initialization > should watch correct directories
[watcher] Stopping file watcher...
[watch] Stopping watcher...

stdout | tests/unit/watcher.test.ts > File Watcher Service > Watcher Initialization > should watch correct directories
[watch] Watcher stopped

stdout | tests/unit/watcher.test.ts > File Watcher Service > Watcher Initialization > should accept custom debounce delay
[watcher] Starting file watcher for /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA
[watch] Watching directories: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA/specs, /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA/issues and JSONL files
[watcher] Stopping file watcher...
[watch] Stopping watcher...

stdout | tests/unit/watcher.test.ts > File Watcher Service > Watcher Initialization > should accept custom debounce delay
[watch] Watcher stopped

stdout | tests/unit/watcher.test.ts > File Watcher Service > File Change Detection > should detect markdown file changes
[watcher] Starting file watcher for /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA
[watch] Watching directories: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA/specs, /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA/issues and JSONL files

stdout | tests/unit/watcher.test.ts > File Watcher Service > File Change Detection > should detect markdown file changes
[watch] Watching 0 files in /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA

stdout | tests/unit/watcher.test.ts > File Watcher Service > File Change Detection > should detect markdown file changes
[watch] Watching 2 files in /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA

stdout | tests/unit/watcher.test.ts > File Watcher Service > File Change Detection > should detect markdown file changes
[watch] Watching 2 files in /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > _isJSONLFile > should return true for .sudocode JSONL files
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/watcher.test.ts > File Watcher Service > File Change Detection > should detect markdown file changes
[watch] add specs/test-spec.md

stdout | tests/unit/watcher.test.ts > File Watcher Service > File Change Detection > should detect markdown file changes
[watch] Synced spec SPEC-001 (updated)
[watcher] Entity synced: spec SPEC-001 (updated)

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getChanges - Scenario A: Committed Changes > should handle binary files
[ExecutionChangesService] Execution exec-4: {
  status: [32m'completed'[39m,
  before_commit: [32m'5f10e210334e04641d1c48d257a1c6d3f6518fd5'[39m,
  after_commit: [32m'ea9aa67a7d298f8d9269fad2447f0700b20097a8'[39m,
  parent_execution_id: [1mnull[22m
}
[ExecutionChangesService] Root execution exec-4: {
  before_commit: [32m'5f10e210334e04641d1c48d257a1c6d3f6518fd5'[39m,
  after_commit: [32m'ea9aa67a7d298f8d9269fad2447f0700b20097a8'[39m
}
[ExecutionChangesService] Computed beforeCommit: 5f10e210334e04641d1c48d257a1c6d3f6518fd5

stdout | tests/unit/watcher.test.ts > File Watcher Service > File Change Detection > should detect markdown file changes
[watch] add specs.jsonl
[watch] Detected 1 changed spec(s) in JSONL

stdout | tests/unit/watcher.test.ts > File Watcher Service > File Change Detection > should detect markdown file changes
[watch] Imported JSONL changes to database
[watch] Synced spec SPEC-001 (created)
[watcher] Entity synced: spec SPEC-001 (created)

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > _isJSONLFile > should return false for non-JSONL files
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getChanges - Scenario B: Uncommitted Changes > should calculate uncommitted changes in working tree
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/watcher.test.ts > File Watcher Service > File Change Detection > should detect markdown file changes
[watcher] Stopping file watcher...
[watch] Stopping watcher...

stdout | tests/unit/watcher.test.ts > File Watcher Service > File Change Detection > should detect markdown file changes
[watch] Watcher stopped

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > _isJSONLFile > should return false for JSONL files outside .sudocode
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/watcher.test.ts > File Watcher Service > File Change Detection > should detect JSONL file changes
[watcher] Starting file watcher for /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA
[watch] Watching directories: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA/specs, /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA/issues and JSONL files

stdout | tests/unit/watcher.test.ts > File Watcher Service > File Change Detection > should detect JSONL file changes
[watch] Watching 4 files in /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA
[watch] Initialized cache for specs.jsonl (1 entities)
[watch] Initialized cache for issues.jsonl (0 entities)

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getChanges - Scenario B: Uncommitted Changes > should calculate uncommitted changes in working tree
[ExecutionChangesService] Execution exec-5: {
  status: [32m'completed'[39m,
  before_commit: [32m'64bd721907029adcf69d613eb4c24c6d57dd4faa'[39m,
  after_commit: [1mnull[22m,
  parent_execution_id: [1mnull[22m
}
[ExecutionChangesService] Root execution exec-5: {
  before_commit: [32m'64bd721907029adcf69d613eb4c24c6d57dd4faa'[39m,
  after_commit: [1mnull[22m
}
[ExecutionChangesService] Computed beforeCommit: 64bd721907029adcf69d613eb4c24c6d57dd4faa

stdout | tests/unit/watcher.test.ts > File Watcher Service > File Change Detection > should detect JSONL file changes
[watch] add specs/specs.jsonl
[watch] Detected 1 changed spec(s) in JSONL

stdout | tests/unit/watcher.test.ts > File Watcher Service > File Change Detection > should detect JSONL file changes
[watch] Imported JSONL changes to database
[watch] Synced spec SPEC-002 (created)
[watcher] Entity synced: spec SPEC-002 (created)

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > _threeWayMergeFile > should merge non-conflicting changes cleanly
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getChanges - Scenario B: Uncommitted Changes > should handle after_commit == before_commit as uncommitted
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/watcher.test.ts > File Watcher Service > File Change Detection > should detect JSONL file changes
[watcher] Stopping file watcher...
[watch] Stopping watcher...

stdout | tests/unit/watcher.test.ts > File Watcher Service > File Change Detection > should detect JSONL file changes
[watch] Watcher stopped

stdout | tests/unit/watcher.test.ts > File Watcher Service > Watcher Control > should stop watcher gracefully
[watcher] Starting file watcher for /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA
[watch] Watching directories: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA/specs, /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA/issues and JSONL files

stdout | tests/unit/watcher.test.ts > File Watcher Service > Watcher Control > should stop watcher gracefully
[watch] Watching 4 files in /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA
[watch] Initialized cache for specs.jsonl (1 entities)
[watch] Initialized cache for issues.jsonl (0 entities)

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > _threeWayMergeFile > should return true and add conflict markers for conflicting changes
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/services/worktree-sync-full.test.ts > Code conflict handling > should detect code conflicts and warn about them
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/watcher.test.ts > File Watcher Service > Watcher Control > should stop watcher gracefully
[watcher] Stopping file watcher...
[watch] Stopping watcher...

stdout | tests/unit/watcher.test.ts > File Watcher Service > Watcher Control > should stop watcher gracefully
[watch] Watcher stopped

stdout | tests/unit/watcher.test.ts > File Watcher Service > Watcher Control > should provide accurate stats
[watcher] Starting file watcher for /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA
[watch] Watching directories: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA/specs, /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA/issues and JSONL files

stdout | tests/unit/watcher.test.ts > File Watcher Service > Watcher Control > should provide accurate stats
[watch] Watching 4 files in /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA
[watch] Initialized cache for specs.jsonl (1 entities)
[watch] Initialized cache for issues.jsonl (0 entities)

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getChanges - Scenario B: Uncommitted Changes > should handle after_commit == before_commit as uncommitted
[ExecutionChangesService] Execution exec-6: {
  status: [32m'completed'[39m,
  before_commit: [32m'64bd721907029adcf69d613eb4c24c6d57dd4faa'[39m,
  after_commit: [32m'64bd721907029adcf69d613eb4c24c6d57dd4faa'[39m,
  parent_execution_id: [1mnull[22m
}
[ExecutionChangesService] Root execution exec-6: {
  before_commit: [32m'64bd721907029adcf69d613eb4c24c6d57dd4faa'[39m,
  after_commit: [32m'64bd721907029adcf69d613eb4c24c6d57dd4faa'[39m
}
[ExecutionChangesService] Computed beforeCommit: 64bd721907029adcf69d613eb4c24c6d57dd4faa

stdout | tests/unit/watcher.test.ts > File Watcher Service > Watcher Control > should provide accurate stats
[watcher] Stopping file watcher...
[watch] Stopping watcher...

stdout | tests/unit/watcher.test.ts > File Watcher Service > Watcher Control > should provide accurate stats
[watch] Watcher stopped

stdout | tests/unit/watcher.test.ts > File Watcher Service > Watcher Control > should handle multiple file changes with debouncing
[watcher] Starting file watcher for /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA
[watch] Watching directories: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA/specs, /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA/issues and JSONL files

stdout | tests/unit/watcher.test.ts > File Watcher Service > Watcher Control > should handle multiple file changes with debouncing
[watch] Watching 4 files in /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA
[watch] Initialized cache for specs.jsonl (1 entities)
[watch] Initialized cache for issues.jsonl (0 entities)

stdout | tests/unit/watcher.test.ts > File Watcher Service > Watcher Control > should handle multiple file changes with debouncing
[watch] add specs/rapid-1.md
[watch] Orphaned file detected: specs/rapid-1.md (no corresponding DB entry)
[watch] Deleted orphaned file: specs/rapid-1.md

stdout | tests/unit/watcher.test.ts > File Watcher Service > Watcher Control > should handle multiple file changes with debouncing
[watch] add specs/rapid-2.md
[watch] Orphaned file detected: specs/rapid-2.md (no corresponding DB entry)
[watch] Deleted orphaned file: specs/rapid-2.md

stdout | tests/unit/watcher.test.ts > File Watcher Service > Watcher Control > should handle multiple file changes with debouncing
[watch] unlink specs/rapid-1.md
[watch] Markdown file deleted: specs/rapid-1.md (DB/JSONL is source of truth)

stdout | tests/unit/watcher.test.ts > File Watcher Service > Watcher Control > should handle multiple file changes with debouncing
[watch] unlink specs/rapid-2.md
[watch] Markdown file deleted: specs/rapid-2.md (DB/JSONL is source of truth)

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > _mergeJSONLFiles > should merge JSONL files using UUID-based deduplication
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getChanges - Scenario C: No Changes > should return empty changes when no modifications
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getChanges - Scenario C: No Changes > should return empty changes when no modifications
[ExecutionChangesService] Execution exec-7: {
  status: [32m'completed'[39m,
  before_commit: [32m'efa32c69dbf2d53f6fe86f963c791ecc494bdb1d'[39m,
  after_commit: [32m'efa32c69dbf2d53f6fe86f963c791ecc494bdb1d'[39m,
  parent_execution_id: [1mnull[22m
}
[ExecutionChangesService] Root execution exec-7: {
  before_commit: [32m'efa32c69dbf2d53f6fe86f963c791ecc494bdb1d'[39m,
  after_commit: [32m'efa32c69dbf2d53f6fe86f963c791ecc494bdb1d'[39m
}
[ExecutionChangesService] Computed beforeCommit: efa32c69dbf2d53f6fe86f963c791ecc494bdb1d

stdout | tests/unit/watcher.test.ts > File Watcher Service > Watcher Control > should handle multiple file changes with debouncing
[watcher] Stopping file watcher...
[watch] Stopping watcher...

stdout | tests/unit/watcher.test.ts > File Watcher Service > Watcher Control > should handle multiple file changes with debouncing
[watch] Watcher stopped

stdout | tests/unit/watcher.test.ts > File Watcher Service > Callback Integration > should invoke onFileChange callback with entity info
[watcher] Starting file watcher for /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA
[watch] Watching directories: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA/specs, /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA/issues and JSONL files

stdout | tests/unit/watcher.test.ts > File Watcher Service > Callback Integration > should invoke onFileChange callback with entity info
[watch] Watching 4 files in /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-watcher-oqPrXA
[watch] Initialized cache for specs.jsonl (1 entities)
[watch] Initialized cache for issues.jsonl (0 entities)

stdout | tests/unit/watcher.test.ts > File Watcher Service > Callback Integration > should invoke onFileChange callback with entity info
[watch] add specs/callback-test.md
[watch] Orphaned file detected: specs/callback-test.md (no corresponding DB entry)
[watch] Deleted orphaned file: specs/callback-test.md

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > _mergeJSONLFiles > should merge duplicate UUIDs by keeping most recent
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/watcher.test.ts > File Watcher Service > Callback Integration > should invoke onFileChange callback with entity info
[watch] unlink specs/callback-test.md
[watch] Markdown file deleted: specs/callback-test.md (DB/JSONL is source of truth)

stdout | tests/unit/watcher.test.ts > File Watcher Service > Callback Integration > should invoke onFileChange callback with entity info
[watcher] Stopping file watcher...
[watch] Stopping watcher...

stdout | tests/unit/watcher.test.ts > File Watcher Service > Callback Integration > should invoke onFileChange callback with entity info
[watch] Watcher stopped

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getChanges - Error Cases > should return unavailable for non-existent execution
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getChanges - Error Cases > should return unavailable for non-existent execution
[ExecutionChangesService] Execution not found: nonexistent

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > _copyUncommittedFiles with safe merging > should copy file directly when no local changes exist
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getChanges - Error Cases > should support running executions with valid commits
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/local-server| tests/unit/watcher.test.ts (9 tests) 7388ms
   âœ“ File Watcher Service > File Change Detection > should detect markdown file changes  988ms
   âœ“ File Watcher Service > File Change Detection > should detect JSONL file changes  915ms
   âœ“ File Watcher Service > Watcher Control > should handle multiple file changes with debouncing  988ms
   âœ“ File Watcher Service > Callback Integration > should invoke onFileChange callback with entity info  1314ms
stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getChanges - Error Cases > should support running executions with valid commits
[ExecutionChangesService] Execution exec-8: {
  status: [32m'running'[39m,
  before_commit: [32m'2403acceaf207c7163d26b9e89c9c6b77e8b8946'[39m,
  after_commit: [1mnull[22m,
  parent_execution_id: [1mnull[22m
}
[ExecutionChangesService] Root execution exec-8: {
  before_commit: [32m'2403acceaf207c7163d26b9e89c9c6b77e8b8946'[39m,
  after_commit: [1mnull[22m
}
[ExecutionChangesService] Computed beforeCommit: 2403acceaf207c7163d26b9e89c9c6b77e8b8946

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > _copyUncommittedFiles with safe merging > should use three-way merge when local has uncommitted changes
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getChanges - Error Cases > should return unavailable when before_commit is missing
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getChanges - Error Cases > should return unavailable when before_commit is missing
[ExecutionChangesService] Execution exec-9: {
  status: [32m'completed'[39m,
  before_commit: [1mnull[22m,
  after_commit: [1mnull[22m,
  parent_execution_id: [1mnull[22m
}
[ExecutionChangesService] Root execution exec-9: { before_commit: [1mnull[22m, after_commit: [1mnull[22m }
[ExecutionChangesService] Computed beforeCommit: null

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getChanges - Error Cases > should return unavailable when commits not found (garbage collected)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/services/worktree-sync-full.test.ts > Safety and rollback > should create safety tag before sync
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getChanges - Error Cases > should return unavailable when commits not found (garbage collected)
[ExecutionChangesService] Execution exec-10: {
  status: [32m'completed'[39m,
  before_commit: [32m'0000000000000000000000000000000000000000'[39m,
  after_commit: [32m'1111111111111111111111111111111111111111'[39m,
  parent_execution_id: [1mnull[22m
}
[ExecutionChangesService] Root execution exec-10: {
  before_commit: [32m'0000000000000000000000000000000000000000'[39m,
  after_commit: [32m'1111111111111111111111111111111111111111'[39m
}
[ExecutionChangesService] Computed beforeCommit: 0000000000000000000000000000000000000000

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > _copyUncommittedFiles with safe merging > should use JSONL merge for .sudocode JSONL files
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getChanges - Error Cases > should return unavailable when worktree deleted with uncommitted changes
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getChanges - Error Cases > should return unavailable when worktree deleted with uncommitted changes
[ExecutionChangesService] Execution exec-11: {
  status: [32m'completed'[39m,
  before_commit: [32m'0d82f1fe7e0e6a03b5e8f38ab090a3094d5d9b26'[39m,
  after_commit: [1mnull[22m,
  parent_execution_id: [1mnull[22m
}
[ExecutionChangesService] Root execution exec-11: {
  before_commit: [32m'0d82f1fe7e0e6a03b5e8f38ab090a3094d5d9b26'[39m,
  after_commit: [1mnull[22m
}
[ExecutionChangesService] Computed beforeCommit: 0d82f1fe7e0e6a03b5e8f38ab090a3094d5d9b26

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > Summary Calculation > should correctly sum up statistics
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > _copyUncommittedFiles with safe merging > should use three-way merge for untracked local files
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > Summary Calculation > should correctly sum up statistics
[ExecutionChangesService] Execution exec-12: {
  status: [32m'completed'[39m,
  before_commit: [32m'9589c1c3911f1b0d6903d6fd61c7c4ced0801c75'[39m,
  after_commit: [32m'03051ad9f8772a3471908090124c93ddd83890f9'[39m,
  parent_execution_id: [1mnull[22m
}
[ExecutionChangesService] Root execution exec-12: {
  before_commit: [32m'9589c1c3911f1b0d6903d6fd61c7c4ced0801c75'[39m,
  after_commit: [32m'03051ad9f8772a3471908090124c93ddd83890f9'[39m
}
[ExecutionChangesService] Computed beforeCommit: 9589c1c3911f1b0d6903d6fd61c7c4ced0801c75

stdout | tests/integration/services/worktree-sync-full.test.ts > Validation failures > should fail if local working tree is dirty with non-JSONL files
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/worktree-sync-service.test.ts > WorktreeSyncService Foundation > _copyUncommittedFiles with safe merging > should NOT stage files that have conflict markers
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > Deleted Resources > should handle deleted branch gracefully
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/services/worktree-sync-full.test.ts > Validation failures > should allow sync when only JSONL files are uncommitted
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > Deleted Resources > should handle deleted branch gracefully
[ExecutionChangesService] Execution exec-13: {
  status: [32m'completed'[39m,
  before_commit: [32m'620d50bbe6170a91c0c53958d4dbb315192cdc12'[39m,
  after_commit: [32m'dbe13fc45ca51843c4a8812d2c72119334d619ca'[39m,
  parent_execution_id: [1mnull[22m
}
[ExecutionChangesService] Root execution exec-13: {
  before_commit: [32m'620d50bbe6170a91c0c53958d4dbb315192cdc12'[39m,
  after_commit: [32m'dbe13fc45ca51843c4a8812d2c72119334d619ca'[39m
}
[ExecutionChangesService] Computed beforeCommit: 620d50bbe6170a91c0c53958d4dbb315192cdc12

 âœ“ |@sudocode-ai/local-server| tests/unit/services/worktree-sync-service.test.ts (62 tests) 64814ms
   âœ“ WorktreeSyncService Foundation > constructor > should create service instance  766ms
   âœ“ WorktreeSyncService Foundation > loadAndValidateExecution > should load execution from database  494ms
   âœ“ WorktreeSyncService Foundation > loadAndValidateExecution > should throw EXECUTION_NOT_FOUND for missing execution  490ms
   âœ“ WorktreeSyncService Foundation > _validateSyncPreconditions > should pass validation for valid execution  1229ms
   âœ“ WorktreeSyncService Foundation > _validateSyncPreconditions > should throw NO_WORKTREE if worktree_path is null  746ms
   âœ“ WorktreeSyncService Foundation > _validateSyncPreconditions > should throw WORKTREE_MISSING if worktree directory does not exist  1053ms
   âœ“ WorktreeSyncService Foundation > _validateSyncPreconditions > should throw BRANCH_MISSING if worktree branch does not exist  977ms
   âœ“ WorktreeSyncService Foundation > _validateSyncPreconditions > should throw TARGET_BRANCH_MISSING if target branch does not exist  942ms
   âœ“ WorktreeSyncService Foundation > _validateSyncPreconditions > should throw DIRTY_WORKING_TREE if local tree has uncommitted changes  857ms
   âœ“ WorktreeSyncService Foundation > _createSafetySnapshot > should create safety tag  934ms
   âœ“ WorktreeSyncService Foundation > _isLocalTreeClean > should return true for clean working tree  386ms
   âœ“ WorktreeSyncService Foundation > _isLocalTreeClean > should return true for untracked files (ignored)  746ms
   âœ“ WorktreeSyncService Foundation > _isLocalTreeClean > should return false for modified tracked files  623ms
   âœ“ WorktreeSyncService Foundation > _getBranches > should return list of branches  583ms
   âœ“ WorktreeSyncService Foundation > _getCurrentCommit > should return commit SHA for branch  322ms
   âœ“ WorktreeSyncService Foundation > _getCurrentCommit > should throw for nonexistent branch  497ms
   âœ“ WorktreeSyncService Foundation > previewSync > should preview clean merge with no conflicts  1499ms
   âœ“ WorktreeSyncService Foundation > previewSync > should detect code conflicts and set canSync=false  1027ms
   âœ“ WorktreeSyncService Foundation > previewSync > should detect uncommitted JSONL files  1228ms
   âœ“ WorktreeSyncService Foundation > previewSync > should warn when execution is running  1702ms
   âœ“ WorktreeSyncService Foundation > previewSync > should return error when validation fails  575ms
   âœ“ WorktreeSyncService Foundation > previewSync > should handle JSONL conflicts as auto-resolvable  2212ms
   âœ“ WorktreeSyncService Foundation > resolveJSONLConflicts > should resolve JSONL conflicts using three-way merge  792ms
   âœ“ WorktreeSyncService Foundation > resolveJSONLConflicts > should handle empty conflict list  376ms
   âœ“ WorktreeSyncService Foundation > resolveJSONLConflicts > should throw error if file does not exist at revision  486ms
   âœ“ WorktreeSyncService Foundation > commitUncommittedJSONL > should commit uncommitted JSONL files  587ms
   âœ“ WorktreeSyncService Foundation > commitUncommittedJSONL > should handle multiple files  739ms
   âœ“ WorktreeSyncService Foundation > stageSync > should stage changes without committing  1769ms
   âœ“ WorktreeSyncService Foundation > stageSync > should return error when code conflicts exist  1610ms
   âœ“ WorktreeSyncService Foundation > stageSync > should handle uncommitted JSONL files  1288ms
   âœ“ WorktreeSyncService Foundation > stageSync > should throw error for non-existent execution  354ms
   âœ“ WorktreeSyncService Foundation > stageSync > should leave changes staged for manual commit  2433ms
   âœ“ WorktreeSyncService Foundation > preserveSync > should merge commits preserving history  2597ms
   âœ“ WorktreeSyncService Foundation > preserveSync > should return error when code conflicts exist  2395ms
   âœ“ WorktreeSyncService Foundation > preserveSync > should auto-resolve JSONL conflicts  3280ms
   âœ“ WorktreeSyncService Foundation > preserveSync > should throw error for non-existent execution  475ms
   âœ“ WorktreeSyncService Foundation > preserveSync > should return error when no commits to merge  1166ms
   âœ“ WorktreeSyncService Foundation > preserveSync > should throw DIRTY_WORKING_TREE if local tree has uncommitted changes  786ms
   âœ“ WorktreeSyncService Foundation > _readJSONLVersion > should read JSONL file at specific revision  711ms
   âœ“ WorktreeSyncService Foundation > _readJSONLVersion > should return empty array for non-existent file  481ms
   âœ“ WorktreeSyncService Foundation > _readJSONLVersion > should read file at specific commit  1724ms
   âœ“ WorktreeSyncService Foundation > _hasLocalUncommittedChanges > should return false for file without changes  408ms
   âœ“ WorktreeSyncService Foundation > _hasLocalUncommittedChanges > should return true for file with uncommitted changes  465ms
   âœ“ WorktreeSyncService Foundation > _hasLocalUncommittedChanges > should return false for new untracked file (not in HEAD)  334ms
   âœ“ WorktreeSyncService Foundation > _isFileUntracked > should return true for untracked file  531ms
   âœ“ WorktreeSyncService Foundation > _isFileUntracked > should return false for tracked file  539ms
   âœ“ WorktreeSyncService Foundation > _isFileUntracked > should return false for staged file  1099ms
   âœ“ WorktreeSyncService Foundation > _isJSONLFile > should return true for .sudocode JSONL files  548ms
   âœ“ WorktreeSyncService Foundation > _isJSONLFile > should return false for non-JSONL files  343ms
   âœ“ WorktreeSyncService Foundation > _isJSONLFile > should return false for JSONL files outside .sudocode  347ms
   âœ“ WorktreeSyncService Foundation > _threeWayMergeFile > should merge non-conflicting changes cleanly  599ms
   âœ“ WorktreeSyncService Foundation > _threeWayMergeFile > should return true and add conflict markers for conflicting changes  755ms
   âœ“ WorktreeSyncService Foundation > _mergeJSONLFiles > should merge JSONL files using UUID-based deduplication  479ms
   âœ“ WorktreeSyncService Foundation > _mergeJSONLFiles > should merge duplicate UUIDs by keeping most recent  697ms
   âœ“ WorktreeSyncService Foundation > _copyUncommittedFiles with safe merging > should copy file directly when no local changes exist  3545ms
   âœ“ WorktreeSyncService Foundation > _copyUncommittedFiles with safe merging > should use three-way merge when local has uncommitted changes  1162ms
   âœ“ WorktreeSyncService Foundation > _copyUncommittedFiles with safe merging > should use JSONL merge for .sudocode JSONL files  1010ms
   âœ“ WorktreeSyncService Foundation > _copyUncommittedFiles with safe merging > should use three-way merge for untracked local files  1044ms
   âœ“ WorktreeSyncService Foundation > _copyUncommittedFiles with safe merging > should NOT stage files that have conflict markers  4942ms
stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > Deleted Resources > should track worktree existence
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > Deleted Resources > should track worktree existence
[ExecutionChangesService] Execution exec-14: {
  status: [32m'completed'[39m,
  before_commit: [32m'a837e395d066a657f30639accdf6d02dcc5e595e'[39m,
  after_commit: [32m'8953efe94ff5942be9d7fbb7f515444c7d2ddcb6'[39m,
  parent_execution_id: [1mnull[22m
}
[ExecutionChangesService] Root execution exec-14: {
  before_commit: [32m'a837e395d066a657f30639accdf6d02dcc5e595e'[39m,
  after_commit: [32m'8953efe94ff5942be9d7fbb7f515444c7d2ddcb6'[39m
}
[ExecutionChangesService] Computed beforeCommit: a837e395d066a657f30639accdf6d02dcc5e595e

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > CRUD Operations > GET /api/workflows/:id - Get > should get workflow by ID
[workflows] getEngineForWorkflow: workflow=wf-e0902ea9, engineType=sequential

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > CRUD Operations > DELETE /api/workflows/:id - Delete > should delete pending workflow
[workflows] getEngineForWorkflow: workflow=wf-7928f03c, engineType=sequential

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/start > should start pending workflow
[workflows] getEngineForWorkflow: workflow=wf-0f7df425, engineType=sequential

stdout | tests/integration/services/worktree-sync-full.test.ts > Validation failures > should fail if worktree missing
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > Deleted Resources > should calculate current state from main repo when worktree is deleted
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/start > should start pending workflow
[WorktreeManager] Setting up isolated worktree environment {
  repoPath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF'[39m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-0f7df425'[39m
}
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-0f7df425/.sudocode'[39m
}
[WorktreeManager] Created .sudocode directory in worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-0f7df425/.sudocode
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-0f7df425/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/issues.jsonl
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-0f7df425/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/specs.jsonl
[WorktreeManager] No config.json to copy from main repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/start > should start pending workflow
[WorktreeManager] Successfully initialized local database in worktree at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-0f7df425/.sudocode/cache.db
[WorktreeManager] Database file created {
  path: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-0f7df425/.sudocode/cache.db'[39m,
  size: [33m4096[39m
}
[WorktreeManager] Worktree environment setup complete

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/start > should start pending workflow
[ExecutionLifecycle] Created workflow worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-0f7df425 (branch: sudocode/workflow/0f7df425/workflow-for-2-issues)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/start > should start pending workflow
[BaseWorkflowEngine] Created workflow worktree for wf-0f7df425: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-0f7df425 (branch: sudocode/workflow/0f7df425/workflow-for-2-issues)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/start > should start pending workflow
[workflows] getEngineForWorkflow: workflow=wf-0f7df425, engineType=sequential

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/start > should fail to start already running workflow
[workflows] getEngineForWorkflow: workflow=wf-242fbb11, engineType=sequential

stdout | tests/integration/services/worktree-sync-full.test.ts > Multiple JSONL files > should handle multiple JSONL files in sync
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/start > should fail to start already running workflow
[WorktreeManager] Setting up isolated worktree environment {
  repoPath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF'[39m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-242fbb11'[39m
}
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-242fbb11/.sudocode'[39m
}
[WorktreeManager] Created .sudocode directory in worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-242fbb11/.sudocode
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-242fbb11/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/issues.jsonl
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-242fbb11/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/specs.jsonl
[WorktreeManager] No config.json to copy from main repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/start > should fail to start already running workflow
[WorktreeManager] Successfully initialized local database in worktree at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-242fbb11/.sudocode/cache.db
[WorktreeManager] Database file created {
  path: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-242fbb11/.sudocode/cache.db'[39m,
  size: [33m4096[39m
}
[WorktreeManager] Worktree environment setup complete

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/start > should fail to start already running workflow
[ExecutionLifecycle] Created workflow worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-242fbb11 (branch: sudocode/workflow/242fbb11/workflow-for-2-issues)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/start > should fail to start already running workflow
[BaseWorkflowEngine] Created workflow worktree for wf-242fbb11: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-242fbb11 (branch: sudocode/workflow/242fbb11/workflow-for-2-issues)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/start > should fail to start already running workflow
[workflows] getEngineForWorkflow: workflow=wf-242fbb11, engineType=sequential

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > Deleted Resources > should calculate current state from main repo when worktree is deleted
[ExecutionChangesService] Execution exec-15: {
  status: [32m'completed'[39m,
  before_commit: [32m'ae4704d2a35e1200d6d4536b6f5d677e418c95f6'[39m,
  after_commit: [32m'ab82364d2666852ca25d86cadab108c7ac483b60'[39m,
  parent_execution_id: [1mnull[22m
}
[ExecutionChangesService] Root execution exec-15: {
  before_commit: [32m'ae4704d2a35e1200d6d4536b6f5d677e418c95f6'[39m,
  after_commit: [32m'ab82364d2666852ca25d86cadab108c7ac483b60'[39m
}
[ExecutionChangesService] Computed beforeCommit: ae4704d2a35e1200d6d4536b6f5d677e418c95f6

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/pause > should pause running workflow
[workflows] getEngineForWorkflow: workflow=wf-e0424bb8, engineType=sequential

stdout | tests/unit/services/execution-service.test.ts > ExecutionService
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > prompt resolution > should resolve [[s-xxxxx]] spec references in prompt
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > prompt resolution > should resolve [[s-xxxxx]] spec references in prompt
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/pause > should pause running workflow
[WorktreeManager] Setting up isolated worktree environment {
  repoPath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF'[39m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-e0424bb8'[39m
}
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-e0424bb8/.sudocode'[39m
}
[WorktreeManager] Created .sudocode directory in worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-e0424bb8/.sudocode
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-e0424bb8/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/issues.jsonl
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-e0424bb8/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/specs.jsonl
[WorktreeManager] No config.json to copy from main repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > prompt resolution > should resolve [[s-xxxxx]] spec references in prompt
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > prompt resolution > should resolve @s-xxxxx spec references in prompt
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > prompt resolution > should resolve @s-xxxxx spec references in prompt
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/pause > should pause running workflow
[WorktreeManager] Successfully initialized local database in worktree at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-e0424bb8/.sudocode/cache.db
[WorktreeManager] Database file created {
  path: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-e0424bb8/.sudocode/cache.db'[39m,
  size: [33m4096[39m
}
[WorktreeManager] Worktree environment setup complete

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/pause > should pause running workflow
[ExecutionLifecycle] Created workflow worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-e0424bb8 (branch: sudocode/workflow/e0424bb8/workflow-for-2-issues)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/pause > should pause running workflow
[BaseWorkflowEngine] Created workflow worktree for wf-e0424bb8: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-e0424bb8 (branch: sudocode/workflow/e0424bb8/workflow-for-2-issues)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/pause > should pause running workflow
[workflows] getEngineForWorkflow: workflow=wf-e0424bb8, engineType=sequential

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/pause > should pause running workflow
[SequentialWorkflowEngine] Reset step step-f2590410 to pending after pause (keeping executionId for resume)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/pause > should pause running workflow
[workflows] getEngineForWorkflow: workflow=wf-e0424bb8, engineType=sequential

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > prompt resolution > should resolve @s-xxxxx spec references in prompt
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > prompt resolution > should resolve [[i-xxxxx]] issue references in prompt
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > prompt resolution > should resolve [[i-xxxxx]] issue references in prompt
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/resume > should resume paused workflow
[workflows] getEngineForWorkflow: workflow=wf-016fe9d2, engineType=sequential

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > Deleted Resources > should show only captured state when both branch and worktree are deleted
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > prompt resolution > should resolve [[i-xxxxx]] issue references in prompt
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > prompt resolution > should resolve @i-xxxxx issue references in prompt
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > prompt resolution > should resolve @i-xxxxx issue references in prompt
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > prompt resolution > should resolve @i-xxxxx issue references in prompt
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > prompt resolution > should resolve multiple references in one prompt
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > prompt resolution > should resolve multiple references in one prompt
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/resume > should resume paused workflow
[WorktreeManager] Setting up isolated worktree environment {
  repoPath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF'[39m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-016fe9d2'[39m
}
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-016fe9d2/.sudocode'[39m
}
[WorktreeManager] Created .sudocode directory in worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-016fe9d2/.sudocode
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-016fe9d2/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/issues.jsonl
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-016fe9d2/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/specs.jsonl
[WorktreeManager] No config.json to copy from main repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > prompt resolution > should resolve multiple references in one prompt
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/resume > should resume paused workflow
[WorktreeManager] Successfully initialized local database in worktree at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-016fe9d2/.sudocode/cache.db
[WorktreeManager] Database file created {
  path: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-016fe9d2/.sudocode/cache.db'[39m,
  size: [33m4096[39m
}
[WorktreeManager] Worktree environment setup complete

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/resume > should resume paused workflow
[ExecutionLifecycle] Created workflow worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-016fe9d2 (branch: sudocode/workflow/016fe9d2/workflow-for-2-issues)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/resume > should resume paused workflow
[BaseWorkflowEngine] Created workflow worktree for wf-016fe9d2: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-016fe9d2 (branch: sudocode/workflow/016fe9d2/workflow-for-2-issues)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > prompt resolution > should pass through @file mentions unchanged
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > prompt resolution > should pass through @file mentions unchanged
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/resume > should resume paused workflow
[workflows] getEngineForWorkflow: workflow=wf-016fe9d2, engineType=sequential

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/resume > should resume paused workflow
[SequentialWorkflowEngine] Reset step step-626d6568 to pending after pause (keeping executionId for resume)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/resume > should resume paused workflow
[workflows] getEngineForWorkflow: workflow=wf-016fe9d2, engineType=sequential

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/resume > should resume paused workflow
[workflows] getEngineForWorkflow: workflow=wf-016fe9d2, engineType=sequential

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > prompt resolution > should pass through @file mentions unchanged
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/cancel > should cancel running workflow
[workflows] getEngineForWorkflow: workflow=wf-6a05228c, engineType=sequential

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > Deleted Resources > should show only captured state when both branch and worktree are deleted
[ExecutionChangesService] Execution exec-16: {
  status: [32m'completed'[39m,
  before_commit: [32m'75566ef8c6d87d90f52219db7234dd6c85364832'[39m,
  after_commit: [32m'91607dbba3a60d0d48444b1edade589d39f89821'[39m,
  parent_execution_id: [1mnull[22m
}
[ExecutionChangesService] Root execution exec-16: {
  before_commit: [32m'75566ef8c6d87d90f52219db7234dd6c85364832'[39m,
  after_commit: [32m'91607dbba3a60d0d48444b1edade589d39f89821'[39m
}
[ExecutionChangesService] Computed beforeCommit: 75566ef8c6d87d90f52219db7234dd6c85364832

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > prompt resolution > should handle missing spec references gracefully
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > prompt resolution > should handle missing spec references gracefully
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > prompt resolution > should handle missing spec references gracefully
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > prompt resolution > should handle missing issue references gracefully
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > prompt resolution > should handle missing issue references gracefully
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > prompt resolution > should handle missing issue references gracefully
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > prompt resolution > should resolve references in worktree mode
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > prompt resolution > should resolve references in worktree mode
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > Deleted Resources > should use main repo path for branch operations even with deleted worktree
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/cancel > should cancel running workflow
[WorktreeManager] Setting up isolated worktree environment {
  repoPath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF'[39m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-6a05228c'[39m
}
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-6a05228c/.sudocode'[39m
}
[WorktreeManager] Created .sudocode directory in worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-6a05228c/.sudocode
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-6a05228c/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/issues.jsonl
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-6a05228c/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/specs.jsonl
[WorktreeManager] No config.json to copy from main repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > prompt resolution > should resolve references in worktree mode
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/cancel > should cancel running workflow
[WorktreeManager] Successfully initialized local database in worktree at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-6a05228c/.sudocode/cache.db
[WorktreeManager] Database file created {
  path: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-6a05228c/.sudocode/cache.db'[39m,
  size: [33m4096[39m
}
[WorktreeManager] Worktree environment setup complete

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/cancel > should cancel running workflow
[ExecutionLifecycle] Created workflow worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-6a05228c (branch: sudocode/workflow/6a05228c/workflow-for-2-issues)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/cancel > should cancel running workflow
[BaseWorkflowEngine] Created workflow worktree for wf-6a05228c: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-6a05228c (branch: sudocode/workflow/6a05228c/workflow-for-2-issues)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createExecution > should create execution in worktree mode
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createExecution > should create execution in worktree mode
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/cancel > should cancel running workflow
[workflows] getEngineForWorkflow: workflow=wf-6a05228c, engineType=sequential

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/cancel > should cancel running workflow
[workflows] getEngineForWorkflow: workflow=wf-6a05228c, engineType=sequential

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Step Operations > should skip step with reason
[workflows] getEngineForWorkflow: workflow=wf-9d790114, engineType=sequential

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createExecution > should create execution in worktree mode
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createExecution > should create execution in local mode
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createExecution > should create execution in local mode
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createExecution > should create execution in local mode
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Step Operations > should skip step with reason
[WorktreeManager] Setting up isolated worktree environment {
  repoPath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF'[39m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-9d790114'[39m
}
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-9d790114/.sudocode'[39m
}
[WorktreeManager] Created .sudocode directory in worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-9d790114/.sudocode
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-9d790114/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/issues.jsonl
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-9d790114/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/specs.jsonl
[WorktreeManager] No config.json to copy from main repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Step Operations > should skip step with reason
[WorktreeManager] Successfully initialized local database in worktree at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-9d790114/.sudocode/cache.db
[WorktreeManager] Database file created {
  path: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-9d790114/.sudocode/cache.db'[39m,
  size: [33m4096[39m
}
[WorktreeManager] Worktree environment setup complete

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Step Operations > should skip step with reason
[ExecutionLifecycle] Created workflow worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-9d790114 (branch: sudocode/workflow/9d790114/workflow-for-2-issues)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Step Operations > should skip step with reason
[BaseWorkflowEngine] Created workflow worktree for wf-9d790114: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-9d790114 (branch: sudocode/workflow/9d790114/workflow-for-2-issues)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Step Operations > should skip step with reason
[workflows] getEngineForWorkflow: workflow=wf-9d790114, engineType=sequential

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Step Operations > should skip step with reason
[workflows] getEngineForWorkflow: workflow=wf-9d790114, engineType=sequential

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Step Operations > should skip step with reason
[workflows] getEngineForWorkflow: workflow=wf-9d790114, engineType=sequential

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Events > should record and retrieve workflow events
[workflows] getEngineForWorkflow: workflow=wf-4405e957, engineType=sequential

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > Deleted Resources > should use main repo path for branch operations even with deleted worktree
[ExecutionChangesService] Execution exec-17: {
  status: [32m'completed'[39m,
  before_commit: [32m'9a4246944038dbe0840d2d808ab356e62806bb48'[39m,
  after_commit: [32m'e19f1e77e252df160dd51cebb40e17b68ed357c8'[39m,
  parent_execution_id: [1mnull[22m
}
[ExecutionChangesService] Root execution exec-17: {
  before_commit: [32m'9a4246944038dbe0840d2d808ab356e62806bb48'[39m,
  after_commit: [32m'e19f1e77e252df160dd51cebb40e17b68ed357c8'[39m
}
[ExecutionChangesService] Computed beforeCommit: 9a4246944038dbe0840d2d808ab356e62806bb48

stdout | tests/integration/services/worktree-sync-full.test.ts > Large changesets > should handle syncing 50+ files
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createExecution > should capture before_commit in local mode
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createExecution > should capture before_commit in local mode
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createExecution > should capture before_commit in local mode
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Events > should record and retrieve workflow events
[WorktreeManager] Setting up isolated worktree environment {
  repoPath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF'[39m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-4405e957'[39m
}
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-4405e957/.sudocode'[39m
}
[WorktreeManager] Created .sudocode directory in worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-4405e957/.sudocode
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-4405e957/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/issues.jsonl
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-4405e957/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/specs.jsonl
[WorktreeManager] No config.json to copy from main repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Events > should record and retrieve workflow events
[WorktreeManager] Successfully initialized local database in worktree at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-4405e957/.sudocode/cache.db
[WorktreeManager] Database file created {
  path: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-4405e957/.sudocode/cache.db'[39m,
  size: [33m4096[39m
}
[WorktreeManager] Worktree environment setup complete

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Events > should record and retrieve workflow events
[ExecutionLifecycle] Created workflow worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-4405e957 (branch: sudocode/workflow/4405e957/workflow-for-2-issues)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Events > should record and retrieve workflow events
[BaseWorkflowEngine] Created workflow worktree for wf-4405e957: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-4405e957 (branch: sudocode/workflow/4405e957/workflow-for-2-issues)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createExecution > should capture before_commit in local mode
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getFileDiff > should return old and new content for a modified file
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createExecution > should throw error for non-existent issue
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createExecution > should throw error for non-existent issue
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Events > should record and retrieve workflow events
[workflows] getEngineForWorkflow: workflow=wf-4405e957, engineType=sequential

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createExecution > should default to claude-code agent when agentType not specified
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createExecution > should default to claude-code agent when agentType not specified
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Extended Status > should return extended workflow status
[workflows] getEngineForWorkflow: workflow=wf-8649377e, engineType=sequential

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createExecution > should default to claude-code agent when agentType not specified
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createExecution > should create execution with specified agent type
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createExecution > should create execution with specified agent type
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createExecution > should create execution with specified agent type
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createExecution > should create execution for codex agent
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createExecution > should create execution for codex agent
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getFileDiff > should return old and new content for a modified file
[ExecutionChangesService] Getting diff for test.ts: {
  beforeCommit: [32m'ce007bb213d628338b1d9ab9e44ea9d02cc1dcba'[39m,
  afterCommit: [32m'0c24ebe179e3dddfc50b994bd21ab11167ab289e'[39m,
  worktreePath: [1mnull[22m,
  normalizedPath: [32m'test.ts'[39m
}
[ExecutionChangesService] Running: git show ce007bb213d628338b1d9ab9e44ea9d02cc1dcba:test.ts
[ExecutionChangesService] Old content length: 19
[ExecutionChangesService] Fetching new content from after_commit: 0c24ebe179e3dddfc50b994bd21ab11167ab289e
[ExecutionChangesService] Running: git show 0c24ebe179e3dddfc50b994bd21ab11167ab289e:test.ts
[ExecutionChangesService] New content length: 19
[ExecutionChangesService] Returning diff - oldContent: 19 chars, newContent: 19 chars

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createExecution > should create execution for copilot agent
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Extended Status > should return extended workflow status
[WorktreeManager] Setting up isolated worktree environment {
  repoPath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF'[39m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-8649377e'[39m
}
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-8649377e/.sudocode'[39m
}
[WorktreeManager] Created .sudocode directory in worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-8649377e/.sudocode
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-8649377e/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/issues.jsonl
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-8649377e/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/specs.jsonl
[WorktreeManager] No config.json to copy from main repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Extended Status > should return extended workflow status
[WorktreeManager] Successfully initialized local database in worktree at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-8649377e/.sudocode/cache.db
[WorktreeManager] Database file created {
  path: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-8649377e/.sudocode/cache.db'[39m,
  size: [33m4096[39m
}
[WorktreeManager] Worktree environment setup complete

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Extended Status > should return extended workflow status
[ExecutionLifecycle] Created workflow worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-8649377e (branch: sudocode/workflow/8649377e/workflow-for-3-issues)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Extended Status > should return extended workflow status
[BaseWorkflowEngine] Created workflow worktree for wf-8649377e: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-8649377e (branch: sudocode/workflow/8649377e/workflow-for-3-issues)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Extended Status > should return extended workflow status
[workflows] getEngineForWorkflow: workflow=wf-8649377e, engineType=sequential

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createExecution > should create execution for copilot agent
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Extended Status > should include active executions
[workflows] getEngineForWorkflow: workflow=wf-f94aa0e6, engineType=sequential

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createExecution > should create execution for cursor agent
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createExecution > should create execution for cursor agent
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createExecution > should use provided baseBranch in worktree mode
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createExecution > should use provided baseBranch in worktree mode
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getFileDiff > should return empty old content for a new file
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createExecution > should use provided baseBranch in worktree mode
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Extended Status > should include active executions
[WorktreeManager] Setting up isolated worktree environment {
  repoPath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF'[39m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-f94aa0e6'[39m
}
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-f94aa0e6/.sudocode'[39m
}
[WorktreeManager] Created .sudocode directory in worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-f94aa0e6/.sudocode
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-f94aa0e6/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/issues.jsonl
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-f94aa0e6/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/specs.jsonl
[WorktreeManager] No config.json to copy from main repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Extended Status > should include active executions
[WorktreeManager] Successfully initialized local database in worktree at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-f94aa0e6/.sudocode/cache.db
[WorktreeManager] Database file created {
  path: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-f94aa0e6/.sudocode/cache.db'[39m,
  size: [33m4096[39m
}
[WorktreeManager] Worktree environment setup complete

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createExecution > should use provided baseBranch in local mode
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createExecution > should use provided baseBranch in local mode
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Extended Status > should include active executions
[ExecutionLifecycle] Created workflow worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-f94aa0e6 (branch: sudocode/workflow/f94aa0e6/workflow-for-2-issues)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Extended Status > should include active executions
[BaseWorkflowEngine] Created workflow worktree for wf-f94aa0e6: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-f94aa0e6 (branch: sudocode/workflow/f94aa0e6/workflow-for-2-issues)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Extended Status > should include active executions
[workflows] getEngineForWorkflow: workflow=wf-f94aa0e6, engineType=sequential

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Escalation Flow > should create escalation
[workflows] getEngineForWorkflow: workflow=wf-e7a68e03, engineType=sequential

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createExecution > should use provided baseBranch in local mode
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getFileDiff > should return empty old content for a new file
[ExecutionChangesService] Getting diff for newfile.ts: {
  beforeCommit: [32m'e977d9998d18e1a27687db3281675b8d1e840f08'[39m,
  afterCommit: [32m'd21860d4c66c14593bad0a84a49bce439624707b'[39m,
  worktreePath: [1mnull[22m,
  normalizedPath: [32m'newfile.ts'[39m
}
[ExecutionChangesService] Running: git show e977d9998d18e1a27687db3281675b8d1e840f08:newfile.ts
[ExecutionChangesService] Failed to get old content: Command failed: git show e977d9998d18e1a27687db3281675b8d1e840f08:newfile.ts
fatal: path 'newfile.ts' exists on disk, but not in 'e977d9998d18e1a27687db3281675b8d1e840f08'

[ExecutionChangesService] Fetching new content from after_commit: d21860d4c66c14593bad0a84a49bce439624707b
[ExecutionChangesService] Running: git show d21860d4c66c14593bad0a84a49bce439624707b:newfile.ts
[ExecutionChangesService] New content length: 21
[ExecutionChangesService] Returning diff - oldContent: 0 chars, newContent: 21 chars

stdout | tests/integration/export.test.ts > JSONL Export Integration
Shutting down ProjectManager...
Closing project: test-project-0507d9dd
Shutting down project context: test-project-0507d9dd

stdout | tests/integration/export.test.ts > JSONL Export Integration
[integration-sync] Stopping for project test-project-0507d9dd
[integration-sync] Service stopped for test-project-0507d9dd

stdout | tests/integration/export.test.ts > JSONL Export Integration
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-0507d9dd

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Escalation Flow > should create escalation
[WorktreeManager] Setting up isolated worktree environment {
  repoPath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF'[39m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-e7a68e03'[39m
}
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-e7a68e03/.sudocode'[39m
}
[WorktreeManager] Created .sudocode directory in worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-e7a68e03/.sudocode
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-e7a68e03/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/issues.jsonl
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-e7a68e03/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/specs.jsonl
[WorktreeManager] No config.json to copy from main repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Escalation Flow > should create escalation
[WorktreeManager] Successfully initialized local database in worktree at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-e7a68e03/.sudocode/cache.db
[WorktreeManager] Database file created {
  path: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-e7a68e03/.sudocode/cache.db'[39m,
  size: [33m4096[39m
}
[WorktreeManager] Worktree environment setup complete

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Escalation Flow > should create escalation
[ExecutionLifecycle] Created workflow worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-e7a68e03 (branch: sudocode/workflow/e7a68e03/workflow-for-2-issues)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Escalation Flow > should create escalation
[BaseWorkflowEngine] Created workflow worktree for wf-e7a68e03: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-e7a68e03 (branch: sudocode/workflow/e7a68e03/workflow-for-2-issues)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Escalation Flow > should create escalation
[workflows] getEngineForWorkflow: workflow=wf-e7a68e03, engineType=sequential
[workflows/:id/escalate] Escalation created for workflow wf-e7a68e03: b2a4244c-0f9a-444c-adc9-038fb94edff4

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createExecution > should default to current branch when baseBranch not provided
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/export.test.ts > JSONL Export Integration
Project closed: test-project-0507d9dd

stdout | tests/integration/export.test.ts > JSONL Export Integration
ProjectManager shutdown complete

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createExecution > should default to current branch when baseBranch not provided
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createExecution > should default to current branch when baseBranch not provided
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getFileDiff > should return empty new content for a deleted file
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Escalation Flow > should create escalation with options
[workflows] getEngineForWorkflow: workflow=wf-88a73657, engineType=sequential

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createExecution > should default to current branch when baseBranch not provided
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should create follow-up execution reusing worktree
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should create follow-up execution reusing worktree
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Escalation Flow > should create escalation with options
[WorktreeManager] Setting up isolated worktree environment {
  repoPath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF'[39m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-88a73657'[39m
}
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-88a73657/.sudocode'[39m
}
[WorktreeManager] Created .sudocode directory in worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-88a73657/.sudocode
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-88a73657/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/issues.jsonl
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-88a73657/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/specs.jsonl
[WorktreeManager] No config.json to copy from main repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Escalation Flow > should create escalation with options
[WorktreeManager] Successfully initialized local database in worktree at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-88a73657/.sudocode/cache.db
[WorktreeManager] Database file created {
  path: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-88a73657/.sudocode/cache.db'[39m,
  size: [33m4096[39m
}
[WorktreeManager] Worktree environment setup complete

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Escalation Flow > should create escalation with options
[ExecutionLifecycle] Created workflow worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-88a73657 (branch: sudocode/workflow/88a73657/workflow-for-2-issues)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Escalation Flow > should create escalation with options
[BaseWorkflowEngine] Created workflow worktree for wf-88a73657: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-88a73657 (branch: sudocode/workflow/88a73657/workflow-for-2-issues)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should create follow-up execution reusing worktree
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should create follow-up execution reusing worktree
Recreating worktree for follow-up execution: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-service-tmB0oB/.worktrees/5c138b4e-8982-4d6b-8658-4a08f553e360

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should create follow-up execution reusing worktree
[ExecutionService] Follow-up task metadata: {
  executionId: [32m'a28ef914-706f-4a54-861f-eb4252982606'[39m,
  parentExecutionId: [32m'5c138b4e-8982-4d6b-8658-4a08f553e360'[39m,
  inheritedConfigKeys: [ [32m'mode'[39m ],
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  model: [90mundefined[39m
}

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Escalation Flow > should create escalation with options
[workflows] getEngineForWorkflow: workflow=wf-88a73657, engineType=sequential
[workflows/:id/escalate] Escalation created for workflow wf-88a73657: b791921c-07d5-4822-b42f-8a941181c968

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should preserve agent type from parent execution
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should preserve agent type from parent execution
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Escalation Flow > should auto-approve in full_auto mode
[workflows] getEngineForWorkflow: workflow=wf-63f924ac, engineType=sequential

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should preserve agent type from parent execution
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should preserve agent type from parent execution
Recreating worktree for follow-up execution: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-service-tmB0oB/.worktrees/110b8848-14e7-479d-92c8-a0c15115a5e4

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should preserve agent type from parent execution
[ExecutionService] Follow-up task metadata: {
  executionId: [32m'3c512742-c914-48f7-8f94-97a1d7cde0b3'[39m,
  parentExecutionId: [32m'110b8848-14e7-479d-92c8-a0c15115a5e4'[39m,
  inheritedConfigKeys: [ [32m'mode'[39m ],
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  model: [90mundefined[39m
}

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getFileDiff > should return empty new content for a deleted file
[ExecutionChangesService] Getting diff for todelete.ts: {
  beforeCommit: [32m'f010e75ae9304158da1519c3881ad3900a655257'[39m,
  afterCommit: [32m'8db62f29c525cd7aa76b5c91d0b54e429ae01d76'[39m,
  worktreePath: [1mnull[22m,
  normalizedPath: [32m'todelete.ts'[39m
}
[ExecutionChangesService] Running: git show f010e75ae9304158da1519c3881ad3900a655257:todelete.ts
[ExecutionChangesService] Old content length: 22
[ExecutionChangesService] Fetching new content from after_commit: 8db62f29c525cd7aa76b5c91d0b54e429ae01d76
[ExecutionChangesService] Running: git show 8db62f29c525cd7aa76b5c91d0b54e429ae01d76:todelete.ts
[ExecutionChangesService] Failed to get new content: Command failed: git show 8db62f29c525cd7aa76b5c91d0b54e429ae01d76:todelete.ts
fatal: path 'todelete.ts' does not exist in '8db62f29c525cd7aa76b5c91d0b54e429ae01d76'

[ExecutionChangesService] Returning diff - oldContent: 22 chars, newContent: 0 chars

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should store user feedback as prompt in follow-up execution
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should store user feedback as prompt in follow-up execution
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should store user feedback as prompt in follow-up execution
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should store user feedback as prompt in follow-up execution
Recreating worktree for follow-up execution: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-service-tmB0oB/.worktrees/b1617955-dd05-4422-b524-8cfcd9761a6b

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should store user feedback as prompt in follow-up execution
[ExecutionService] Follow-up task metadata: {
  executionId: [32m'1058e7af-e57e-448f-88b1-b3775a5a5e1f'[39m,
  parentExecutionId: [32m'b1617955-dd05-4422-b524-8cfcd9761a6b'[39m,
  inheritedConfigKeys: [ [32m'mode'[39m ],
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  model: [90mundefined[39m
}

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Escalation Flow > should auto-approve in full_auto mode
[WorktreeManager] Setting up isolated worktree environment {
  repoPath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF'[39m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-63f924ac'[39m
}
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-63f924ac/.sudocode'[39m
}
[WorktreeManager] Created .sudocode directory in worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-63f924ac/.sudocode
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-63f924ac/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/issues.jsonl
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-63f924ac/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/specs.jsonl
[WorktreeManager] No config.json to copy from main repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getFileDiff > should handle files with leading ./ in path
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should include original prompt when option is enabled
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should include original prompt when option is enabled
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Escalation Flow > should auto-approve in full_auto mode
[WorktreeManager] Successfully initialized local database in worktree at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-63f924ac/.sudocode/cache.db
[WorktreeManager] Database file created {
  path: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-63f924ac/.sudocode/cache.db'[39m,
  size: [33m4096[39m
}
[WorktreeManager] Worktree environment setup complete

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Escalation Flow > should auto-approve in full_auto mode
[ExecutionLifecycle] Created workflow worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-63f924ac (branch: sudocode/workflow/63f924ac/workflow-for-2-issues)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Escalation Flow > should auto-approve in full_auto mode
[BaseWorkflowEngine] Created workflow worktree for wf-63f924ac: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-63f924ac (branch: sudocode/workflow/63f924ac/workflow-for-2-issues)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should include original prompt when option is enabled
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should include original prompt when option is enabled
Recreating worktree for follow-up execution: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-service-tmB0oB/.worktrees/273b1012-ce8e-414e-8102-3622f5fe687c

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should include original prompt when option is enabled
[ExecutionService] Follow-up task metadata: {
  executionId: [32m'c1280aae-6fba-41c1-81db-0922f319cc70'[39m,
  parentExecutionId: [32m'273b1012-ce8e-414e-8102-3622f5fe687c'[39m,
  inheritedConfigKeys: [ [32m'mode'[39m ],
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  model: [90mundefined[39m
}

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should support follow-ups for local mode executions (no worktree)
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should support follow-ups for local mode executions (no worktree)
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Escalation Flow > should auto-approve in full_auto mode
[workflows/:id/escalate] Workflow wf-63f924ac is in full_auto mode, auto-approving

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Escalation Flow > should respond to escalation
[workflows] getEngineForWorkflow: workflow=wf-671387ad, engineType=sequential

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should support follow-ups for local mode executions (no worktree)
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should support follow-ups for local mode executions (no worktree)
[ExecutionService] Follow-up task metadata: {
  executionId: [32m'c27a6efe-fc88-41cf-ab66-f6d959986e25'[39m,
  parentExecutionId: [32m'2fa6ec8d-42d3-48dc-9182-e7cefa635f74'[39m,
  inheritedConfigKeys: [ [32m'mode'[39m ],
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  model: [90mundefined[39m
}

 âœ“ |@sudocode-ai/local-server| tests/integration/export.test.ts (9 tests) 40098ms
   âœ“ JSONL Export Integration > Issue Export > should export issue to JSONL and Markdown after creation  2567ms
   âœ“ JSONL Export Integration > Issue Export > should update JSONL and Markdown after issue update  5141ms
   âœ“ JSONL Export Integration > Issue Export > should remove issue from JSONL after deletion  5059ms
   âœ“ JSONL Export Integration > Issue Export > should handle multiple rapid updates with debouncing  2608ms
   âœ“ JSONL Export Integration > Issue Export > should handle multiple different issues updated rapidly  7149ms
   âœ“ JSONL Export Integration > Spec Export > should export spec to JSONL after creation  2532ms
   âœ“ JSONL Export Integration > Spec Export > should update JSONL file after spec update  5633ms
   âœ“ JSONL Export Integration > Spec Export > should remove spec from JSONL after deletion  5141ms
   âœ“ JSONL Export Integration > Export Debouncing > should batch multiple operations within debounce window  2578ms
stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should inherit mode from parent execution (worktree mode)
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should inherit mode from parent execution (worktree mode)
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should inherit mode from parent execution (worktree mode)
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should inherit mode from parent execution (worktree mode)
Recreating worktree for follow-up execution: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-service-tmB0oB/.worktrees/b331a5c1-ceac-4ceb-8a1d-f334bb623405

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should inherit mode from parent execution (worktree mode)
[ExecutionService] Follow-up task metadata: {
  executionId: [32m'31ba66ce-7c65-41e0-999c-3dd60d47aa0b'[39m,
  parentExecutionId: [32m'b331a5c1-ceac-4ceb-8a1d-f334bb623405'[39m,
  inheritedConfigKeys: [ [32m'mode'[39m ],
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  model: [90mundefined[39m
}

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should inherit mode from parent execution (local mode)
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should inherit mode from parent execution (local mode)
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getFileDiff > should handle files with leading ./ in path
[ExecutionChangesService] Getting diff for ./withslash.ts: {
  beforeCommit: [32m'56c57e940c690972dbfa30f2a094d64e224711b1'[39m,
  afterCommit: [32m'21acac3cd6439d4df4fb09ae849a9c440475b6ae'[39m,
  worktreePath: [1mnull[22m,
  normalizedPath: [32m'withslash.ts'[39m
}
[ExecutionChangesService] Running: git show 56c57e940c690972dbfa30f2a094d64e224711b1:withslash.ts
[ExecutionChangesService] Old content length: 16
[ExecutionChangesService] Fetching new content from after_commit: 21acac3cd6439d4df4fb09ae849a9c440475b6ae
[ExecutionChangesService] Running: git show 21acac3cd6439d4df4fb09ae849a9c440475b6ae:withslash.ts
[ExecutionChangesService] New content length: 16
[ExecutionChangesService] Returning diff - oldContent: 16 chars, newContent: 16 chars

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should inherit mode from parent execution (local mode)
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Escalation Flow > should respond to escalation
[WorktreeManager] Setting up isolated worktree environment {
  repoPath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF'[39m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-671387ad'[39m
}
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-671387ad/.sudocode'[39m
}
[WorktreeManager] Created .sudocode directory in worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-671387ad/.sudocode
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-671387ad/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/issues.jsonl
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-671387ad/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/specs.jsonl
[WorktreeManager] No config.json to copy from main repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Escalation Flow > should respond to escalation
[WorktreeManager] Successfully initialized local database in worktree at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-671387ad/.sudocode/cache.db
[WorktreeManager] Database file created {
  path: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-671387ad/.sudocode/cache.db'[39m,
  size: [33m4096[39m
}
[WorktreeManager] Worktree environment setup complete

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Escalation Flow > should respond to escalation
[ExecutionLifecycle] Created workflow worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-671387ad (branch: sudocode/workflow/671387ad/workflow-for-2-issues)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Escalation Flow > should respond to escalation
[BaseWorkflowEngine] Created workflow worktree for wf-671387ad: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-671387ad (branch: sudocode/workflow/671387ad/workflow-for-2-issues)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should inherit mode from parent execution (local mode)
[ExecutionService] Follow-up task metadata: {
  executionId: [32m'1ed4bb63-4590-41aa-9227-a568c0b1c436'[39m,
  parentExecutionId: [32m'f5e18bc9-212e-4a00-bd96-04c2f49c356f'[39m,
  inheritedConfigKeys: [ [32m'mode'[39m ],
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  model: [90mundefined[39m
}

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Escalation Flow > should respond to escalation
[workflows] getEngineForWorkflow: workflow=wf-671387ad, engineType=sequential
[workflows/:id/escalate] Escalation created for workflow wf-671387ad: 07030f7a-a29d-4900-abb4-288dbf6df80a

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Escalation Flow > should respond to escalation
[workflows] getEngineForWorkflow: workflow=wf-671387ad, engineType=sequential

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should default to worktree mode when parent has worktree_path but no mode
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should default to worktree mode when parent has worktree_path but no mode
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should default to worktree mode when parent has worktree_path but no mode
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should default to worktree mode when parent has worktree_path but no mode
Recreating worktree for follow-up execution: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-service-tmB0oB/.worktrees/1a0208dc-f994-4a3d-b5cf-d3a2bb296e97

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should default to worktree mode when parent has worktree_path but no mode
[ExecutionService] Follow-up task metadata: {
  executionId: [32m'8b34b083-66d4-4c7d-bacf-59c950c019fa'[39m,
  parentExecutionId: [32m'1a0208dc-f994-4a3d-b5cf-d3a2bb296e97'[39m,
  inheritedConfigKeys: [ [32m'mode'[39m ],
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  model: [90mundefined[39m
}

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Notifications > should send notification
[workflows] getEngineForWorkflow: workflow=wf-9877ec25, engineType=sequential

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should default to local mode when parent has no worktree_path and no mode
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should default to local mode when parent has no worktree_path and no mode
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should default to local mode when parent has no worktree_path and no mode
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getFileDiff > should get content from worktree for uncommitted changes
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should default to local mode when parent has no worktree_path and no mode
[ExecutionService] Follow-up task metadata: {
  executionId: [32m'965307c9-5e73-475a-b77b-4bb95e6d9201'[39m,
  parentExecutionId: [32m'8569415d-337a-40ba-927f-d59d4b3113e8'[39m,
  inheritedConfigKeys: [ [32m'mode'[39m ],
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  model: [90mundefined[39m
}

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should inherit all config from parent execution including dangerouslySkipPermissions and mcpServers
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should inherit all config from parent execution including dangerouslySkipPermissions and mcpServers
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getFileDiff > should get content from worktree for uncommitted changes
[ExecutionChangesService] Getting diff for uncommitted.ts: {
  beforeCommit: [32m'c5b1f359e50816f7df080ff73c30c69d9ab00b7b'[39m,
  afterCommit: [1mnull[22m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/test-worktree'[39m,
  normalizedPath: [32m'uncommitted.ts'[39m
}
[ExecutionChangesService] Running: git show c5b1f359e50816f7df080ff73c30c69d9ab00b7b:uncommitted.ts
[ExecutionChangesService] Failed to get old content: Command failed: git show c5b1f359e50816f7df080ff73c30c69d9ab00b7b:uncommitted.ts
fatal: path 'uncommitted.ts' does not exist in 'c5b1f359e50816f7df080ff73c30c69d9ab00b7b'

[ExecutionChangesService] Fetching new content from worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/test-worktree

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getFileDiff > should get content from worktree for uncommitted changes
[ExecutionChangesService] Checking file: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/test-worktree/uncommitted.ts
[ExecutionChangesService] New content length: 25
[ExecutionChangesService] Returning diff - oldContent: 0 chars, newContent: 25 chars

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should inherit all config from parent execution including dangerouslySkipPermissions and mcpServers
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mtrue[39m,
  mcpServerNames: [ [32m'custom-workflow-mcp'[39m ],
  hasAppendSystemPrompt: [33mtrue[39m,
  dangerouslySkipPermissions: [33mtrue[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mtrue[39m,
  mcpServerNames: [ [32m'custom-workflow-mcp'[39m ],
  hasAppendSystemPrompt: [33mtrue[39m,
  dangerouslySkipPermissions: [33mtrue[39m,
  allKeys: [
    [32m'model'[39m,
    [32m'dangerouslySkipPermissions'[39m,
    [32m'mcpServers'[39m,
    [32m'appendSystemPrompt'[39m
  ]
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mtrue[39m, mcpServerNames: [ [32m'custom-workflow-mcp'[39m ] }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should inherit all config from parent execution including dangerouslySkipPermissions and mcpServers
Recreating worktree for follow-up execution: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-service-tmB0oB/.worktrees/c97c2cfc-03db-4629-8065-d86894071129

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > createFollowUp > should inherit all config from parent execution including dangerouslySkipPermissions and mcpServers
[ExecutionService] Follow-up task metadata: {
  executionId: [32m'991bc115-d457-4f34-95d1-2d8c152ee94e'[39m,
  parentExecutionId: [32m'c97c2cfc-03db-4629-8065-d86894071129'[39m,
  inheritedConfigKeys: [
    [32m'mode'[39m,
    [32m'model'[39m,
    [32m'dangerouslySkipPermissions'[39m,
    [32m'mcpServers'[39m,
    [32m'appendSystemPrompt'[39m
  ],
  hasMcpServers: [33mtrue[39m,
  mcpServerNames: [ [32m'custom-workflow-mcp'[39m ],
  dangerouslySkipPermissions: [33mtrue[39m,
  hasAppendSystemPrompt: [33mtrue[39m,
  model: [32m'claude-sonnet-4'[39m
}

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Notifications > should send notification
[WorktreeManager] Setting up isolated worktree environment {
  repoPath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF'[39m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-9877ec25'[39m
}
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-9877ec25/.sudocode'[39m
}
[WorktreeManager] Created .sudocode directory in worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-9877ec25/.sudocode
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-9877ec25/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/issues.jsonl
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-9877ec25/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/specs.jsonl
[WorktreeManager] No config.json to copy from main repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Notifications > should send notification
[WorktreeManager] Successfully initialized local database in worktree at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-9877ec25/.sudocode/cache.db
[WorktreeManager] Database file created {
  path: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-9877ec25/.sudocode/cache.db'[39m,
  size: [33m4096[39m
}
[WorktreeManager] Worktree environment setup complete

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Notifications > should send notification
[ExecutionLifecycle] Created workflow worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-9877ec25 (branch: sudocode/workflow/9877ec25/workflow-for-2-issues)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Notifications > should send notification
[BaseWorkflowEngine] Created workflow worktree for wf-9877ec25: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-9877ec25 (branch: sudocode/workflow/9877ec25/workflow-for-2-issues)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > worktree system prompt context > should add worktree context to appendSystemPrompt for worktree executions
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > worktree system prompt context > should add worktree context to appendSystemPrompt for worktree executions
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Notifications > should send notification
[workflows/:id/notify] [INFO] Workflow wf-9877ec25: Progress update: 50% complete

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > worktree system prompt context > should add worktree context to appendSystemPrompt for worktree executions
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > worktree system prompt context > should merge worktree context with existing appendSystemPrompt
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > worktree system prompt context > should merge worktree context with existing appendSystemPrompt
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Notifications > should support different notification levels
[workflows] getEngineForWorkflow: workflow=wf-2db9b49e, engineType=sequential

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > worktree system prompt context > should merge worktree context with existing appendSystemPrompt
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mtrue[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mtrue[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: [ [32m'appendSystemPrompt'[39m ]
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getFileDiff > should return error for non-existent execution
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > worktree system prompt context > should not add worktree context for local mode executions
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > worktree system prompt context > should not add worktree context for local mode executions
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > worktree system prompt context > should not add worktree context for local mode executions
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > worktree system prompt context > should add worktree context for follow-up executions in worktree mode
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > worktree system prompt context > should add worktree context for follow-up executions in worktree mode
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Notifications > should support different notification levels
[WorktreeManager] Setting up isolated worktree environment {
  repoPath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF'[39m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-2db9b49e'[39m
}
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-2db9b49e/.sudocode'[39m
}
[WorktreeManager] Created .sudocode directory in worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-2db9b49e/.sudocode
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-2db9b49e/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/issues.jsonl
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-2db9b49e/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/specs.jsonl
[WorktreeManager] No config.json to copy from main repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Notifications > should support different notification levels
[WorktreeManager] Successfully initialized local database in worktree at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-2db9b49e/.sudocode/cache.db
[WorktreeManager] Database file created {
  path: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-2db9b49e/.sudocode/cache.db'[39m,
  size: [33m4096[39m
}
[WorktreeManager] Worktree environment setup complete

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Notifications > should support different notification levels
[ExecutionLifecycle] Created workflow worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-2db9b49e (branch: sudocode/workflow/2db9b49e/workflow-for-2-issues)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Notifications > should support different notification levels
[BaseWorkflowEngine] Created workflow worktree for wf-2db9b49e: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-2db9b49e (branch: sudocode/workflow/2db9b49e/workflow-for-2-issues)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Notifications > should support different notification levels
[workflows/:id/notify] [WARNING] Workflow wf-2db9b49e: Warning message

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Notifications > should support different notification levels
[workflows/:id/notify] [ERROR] Workflow wf-2db9b49e: Error message

 âœ“ |@sudocode-ai/local-server| tests/unit/execution/worktree/git-sync-cli.test.ts (28 tests) 26544ms
   âœ“ GitSyncCli > getMergeBase > should find merge base between two branches  1106ms
   âœ“ GitSyncCli > getMergeBase > should throw error for invalid branch  508ms
   âœ“ GitSyncCli > getDiff > should get diff between two commits  3755ms
   âœ“ GitSyncCli > getDiff > should detect additions and deletions  663ms
   âœ“ GitSyncCli > getDiff > should return empty diff for same commit  525ms
   âœ“ GitSyncCli > checkMergeConflicts > should detect no conflicts for clean merge  1014ms
   âœ“ GitSyncCli > checkMergeConflicts > should detect conflicts when same file is modified differently  653ms
   âœ“ GitSyncCli > squashMerge > should perform squash merge  4439ms
   âœ“ GitSyncCli > getCommitList > should get list of commits between refs  1633ms
   âœ“ GitSyncCli > getCommitList > should return empty list for same ref  803ms
   âœ“ GitSyncCli > getCommitList > should handle commit messages with pipe characters  817ms
   âœ“ GitSyncCli > isWorkingTreeClean > should return true for clean working tree  402ms
   âœ“ GitSyncCli > isWorkingTreeClean > should return true for untracked files (ignored)  695ms
   âœ“ GitSyncCli > isWorkingTreeClean > should return false for modified tracked files  768ms
   âœ“ GitSyncCli > isWorkingTreeClean > should return false for staged changes  749ms
   âœ“ GitSyncCli > createSafetyTag > should create annotated tag  670ms
   âœ“ GitSyncCli > createSafetyTag > should create tag for branch reference  511ms
   âœ“ GitSyncCli > getUncommittedFiles > should return empty array for clean tree  348ms
   âœ“ GitSyncCli > getUncommittedFiles > should detect uncommitted files  346ms
   âœ“ GitSyncCli > getUncommittedFiles > should detect modified files  418ms
   âœ“ GitSyncCli > getUncommittedFiles > should detect staged files  369ms
   âœ“ GitSyncCli > cherryPickRange > should successfully cherry-pick range without conflicts  975ms
   âœ“ GitSyncCli > cherryPickRange > should detect conflicts during cherry-pick  915ms
   âœ“ GitSyncCli > error handling > should include git error message in WorktreeError  417ms
   âœ“ GitSyncCli > security > should properly escape shell arguments  814ms
   âœ“ GitSyncCli > security > should validate SHA format  569ms
stdout | tests/unit/services/execution-service.test.ts > ExecutionService > worktree system prompt context > should add worktree context for follow-up executions in worktree mode
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > worktree system prompt context > should add worktree context for follow-up executions in worktree mode
Recreating worktree for follow-up execution: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-service-tmB0oB/.worktrees/24be290f-ba9a-4c05-a27c-1533ae7ea66d

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > worktree system prompt context > should add worktree context for follow-up executions in worktree mode
[ExecutionService] Follow-up task metadata: {
  executionId: [32m'384086ab-1142-40c5-a8b0-080f85d99861'[39m,
  parentExecutionId: [32m'24be290f-ba9a-4c05-a27c-1533ae7ea66d'[39m,
  inheritedConfigKeys: [ [32m'mode'[39m ],
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  model: [90mundefined[39m
}

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getFileDiff > should return error for missing before_commit
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > worktree system prompt context > should include branch name in worktree context
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > worktree system prompt context > should include branch name in worktree context
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Complete Workflow > should complete running workflow
[workflows] getEngineForWorkflow: workflow=wf-92c2daaf, engineType=sequential

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > worktree system prompt context > should include branch name in worktree context
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > worktree system prompt context > should include main repository path in worktree context
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > worktree system prompt context > should include main repository path in worktree context
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getFileDiff > should handle multiline content correctly
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > worktree system prompt context > should include main repository path in worktree context
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Complete Workflow > should complete running workflow
[WorktreeManager] Setting up isolated worktree environment {
  repoPath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF'[39m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-92c2daaf'[39m
}
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-92c2daaf/.sudocode'[39m
}
[WorktreeManager] Created .sudocode directory in worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-92c2daaf/.sudocode
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-92c2daaf/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/issues.jsonl
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-92c2daaf/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/specs.jsonl
[WorktreeManager] No config.json to copy from main repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Complete Workflow > should complete running workflow
[WorktreeManager] Successfully initialized local database in worktree at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-92c2daaf/.sudocode/cache.db
[WorktreeManager] Database file created {
  path: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-92c2daaf/.sudocode/cache.db'[39m,
  size: [33m4096[39m
}
[WorktreeManager] Worktree environment setup complete

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Complete Workflow > should complete running workflow
[ExecutionLifecycle] Created workflow worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-92c2daaf (branch: sudocode/workflow/92c2daaf/workflow-for-2-issues)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Complete Workflow > should complete running workflow
[BaseWorkflowEngine] Created workflow worktree for wf-92c2daaf: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-92c2daaf (branch: sudocode/workflow/92c2daaf/workflow-for-2-issues)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Complete Workflow > should complete running workflow
[workflows] getEngineForWorkflow: workflow=wf-92c2daaf, engineType=sequential

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Complete Workflow > should complete running workflow
[workflows] getEngineForWorkflow: workflow=wf-92c2daaf, engineType=sequential

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Complete Workflow > should mark workflow as failed
[workflows] getEngineForWorkflow: workflow=wf-0dedeb95, engineType=sequential

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > cancelExecution > should cancel running execution
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > cancelExecution > should cancel running execution
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > cancelExecution > should cancel running execution
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > cancelExecution > should throw error for non-running execution
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > cancelExecution > should throw error for non-running execution
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getFileDiff > should handle multiline content correctly
[ExecutionChangesService] Getting diff for multiline.ts: {
  beforeCommit: [32m'cfdd64b1ea3ce7004139594bdfc2da29b7c87818'[39m,
  afterCommit: [32m'1a72447ab225cf526b1061642287b4fda97f410c'[39m,
  worktreePath: [1mnull[22m,
  normalizedPath: [32m'multiline.ts'[39m
}
[ExecutionChangesService] Running: git show cfdd64b1ea3ce7004139594bdfc2da29b7c87818:multiline.ts
[ExecutionChangesService] Old content length: 21
[ExecutionChangesService] Fetching new content from after_commit: 1a72447ab225cf526b1061642287b4fda97f410c
[ExecutionChangesService] Running: git show 1a72447ab225cf526b1061642287b4fda97f410c:multiline.ts
[ExecutionChangesService] New content length: 36
[ExecutionChangesService] Returning diff - oldContent: 21 chars, newContent: 36 chars

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > cancelExecution > should throw error for non-running execution
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > cleanupExecution > should cleanup execution resources
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > cleanupExecution > should cleanup execution resources
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Complete Workflow > should mark workflow as failed
[WorktreeManager] Setting up isolated worktree environment {
  repoPath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF'[39m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-0dedeb95'[39m
}
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-0dedeb95/.sudocode'[39m
}
[WorktreeManager] Created .sudocode directory in worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-0dedeb95/.sudocode
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-0dedeb95/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/issues.jsonl
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-0dedeb95/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/specs.jsonl
[WorktreeManager] No config.json to copy from main repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Complete Workflow > should mark workflow as failed
[WorktreeManager] Successfully initialized local database in worktree at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-0dedeb95/.sudocode/cache.db
[WorktreeManager] Database file created {
  path: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-0dedeb95/.sudocode/cache.db'[39m,
  size: [33m4096[39m
}
[WorktreeManager] Worktree environment setup complete

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Complete Workflow > should mark workflow as failed
[ExecutionLifecycle] Created workflow worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-0dedeb95 (branch: sudocode/workflow/0dedeb95/workflow-for-2-issues)

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Complete Workflow > should mark workflow as failed
[BaseWorkflowEngine] Created workflow worktree for wf-0dedeb95: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-api-G338eF/.sudocode/worktrees/workflow-wf-0dedeb95 (branch: sudocode/workflow/0dedeb95/workflow-for-2-issues)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > cleanupExecution > should cleanup execution resources
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > cleanupExecution > should cleanup execution resources
Successfully cleaned up worktree for execution 21a681b9-ee09-4e17-8314-b901d81bed4c

stdout | tests/integration/workflow/workflow-api.test.ts > Workflow REST API > Complete Workflow > should mark workflow as failed
[workflows] getEngineForWorkflow: workflow=wf-0dedeb95, engineType=sequential

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > deleteExecution > should delete a single execution
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > deleteExecution > should delete a single execution
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getFileDiff > should work for follow-up executions using root execution's before_commit
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/round-trip-server.test.ts > Server Round-Trip Integration Tests
Shutting down ProjectManager...
Closing project: test-project-7eefe4cc
Shutting down project context: test-project-7eefe4cc

stdout | tests/integration/round-trip-server.test.ts > Server Round-Trip Integration Tests
[integration-sync] Stopping for project test-project-7eefe4cc
[integration-sync] Service stopped for test-project-7eefe4cc

stdout | tests/integration/round-trip-server.test.ts > Server Round-Trip Integration Tests
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-7eefe4cc

stdout | tests/integration/round-trip-server.test.ts > Server Round-Trip Integration Tests
Project closed: test-project-7eefe4cc

stdout | tests/integration/round-trip-server.test.ts > Server Round-Trip Integration Tests
ProjectManager shutdown complete

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > deleteExecution > should delete a single execution
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > deleteExecution > should delete entire execution chain
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > deleteExecution > should delete entire execution chain
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > deleteExecution > should delete entire execution chain
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > deleteExecution > should delete entire execution chain
Recreating worktree for follow-up execution: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-service-tmB0oB/.worktrees/0afc2f60-ef9e-45e4-a80b-6e48feb615d9

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > deleteExecution > should delete entire execution chain
[ExecutionService] Follow-up task metadata: {
  executionId: [32m'72677427-068d-4189-98ff-6db5770ed613'[39m,
  parentExecutionId: [32m'0afc2f60-ef9e-45e4-a80b-6e48feb615d9'[39m,
  inheritedConfigKeys: [ [32m'mode'[39m ],
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  model: [90mundefined[39m
}

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > deleteExecution > should delete entire execution chain
Recreating worktree for follow-up execution: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-service-tmB0oB/.worktrees/0afc2f60-ef9e-45e4-a80b-6e48feb615d9

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > deleteExecution > should delete entire execution chain
[ExecutionService] Follow-up task metadata: {
  executionId: [32m'18d90290-a252-4dad-817c-bb6a42602060'[39m,
  parentExecutionId: [32m'72677427-068d-4189-98ff-6db5770ed613'[39m,
  inheritedConfigKeys: [ [32m'mode'[39m ],
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  model: [90mundefined[39m
}

stdout | tests/unit/services/execution-changes-service.test.ts > ExecutionChangesService > getFileDiff > should work for follow-up executions using root execution's before_commit
[ExecutionChangesService] Getting diff for root.ts: {
  beforeCommit: [32m'63a7db21fc8bc0f43250aedef259bb0f8a367f82'[39m,
  afterCommit: [32m'4c9cd8222ddf5464ecbaca5118f69c1472a91e1a'[39m,
  worktreePath: [1mnull[22m,
  normalizedPath: [32m'root.ts'[39m
}
[ExecutionChangesService] Running: git show 63a7db21fc8bc0f43250aedef259bb0f8a367f82:root.ts
[ExecutionChangesService] Failed to get old content: Command failed: git show 63a7db21fc8bc0f43250aedef259bb0f8a367f82:root.ts
fatal: path 'root.ts' exists on disk, but not in '63a7db21fc8bc0f43250aedef259bb0f8a367f82'

[ExecutionChangesService] Fetching new content from after_commit: 4c9cd8222ddf5464ecbaca5118f69c1472a91e1a
[ExecutionChangesService] Running: git show 4c9cd8222ddf5464ecbaca5118f69c1472a91e1a:root.ts
[ExecutionChangesService] New content length: 15
[ExecutionChangesService] Returning diff - oldContent: 0 chars, newContent: 15 chars

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > deleteExecution > should cancel running executions before deletion
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > deleteExecution > should cancel running executions before deletion
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > deleteExecution > should cancel running executions before deletion
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > deleteExecution > should delete branch when deleteBranch is true and branch was created by execution
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > deleteExecution > should delete branch when deleteBranch is true and branch was created by execution
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > deleteExecution > should delete branch when deleteBranch is true and branch was created by execution
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > deleteExecution > should delete branch when deleteBranch is true and branch was created by execution
[ExecutionService] Deleted execution-created branch: worktree/a267adea/implement-user-authentication

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > deleteExecution > should not fail when deleteBranch is true but branch was not created by execution
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > deleteExecution > should not fail when deleteBranch is true but branch was not created by execution
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > deleteExecution > should not fail when deleteBranch is true but branch was not created by execution
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > deleteExecution > should not fail when deleteBranch is true but branch was not created by execution
[ExecutionService] Skipping branch deletion - branch main is the target branch (not created by execution)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > deleteExecution > should not delete branch when deleteBranch is false
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > deleteExecution > should not delete branch when deleteBranch is false
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > deleteExecution > should not delete branch when deleteBranch is false
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > deleteExecution > should not delete detached HEAD branches
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > deleteExecution > should not delete detached HEAD branches
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

 âœ“ |@sudocode-ai/local-server| tests/integration/round-trip-server.test.ts (18 tests) 70314ms
   âœ“ Server Round-Trip Integration Tests > API â†’ Export â†’ JSONL Consistency > should create spec via API and export to JSONL correctly  2556ms
   âœ“ Server Round-Trip Integration Tests > API â†’ Export â†’ JSONL Consistency > should create issue via API and export to JSONL correctly  2535ms
   âœ“ Server Round-Trip Integration Tests > API â†’ Export â†’ JSONL Consistency > should update spec via API and export updates to JSONL  5102ms
   âœ“ Server Round-Trip Integration Tests > Relationship Preservation Through Server Flow > should preserve implements relationship when spec is updated via API  5064ms
   âœ“ Server Round-Trip Integration Tests > Relationship Preservation Through Server Flow > should preserve multiple relationships when issue is updated via API  5176ms
   âœ“ Server Round-Trip Integration Tests > Relationship Preservation Through Server Flow > should preserve bidirectional issue relationships (blocks/depends-on)  5624ms
   âœ“ Server Round-Trip Integration Tests > Full Watcher Simulation Cycle > should handle spec update â†’ export â†’ watcher import â†’ export cycle  7632ms
   âœ“ Server Round-Trip Integration Tests > Full Watcher Simulation Cycle > should handle concurrent spec and issue updates without losing relationships  5093ms
   âœ“ Server Round-Trip Integration Tests > Edge Cases > should handle spec without relationships correctly  6100ms
   âœ“ Server Round-Trip Integration Tests > Edge Cases > should preserve archived status through round trip  5210ms
   âœ“ Server Round-Trip Integration Tests > Markdown â†’ Server â†’ JSONL Flow > should sync markdown spec updates to DB and export to JSONL  3152ms
   âœ“ Server Round-Trip Integration Tests > Markdown â†’ Server â†’ JSONL Flow > should preserve relationships when spec is updated via markdown  2683ms
   âœ“ Server Round-Trip Integration Tests > Markdown â†’ Server â†’ JSONL Flow > should preserve relationships when issue is updated via markdown  2632ms
   âœ“ Server Round-Trip Integration Tests > Markdown â†’ Server â†’ JSONL Flow > should handle markdown with cross-references that create relationships  2541ms
   âœ“ Server Round-Trip Integration Tests > Markdown â†’ Server â†’ JSONL Flow > should handle concurrent markdown and API updates correctly  7621ms
stdout | tests/unit/services/execution-service.test.ts > ExecutionService > deleteExecution > should not delete detached HEAD branches
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > deleteExecution > should not delete detached HEAD branches
[ExecutionService] Deleted execution-created branch: worktree/b5584662/implement-user-authentication

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > WebSocket broadcasting > should broadcast execution_created when creating execution with issue
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > WebSocket broadcasting > should broadcast execution_created when creating execution with issue
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

 âœ“ |@sudocode-ai/local-server| tests/integration/workflow/workflow-api.test.ts (34 tests | 4 skipped) 17146ms
   âœ“ Workflow REST API > CRUD Operations > POST /api/workflows - Create > should create workflow from issue IDs  609ms
   âœ“ Workflow REST API > CRUD Operations > GET /api/workflows - List > should filter by status  352ms
   âœ“ Workflow REST API > CRUD Operations > GET /api/workflows - List > should support pagination  344ms
   âœ“ Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/start > should start pending workflow  808ms
   âœ“ Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/start > should fail to start already running workflow  982ms
   âœ“ Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/pause > should pause running workflow  1138ms
   âœ“ Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/resume > should resume paused workflow  854ms
   âœ“ Workflow REST API > Lifecycle Operations > POST /api/workflows/:id/cancel > should cancel running workflow  577ms
   âœ“ Workflow REST API > Step Operations > should skip step with reason  449ms
   âœ“ Workflow REST API > Events > should record and retrieve workflow events  702ms
   âœ“ Workflow REST API > Extended Status > should return extended workflow status  397ms
   âœ“ Workflow REST API > Extended Status > should include active executions  500ms
   âœ“ Workflow REST API > Escalation Flow > should create escalation  476ms
   âœ“ Workflow REST API > Escalation Flow > should auto-approve in full_auto mode  703ms
   âœ“ Workflow REST API > Escalation Flow > should respond to escalation  840ms
   âœ“ Workflow REST API > Notifications > should send notification  1003ms
   âœ“ Workflow REST API > Notifications > should support different notification levels  751ms
   âœ“ Workflow REST API > Complete Workflow > should complete running workflow  706ms
   âœ“ Workflow REST API > Complete Workflow > should mark workflow as failed  880ms
stdout | tests/unit/services/execution-service.test.ts > ExecutionService > WebSocket broadcasting > should broadcast execution_created when creating execution with issue
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

 âœ“ |@sudocode-ai/local-server| tests/unit/services/execution-changes-service.test.ts (27 tests) 37233ms
   âœ“ ExecutionChangesService > getChanges - Scenario A: Committed Changes > should calculate committed changes between two commits  2333ms
   âœ“ ExecutionChangesService > getChanges - Scenario A: Committed Changes > should handle modified files  1142ms
   âœ“ ExecutionChangesService > getChanges - Scenario A: Committed Changes > should handle deleted files  1429ms
   âœ“ ExecutionChangesService > getChanges - Scenario A: Committed Changes > should handle binary files  1548ms
   âœ“ ExecutionChangesService > getChanges - Scenario B: Uncommitted Changes > should calculate uncommitted changes in working tree  702ms
   âœ“ ExecutionChangesService > getChanges - Scenario B: Uncommitted Changes > should handle after_commit == before_commit as uncommitted  1064ms
   âœ“ ExecutionChangesService > getChanges - Scenario C: No Changes > should return empty changes when no modifications  876ms
   âœ“ ExecutionChangesService > getChanges - Error Cases > should return unavailable for non-existent execution  2872ms
   âœ“ ExecutionChangesService > getChanges - Error Cases > should support running executions with valid commits  1177ms
   âœ“ ExecutionChangesService > getChanges - Error Cases > should return unavailable when before_commit is missing  423ms
   âœ“ ExecutionChangesService > getChanges - Error Cases > should return unavailable when commits not found (garbage collected)  566ms
   âœ“ ExecutionChangesService > getChanges - Error Cases > should return unavailable when worktree deleted with uncommitted changes  696ms
   âœ“ ExecutionChangesService > Summary Calculation > should correctly sum up statistics  1991ms
   âœ“ ExecutionChangesService > Deleted Resources > should handle deleted branch gracefully  5148ms
   âœ“ ExecutionChangesService > Deleted Resources > should track worktree existence  1327ms
   âœ“ ExecutionChangesService > Deleted Resources > should calculate current state from main repo when worktree is deleted  2871ms
   âœ“ ExecutionChangesService > Deleted Resources > should show only captured state when both branch and worktree are deleted  1101ms
   âœ“ ExecutionChangesService > Deleted Resources > should use main repo path for branch operations even with deleted worktree  1116ms
   âœ“ ExecutionChangesService > getFileDiff > should return old and new content for a modified file  909ms
   âœ“ ExecutionChangesService > getFileDiff > should return empty old content for a new file  713ms
   âœ“ ExecutionChangesService > getFileDiff > should return empty new content for a deleted file  680ms
   âœ“ ExecutionChangesService > getFileDiff > should handle files with leading ./ in path  1394ms
   âœ“ ExecutionChangesService > getFileDiff > should get content from worktree for uncommitted changes  1027ms
   âœ“ ExecutionChangesService > getFileDiff > should return error for non-existent execution  497ms
   âœ“ ExecutionChangesService > getFileDiff > should return error for missing before_commit  474ms
   âœ“ ExecutionChangesService > getFileDiff > should handle multiline content correctly  861ms
   âœ“ ExecutionChangesService > getFileDiff > should work for follow-up executions using root execution's before_commit  1163ms
stdout | tests/unit/services/execution-service.test.ts > ExecutionService > WebSocket broadcasting > should broadcast execution_status_changed on workflow completion
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > WebSocket broadcasting > should broadcast execution_status_changed on workflow completion
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > WebSocket broadcasting > should broadcast execution_status_changed on workflow completion
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > WebSocket broadcasting > should broadcast execution_status_changed when canceling execution
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > WebSocket broadcasting > should broadcast execution_status_changed when canceling execution
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > WebSocket broadcasting > should broadcast execution_status_changed when canceling execution
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > WebSocket broadcasting > should broadcast with issue_id for issue-linked executions
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > WebSocket broadcasting > should broadcast with issue_id for issue-linked executions
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - JSONL changes > should call onEntitySync when JSONL changes (import needed)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - JSONL changes > should call onEntitySync when JSONL changes (import needed)
[watch] Watching directories: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-callback-test-53dgNm/specs, /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-callback-test-53dgNm/issues and JSONL files

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - JSONL changes > should call onEntitySync when JSONL changes (import needed)
[watch] Watching 4 files in /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-callback-test-53dgNm
[watch] Initialized cache for specs.jsonl (0 entities)
[watch] Initialized cache for issues.jsonl (1 entities)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > WebSocket broadcasting > should broadcast with issue_id for issue-linked executions
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > WebSocket broadcasting > should broadcast execution_created when creating follow-up execution
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > WebSocket broadcasting > should broadcast execution_created when creating follow-up execution
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > WebSocket broadcasting > should broadcast execution_created when creating follow-up execution
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > WebSocket broadcasting > should broadcast execution_created when creating follow-up execution
Recreating worktree for follow-up execution: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-service-tmB0oB/.worktrees/916bb8a6-6a00-46cb-8cbe-6e7e220a906f

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > WebSocket broadcasting > should broadcast execution_created when creating follow-up execution
[ExecutionService] Follow-up task metadata: {
  executionId: [32m'3144e895-9c82-408e-8e54-8f4f224c5952'[39m,
  parentExecutionId: [32m'916bb8a6-6a00-46cb-8cbe-6e7e220a906f'[39m,
  inheritedConfigKeys: [ [32m'mode'[39m ],
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  model: [90mundefined[39m
}

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > WebSocket broadcasting > should broadcast execution_deleted when deleting execution
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > WebSocket broadcasting > should broadcast execution_deleted when deleting execution
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - JSONL changes > should call onEntitySync when JSONL changes (import needed)
[watch] change issues.jsonl
[watch] Detected 1 changed issue(s) in JSONL

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > WebSocket broadcasting > should broadcast execution_deleted when deleting execution
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - JSONL changes > should call onEntitySync when JSONL changes (import needed)
[watch] Imported JSONL changes to database
[watch] Synced issue i-test1 (updated)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > WebSocket broadcasting > should include projectId in all broadcasts
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > WebSocket broadcasting > should include projectId in all broadcasts
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - JSONL changes > should call onEntitySync when JSONL changes (import needed)
[watch] Stopping watcher...

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - JSONL changes > should call onEntitySync when JSONL changes (import needed)
[watch] Watcher stopped

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - JSONL changes > should emit events for multiple entities changed in JSONL
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - JSONL changes > should emit events for multiple entities changed in JSONL
[watch] Watching directories: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-callback-test-XXMTMq/specs, /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-callback-test-XXMTMq/issues and JSONL files

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - JSONL changes > should emit events for multiple entities changed in JSONL
[watch] Watching 4 files in /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-callback-test-XXMTMq
[watch] Initialized cache for specs.jsonl (0 entities)
[watch] Initialized cache for issues.jsonl (2 entities)

stdout | tests/unit/services/execution-service.test.ts > ExecutionService > WebSocket broadcasting > should include projectId in all broadcasts
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - JSONL changes > should emit events for multiple entities changed in JSONL
[watch] change issues.jsonl
[watch] Detected 2 changed issue(s) in JSONL

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - JSONL changes > should emit events for multiple entities changed in JSONL
[watch] Imported JSONL changes to database
[watch] Synced issue i-multi1 (updated)

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - JSONL changes > should emit events for multiple entities changed in JSONL
[watch] Synced issue i-multi2 (updated)

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - JSONL changes > should emit events for multiple entities changed in JSONL
[watch] Stopping watcher...

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - JSONL changes > should emit events for multiple entities changed in JSONL
[watch] Watcher stopped

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - JSONL changes > should detect content changes even without timestamp update
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - JSONL changes > should detect content changes even without timestamp update
[watch] Watching directories: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-callback-test-zHQlj7/specs, /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-callback-test-zHQlj7/issues and JSONL files

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - JSONL changes > should detect content changes even without timestamp update
[watch] Watching 4 files in /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-callback-test-zHQlj7
[watch] Initialized cache for specs.jsonl (0 entities)
[watch] Initialized cache for issues.jsonl (1 entities)

 âœ“ |@sudocode-ai/local-server| tests/unit/services/execution-service.test.ts (59 tests) 16438ms
   âœ“ ExecutionService > createExecution > should capture before_commit in local mode  604ms
   âœ“ ExecutionService > createExecution > should default to current branch when baseBranch not provided  579ms
   âœ“ ExecutionService > createFollowUp > should store user feedback as prompt in follow-up execution  382ms
   âœ“ ExecutionService > createFollowUp > should support follow-ups for local mode executions (no worktree)  488ms
   âœ“ ExecutionService > worktree system prompt context > should add worktree context to appendSystemPrompt for worktree executions  412ms
   âœ“ ExecutionService > worktree system prompt context > should add worktree context for follow-up executions in worktree mode  381ms
   âœ“ ExecutionService > cleanupExecution > should cleanup execution resources  534ms
   âœ“ ExecutionService > deleteExecution > should delete a single execution  314ms
   âœ“ ExecutionService > WebSocket broadcasting > should broadcast execution_created when creating execution with issue  305ms
   âœ“ ExecutionService > WebSocket broadcasting > should broadcast execution_status_changed on workflow completion  646ms
   âœ“ ExecutionService > WebSocket broadcasting > should broadcast execution_status_changed when canceling execution  693ms
   âœ“ ExecutionService > WebSocket broadcasting > should broadcast with issue_id for issue-linked executions  869ms
   âœ“ ExecutionService > WebSocket broadcasting > should broadcast execution_deleted when deleting execution  322ms
   âœ“ ExecutionService > WebSocket broadcasting > should include projectId in all broadcasts  324ms
stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - JSONL changes > should detect content changes even without timestamp update
[watch] change issues.jsonl
[watch] Detected 1 changed issue(s) in JSONL

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - JSONL changes > should detect content changes even without timestamp update
[watch] Imported JSONL changes to database
[watch] Synced issue i-content-test (updated)

stdout | tests/unit/watcher-frontmatter-writeback.test.ts > File Watcher - Orphaned Files and Frontmatter > should delete orphaned spec file without frontmatter (no DB entry)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - JSONL changes > should detect content changes even without timestamp update
[watch] Stopping watcher...

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - JSONL changes > should detect content changes even without timestamp update
[watch] Watcher stopped

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - Markdown changes > should call onEntitySync when markdown file changes (entity exists in DB)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - Markdown changes > should call onEntitySync when markdown file changes (entity exists in DB)
[watch] Watching directories: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-callback-test-c2JyZm/specs, /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-callback-test-c2JyZm/issues and JSONL files

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - Markdown changes > should call onEntitySync when markdown file changes (entity exists in DB)
[watch] Watching 4 files in /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-callback-test-c2JyZm
[watch] Initialized cache for specs.jsonl (0 entities)
[watch] Initialized cache for issues.jsonl (0 entities)

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - Markdown changes > should call onEntitySync when markdown file changes (entity exists in DB)
[watch] add specs/s-md1 - Test Spec.md

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - Markdown changes > should call onEntitySync when markdown file changes (entity exists in DB)
[watch] Synced spec s-md1 (updated)

stdout | tests/unit/watcher-frontmatter-writeback.test.ts > File Watcher - Orphaned Files and Frontmatter > should delete orphaned spec file with frontmatter but no DB entry
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - Markdown changes > should call onEntitySync when markdown file changes (entity exists in DB)
[watch] change specs.jsonl
[watch] Detected 1 changed spec(s) in JSONL

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - Markdown changes > should call onEntitySync when markdown file changes (entity exists in DB)
[watch] Imported JSONL changes to database
[watch] Synced spec s-md1 (created)

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - Markdown changes > should call onEntitySync when markdown file changes (entity exists in DB)
[watch] change issues.jsonl
[watch] No entity changes detected in issues.jsonl

 âœ“ |@sudocode-ai/local-server| tests/integration/services/worktree-sync-full.test.ts (10 tests) 45589ms
   âœ“ Full squash sync workflow - happy path > should complete full sync from preview to database update  3594ms
   âœ“ JSONL conflict resolution > should auto-resolve JSONL conflicts during squash  2649ms
   âœ“ Uncommitted JSONL handling > should include uncommitted JSONL changes in sync  3271ms
   âœ“ Code conflict handling > should detect code conflicts and warn about them  6176ms
   âœ“ Safety and rollback > should create safety tag before sync  2149ms
   âœ“ Validation failures > should fail if local working tree is dirty with non-JSONL files  4812ms
   âœ“ Validation failures > should allow sync when only JSONL files are uncommitted  2812ms
   âœ“ Validation failures > should fail if worktree missing  883ms
   âœ“ Multiple JSONL files > should handle multiple JSONL files in sync  3683ms
   âœ“ Large changesets > should handle syncing 50+ files  14366ms
stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - Markdown changes > should call onEntitySync when markdown file changes (entity exists in DB)
[watch] Stopping watcher...

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - Markdown changes > should call onEntitySync when markdown file changes (entity exists in DB)
[watch] Watcher stopped

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - Markdown changes > should include entity data in markdown sync events
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - Markdown changes > should include entity data in markdown sync events
[watch] Watching directories: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-callback-test-FUVvgN/specs, /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-callback-test-FUVvgN/issues and JSONL files

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - Markdown changes > should include entity data in markdown sync events
[watch] Watching 4 files in /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-callback-test-FUVvgN
[watch] Initialized cache for specs.jsonl (0 entities)
[watch] Initialized cache for issues.jsonl (0 entities)

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - Markdown changes > should include entity data in markdown sync events
[watch] add issues/i-md2 - Test Issue.md

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - Markdown changes > should include entity data in markdown sync events
[watch] Synced issue i-md2 (updated)

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - Markdown changes > should include entity data in markdown sync events
[watch] change specs.jsonl
[watch] No entity changes detected in specs.jsonl

stdout | tests/unit/watcher-frontmatter-writeback.test.ts > File Watcher - Orphaned Files and Frontmatter > should preserve valid spec file with matching DB entry
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - Markdown changes > should include entity data in markdown sync events
[watch] Stopping watcher...

stdout | tests/unit/watcher-callbacks.test.ts > Watcher Typed Callbacks > onEntitySync - Markdown changes > should include entity data in markdown sync events
[watch] Watcher stopped

 âœ“ |@sudocode-ai/cli| tests/unit/watcher-callbacks.test.ts (10 tests | 5 skipped) 5888ms
   âœ“ Watcher Typed Callbacks > onEntitySync - JSONL changes > should call onEntitySync when JSONL changes (import needed)  2044ms
   âœ“ Watcher Typed Callbacks > onEntitySync - JSONL changes > should emit events for multiple entities changed in JSONL  779ms
   âœ“ Watcher Typed Callbacks > onEntitySync - JSONL changes > should detect content changes even without timestamp update  1367ms
   âœ“ Watcher Typed Callbacks > onEntitySync - Markdown changes > should call onEntitySync when markdown file changes (entity exists in DB)  888ms
   âœ“ Watcher Typed Callbacks > onEntitySync - Markdown changes > should include entity data in markdown sync events  805ms
 âœ“ |@sudocode-ai/cli| tests/unit/watcher-frontmatter-writeback.test.ts (3 tests) 2627ms
   âœ“ File Watcher - Orphaned Files and Frontmatter > should delete orphaned spec file without frontmatter (no DB entry)  845ms
   âœ“ File Watcher - Orphaned Files and Frontmatter > should delete orphaned spec file with frontmatter but no DB entry  822ms
   âœ“ File Watcher - Orphaned Files and Frontmatter > should preserve valid spec file with matching DB entry  950ms
stdout | tests/unit/services/execution-logs-cleanup.test.ts > ExecutionLogsCleanup > Configuration > should accept custom configuration
[ExecutionLogsCleanup] Cleanup service disabled by configuration

stdout | tests/unit/services/execution-logs-cleanup.test.ts > ExecutionLogsCleanup > start() > should start the cleanup service
[ExecutionLogsCleanup] Starting cleanup service (retention: 30 days, interval: 3600000ms)
[ExecutionLogsCleanup] Running cleanup...
[ExecutionLogsCleanup] Cleanup complete: deleted 0 execution logs older than 30 days (2025-11-19T06:27:39.760Z) in 0ms

stdout | tests/unit/services/execution-logs-cleanup.test.ts > ExecutionLogsCleanup > start() > should start the cleanup service
[ExecutionLogsCleanup] Stopping cleanup service

stdout | tests/unit/services/execution-logs-cleanup.test.ts > ExecutionLogsCleanup > start() > should not start when disabled
[ExecutionLogsCleanup] Cleanup service disabled by configuration

stdout | tests/unit/services/execution-logs-cleanup.test.ts > ExecutionLogsCleanup > start() > should not start duplicate intervals
[ExecutionLogsCleanup] Starting cleanup service (retention: 30 days, interval: 3600000ms)
[ExecutionLogsCleanup] Running cleanup...
[ExecutionLogsCleanup] Cleanup complete: deleted 1 execution logs older than 30 days (2025-11-19T06:27:39.767Z) in 0ms

stdout | tests/unit/services/execution-logs-cleanup.test.ts > ExecutionLogsCleanup > start() > should not start duplicate intervals
[ExecutionLogsCleanup] Stopping cleanup service

stdout | tests/unit/services/execution-logs-cleanup.test.ts > ExecutionLogsCleanup > start() > should run cleanup immediately on start
[ExecutionLogsCleanup] Starting cleanup service (retention: 0 days, interval: 3600000ms)
[ExecutionLogsCleanup] Running cleanup...
[ExecutionLogsCleanup] Cleanup complete: deleted 4 execution logs older than 0 days (2025-12-19T06:27:38.774Z) in 0ms

stdout | tests/integration/workflow/mcp-protocol.test.ts > Workflow MCP Protocol
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-logs-cleanup.test.ts > ExecutionLogsCleanup > start() > should run cleanup immediately on start
[ExecutionLogsCleanup] Stopping cleanup service

stdout | tests/unit/services/execution-logs-cleanup.test.ts > ExecutionLogsCleanup > stop() > should stop the cleanup service
[ExecutionLogsCleanup] Starting cleanup service (retention: 30 days, interval: 3600000ms)
[ExecutionLogsCleanup] Running cleanup...
[ExecutionLogsCleanup] Cleanup complete: deleted 0 execution logs older than 30 days (2025-11-19T06:27:39.993Z) in 0ms
[ExecutionLogsCleanup] Stopping cleanup service

stdout | tests/unit/services/execution-logs-cleanup.test.ts > ExecutionLogsCleanup > stop() > should clear the interval
[ExecutionLogsCleanup] Starting cleanup service (retention: 30 days, interval: 100ms)

stdout | tests/unit/services/execution-logs-cleanup.test.ts > ExecutionLogsCleanup > stop() > should clear the interval
[ExecutionLogsCleanup] Stopping cleanup service

stdout | tests/unit/services/execution-logs-cleanup.test.ts > ExecutionLogsCleanup > runCleanup() > should delete logs older than retention period
[ExecutionLogsCleanup] Running cleanup...
[ExecutionLogsCleanup] Cleanup complete: deleted 2 execution logs older than 2 days (2025-12-17T06:27:40.568Z) in 0ms

stdout | tests/unit/services/execution-logs-cleanup.test.ts > ExecutionLogsCleanup > runCleanup() > should delete all logs when retention is 0
[ExecutionLogsCleanup] Running cleanup...
[ExecutionLogsCleanup] Cleanup complete: deleted 4 execution logs older than 0 days (2025-12-19T06:27:40.571Z) in 0ms

stdout | tests/unit/services/execution-logs-cleanup.test.ts > ExecutionLogsCleanup > runCleanup() > should keep all logs when retention is very long
[ExecutionLogsCleanup] Running cleanup...
[ExecutionLogsCleanup] Cleanup complete: deleted 0 execution logs older than 365 days (2024-12-19T06:27:40.573Z) in 1ms

stdout | tests/unit/services/execution-logs-cleanup.test.ts > ExecutionLogsCleanup > runCleanup() > should return timestamp in result
[ExecutionLogsCleanup] Running cleanup...
[ExecutionLogsCleanup] Cleanup complete: deleted 0 execution logs older than 30 days (2025-11-19T06:27:40.576Z) in 1ms

stdout | tests/unit/services/execution-logs-cleanup.test.ts > ExecutionLogsCleanup > runCleanup() > should handle errors gracefully
[ExecutionLogsCleanup] Running cleanup...

stdout | tests/unit/services/execution-logs-cleanup.test.ts > ExecutionLogsCleanup > isRunning() > should return true after start
[ExecutionLogsCleanup] Starting cleanup service (retention: 30 days, interval: 3600000ms)
[ExecutionLogsCleanup] Running cleanup...
[ExecutionLogsCleanup] Cleanup complete: deleted 1 execution logs older than 30 days (2025-11-19T06:27:40.580Z) in 0ms

stdout | tests/unit/services/execution-logs-cleanup.test.ts > ExecutionLogsCleanup > isRunning() > should return true after start
[ExecutionLogsCleanup] Stopping cleanup service

stdout | tests/unit/services/execution-logs-cleanup.test.ts > ExecutionLogsCleanup > isRunning() > should return false after stop
[ExecutionLogsCleanup] Starting cleanup service (retention: 30 days, interval: 3600000ms)
[ExecutionLogsCleanup] Running cleanup...
[ExecutionLogsCleanup] Cleanup complete: deleted 0 execution logs older than 30 days (2025-11-19T06:27:40.581Z) in 0ms
[ExecutionLogsCleanup] Stopping cleanup service

stdout | tests/unit/services/execution-logs-cleanup.test.ts > ExecutionLogsCleanup > Periodic Execution > should run cleanup periodically
[ExecutionLogsCleanup] Starting cleanup service (retention: 30 days, interval: 100ms)

stdout | tests/unit/services/execution-logs-cleanup.test.ts > ExecutionLogsCleanup > Periodic Execution > should run cleanup periodically
[ExecutionLogsCleanup] Stopping cleanup service

stdout | tests/integration/execution-changes.test.ts > Execution Changes Integration Tests
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully
Initializing new database for test-repo-c94e5620 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-changes-DjQabk/test-repo/.sudocode/cache.db

stdout | tests/integration/execution-changes.test.ts > Execution Changes Integration Tests
Project context initialized: test-repo-c94e5620 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-changes-DjQabk/test-repo

stdout | tests/integration/execution-changes.test.ts > Execution Changes Integration Tests
[project-manager] Starting workflow recovery for test-repo-c94e5620...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/integration/execution-changes.test.ts > Execution Changes Integration Tests
[OrchestratorEngine] Checking for stale executions...

stdout | tests/integration/execution-changes.test.ts > Execution Changes Integration Tests
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/integration/execution-changes.test.ts > Execution Changes Integration Tests
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/integration/execution-changes.test.ts > Execution Changes Integration Tests
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/integration/execution-changes.test.ts > Execution Changes Integration Tests
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/integration/execution-changes.test.ts > Execution Changes Integration Tests
[WakeupService] State recovery complete

stdout | tests/integration/execution-changes.test.ts > Execution Changes Integration Tests
[project-manager] Workflow recovery complete for test-repo-c94e5620
[watcher] Starting file watcher for /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-changes-DjQabk/test-repo/.sudocode
[watch] Watching directories: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-changes-DjQabk/test-repo/.sudocode/specs, /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-changes-DjQabk/test-repo/.sudocode/issues and JSONL files
[integration-sync] Starting for project test-repo-c94e5620
[integration-sync] No enabled integrations found

stdout | tests/integration/execution-changes.test.ts > Execution Changes Integration Tests
Project opened successfully: test-repo-c94e5620 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-changes-DjQabk/test-repo

 âœ“ |@sudocode-ai/local-server| tests/unit/services/execution-logs-cleanup.test.ts (19 tests | 1 skipped) 2367ms
   âœ“ ExecutionLogsCleanup > stop() > should clear the interval  541ms
   âœ“ ExecutionLogsCleanup > Periodic Execution > should run cleanup periodically  355ms
stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > SequentialWorkflowEngine recovery > should resume running workflow after restart
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Executor Factory > should create AgentExecutorWrapper for claude-code
[ExecutorFactory] Creating executor {
  agentType: [32m'claude-code'[39m,
  workDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-multi-agent-test-5UOB36'[39m
}
[ExecutorFactory] Using AgentExecutorWrapper for claude-code

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Executor Factory > should create AgentExecutorWrapper for codex
[ExecutorFactory] Creating executor {
  agentType: [32m'codex'[39m,
  workDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-multi-agent-test-5UOB36'[39m
}
[ExecutorFactory] Using AgentExecutorWrapper for codex

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Executor Factory > should create executor for copilot agent
[ExecutorFactory] Creating executor {
  agentType: [32m'copilot'[39m,
  workDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-multi-agent-test-5UOB36'[39m
}
[ExecutorFactory] Using AgentExecutorWrapper for copilot

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Executor Factory > should throw for invalid configuration
[ExecutorFactory] Creating executor {
  agentType: [32m'claude-code'[39m,
  workDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-multi-agent-test-5UOB36'[39m
}

stdout | tests/integration/execution-changes.test.ts > Execution Changes Integration Tests > Committed Changes (Scenario A) > should return file changes for completed execution with commits
[watch] Watching 0 files in /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-changes-DjQabk/test-repo/.sudocode

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > SequentialWorkflowEngine recovery > should resume running workflow after restart
[WorktreeManager] Setting up isolated worktree environment {
  repoPath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM'[39m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/worktrees/workflow-wf-b1056d64'[39m
}
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/worktrees/workflow-wf-b1056d64/.sudocode'[39m
}
[WorktreeManager] Created .sudocode directory in worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/worktrees/workflow-wf-b1056d64/.sudocode
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/worktrees/workflow-wf-b1056d64/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/issues.jsonl
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/worktrees/workflow-wf-b1056d64/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/specs.jsonl
[WorktreeManager] No config.json to copy from main repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > SequentialWorkflowEngine recovery > should resume running workflow after restart
[WorktreeManager] Successfully initialized local database in worktree at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/worktrees/workflow-wf-b1056d64/.sudocode/cache.db
[WorktreeManager] Database file created {
  path: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/worktrees/workflow-wf-b1056d64/.sudocode/cache.db'[39m,
  size: [33m4096[39m
}
[WorktreeManager] Worktree environment setup complete

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > SequentialWorkflowEngine recovery > should resume running workflow after restart
[ExecutionLifecycle] Created workflow worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/worktrees/workflow-wf-b1056d64 (branch: sudocode/workflow/b1056d64/workflow-for-3-issues)

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > SequentialWorkflowEngine recovery > should resume running workflow after restart
[BaseWorkflowEngine] Created workflow worktree for wf-b1056d64: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/worktrees/workflow-wf-b1056d64 (branch: sudocode/workflow/b1056d64/workflow-for-3-issues)

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > ExecutionService Multi-Agent Integration > should create execution with default claude-code agent
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > ExecutionService Multi-Agent Integration > should create execution with default claude-code agent
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > ExecutionService Multi-Agent Integration > should create execution with default claude-code agent
[ExecutorFactory] Creating executor {
  agentType: [32m'claude-code'[39m,
  workDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-multi-agent-test-5UOB36'[39m
}
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > SequentialWorkflowEngine recovery > should resume running workflow after restart
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 1 workflows to recover
[SequentialWorkflowEngine] Recovering workflow wf-b1056d64 (status: running)
[SequentialWorkflowEngine] Found running step step-e6f767a2 (execution: exec-433b90fc)
[SequentialWorkflowEngine] Execution exec-433b90fc was running, marking as failed

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > SequentialWorkflowEngine recovery > should resume running workflow after restart
[SequentialWorkflowEngine] Resuming execution loop for workflow wf-b1056d64

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > SequentialWorkflowEngine recovery > should resume running workflow after restart
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > ExecutionService Multi-Agent Integration > should create execution with explicit agent type
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > ExecutionService Multi-Agent Integration > should create execution with explicit agent type
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > SequentialWorkflowEngine recovery > should handle step that was running during crash
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > ExecutionService Multi-Agent Integration > should create execution with explicit agent type
[ExecutorFactory] Creating executor {
  agentType: [32m'claude-code'[39m,
  workDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-multi-agent-test-5UOB36'[39m
}
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > ExecutionService Multi-Agent Integration > should create execution with codex agent
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/execution-changes.test.ts > Execution Changes Integration Tests > Committed Changes (Scenario A) > should return file changes for completed execution with commits
[ExecutionChangesService] Execution exec-committed-1: {
  status: [32m'completed'[39m,
  before_commit: [32m'c567f3837981795323ee82d3b3962955711156ca'[39m,
  after_commit: [32m'f7be985add9c7515bbd7b3a31524e504ed822fd4'[39m,
  parent_execution_id: [1mnull[22m
}
[ExecutionChangesService] Root execution exec-committed-1: {
  before_commit: [32m'c567f3837981795323ee82d3b3962955711156ca'[39m,
  after_commit: [32m'f7be985add9c7515bbd7b3a31524e504ed822fd4'[39m
}
[ExecutionChangesService] Computed beforeCommit: c567f3837981795323ee82d3b3962955711156ca

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > ExecutionService Multi-Agent Integration > should create execution with codex agent
[ExecutorFactory] Creating executor {
  agentType: [32m'codex'[39m,
  workDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-multi-agent-test-5UOB36'[39m
}
[ExecutorFactory] Using AgentExecutorWrapper for codex
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > ExecutionService Multi-Agent Integration > should create execution for copilot agent
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > ExecutionService Multi-Agent Integration > should create execution for copilot agent
[ExecutorFactory] Creating executor {
  agentType: [32m'copilot'[39m,
  workDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-multi-agent-test-5UOB36'[39m
}
[ExecutorFactory] Using AgentExecutorWrapper for copilot
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > SequentialWorkflowEngine recovery > should handle step that was running during crash
[WorktreeManager] Setting up isolated worktree environment {
  repoPath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM'[39m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/worktrees/workflow-wf-3a4bb08c'[39m
}
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/worktrees/workflow-wf-3a4bb08c/.sudocode'[39m
}
[WorktreeManager] Created .sudocode directory in worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/worktrees/workflow-wf-3a4bb08c/.sudocode
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/worktrees/workflow-wf-3a4bb08c/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/issues.jsonl
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/worktrees/workflow-wf-3a4bb08c/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/specs.jsonl
[WorktreeManager] No config.json to copy from main repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > SequentialWorkflowEngine recovery > should handle step that was running during crash
[WorktreeManager] Successfully initialized local database in worktree at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/worktrees/workflow-wf-3a4bb08c/.sudocode/cache.db
[WorktreeManager] Database file created {
  path: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/worktrees/workflow-wf-3a4bb08c/.sudocode/cache.db'[39m,
  size: [33m4096[39m
}
[WorktreeManager] Worktree environment setup complete

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > SequentialWorkflowEngine recovery > should handle step that was running during crash
[ExecutionLifecycle] Created workflow worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/worktrees/workflow-wf-3a4bb08c (branch: sudocode/workflow/3a4bb08c/workflow-for-2-issues)

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > SequentialWorkflowEngine recovery > should handle step that was running during crash
[BaseWorkflowEngine] Created workflow worktree for wf-3a4bb08c: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/worktrees/workflow-wf-3a4bb08c (branch: sudocode/workflow/3a4bb08c/workflow-for-2-issues)

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > ExecutionService Multi-Agent Integration > should persist agent_type to database
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > ExecutionService Multi-Agent Integration > should persist agent_type to database
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/execution-changes.test.ts > Execution Changes Integration Tests > Committed Changes (Scenario A) > should return file changes for completed execution with commits
[watch] Watching 2 files in /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-changes-DjQabk/test-repo/.sudocode

stdout | tests/integration/execution-changes.test.ts > Execution Changes Integration Tests > Committed Changes (Scenario A) > should return file changes for completed execution with commits
[watch] Watching 2 files in /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-changes-DjQabk/test-repo/.sudocode

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > SequentialWorkflowEngine recovery > should handle step that was running during crash
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 1 workflows to recover
[SequentialWorkflowEngine] Recovering workflow wf-3a4bb08c (status: running)
[SequentialWorkflowEngine] Found running step step-46c36ab8 (execution: exec-a785d9b2)
[SequentialWorkflowEngine] Execution exec-a785d9b2 was running, marking as failed

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > SequentialWorkflowEngine recovery > should handle step that was running during crash
[SequentialWorkflowEngine] Resuming execution loop for workflow wf-3a4bb08c

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > SequentialWorkflowEngine recovery > should handle step that was running during crash
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > SequentialWorkflowEngine recovery > should preserve paused state after restart
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > ExecutionService Multi-Agent Integration > should persist agent_type to database
[ExecutorFactory] Creating executor {
  agentType: [32m'claude-code'[39m,
  workDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-multi-agent-test-5UOB36'[39m
}
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > ExecutionService Multi-Agent Integration > should handle NULL agent_type in database gracefully
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > ExecutionService Multi-Agent Integration > should handle NULL agent_type in database gracefully
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > ExecutionService Multi-Agent Integration > should handle NULL agent_type in database gracefully
[ExecutorFactory] Creating executor {
  agentType: [32m'claude-code'[39m,
  workDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-multi-agent-test-5UOB36'[39m
}
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > ExecutionService Multi-Agent Integration > should handle NULL agent_type in database gracefully
Recreating worktree for follow-up execution: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-multi-agent-test-5UOB36/.worktrees/66209981-34f9-4d44-9c9f-d41d8beafa78

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > ExecutionService Multi-Agent Integration > should handle NULL agent_type in database gracefully
[ExecutorFactory] Creating executor {
  agentType: [32m'claude-code'[39m,
  workDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-multi-agent-test-5UOB36'[39m
}
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[ExecutionService] Follow-up task metadata: {
  executionId: [32m'534e5dcf-2806-4986-a8ee-2be7345befb6'[39m,
  parentExecutionId: [32m'66209981-34f9-4d44-9c9f-d41d8beafa78'[39m,
  inheritedConfigKeys: [ [32m'mode'[39m ],
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  model: [90mundefined[39m
}

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Regression Testing - Claude Code Functionality > should create Claude Code execution without breaking changes
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Regression Testing - Claude Code Functionality > should create Claude Code execution without breaking changes
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > SequentialWorkflowEngine recovery > should preserve paused state after restart
[WorktreeManager] Setting up isolated worktree environment {
  repoPath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM'[39m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/worktrees/workflow-wf-637be77c'[39m
}
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/worktrees/workflow-wf-637be77c/.sudocode'[39m
}
[WorktreeManager] Created .sudocode directory in worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/worktrees/workflow-wf-637be77c/.sudocode
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/worktrees/workflow-wf-637be77c/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/issues.jsonl
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/worktrees/workflow-wf-637be77c/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/specs.jsonl
[WorktreeManager] No config.json to copy from main repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Regression Testing - Claude Code Functionality > should create Claude Code execution without breaking changes
[ExecutorFactory] Creating executor {
  agentType: [32m'claude-code'[39m,
  workDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-multi-agent-test-5UOB36'[39m
}
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > SequentialWorkflowEngine recovery > should preserve paused state after restart
[WorktreeManager] Successfully initialized local database in worktree at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/worktrees/workflow-wf-637be77c/.sudocode/cache.db
[WorktreeManager] Database file created {
  path: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/worktrees/workflow-wf-637be77c/.sudocode/cache.db'[39m,
  size: [33m4096[39m
}
[WorktreeManager] Worktree environment setup complete

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > SequentialWorkflowEngine recovery > should preserve paused state after restart
[ExecutionLifecycle] Created workflow worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/worktrees/workflow-wf-637be77c (branch: sudocode/workflow/637be77c/workflow-for-2-issues)

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > SequentialWorkflowEngine recovery > should preserve paused state after restart
[BaseWorkflowEngine] Created workflow worktree for wf-637be77c: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/worktrees/workflow-wf-637be77c (branch: sudocode/workflow/637be77c/workflow-for-2-issues)

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > SequentialWorkflowEngine recovery > should preserve paused state after restart
[SequentialWorkflowEngine] Reset step step-4ac85c4e to pending after pause (keeping executionId for resume)

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > SequentialWorkflowEngine recovery > should preserve paused state after restart
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 1 workflows to recover
[SequentialWorkflowEngine] Recovering workflow wf-637be77c (status: paused)
[SequentialWorkflowEngine] Workflow wf-637be77c is paused, not resuming execution loop

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > SequentialWorkflowEngine recovery > should preserve paused state after restart
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > SequentialWorkflowEngine recovery > should not recover cancelled workflows
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Regression Testing - Claude Code Functionality > should list executions correctly
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Regression Testing - Claude Code Functionality > should list executions correctly
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Regression Testing - Claude Code Functionality > should list executions correctly
[ExecutorFactory] Creating executor {
  agentType: [32m'claude-code'[39m,
  workDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-multi-agent-test-5UOB36'[39m
}
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should handle multiple sequential executions with same agent
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should handle multiple sequential executions with same agent
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should handle multiple sequential executions with same agent
[ExecutorFactory] Creating executor {
  agentType: [32m'claude-code'[39m,
  workDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-multi-agent-test-5UOB36'[39m
}
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/integration/execution-changes.test.ts > Execution Changes Integration Tests > Committed Changes (Scenario A) > should handle modified and deleted files
[ExecutionChangesService] Execution exec-committed-2: {
  status: [32m'completed'[39m,
  before_commit: [32m'520b664d6a6e64422556f6ecd84c21e589f6b08d'[39m,
  after_commit: [32m'c28a06268fe285bc68d2b9a64da9f15f5433ccf9'[39m,
  parent_execution_id: [1mnull[22m
}
[ExecutionChangesService] Root execution exec-committed-2: {
  before_commit: [32m'520b664d6a6e64422556f6ecd84c21e589f6b08d'[39m,
  after_commit: [32m'c28a06268fe285bc68d2b9a64da9f15f5433ccf9'[39m
}
[ExecutionChangesService] Computed beforeCommit: 520b664d6a6e64422556f6ecd84c21e589f6b08d

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should handle multiple sequential executions with same agent
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should handle multiple sequential executions with same agent
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > SequentialWorkflowEngine recovery > should not recover cancelled workflows
[WorktreeManager] Setting up isolated worktree environment {
  repoPath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM'[39m,
  worktreePath: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/worktrees/workflow-wf-3497f24c'[39m
}
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/worktrees/workflow-wf-3497f24c/.sudocode'[39m
}
[WorktreeManager] Created .sudocode directory in worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/worktrees/workflow-wf-3497f24c/.sudocode
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/worktrees/workflow-wf-3497f24c/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/issues.jsonl
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/worktrees/workflow-wf-3497f24c/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mfalse[39m
}
[WorktreeManager] Main file does not exist: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/specs.jsonl
[WorktreeManager] No config.json to copy from main repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > SequentialWorkflowEngine recovery > should not recover cancelled workflows
[WorktreeManager] Successfully initialized local database in worktree at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/worktrees/workflow-wf-3497f24c/.sudocode/cache.db
[WorktreeManager] Database file created {
  path: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/worktrees/workflow-wf-3497f24c/.sudocode/cache.db'[39m,
  size: [33m4096[39m
}
[WorktreeManager] Worktree environment setup complete

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > SequentialWorkflowEngine recovery > should not recover cancelled workflows
[ExecutionLifecycle] Created workflow worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/worktrees/workflow-wf-3497f24c (branch: sudocode/workflow/3497f24c/workflow-for-2-issues)

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > SequentialWorkflowEngine recovery > should not recover cancelled workflows
[BaseWorkflowEngine] Created workflow worktree for wf-3497f24c: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-workflow-recovery-se3ocM/.sudocode/worktrees/workflow-wf-3497f24c (branch: sudocode/workflow/3497f24c/workflow-for-2-issues)

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > SequentialWorkflowEngine recovery > should not recover cancelled workflows
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > WorkflowWakeupService recovery > should restore pending await conditions
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > WorkflowWakeupService recovery > should restore pending await conditions
[WakeupService] Scheduled 60s timeout for await 95a06f26-3118-4658-80af-fb43a412c6d0
[WakeupService] Registered await 95a06f26-3118-4658-80af-fb43a412c6d0 for workflow wf-await-test { eventTypes: [ [32m'step_completed'[39m ], executionIds: [90mundefined[39m }
[WakeupService] Starting state recovery...
[WakeupService] Found 1 pending awaits to recover
[WakeupService] Scheduled 59.999s timeout for await 95a06f26-3118-4658-80af-fb43a412c6d0
[WakeupService] Rescheduled await 95a06f26-3118-4658-80af-fb43a412c6d0 timeout (60s remaining)

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > WorkflowWakeupService recovery > should restore pending await conditions
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > WorkflowWakeupService recovery > should restore pending await conditions
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > WorkflowWakeupService recovery > should restore pending await conditions
[WakeupService] State recovery complete

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > WorkflowWakeupService recovery > should trigger immediate wakeup for expired awaits
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > WorkflowWakeupService recovery > should trigger immediate wakeup for expired awaits
[WakeupService] Starting state recovery...
[WakeupService] Found 1 pending awaits to recover
[WakeupService] Await await-expired expired during downtime, triggering wakeup
[WakeupService] Resolved await await-expired for workflow wf-expired-await { resolvedBy: [32m'timeout'[39m }

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > WorkflowWakeupService recovery > should trigger immediate wakeup for expired awaits
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > WorkflowWakeupService recovery > should trigger immediate wakeup for expired awaits
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > WorkflowWakeupService recovery > should trigger immediate wakeup for expired awaits
[WakeupService] State recovery complete

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > WorkflowWakeupService recovery > should reschedule await with remaining time
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > WorkflowWakeupService recovery > should reschedule await with remaining time
[WakeupService] Starting state recovery...
[WakeupService] Found 1 pending awaits to recover
[WakeupService] Scheduled 10s timeout for await await-future
[WakeupService] Rescheduled await await-future timeout (10s remaining)

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > WorkflowWakeupService recovery > should reschedule await with remaining time
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > WorkflowWakeupService recovery > should reschedule await with remaining time
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > WorkflowWakeupService recovery > should reschedule await with remaining time
[WakeupService] State recovery complete

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > Execution timeout recovery > should restore pending execution timeouts
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > Execution timeout recovery > should restore pending execution timeouts
[WakeupService] Started 30000ms timeout for execution exec-timeout-test (deadline: 2025-12-19T06:28:14.912Z)
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > Execution timeout recovery > should restore pending execution timeouts
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > Execution timeout recovery > should restore pending execution timeouts
[WakeupService] Found 1 execution timeouts to recover
[WakeupService] Rescheduled execution exec-timeout-test timeout (30s remaining)

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > Execution timeout recovery > should restore pending execution timeouts
[WakeupService] State recovery complete

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > Execution timeout recovery > should handle expired execution timeout during recovery
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > Execution timeout recovery > should handle expired execution timeout during recovery
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > Execution timeout recovery > should handle expired execution timeout during recovery
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > Execution timeout recovery > should handle expired execution timeout during recovery
[WakeupService] Found 1 execution timeouts to recover
[WakeupService] Execution exec-expired timeout expired during downtime, handling now

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > Execution timeout recovery > should handle expired execution timeout during recovery
[WakeupService] State recovery complete

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > Execution timeout recovery > should clear timeout when execution completes
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/workflow/recovery.test.ts > Workflow Recovery > Execution timeout recovery > should clear timeout when execution completes
[WakeupService] Started 30000ms timeout for execution exec-clear (deadline: 2025-12-19T06:28:14.967Z)
[WakeupService] Cleared timeout for execution exec-clear

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should handle multiple sequential executions with same agent
[ExecutorFactory] Creating executor {
  agentType: [32m'claude-code'[39m,
  workDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-multi-agent-test-5UOB36'[39m
}
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should handle multiple sequential executions with same agent
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should handle multiple sequential executions with same agent
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/workflow/mcp-protocol.test.ts > Workflow MCP Protocol > should handle workflow_status tool call
[workflows] getEngineForWorkflow: workflow=wf-test1, engineType=sequential

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should handle multiple sequential executions with same agent
[ExecutorFactory] Creating executor {
  agentType: [32m'claude-code'[39m,
  workDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-multi-agent-test-5UOB36'[39m
}
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should handle multiple executions with explicit agent types
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should handle multiple executions with explicit agent types
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should handle multiple executions with explicit agent types
[ExecutorFactory] Creating executor {
  agentType: [32m'claude-code'[39m,
  workDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-multi-agent-test-5UOB36'[39m
}
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/integration/workflow/recovery.test.ts
[SequentialWorkflowEngine] Step step-4ac85c4e execution ended due to workflow pause, not treating as failure

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should handle multiple executions with explicit agent types
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should handle multiple executions with explicit agent types
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/execution-changes.test.ts > Execution Changes Integration Tests > Uncommitted Changes (Scenario B) > should return uncommitted changes when after_commit equals before_commit
[ExecutionChangesService] Execution exec-uncommitted-1: {
  status: [32m'completed'[39m,
  before_commit: [32m'c28a06268fe285bc68d2b9a64da9f15f5433ccf9'[39m,
  after_commit: [32m'c28a06268fe285bc68d2b9a64da9f15f5433ccf9'[39m,
  parent_execution_id: [1mnull[22m
}
[ExecutionChangesService] Root execution exec-uncommitted-1: {
  before_commit: [32m'c28a06268fe285bc68d2b9a64da9f15f5433ccf9'[39m,
  after_commit: [32m'c28a06268fe285bc68d2b9a64da9f15f5433ccf9'[39m
}
[ExecutionChangesService] Computed beforeCommit: c28a06268fe285bc68d2b9a64da9f15f5433ccf9

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should handle multiple executions with explicit agent types
[ExecutorFactory] Creating executor {
  agentType: [32m'claude-code'[39m,
  workDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-multi-agent-test-5UOB36'[39m
}
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should handle multiple executions with explicit agent types
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should handle multiple executions with explicit agent types
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/execution-changes.test.ts > Execution Changes Integration Tests > Error Cases > should return unavailable for missing before_commit
[ExecutionChangesService] Execution exec-missing-before: {
  status: [32m'completed'[39m,
  before_commit: [1mnull[22m,
  after_commit: [1mnull[22m,
  parent_execution_id: [1mnull[22m
}
[ExecutionChangesService] Root execution exec-missing-before: { before_commit: [1mnull[22m, after_commit: [1mnull[22m }
[ExecutionChangesService] Computed beforeCommit: null

stdout | tests/integration/execution-changes.test.ts > Execution Changes Integration Tests > Error Cases > should return unavailable for incomplete execution
[ExecutionChangesService] Execution exec-pending: {
  status: [32m'pending'[39m,
  before_commit: [32m'c28a06268fe285bc68d2b9a64da9f15f5433ccf9'[39m,
  after_commit: [32m'c28a06268fe285bc68d2b9a64da9f15f5433ccf9'[39m,
  parent_execution_id: [1mnull[22m
}
[ExecutionChangesService] Execution not started: pending

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should handle multiple executions with explicit agent types
[ExecutorFactory] Creating executor {
  agentType: [32m'claude-code'[39m,
  workDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-multi-agent-test-5UOB36'[39m
}
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/integration/execution-changes.test.ts > Execution Changes Integration Tests > Error Cases > should return unavailable for non-existent commits
[ExecutionChangesService] Execution exec-fake-commits: {
  status: [32m'completed'[39m,
  before_commit: [32m'0000000000000000000000000000000000000000'[39m,
  after_commit: [32m'1111111111111111111111111111111111111111'[39m,
  parent_execution_id: [1mnull[22m
}
[ExecutionChangesService] Root execution exec-fake-commits: {
  before_commit: [32m'0000000000000000000000000000000000000000'[39m,
  after_commit: [32m'1111111111111111111111111111111111111111'[39m
}
[ExecutionChangesService] Computed beforeCommit: 0000000000000000000000000000000000000000

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should handle concurrent execution creation without conflicts
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should handle concurrent execution creation without conflicts
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/workflow/recovery.test.ts
[SequentialWorkflowEngine] Step step-46b634a9 execution ended due to workflow cancel, not treating as failure

stdout | tests/integration/execution-changes.test.ts > Execution Changes Integration Tests > Error Cases > should return unavailable for non-existent execution
[ExecutionChangesService] Execution not found: non-existent

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should handle concurrent execution creation without conflicts
[ExecutorFactory] Creating executor {
  agentType: [32m'claude-code'[39m,
  workDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-multi-agent-test-5UOB36'[39m
}
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should handle concurrent execution creation without conflicts
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should handle concurrent execution creation without conflicts
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should handle concurrent execution creation without conflicts
[ExecutorFactory] Creating executor {
  agentType: [32m'claude-code'[39m,
  workDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-multi-agent-test-5UOB36'[39m
}
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should handle concurrent execution creation without conflicts
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should handle concurrent execution creation without conflicts
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/execution-changes.test.ts > Execution Changes Integration Tests > No Changes > should return empty changes when no files modified
[ExecutionChangesService] Execution exec-no-changes: {
  status: [32m'completed'[39m,
  before_commit: [32m'c28a06268fe285bc68d2b9a64da9f15f5433ccf9'[39m,
  after_commit: [32m'c28a06268fe285bc68d2b9a64da9f15f5433ccf9'[39m,
  parent_execution_id: [1mnull[22m
}
[ExecutionChangesService] Root execution exec-no-changes: {
  before_commit: [32m'c28a06268fe285bc68d2b9a64da9f15f5433ccf9'[39m,
  after_commit: [32m'c28a06268fe285bc68d2b9a64da9f15f5433ccf9'[39m
}
[ExecutionChangesService] Computed beforeCommit: c28a06268fe285bc68d2b9a64da9f15f5433ccf9

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should handle concurrent execution creation without conflicts
[ExecutorFactory] Creating executor {
  agentType: [32m'claude-code'[39m,
  workDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-multi-agent-test-5UOB36'[39m
}
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should isolate executions from each other
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should isolate executions from each other
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should isolate executions from each other
[ExecutorFactory] Creating executor {
  agentType: [32m'claude-code'[39m,
  workDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-multi-agent-test-5UOB36'[39m
}
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should isolate executions from each other
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should isolate executions from each other
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

 âœ“ |@sudocode-ai/local-server| tests/integration/workflow/recovery.test.ts (10 tests) 4675ms
   âœ“ Workflow Recovery > SequentialWorkflowEngine recovery > should resume running workflow after restart  825ms
   âœ“ Workflow Recovery > SequentialWorkflowEngine recovery > should handle step that was running during crash  750ms
   âœ“ Workflow Recovery > SequentialWorkflowEngine recovery > should preserve paused state after restart  699ms
   âœ“ Workflow Recovery > SequentialWorkflowEngine recovery > should not recover cancelled workflows  471ms
stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should isolate executions from each other
[ExecutorFactory] Creating executor {
  agentType: [32m'claude-code'[39m,
  workDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-multi-agent-test-5UOB36'[39m
}
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should track agent type correctly across follow-up executions
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should track agent type correctly across follow-up executions
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should track agent type correctly across follow-up executions
[ExecutorFactory] Creating executor {
  agentType: [32m'claude-code'[39m,
  workDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-multi-agent-test-5UOB36'[39m
}
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[ExecutionService] createExecution mergedConfig: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m
}
[ExecutionService] agentConfig passed to executor: {
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  allKeys: []
}
[ExecutionService] Task metadata mcpServers: { hasMcpServers: [33mfalse[39m, mcpServerNames: [32m'none'[39m }

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should track agent type correctly across follow-up executions
Recreating worktree for follow-up execution: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-multi-agent-test-5UOB36/.worktrees/eef22e80-5161-47f8-8492-08842af5d801

stdout | tests/integration/multi-agent.test.ts > Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should track agent type correctly across follow-up executions
[ExecutorFactory] Creating executor {
  agentType: [32m'claude-code'[39m,
  workDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-multi-agent-test-5UOB36'[39m
}
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[ExecutionService] Follow-up task metadata: {
  executionId: [32m'913431c7-11c9-45bb-8cc7-27dd7219c572'[39m,
  parentExecutionId: [32m'eef22e80-5161-47f8-8492-08842af5d801'[39m,
  inheritedConfigKeys: [ [32m'mode'[39m ],
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  model: [90mundefined[39m
}

stdout | tests/integration/execution-changes.test.ts > Execution Changes Integration Tests > Binary Files > should handle binary files in changes
[ExecutionChangesService] Execution exec-binary: {
  status: [32m'completed'[39m,
  before_commit: [32m'c28a06268fe285bc68d2b9a64da9f15f5433ccf9'[39m,
  after_commit: [32m'17ac0c58c107a102e4124f6f74b3fe08f574516a'[39m,
  parent_execution_id: [1mnull[22m
}
[ExecutionChangesService] Root execution exec-binary: {
  before_commit: [32m'c28a06268fe285bc68d2b9a64da9f15f5433ccf9'[39m,
  after_commit: [32m'17ac0c58c107a102e4124f6f74b3fe08f574516a'[39m
}
[ExecutionChangesService] Computed beforeCommit: c28a06268fe285bc68d2b9a64da9f15f5433ccf9

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initialization > should create ProjectManager with registry
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initialization > should support disabling file watching
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should reject non-existent path
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should reject path that is not a directory
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should reject project without .sudocode directory
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should reject project without cache.db
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should successfully open valid project
Initializing new database for test-project-b7f05cf8 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-jSWr09/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should successfully open valid project
Project context initialized: test-project-b7f05cf8 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-jSWr09/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should successfully open valid project
[project-manager] Starting workflow recovery for test-project-b7f05cf8...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should successfully open valid project
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should successfully open valid project
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should successfully open valid project
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should successfully open valid project
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should successfully open valid project
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should successfully open valid project
[WakeupService] State recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should successfully open valid project
[project-manager] Workflow recovery complete for test-project-b7f05cf8
[integration-sync] Starting for project test-project-b7f05cf8
[integration-sync] No enabled integrations found

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should successfully open valid project
Project opened successfully: test-project-b7f05cf8 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-jSWr09/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should successfully open valid project
Shutting down ProjectManager...
Closing project: test-project-b7f05cf8
Shutting down project context: test-project-b7f05cf8

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should successfully open valid project
[integration-sync] Stopping for project test-project-b7f05cf8
[integration-sync] Service stopped for test-project-b7f05cf8

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should successfully open valid project
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-b7f05cf8

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should successfully open valid project
Project closed: test-project-b7f05cf8

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should successfully open valid project
ProjectManager shutdown complete

stdout | tests/integration/execution-changes.test.ts > Execution Changes Integration Tests
Closing project: test-repo-c94e5620
Shutting down project context: test-repo-c94e5620

stdout | tests/integration/execution-changes.test.ts > Execution Changes Integration Tests
[integration-sync] Stopping for project test-repo-c94e5620
[integration-sync] Service stopped for test-repo-c94e5620

stdout | tests/integration/execution-changes.test.ts > Execution Changes Integration Tests
[watcher] Stopping file watcher...
[watch] Stopping watcher...
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-repo-c94e5620
[watch] Watcher stopped
Database cached for test-repo-c94e5620 (TTL: 1800000ms)
Project closed: test-repo-c94e5620

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should add opened project to registry
Initializing new database for test-project-49ceef60 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-YD7j50/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should add opened project to registry
Project context initialized: test-project-49ceef60 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-YD7j50/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should add opened project to registry
[project-manager] Starting workflow recovery for test-project-49ceef60...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should add opened project to registry
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should add opened project to registry
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should add opened project to registry
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should add opened project to registry
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should add opened project to registry
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should add opened project to registry
[WakeupService] State recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should add opened project to registry
[project-manager] Workflow recovery complete for test-project-49ceef60
[integration-sync] Starting for project test-project-49ceef60
[integration-sync] No enabled integrations found

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should add opened project to registry
Project opened successfully: test-project-49ceef60 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-YD7j50/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should add opened project to registry
Shutting down ProjectManager...
Closing project: test-project-49ceef60
Shutting down project context: test-project-49ceef60

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should add opened project to registry
[integration-sync] Stopping for project test-project-49ceef60
[integration-sync] Service stopped for test-project-49ceef60

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should add opened project to registry
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-49ceef60

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should add opened project to registry
Project closed: test-project-49ceef60

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should add opened project to registry
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should track opened project
Initializing new database for test-project-24130254 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-c1oEY4/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should track opened project
Project context initialized: test-project-24130254 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-c1oEY4/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should track opened project
[project-manager] Starting workflow recovery for test-project-24130254...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should track opened project
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should track opened project
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should track opened project
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should track opened project
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should track opened project
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should track opened project
[WakeupService] State recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should track opened project
[project-manager] Workflow recovery complete for test-project-24130254
[integration-sync] Starting for project test-project-24130254
[integration-sync] No enabled integrations found

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should track opened project
Project opened successfully: test-project-24130254 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-c1oEY4/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should track opened project
Shutting down ProjectManager...
Closing project: test-project-24130254
Shutting down project context: test-project-24130254

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should track opened project
[integration-sync] Stopping for project test-project-24130254
[integration-sync] Service stopped for test-project-24130254

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should track opened project
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-24130254

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should track opened project
Project closed: test-project-24130254

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should track opened project
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should return existing project if already open
Initializing new database for test-project-0675c0b6 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-MQfkXk/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should return existing project if already open
Project context initialized: test-project-0675c0b6 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-MQfkXk/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should return existing project if already open
[project-manager] Starting workflow recovery for test-project-0675c0b6...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should return existing project if already open
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should return existing project if already open
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should return existing project if already open
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should return existing project if already open
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should return existing project if already open
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should return existing project if already open
[WakeupService] State recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should return existing project if already open
[project-manager] Workflow recovery complete for test-project-0675c0b6
[integration-sync] Starting for project test-project-0675c0b6
[integration-sync] No enabled integrations found

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should return existing project if already open
Project opened successfully: test-project-0675c0b6 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-MQfkXk/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should return existing project if already open
Project already open: test-project-0675c0b6

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should return existing project if already open
Shutting down ProjectManager...
Closing project: test-project-0675c0b6
Shutting down project context: test-project-0675c0b6

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should return existing project if already open
[integration-sync] Stopping for project test-project-0675c0b6
[integration-sync] Service stopped for test-project-0675c0b6

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should return existing project if already open
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-0675c0b6

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should return existing project if already open
Project closed: test-project-0675c0b6

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should return existing project if already open
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should update lastOpened timestamp when reopening
Initializing new database for test-project-fa8c644a at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-LxZdYH/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should update lastOpened timestamp when reopening
Project context initialized: test-project-fa8c644a at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-LxZdYH/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should update lastOpened timestamp when reopening
[project-manager] Starting workflow recovery for test-project-fa8c644a...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should update lastOpened timestamp when reopening
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should update lastOpened timestamp when reopening
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should update lastOpened timestamp when reopening
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should update lastOpened timestamp when reopening
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should update lastOpened timestamp when reopening
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should update lastOpened timestamp when reopening
[WakeupService] State recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should update lastOpened timestamp when reopening
[project-manager] Workflow recovery complete for test-project-fa8c644a
[integration-sync] Starting for project test-project-fa8c644a
[integration-sync] No enabled integrations found

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should update lastOpened timestamp when reopening
Project opened successfully: test-project-fa8c644a at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-LxZdYH/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should update lastOpened timestamp when reopening
Project already open: test-project-fa8c644a

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should update lastOpened timestamp when reopening
Shutting down ProjectManager...
Closing project: test-project-fa8c644a
Shutting down project context: test-project-fa8c644a

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should update lastOpened timestamp when reopening
[integration-sync] Stopping for project test-project-fa8c644a
[integration-sync] Service stopped for test-project-fa8c644a

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should update lastOpened timestamp when reopening
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-fa8c644a

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should update lastOpened timestamp when reopening
Project closed: test-project-fa8c644a

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > openProject > should update lastOpened timestamp when reopening
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should close an open project
Initializing new database for test-project-1aee7609 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-OnW1cD/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should close an open project
Project context initialized: test-project-1aee7609 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-OnW1cD/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should close an open project
[project-manager] Starting workflow recovery for test-project-1aee7609...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should close an open project
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should close an open project
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should close an open project
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should close an open project
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should close an open project
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should close an open project
[WakeupService] State recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should close an open project
[project-manager] Workflow recovery complete for test-project-1aee7609
[integration-sync] Starting for project test-project-1aee7609
[integration-sync] No enabled integrations found

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should close an open project
Project opened successfully: test-project-1aee7609 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-OnW1cD/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should close an open project
Closing project: test-project-1aee7609
Shutting down project context: test-project-1aee7609

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should close an open project
[integration-sync] Stopping for project test-project-1aee7609
[integration-sync] Service stopped for test-project-1aee7609

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should close an open project
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-1aee7609

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should close an open project
Database cached for test-project-1aee7609 (TTL: 1800000ms)
Project closed: test-project-1aee7609

 âœ“ |@sudocode-ai/local-server| tests/unit/repo-info.test.ts (26 tests) 4656ms
   âœ“ Repository Info API > GET /api/repo-info > should return repository information for a valid git repository  542ms
   âœ“ Repository Info API > GET /api/repo-info > should return the repository path  348ms
   âœ“ Repository Info API > GET /api/repo-info/branches > should return all local branches as strings  329ms
   âœ“ Repository Info API > GET /api/repo-info/branches > should return current branch matching repo-info endpoint  460ms
stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should close an open project
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should keep database in cache by default
Initializing new database for test-project-85fc1db2 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-0vAQOi/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should keep database in cache by default
Project context initialized: test-project-85fc1db2 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-0vAQOi/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should keep database in cache by default
[project-manager] Starting workflow recovery for test-project-85fc1db2...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should keep database in cache by default
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should keep database in cache by default
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should keep database in cache by default
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should keep database in cache by default
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should keep database in cache by default
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should keep database in cache by default
[WakeupService] State recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should keep database in cache by default
[project-manager] Workflow recovery complete for test-project-85fc1db2
[integration-sync] Starting for project test-project-85fc1db2
[integration-sync] No enabled integrations found

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should keep database in cache by default
Project opened successfully: test-project-85fc1db2 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-0vAQOi/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should keep database in cache by default
Closing project: test-project-85fc1db2
Shutting down project context: test-project-85fc1db2

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should keep database in cache by default
[integration-sync] Stopping for project test-project-85fc1db2
[integration-sync] Service stopped for test-project-85fc1db2

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should keep database in cache by default
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-85fc1db2

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should keep database in cache by default
Database cached for test-project-85fc1db2 (TTL: 1800000ms)
Project closed: test-project-85fc1db2

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should keep database in cache by default
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should not cache database if keepDbInCache is false
Initializing new database for test-project-4aa39d77 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-oprfT7/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should not cache database if keepDbInCache is false
Project context initialized: test-project-4aa39d77 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-oprfT7/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should not cache database if keepDbInCache is false
[project-manager] Starting workflow recovery for test-project-4aa39d77...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should not cache database if keepDbInCache is false
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should not cache database if keepDbInCache is false
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should not cache database if keepDbInCache is false
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should not cache database if keepDbInCache is false
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should not cache database if keepDbInCache is false
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should not cache database if keepDbInCache is false
[WakeupService] State recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should not cache database if keepDbInCache is false
[project-manager] Workflow recovery complete for test-project-4aa39d77
[integration-sync] Starting for project test-project-4aa39d77
[integration-sync] No enabled integrations found

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should not cache database if keepDbInCache is false
Project opened successfully: test-project-4aa39d77 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-oprfT7/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should not cache database if keepDbInCache is false
Closing project: test-project-4aa39d77
Shutting down project context: test-project-4aa39d77

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should not cache database if keepDbInCache is false
[integration-sync] Stopping for project test-project-4aa39d77
[integration-sync] Service stopped for test-project-4aa39d77

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should not cache database if keepDbInCache is false
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-4aa39d77

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should not cache database if keepDbInCache is false
Project closed: test-project-4aa39d77

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should not cache database if keepDbInCache is false
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > closeProject > should handle closing non-existent project gracefully
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getProject > should return null for non-existent project
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getProject > should return project context for open project
Initializing new database for test-project-bbdc35c7 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-uqJXQH/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getProject > should return project context for open project
Project context initialized: test-project-bbdc35c7 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-uqJXQH/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getProject > should return project context for open project
[project-manager] Starting workflow recovery for test-project-bbdc35c7...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getProject > should return project context for open project
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getProject > should return project context for open project
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getProject > should return project context for open project
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getProject > should return project context for open project
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getProject > should return project context for open project
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getProject > should return project context for open project
[WakeupService] State recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getProject > should return project context for open project
[project-manager] Workflow recovery complete for test-project-bbdc35c7
[integration-sync] Starting for project test-project-bbdc35c7
[integration-sync] No enabled integrations found

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getProject > should return project context for open project
Project opened successfully: test-project-bbdc35c7 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-uqJXQH/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getProject > should return project context for open project
Shutting down ProjectManager...
Closing project: test-project-bbdc35c7
Shutting down project context: test-project-bbdc35c7

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getProject > should return project context for open project
[integration-sync] Stopping for project test-project-bbdc35c7
[integration-sync] Service stopped for test-project-bbdc35c7

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getProject > should return project context for open project
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-bbdc35c7

 âœ“ |@sudocode-ai/local-server| tests/integration/multi-agent.test.ts (26 tests) 5771ms
   âœ“ Multi-Agent Support - Phase 1 Integration > ExecutionService Multi-Agent Integration > should create execution with default claude-code agent  500ms
   âœ“ Multi-Agent Support - Phase 1 Integration > Regression Testing - Claude Code Functionality > should create Claude Code execution without breaking changes  405ms
   âœ“ Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should handle multiple sequential executions with same agent  680ms
   âœ“ Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should handle multiple executions with explicit agent types  521ms
   âœ“ Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should handle concurrent execution creation without conflicts  363ms
   âœ“ Multi-Agent Support - Phase 1 Integration > Multiple and Concurrent Executions > should isolate executions from each other  530ms
stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getProject > should return project context for open project
Project closed: test-project-bbdc35c7

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getProject > should return project context for open project
ProjectManager shutdown complete

stdout | tests/integration/workflow/mcp-protocol.test.ts > Workflow MCP Protocol > should handle workflow_complete tool call
[workflows] getEngineForWorkflow: workflow=wf-test1, engineType=sequential

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getAllOpenProjects > should return empty array when no projects open
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getAllOpenProjects > should return all open projects
Initializing new database for test-project-b8b7386e at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-kJetmV/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getAllOpenProjects > should return all open projects
Project context initialized: test-project-b8b7386e at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-kJetmV/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getAllOpenProjects > should return all open projects
[project-manager] Starting workflow recovery for test-project-b8b7386e...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getAllOpenProjects > should return all open projects
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getAllOpenProjects > should return all open projects
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getAllOpenProjects > should return all open projects
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getAllOpenProjects > should return all open projects
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getAllOpenProjects > should return all open projects
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getAllOpenProjects > should return all open projects
[WakeupService] State recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getAllOpenProjects > should return all open projects
[project-manager] Workflow recovery complete for test-project-b8b7386e
[integration-sync] Starting for project test-project-b8b7386e
[integration-sync] No enabled integrations found

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getAllOpenProjects > should return all open projects
Project opened successfully: test-project-b8b7386e at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-kJetmV/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getAllOpenProjects > should return all open projects
Initializing new database for test-project-2-f11f98e7 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-kJetmV/test-project-2/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getAllOpenProjects > should return all open projects
Project context initialized: test-project-2-f11f98e7 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-kJetmV/test-project-2

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getAllOpenProjects > should return all open projects
[project-manager] Starting workflow recovery for test-project-2-f11f98e7...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getAllOpenProjects > should return all open projects
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getAllOpenProjects > should return all open projects
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getAllOpenProjects > should return all open projects
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getAllOpenProjects > should return all open projects
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getAllOpenProjects > should return all open projects
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getAllOpenProjects > should return all open projects
[WakeupService] State recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getAllOpenProjects > should return all open projects
[project-manager] Workflow recovery complete for test-project-2-f11f98e7
[integration-sync] Starting for project test-project-2-f11f98e7
[integration-sync] No enabled integrations found

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getAllOpenProjects > should return all open projects
Project opened successfully: test-project-2-f11f98e7 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-kJetmV/test-project-2

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getAllOpenProjects > should return all open projects
Shutting down ProjectManager...
Closing project: test-project-b8b7386e
Shutting down project context: test-project-b8b7386e

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getAllOpenProjects > should return all open projects
[integration-sync] Stopping for project test-project-b8b7386e
[integration-sync] Service stopped for test-project-b8b7386e

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getAllOpenProjects > should return all open projects
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-b8b7386e

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getAllOpenProjects > should return all open projects
Project closed: test-project-b8b7386e

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getAllOpenProjects > should return all open projects
Closing project: test-project-2-f11f98e7
Shutting down project context: test-project-2-f11f98e7

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getAllOpenProjects > should return all open projects
[integration-sync] Stopping for project test-project-2-f11f98e7
[integration-sync] Service stopped for test-project-2-f11f98e7

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getAllOpenProjects > should return all open projects
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-2-f11f98e7

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getAllOpenProjects > should return all open projects
Project closed: test-project-2-f11f98e7

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getAllOpenProjects > should return all open projects
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > isProjectOpen > should return false for non-open project
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > isProjectOpen > should return true for open project
Initializing new database for test-project-e85d304f at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-E3gJxR/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > isProjectOpen > should return true for open project
Project context initialized: test-project-e85d304f at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-E3gJxR/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > isProjectOpen > should return true for open project
[project-manager] Starting workflow recovery for test-project-e85d304f...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > isProjectOpen > should return true for open project
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > isProjectOpen > should return true for open project
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > isProjectOpen > should return true for open project
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > isProjectOpen > should return true for open project
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > isProjectOpen > should return true for open project
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > isProjectOpen > should return true for open project
[WakeupService] State recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > isProjectOpen > should return true for open project
[project-manager] Workflow recovery complete for test-project-e85d304f
[integration-sync] Starting for project test-project-e85d304f
[integration-sync] No enabled integrations found

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > isProjectOpen > should return true for open project
Project opened successfully: test-project-e85d304f at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-E3gJxR/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > isProjectOpen > should return true for open project
Shutting down ProjectManager...
Closing project: test-project-e85d304f
Shutting down project context: test-project-e85d304f

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > isProjectOpen > should return true for open project
[integration-sync] Stopping for project test-project-e85d304f
[integration-sync] Service stopped for test-project-e85d304f

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > isProjectOpen > should return true for open project
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-e85d304f

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > isProjectOpen > should return true for open project
Project closed: test-project-e85d304f

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > isProjectOpen > should return true for open project
ProjectManager shutdown complete

 âœ“ |@sudocode-ai/local-server| tests/integration/execution-changes.test.ts (9 tests) 7331ms
   âœ“ Execution Changes Integration Tests > Committed Changes (Scenario A) > should return file changes for completed execution with commits  1939ms
   âœ“ Execution Changes Integration Tests > Committed Changes (Scenario A) > should handle modified and deleted files  1548ms
   âœ“ Execution Changes Integration Tests > Uncommitted Changes (Scenario B) > should return uncommitted changes when after_commit equals before_commit  480ms
   âœ“ Execution Changes Integration Tests > Binary Files > should handle binary files in changes  969ms
stdout | tests/unit/services/project-manager.test.ts > ProjectManager > isProjectOpen > should return false after closing project
Initializing new database for test-project-44b81dfb at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-nrbhoy/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > isProjectOpen > should return false after closing project
Project context initialized: test-project-44b81dfb at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-nrbhoy/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > isProjectOpen > should return false after closing project
[project-manager] Starting workflow recovery for test-project-44b81dfb...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > isProjectOpen > should return false after closing project
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > isProjectOpen > should return false after closing project
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > isProjectOpen > should return false after closing project
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > isProjectOpen > should return false after closing project
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > isProjectOpen > should return false after closing project
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > isProjectOpen > should return false after closing project
[WakeupService] State recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > isProjectOpen > should return false after closing project
[project-manager] Workflow recovery complete for test-project-44b81dfb
[integration-sync] Starting for project test-project-44b81dfb
[integration-sync] No enabled integrations found

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > isProjectOpen > should return false after closing project
Project opened successfully: test-project-44b81dfb at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-nrbhoy/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > isProjectOpen > should return false after closing project
Closing project: test-project-44b81dfb
Shutting down project context: test-project-44b81dfb

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > isProjectOpen > should return false after closing project
[integration-sync] Stopping for project test-project-44b81dfb
[integration-sync] Service stopped for test-project-44b81dfb

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > isProjectOpen > should return false after closing project
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-44b81dfb

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > isProjectOpen > should return false after closing project
Database cached for test-project-44b81dfb (TTL: 1800000ms)
Project closed: test-project-44b81dfb

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > isProjectOpen > should return false after closing project
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > database caching > should reuse cached database on reopen
Initializing new database for test-project-2eed2c66 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-ibemOr/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > database caching > should reuse cached database on reopen
Project context initialized: test-project-2eed2c66 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-ibemOr/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > database caching > should reuse cached database on reopen
[project-manager] Starting workflow recovery for test-project-2eed2c66...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > database caching > should reuse cached database on reopen
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > database caching > should reuse cached database on reopen
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > database caching > should reuse cached database on reopen
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > database caching > should reuse cached database on reopen
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > database caching > should reuse cached database on reopen
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > database caching > should reuse cached database on reopen
[WakeupService] State recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > database caching > should reuse cached database on reopen
[project-manager] Workflow recovery complete for test-project-2eed2c66
[integration-sync] Starting for project test-project-2eed2c66
[integration-sync] No enabled integrations found

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > database caching > should reuse cached database on reopen
Project opened successfully: test-project-2eed2c66 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-ibemOr/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > database caching > should reuse cached database on reopen
Closing project: test-project-2eed2c66
Shutting down project context: test-project-2eed2c66

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > database caching > should reuse cached database on reopen
[integration-sync] Stopping for project test-project-2eed2c66
[integration-sync] Service stopped for test-project-2eed2c66

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > database caching > should reuse cached database on reopen
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-2eed2c66

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > database caching > should reuse cached database on reopen
Database cached for test-project-2eed2c66 (TTL: 1800000ms)
Project closed: test-project-2eed2c66

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > database caching > should reuse cached database on reopen
Using cached database for test-project-2eed2c66

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > database caching > should reuse cached database on reopen
Project context initialized: test-project-2eed2c66 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-ibemOr/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > database caching > should reuse cached database on reopen
[project-manager] Starting workflow recovery for test-project-2eed2c66...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > database caching > should reuse cached database on reopen
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > database caching > should reuse cached database on reopen
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > database caching > should reuse cached database on reopen
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > database caching > should reuse cached database on reopen
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > database caching > should reuse cached database on reopen
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > database caching > should reuse cached database on reopen
[WakeupService] State recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > database caching > should reuse cached database on reopen
[project-manager] Workflow recovery complete for test-project-2eed2c66
[integration-sync] Starting for project test-project-2eed2c66
[integration-sync] No enabled integrations found

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > database caching > should reuse cached database on reopen
Project opened successfully: test-project-2eed2c66 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-ibemOr/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > database caching > should reuse cached database on reopen
Shutting down ProjectManager...
Closing project: test-project-2eed2c66
Shutting down project context: test-project-2eed2c66

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > database caching > should reuse cached database on reopen
[integration-sync] Stopping for project test-project-2eed2c66
[integration-sync] Service stopped for test-project-2eed2c66

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > database caching > should reuse cached database on reopen
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-2eed2c66

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > database caching > should reuse cached database on reopen
Project closed: test-project-2eed2c66

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > database caching > should reuse cached database on reopen
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getSummary > should return summary of manager state
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getSummary > should include open projects in summary
Initializing new database for test-project-bcefb315 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-9HOYGn/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getSummary > should include open projects in summary
Project context initialized: test-project-bcefb315 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-9HOYGn/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getSummary > should include open projects in summary
[project-manager] Starting workflow recovery for test-project-bcefb315...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getSummary > should include open projects in summary
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getSummary > should include open projects in summary
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getSummary > should include open projects in summary
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getSummary > should include open projects in summary
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getSummary > should include open projects in summary
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getSummary > should include open projects in summary
[WakeupService] State recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getSummary > should include open projects in summary
[project-manager] Workflow recovery complete for test-project-bcefb315
[integration-sync] Starting for project test-project-bcefb315
[integration-sync] No enabled integrations found

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getSummary > should include open projects in summary
Project opened successfully: test-project-bcefb315 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-9HOYGn/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getSummary > should include open projects in summary
Shutting down ProjectManager...
Closing project: test-project-bcefb315
Shutting down project context: test-project-bcefb315

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getSummary > should include open projects in summary
[integration-sync] Stopping for project test-project-bcefb315
[integration-sync] Service stopped for test-project-bcefb315

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getSummary > should include open projects in summary
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-bcefb315

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getSummary > should include open projects in summary
Project closed: test-project-bcefb315

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getSummary > should include open projects in summary
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getSummary > should include cached databases in summary
Initializing new database for test-project-c32e6a94 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-gYlBpG/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getSummary > should include cached databases in summary
Project context initialized: test-project-c32e6a94 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-gYlBpG/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getSummary > should include cached databases in summary
[project-manager] Starting workflow recovery for test-project-c32e6a94...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getSummary > should include cached databases in summary
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getSummary > should include cached databases in summary
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getSummary > should include cached databases in summary
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getSummary > should include cached databases in summary
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getSummary > should include cached databases in summary
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getSummary > should include cached databases in summary
[WakeupService] State recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getSummary > should include cached databases in summary
[project-manager] Workflow recovery complete for test-project-c32e6a94
[integration-sync] Starting for project test-project-c32e6a94
[integration-sync] No enabled integrations found

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getSummary > should include cached databases in summary
Project opened successfully: test-project-c32e6a94 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-gYlBpG/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getSummary > should include cached databases in summary
Closing project: test-project-c32e6a94
Shutting down project context: test-project-c32e6a94

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getSummary > should include cached databases in summary
[integration-sync] Stopping for project test-project-c32e6a94
[integration-sync] Service stopped for test-project-c32e6a94

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getSummary > should include cached databases in summary
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-c32e6a94

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getSummary > should include cached databases in summary
Database cached for test-project-c32e6a94 (TTL: 1800000ms)
Project closed: test-project-c32e6a94

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > getSummary > should include cached databases in summary
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should close all open projects on shutdown
Initializing new database for test-project-4c3c76ac at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-6dda1T/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should close all open projects on shutdown
Project context initialized: test-project-4c3c76ac at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-6dda1T/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should close all open projects on shutdown
[project-manager] Starting workflow recovery for test-project-4c3c76ac...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should close all open projects on shutdown
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should close all open projects on shutdown
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should close all open projects on shutdown
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should close all open projects on shutdown
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should close all open projects on shutdown
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should close all open projects on shutdown
[WakeupService] State recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should close all open projects on shutdown
[project-manager] Workflow recovery complete for test-project-4c3c76ac
[integration-sync] Starting for project test-project-4c3c76ac
[integration-sync] No enabled integrations found

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should close all open projects on shutdown
Project opened successfully: test-project-4c3c76ac at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-6dda1T/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should close all open projects on shutdown
Shutting down ProjectManager...
Closing project: test-project-4c3c76ac
Shutting down project context: test-project-4c3c76ac

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should close all open projects on shutdown
[integration-sync] Stopping for project test-project-4c3c76ac
[integration-sync] Service stopped for test-project-4c3c76ac

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should close all open projects on shutdown
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-4c3c76ac

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should close all open projects on shutdown
Project closed: test-project-4c3c76ac

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should close all open projects on shutdown
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should close all open projects on shutdown
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should clear database cache on shutdown
Initializing new database for test-project-d54e1b24 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-oLhRTG/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should clear database cache on shutdown
Project context initialized: test-project-d54e1b24 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-oLhRTG/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should clear database cache on shutdown
[project-manager] Starting workflow recovery for test-project-d54e1b24...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should clear database cache on shutdown
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should clear database cache on shutdown
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should clear database cache on shutdown
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should clear database cache on shutdown
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should clear database cache on shutdown
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should clear database cache on shutdown
[WakeupService] State recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should clear database cache on shutdown
[project-manager] Workflow recovery complete for test-project-d54e1b24
[integration-sync] Starting for project test-project-d54e1b24
[integration-sync] No enabled integrations found

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should clear database cache on shutdown
Project opened successfully: test-project-d54e1b24 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-oLhRTG/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should clear database cache on shutdown
Closing project: test-project-d54e1b24
Shutting down project context: test-project-d54e1b24

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should clear database cache on shutdown
[integration-sync] Stopping for project test-project-d54e1b24
[integration-sync] Service stopped for test-project-d54e1b24

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should clear database cache on shutdown
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-d54e1b24

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should clear database cache on shutdown
Database cached for test-project-d54e1b24 (TTL: 1800000ms)
Project closed: test-project-d54e1b24

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should clear database cache on shutdown
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should clear database cache on shutdown
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should not cache databases when shutting down
Initializing new database for test-project-55c0d07c at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-TZc3Rv/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should not cache databases when shutting down
Project context initialized: test-project-55c0d07c at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-TZc3Rv/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should not cache databases when shutting down
[project-manager] Starting workflow recovery for test-project-55c0d07c...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should not cache databases when shutting down
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should not cache databases when shutting down
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should not cache databases when shutting down
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should not cache databases when shutting down
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should not cache databases when shutting down
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should not cache databases when shutting down
[WakeupService] State recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should not cache databases when shutting down
[project-manager] Workflow recovery complete for test-project-55c0d07c
[integration-sync] Starting for project test-project-55c0d07c
[integration-sync] No enabled integrations found

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should not cache databases when shutting down
Project opened successfully: test-project-55c0d07c at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-TZc3Rv/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should not cache databases when shutting down
Shutting down ProjectManager...
Closing project: test-project-55c0d07c
Shutting down project context: test-project-55c0d07c

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should not cache databases when shutting down
[integration-sync] Stopping for project test-project-55c0d07c
[integration-sync] Service stopped for test-project-55c0d07c

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should not cache databases when shutting down
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-55c0d07c

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should not cache databases when shutting down
Project closed: test-project-55c0d07c

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should not cache databases when shutting down
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > shutdown > should not cache databases when shutting down
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should reject non-existent path
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should reject path that is not a directory
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should successfully initialize new project
Initializing new project at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-uTYUir/init-project
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should successfully initialize new project
Initializing new database for init-project-0a2d68ca at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-uTYUir/init-project/.sudocode/cache.db

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should successfully initialize new project
Project context initialized: init-project-0a2d68ca at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-uTYUir/init-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should successfully initialize new project
[project-manager] Starting workflow recovery for init-project-0a2d68ca...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should successfully initialize new project
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should successfully initialize new project
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should successfully initialize new project
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should successfully initialize new project
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should successfully initialize new project
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should successfully initialize new project
[WakeupService] State recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should successfully initialize new project
[project-manager] Workflow recovery complete for init-project-0a2d68ca
[integration-sync] Starting for project init-project-0a2d68ca
[integration-sync] No enabled integrations found

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should successfully initialize new project
Project opened successfully: init-project-0a2d68ca at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-uTYUir/init-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should successfully initialize new project
Shutting down ProjectManager...
Closing project: init-project-0a2d68ca
Shutting down project context: init-project-0a2d68ca

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should successfully initialize new project
[integration-sync] Stopping for project init-project-0a2d68ca
[integration-sync] Service stopped for init-project-0a2d68ca

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should successfully initialize new project
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: init-project-0a2d68ca

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should successfully initialize new project
Project closed: init-project-0a2d68ca

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should successfully initialize new project
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should set project name when provided
Initializing new project at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-hQ0qoQ/named-init-project
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should set project name when provided
Initializing new database for named-init-project-de58749c at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-hQ0qoQ/named-init-project/.sudocode/cache.db

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should set project name when provided
Project context initialized: named-init-project-de58749c at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-hQ0qoQ/named-init-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should set project name when provided
[project-manager] Starting workflow recovery for named-init-project-de58749c...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should set project name when provided
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should set project name when provided
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should set project name when provided
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should set project name when provided
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should set project name when provided
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should set project name when provided
[WakeupService] State recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should set project name when provided
[project-manager] Workflow recovery complete for named-init-project-de58749c
[integration-sync] Starting for project named-init-project-de58749c
[integration-sync] No enabled integrations found

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should set project name when provided
Project opened successfully: named-init-project-de58749c at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-hQ0qoQ/named-init-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should set project name when provided
Shutting down ProjectManager...
Closing project: named-init-project-de58749c
Shutting down project context: named-init-project-de58749c

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should set project name when provided
[integration-sync] Stopping for project named-init-project-de58749c
[integration-sync] Service stopped for named-init-project-de58749c

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should set project name when provided
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: named-init-project-de58749c

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should set project name when provided
Project closed: named-init-project-de58749c

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should set project name when provided
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should open already initialized project without reinitializing
Initializing new project at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-5Y8iAY/test-project
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should open already initialized project without reinitializing
Initializing new database for test-project-3b8f7af0 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-5Y8iAY/test-project/.sudocode/cache.db

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should open already initialized project without reinitializing
Project context initialized: test-project-3b8f7af0 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-5Y8iAY/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should open already initialized project without reinitializing
[project-manager] Starting workflow recovery for test-project-3b8f7af0...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should open already initialized project without reinitializing
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should open already initialized project without reinitializing
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should open already initialized project without reinitializing
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should open already initialized project without reinitializing
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should open already initialized project without reinitializing
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should open already initialized project without reinitializing
[WakeupService] State recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should open already initialized project without reinitializing
[project-manager] Workflow recovery complete for test-project-3b8f7af0
[integration-sync] Starting for project test-project-3b8f7af0
[integration-sync] No enabled integrations found

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should open already initialized project without reinitializing
Project opened successfully: test-project-3b8f7af0 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-5Y8iAY/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should open already initialized project without reinitializing
Shutting down ProjectManager...
Closing project: test-project-3b8f7af0
Shutting down project context: test-project-3b8f7af0

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should open already initialized project without reinitializing
[integration-sync] Stopping for project test-project-3b8f7af0
[integration-sync] Service stopped for test-project-3b8f7af0

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should open already initialized project without reinitializing
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-3b8f7af0

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should open already initialized project without reinitializing
Project closed: test-project-3b8f7af0

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should open already initialized project without reinitializing
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should add initialized project to registry
Initializing new project at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-AfQHtn/registered-init-project
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should add initialized project to registry
Initializing new database for registered-init-project-13d4678a at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-AfQHtn/registered-init-project/.sudocode/cache.db

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should add initialized project to registry
Project context initialized: registered-init-project-13d4678a at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-AfQHtn/registered-init-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should add initialized project to registry
[project-manager] Starting workflow recovery for registered-init-project-13d4678a...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should add initialized project to registry
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should add initialized project to registry
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should add initialized project to registry
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should add initialized project to registry
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should add initialized project to registry
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should add initialized project to registry
[WakeupService] State recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should add initialized project to registry
[project-manager] Workflow recovery complete for registered-init-project-13d4678a
[integration-sync] Starting for project registered-init-project-13d4678a
[integration-sync] No enabled integrations found

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should add initialized project to registry
Project opened successfully: registered-init-project-13d4678a at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-AfQHtn/registered-init-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should add initialized project to registry
Shutting down ProjectManager...
Closing project: registered-init-project-13d4678a
Shutting down project context: registered-init-project-13d4678a

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should add initialized project to registry
[integration-sync] Stopping for project registered-init-project-13d4678a
[integration-sync] Service stopped for registered-init-project-13d4678a

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should add initialized project to registry
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: registered-init-project-13d4678a

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should add initialized project to registry
Project closed: registered-init-project-13d4678a

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should add initialized project to registry
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should track initialized project as open
Initializing new project at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-KfqC6c/tracked-init-project
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should track initialized project as open
Initializing new database for tracked-init-project-4ae67078 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-KfqC6c/tracked-init-project/.sudocode/cache.db

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should track initialized project as open
Project context initialized: tracked-init-project-4ae67078 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-KfqC6c/tracked-init-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should track initialized project as open
[project-manager] Starting workflow recovery for tracked-init-project-4ae67078...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should track initialized project as open
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should track initialized project as open
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should track initialized project as open
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should track initialized project as open
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should track initialized project as open
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should track initialized project as open
[WakeupService] State recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should track initialized project as open
[project-manager] Workflow recovery complete for tracked-init-project-4ae67078
[integration-sync] Starting for project tracked-init-project-4ae67078
[integration-sync] No enabled integrations found

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should track initialized project as open
Project opened successfully: tracked-init-project-4ae67078 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-KfqC6c/tracked-init-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should track initialized project as open
Shutting down ProjectManager...
Closing project: tracked-init-project-4ae67078
Shutting down project context: tracked-init-project-4ae67078

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should track initialized project as open
[integration-sync] Stopping for project tracked-init-project-4ae67078
[integration-sync] Service stopped for tracked-init-project-4ae67078

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should track initialized project as open
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: tracked-init-project-4ae67078

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should track initialized project as open
Project closed: tracked-init-project-4ae67078

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should track initialized project as open
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should create proper config.json with version and worktree settings
Initializing new project at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-QY7nxI/config-init-project
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should create proper config.json with version and worktree settings
Initializing new database for config-init-project-27331a5f at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-QY7nxI/config-init-project/.sudocode/cache.db

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should create proper config.json with version and worktree settings
Project context initialized: config-init-project-27331a5f at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-QY7nxI/config-init-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should create proper config.json with version and worktree settings
[project-manager] Starting workflow recovery for config-init-project-27331a5f...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should create proper config.json with version and worktree settings
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should create proper config.json with version and worktree settings
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should create proper config.json with version and worktree settings
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should create proper config.json with version and worktree settings
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should create proper config.json with version and worktree settings
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should create proper config.json with version and worktree settings
[WakeupService] State recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should create proper config.json with version and worktree settings
[project-manager] Workflow recovery complete for config-init-project-27331a5f
[integration-sync] Starting for project config-init-project-27331a5f
[integration-sync] No enabled integrations found

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should create proper config.json with version and worktree settings
Project opened successfully: config-init-project-27331a5f at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-QY7nxI/config-init-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should create proper config.json with version and worktree settings
Shutting down ProjectManager...
Closing project: config-init-project-27331a5f
Shutting down project context: config-init-project-27331a5f

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should create proper config.json with version and worktree settings
[integration-sync] Stopping for project config-init-project-27331a5f
[integration-sync] Service stopped for config-init-project-27331a5f

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should create proper config.json with version and worktree settings
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: config-init-project-27331a5f

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should create proper config.json with version and worktree settings
Project closed: config-init-project-27331a5f

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > initializeProject > should create proper config.json with version and worktree settings
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should initialize watcher when watchEnabled is true
Initializing new database for test-project-246803b9 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-c65qEO/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should initialize watcher when watchEnabled is true
Project context initialized: test-project-246803b9 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-c65qEO/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should initialize watcher when watchEnabled is true
[project-manager] Starting workflow recovery for test-project-246803b9...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should initialize watcher when watchEnabled is true
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should initialize watcher when watchEnabled is true
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should initialize watcher when watchEnabled is true
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should initialize watcher when watchEnabled is true
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should initialize watcher when watchEnabled is true
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should initialize watcher when watchEnabled is true
[WakeupService] State recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should initialize watcher when watchEnabled is true
[project-manager] Workflow recovery complete for test-project-246803b9
[watcher] Starting file watcher for /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-c65qEO/test-project/.sudocode
[watch] Watching directories: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-c65qEO/test-project/.sudocode/specs, /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-c65qEO/test-project/.sudocode/issues and JSONL files
[integration-sync] Starting for project test-project-246803b9
[integration-sync] No enabled integrations found

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should initialize watcher when watchEnabled is true
Project opened successfully: test-project-246803b9 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-c65qEO/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should initialize watcher when watchEnabled is true
Shutting down ProjectManager...
Closing project: test-project-246803b9
Shutting down project context: test-project-246803b9

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should initialize watcher when watchEnabled is true
[integration-sync] Stopping for project test-project-246803b9
[integration-sync] Service stopped for test-project-246803b9

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should initialize watcher when watchEnabled is true
[watcher] Stopping file watcher...
[watch] Stopping watcher...
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-246803b9
[watch] Watcher stopped
Project closed: test-project-246803b9

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should initialize watcher when watchEnabled is true
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should initialize watcher when watchEnabled is true
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should not initialize watcher when watchEnabled is false
Initializing new database for test-project-f106c61f at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-U7vCOQ/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should not initialize watcher when watchEnabled is false
Project context initialized: test-project-f106c61f at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-U7vCOQ/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should not initialize watcher when watchEnabled is false
[project-manager] Starting workflow recovery for test-project-f106c61f...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should not initialize watcher when watchEnabled is false
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should not initialize watcher when watchEnabled is false
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should not initialize watcher when watchEnabled is false
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should not initialize watcher when watchEnabled is false
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should not initialize watcher when watchEnabled is false
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should not initialize watcher when watchEnabled is false
[WakeupService] State recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should not initialize watcher when watchEnabled is false
[project-manager] Workflow recovery complete for test-project-f106c61f
[integration-sync] Starting for project test-project-f106c61f
[integration-sync] No enabled integrations found

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should not initialize watcher when watchEnabled is false
Project opened successfully: test-project-f106c61f at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-U7vCOQ/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should not initialize watcher when watchEnabled is false
Shutting down ProjectManager...
Closing project: test-project-f106c61f
Shutting down project context: test-project-f106c61f

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should not initialize watcher when watchEnabled is false
[integration-sync] Stopping for project test-project-f106c61f
[integration-sync] Service stopped for test-project-f106c61f

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should not initialize watcher when watchEnabled is false
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-f106c61f

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should not initialize watcher when watchEnabled is false
Project closed: test-project-f106c61f

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should not initialize watcher when watchEnabled is false
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should stop watcher on project close
Initializing new database for test-project-46a71858 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-1BIM8i/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should stop watcher on project close
Project context initialized: test-project-46a71858 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-1BIM8i/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should stop watcher on project close
[project-manager] Starting workflow recovery for test-project-46a71858...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should stop watcher on project close
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should stop watcher on project close
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should stop watcher on project close
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should stop watcher on project close
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should stop watcher on project close
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should stop watcher on project close
[WakeupService] State recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should stop watcher on project close
[project-manager] Workflow recovery complete for test-project-46a71858
[watcher] Starting file watcher for /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-1BIM8i/test-project/.sudocode
[watch] Watching directories: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-1BIM8i/test-project/.sudocode/specs, /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-1BIM8i/test-project/.sudocode/issues and JSONL files
[integration-sync] Starting for project test-project-46a71858
[integration-sync] No enabled integrations found

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should stop watcher on project close
Project opened successfully: test-project-46a71858 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-1BIM8i/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should stop watcher on project close
Closing project: test-project-46a71858
Shutting down project context: test-project-46a71858

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should stop watcher on project close
[integration-sync] Stopping for project test-project-46a71858
[integration-sync] Service stopped for test-project-46a71858

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should stop watcher on project close
[watcher] Stopping file watcher...
[watch] Stopping watcher...
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-46a71858
[watch] Watcher stopped
Database cached for test-project-46a71858 (TTL: 1800000ms)
Project closed: test-project-46a71858

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should stop watcher on project close
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > file watcher integration > should stop watcher on project close
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should update server URL for all open projects
Initializing new database for test-project-26ba352e at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-sv7JCa/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should update server URL for all open projects
Project context initialized: test-project-26ba352e at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-sv7JCa/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should update server URL for all open projects
[project-manager] Starting workflow recovery for test-project-26ba352e...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should update server URL for all open projects
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should update server URL for all open projects
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should update server URL for all open projects
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should update server URL for all open projects
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should update server URL for all open projects
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should update server URL for all open projects
[WakeupService] State recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should update server URL for all open projects
[project-manager] Workflow recovery complete for test-project-26ba352e
[integration-sync] Starting for project test-project-26ba352e
[integration-sync] No enabled integrations found

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should update server URL for all open projects
Project opened successfully: test-project-26ba352e at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-sv7JCa/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should update server URL for all open projects
Initializing new database for test-project-2-09217911 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-sv7JCa/test-project-2/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should update server URL for all open projects
Project context initialized: test-project-2-09217911 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-sv7JCa/test-project-2

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should update server URL for all open projects
[project-manager] Starting workflow recovery for test-project-2-09217911...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should update server URL for all open projects
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should update server URL for all open projects
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should update server URL for all open projects
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should update server URL for all open projects
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should update server URL for all open projects
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should update server URL for all open projects
[WakeupService] State recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should update server URL for all open projects
[project-manager] Workflow recovery complete for test-project-2-09217911
[integration-sync] Starting for project test-project-2-09217911
[integration-sync] No enabled integrations found

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should update server URL for all open projects
Project opened successfully: test-project-2-09217911 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-sv7JCa/test-project-2

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Full Execution Flow - Success Path > should execute full flow successfully
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully
[ExecutorFactory] Creating executor { agentType: [32m'claude-code'[39m, workDir: [32m'/tmp/test'[39m }
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m7[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mtrue[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}
[AgentExecutorWrapper] Initialized {
  agentType: [32m'claude-code'[39m,
  adapterName: [32m'claude-code'[39m,
  projectId: [32m'test-project'[39m,
  workDir: [32m'/tmp/test'[39m,
  hasTransport: [33mtrue[39m,
  hasLogsStore: [33mtrue[39m
}

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Full Execution Flow - Success Path > should execute full flow successfully
[AgentExecutorWrapper] Starting execution exec-test-1 { agentType: [32m'claude-code'[39m, taskId: [32m'task-1'[39m, workDir: [32m'/tmp/test'[39m }
[AgentExecutorWrapper] Setup AG-UI system for exec-test-1
[AgentExecutorWrapper] Connected AG-UI adapter to transport for exec-test-1
[EventBuffer] Created buffer for execution { executionId: [32m'exec-test-1'[39m, timestamp: [32m'2025-12-19T06:27:50.571Z'[39m }
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-1'[39m,
  eventType: [32m'RUN_STARTED'[39m,
  sequenceNumber: [33m0[39m,
  totalEvents: [33m1[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-1'[39m,
  eventType: [32m'RUN_STARTED'[39m,
  sequenceNumber: [33m1[39m,
  totalEvents: [33m2[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-1'[39m,
  eventType: [32m'STATE_SNAPSHOT'[39m,
  sequenceNumber: [33m2[39m,
  totalEvents: [33m3[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-1'[39m,
  eventType: [32m'STATE_SNAPSHOT'[39m,
  sequenceNumber: [33m3[39m,
  totalEvents: [33m4[39m
}
[AgentExecutorWrapper] Task metadata for exec-test-1: {
  agentType: [32m'claude-code'[39m,
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  resume: [90mundefined[39m
}
[AgentExecutorWrapper] Spawning claude-code process for exec-test-1 { taskId: [32m'task-1'[39m, workDir: [32m'/tmp/test'[39m, promptLength: [33m11[39m }

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Full Execution Flow - Success Path > should execute full flow successfully
[AgentExecutorWrapper] claude-code process spawned for exec-test-1 { pid: [90mundefined[39m, spawnfile: [90mundefined[39m }
[AgentExecutorWrapper] Processing normalized output for exec-test-1

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Full Execution Flow - Success Path > should execute full flow successfully
[AgentExecutorWrapper] Entry 1 for exec-test-1: {
  index: [33m0[39m,
  kind: [32m'assistant_message'[39m,
  timestamp: [35m2025-12-19T06:27:50.566Z[39m,
  hasMetadata: [33mfalse[39m,
  sessionId: [90mundefined[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-1'[39m,
  eventType: [32m'TEXT_MESSAGE_START'[39m,
  sequenceNumber: [33m4[39m,
  totalEvents: [33m5[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-1'[39m,
  eventType: [32m'TEXT_MESSAGE_START'[39m,
  sequenceNumber: [33m5[39m,
  totalEvents: [33m6[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-1'[39m,
  eventType: [32m'TEXT_MESSAGE_CONTENT'[39m,
  sequenceNumber: [33m6[39m,
  totalEvents: [33m7[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-1'[39m,
  eventType: [32m'TEXT_MESSAGE_CONTENT'[39m,
  sequenceNumber: [33m7[39m,
  totalEvents: [33m8[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-1'[39m,
  eventType: [32m'TEXT_MESSAGE_END'[39m,
  sequenceNumber: [33m8[39m,
  totalEvents: [33m9[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-1'[39m,
  eventType: [32m'TEXT_MESSAGE_END'[39m,
  sequenceNumber: [33m9[39m,
  totalEvents: [33m10[39m
}

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Full Execution Flow - Success Path > should execute full flow successfully
[AgentExecutorWrapper] Entry 2 for exec-test-1: {
  index: [33m1[39m,
  kind: [32m'tool_use'[39m,
  timestamp: [35m2025-12-19T06:27:50.566Z[39m,
  hasMetadata: [33mfalse[39m,
  sessionId: [90mundefined[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-1'[39m,
  eventType: [32m'TOOL_CALL_START'[39m,
  sequenceNumber: [33m10[39m,
  totalEvents: [33m11[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-1'[39m,
  eventType: [32m'TOOL_CALL_START'[39m,
  sequenceNumber: [33m11[39m,
  totalEvents: [33m12[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-1'[39m,
  eventType: [32m'TOOL_CALL_ARGS'[39m,
  sequenceNumber: [33m12[39m,
  totalEvents: [33m13[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-1'[39m,
  eventType: [32m'TOOL_CALL_ARGS'[39m,
  sequenceNumber: [33m13[39m,
  totalEvents: [33m14[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-1'[39m,
  eventType: [32m'TOOL_CALL_END'[39m,
  sequenceNumber: [33m14[39m,
  totalEvents: [33m15[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-1'[39m,
  eventType: [32m'TOOL_CALL_END'[39m,
  sequenceNumber: [33m15[39m,
  totalEvents: [33m16[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-1'[39m,
  eventType: [32m'TOOL_CALL_RESULT'[39m,
  sequenceNumber: [33m16[39m,
  totalEvents: [33m17[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-1'[39m,
  eventType: [32m'TOOL_CALL_RESULT'[39m,
  sequenceNumber: [33m17[39m,
  totalEvents: [33m18[39m
}

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Full Execution Flow - Success Path > should execute full flow successfully
[AgentExecutorWrapper] Entry 3 for exec-test-1: {
  index: [33m2[39m,
  kind: [32m'assistant_message'[39m,
  timestamp: [35m2025-12-19T06:27:50.566Z[39m,
  hasMetadata: [33mfalse[39m,
  sessionId: [90mundefined[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-1'[39m,
  eventType: [32m'TEXT_MESSAGE_START'[39m,
  sequenceNumber: [33m18[39m,
  totalEvents: [33m19[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-1'[39m,
  eventType: [32m'TEXT_MESSAGE_START'[39m,
  sequenceNumber: [33m19[39m,
  totalEvents: [33m20[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-1'[39m,
  eventType: [32m'TEXT_MESSAGE_CONTENT'[39m,
  sequenceNumber: [33m20[39m,
  totalEvents: [33m21[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-1'[39m,
  eventType: [32m'TEXT_MESSAGE_CONTENT'[39m,
  sequenceNumber: [33m21[39m,
  totalEvents: [33m22[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-1'[39m,
  eventType: [32m'TEXT_MESSAGE_END'[39m,
  sequenceNumber: [33m22[39m,
  totalEvents: [33m23[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-1'[39m,
  eventType: [32m'TEXT_MESSAGE_END'[39m,
  sequenceNumber: [33m23[39m,
  totalEvents: [33m24[39m
}

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Full Execution Flow - Success Path > should execute full flow successfully
[AgentExecutorWrapper] Finished processing 3 entries for exec-test-1

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Full Execution Flow - Success Path > should execute full flow successfully
[AgentExecutorWrapper] Output processing completed for exec-test-1
[AgentExecutorWrapper] Closed stdin for Claude Code process exec-test-1

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should update server URL for all open projects
Server URL updated to http://localhost:3005 for 2 projects

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should update server URL for all open projects
Shutting down ProjectManager...
Closing project: test-project-26ba352e
Shutting down project context: test-project-26ba352e

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should update server URL for all open projects
[integration-sync] Stopping for project test-project-26ba352e
[integration-sync] Service stopped for test-project-26ba352e

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should update server URL for all open projects
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-26ba352e

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should update server URL for all open projects
Project closed: test-project-26ba352e

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should update server URL for all open projects
Closing project: test-project-2-09217911
Shutting down project context: test-project-2-09217911

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should update server URL for all open projects
[integration-sync] Stopping for project test-project-2-09217911
[integration-sync] Service stopped for test-project-2-09217911

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should update server URL for all open projects
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-2-09217911

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should update server URL for all open projects
Project closed: test-project-2-09217911

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should update server URL for all open projects
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should handle empty projects list gracefully
Server URL updated to http://localhost:3005 for 0 projects

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should handle empty projects list gracefully
Shutting down ProjectManager...
ProjectManager shutdown complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should propagate URL to project contexts
Initializing new database for test-project-121fd0b8 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-2igSDA/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should propagate URL to project contexts
Project context initialized: test-project-121fd0b8 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-2igSDA/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should propagate URL to project contexts
[project-manager] Starting workflow recovery for test-project-121fd0b8...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should propagate URL to project contexts
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should propagate URL to project contexts
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should propagate URL to project contexts
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should propagate URL to project contexts
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should propagate URL to project contexts
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should propagate URL to project contexts
[WakeupService] State recovery complete

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should propagate URL to project contexts
[project-manager] Workflow recovery complete for test-project-121fd0b8
[integration-sync] Starting for project test-project-121fd0b8
[integration-sync] No enabled integrations found

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should propagate URL to project contexts
Project opened successfully: test-project-121fd0b8 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-pm-test-2igSDA/test-project

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should propagate URL to project contexts
Server URL updated to http://localhost:3005 for 1 projects

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should propagate URL to project contexts
Shutting down ProjectManager...
Closing project: test-project-121fd0b8
Shutting down project context: test-project-121fd0b8

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should propagate URL to project contexts
[integration-sync] Stopping for project test-project-121fd0b8
[integration-sync] Service stopped for test-project-121fd0b8

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should propagate URL to project contexts
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-121fd0b8

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should propagate URL to project contexts
Project closed: test-project-121fd0b8

stdout | tests/unit/services/project-manager.test.ts > ProjectManager > updateServerUrl > should propagate URL to project contexts
ProjectManager shutdown complete

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Full Execution Flow - Success Path > should execute full flow successfully
[AgentExecutorWrapper] Process exited with code 0 for exec-test-1

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Full Execution Flow - Success Path > should execute full flow successfully
[AgentExecutorWrapper] Execution exec-test-1 completed successfully
[ExecutionChangesService] Execution exec-test-1: {
  status: [32m'running'[39m,
  before_commit: [1mnull[22m,
  after_commit: [1mnull[22m,
  parent_execution_id: [1mnull[22m
}
[ExecutionChangesService] Root execution exec-test-1: { before_commit: [1mnull[22m, after_commit: [1mnull[22m }
[ExecutionChangesService] Computed beforeCommit: null

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Full Execution Flow - Success Path > should execute full flow successfully
[AgentExecutorWrapper] No file changes detected for execution exec-test-1: missing_commits

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Full Execution Flow - Success Path > should execute full flow successfully
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-1'[39m,
  eventType: [32m'RUN_FINISHED'[39m,
  sequenceNumber: [33m24[39m,
  totalEvents: [33m25[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-1'[39m,
  eventType: [32m'RUN_FINISHED'[39m,
  sequenceNumber: [33m25[39m,
  totalEvents: [33m26[39m
}
[AgentExecutorWrapper] Disconnected AG-UI adapter for exec-test-1

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Full Execution Flow - Success Path > should process all entry types correctly
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully
[ExecutorFactory] Creating executor { agentType: [32m'claude-code'[39m, workDir: [32m'/tmp/test'[39m }
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m7[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mtrue[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}
[AgentExecutorWrapper] Initialized {
  agentType: [32m'claude-code'[39m,
  adapterName: [32m'claude-code'[39m,
  projectId: [32m'test-project'[39m,
  workDir: [32m'/tmp/test'[39m,
  hasTransport: [33mtrue[39m,
  hasLogsStore: [33mtrue[39m
}

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Full Execution Flow - Success Path > should process all entry types correctly
[AgentExecutorWrapper] Starting execution exec-test-all-types {
  agentType: [32m'claude-code'[39m,
  taskId: [32m'task-test-1'[39m,
  workDir: [32m'/tmp/test'[39m
}
[AgentExecutorWrapper] Setup AG-UI system for exec-test-all-types
[AgentExecutorWrapper] Connected AG-UI adapter to transport for exec-test-all-types
[EventBuffer] Created buffer for execution {
  executionId: [32m'exec-test-all-types'[39m,
  timestamp: [32m'2025-12-19T06:27:50.677Z'[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-all-types'[39m,
  eventType: [32m'RUN_STARTED'[39m,
  sequenceNumber: [33m0[39m,
  totalEvents: [33m1[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-all-types'[39m,
  eventType: [32m'RUN_STARTED'[39m,
  sequenceNumber: [33m1[39m,
  totalEvents: [33m2[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-all-types'[39m,
  eventType: [32m'STATE_SNAPSHOT'[39m,
  sequenceNumber: [33m2[39m,
  totalEvents: [33m3[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-all-types'[39m,
  eventType: [32m'STATE_SNAPSHOT'[39m,
  sequenceNumber: [33m3[39m,
  totalEvents: [33m4[39m
}
[AgentExecutorWrapper] Task metadata for exec-test-all-types: {
  agentType: [32m'claude-code'[39m,
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  resume: [90mundefined[39m
}
[AgentExecutorWrapper] Spawning claude-code process for exec-test-all-types { taskId: [32m'task-test-1'[39m, workDir: [32m'/tmp/test'[39m, promptLength: [33m11[39m }

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Full Execution Flow - Success Path > should process all entry types correctly
[AgentExecutorWrapper] claude-code process spawned for exec-test-all-types { pid: [90mundefined[39m, spawnfile: [90mundefined[39m }
[AgentExecutorWrapper] Processing normalized output for exec-test-all-types

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Full Execution Flow - Success Path > should process all entry types correctly
[AgentExecutorWrapper] Entry 1 for exec-test-all-types: {
  index: [33m0[39m,
  kind: [32m'assistant_message'[39m,
  timestamp: [35m2025-12-19T06:27:50.677Z[39m,
  hasMetadata: [33mfalse[39m,
  sessionId: [90mundefined[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-all-types'[39m,
  eventType: [32m'TEXT_MESSAGE_START'[39m,
  sequenceNumber: [33m4[39m,
  totalEvents: [33m5[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-all-types'[39m,
  eventType: [32m'TEXT_MESSAGE_START'[39m,
  sequenceNumber: [33m5[39m,
  totalEvents: [33m6[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-all-types'[39m,
  eventType: [32m'TEXT_MESSAGE_CONTENT'[39m,
  sequenceNumber: [33m6[39m,
  totalEvents: [33m7[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-all-types'[39m,
  eventType: [32m'TEXT_MESSAGE_CONTENT'[39m,
  sequenceNumber: [33m7[39m,
  totalEvents: [33m8[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-all-types'[39m,
  eventType: [32m'TEXT_MESSAGE_END'[39m,
  sequenceNumber: [33m8[39m,
  totalEvents: [33m9[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-all-types'[39m,
  eventType: [32m'TEXT_MESSAGE_END'[39m,
  sequenceNumber: [33m9[39m,
  totalEvents: [33m10[39m
}

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Full Execution Flow - Success Path > should process all entry types correctly
[AgentExecutorWrapper] Entry 2 for exec-test-all-types: {
  index: [33m1[39m,
  kind: [32m'thinking'[39m,
  timestamp: [35m2025-12-19T06:27:50.677Z[39m,
  hasMetadata: [33mfalse[39m,
  sessionId: [90mundefined[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-all-types'[39m,
  eventType: [32m'TEXT_MESSAGE_START'[39m,
  sequenceNumber: [33m10[39m,
  totalEvents: [33m11[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-all-types'[39m,
  eventType: [32m'TEXT_MESSAGE_START'[39m,
  sequenceNumber: [33m11[39m,
  totalEvents: [33m12[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-all-types'[39m,
  eventType: [32m'TEXT_MESSAGE_CONTENT'[39m,
  sequenceNumber: [33m12[39m,
  totalEvents: [33m13[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-all-types'[39m,
  eventType: [32m'TEXT_MESSAGE_CONTENT'[39m,
  sequenceNumber: [33m13[39m,
  totalEvents: [33m14[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-all-types'[39m,
  eventType: [32m'TEXT_MESSAGE_END'[39m,
  sequenceNumber: [33m14[39m,
  totalEvents: [33m15[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-all-types'[39m,
  eventType: [32m'TEXT_MESSAGE_END'[39m,
  sequenceNumber: [33m15[39m,
  totalEvents: [33m16[39m
}

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Full Execution Flow - Success Path > should process all entry types correctly
[AgentExecutorWrapper] Entry 3 for exec-test-all-types: {
  index: [33m2[39m,
  kind: [32m'system_message'[39m,
  timestamp: [35m2025-12-19T06:27:50.677Z[39m,
  hasMetadata: [33mfalse[39m,
  sessionId: [90mundefined[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-all-types'[39m,
  eventType: [32m'TEXT_MESSAGE_START'[39m,
  sequenceNumber: [33m16[39m,
  totalEvents: [33m17[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-all-types'[39m,
  eventType: [32m'TEXT_MESSAGE_START'[39m,
  sequenceNumber: [33m17[39m,
  totalEvents: [33m18[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-all-types'[39m,
  eventType: [32m'TEXT_MESSAGE_CONTENT'[39m,
  sequenceNumber: [33m18[39m,
  totalEvents: [33m19[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-all-types'[39m,
  eventType: [32m'TEXT_MESSAGE_CONTENT'[39m,
  sequenceNumber: [33m19[39m,
  totalEvents: [33m20[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-all-types'[39m,
  eventType: [32m'TEXT_MESSAGE_END'[39m,
  sequenceNumber: [33m20[39m,
  totalEvents: [33m21[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-all-types'[39m,
  eventType: [32m'TEXT_MESSAGE_END'[39m,
  sequenceNumber: [33m21[39m,
  totalEvents: [33m22[39m
}

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Full Execution Flow - Success Path > should process all entry types correctly
[AgentExecutorWrapper] Entry 4 for exec-test-all-types: {
  index: [33m3[39m,
  kind: [32m'error'[39m,
  timestamp: [35m2025-12-19T06:27:50.677Z[39m,
  hasMetadata: [33mfalse[39m,
  sessionId: [90mundefined[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-all-types'[39m,
  eventType: [32m'RUN_ERROR'[39m,
  sequenceNumber: [33m22[39m,
  totalEvents: [33m23[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-all-types'[39m,
  eventType: [32m'RUN_ERROR'[39m,
  sequenceNumber: [33m23[39m,
  totalEvents: [33m24[39m
}

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Full Execution Flow - Success Path > should process all entry types correctly
[AgentExecutorWrapper] Entry 5 for exec-test-all-types: {
  index: [33m4[39m,
  kind: [32m'user_message'[39m,
  timestamp: [35m2025-12-19T06:27:50.677Z[39m,
  hasMetadata: [33mfalse[39m,
  sessionId: [90mundefined[39m
}

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Full Execution Flow - Success Path > should process all entry types correctly
[AgentExecutorWrapper] Finished processing 5 entries for exec-test-all-types

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Full Execution Flow - Success Path > should process all entry types correctly
[AgentExecutorWrapper] Output processing completed for exec-test-all-types
[AgentExecutorWrapper] Closed stdin for Claude Code process exec-test-all-types

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Full Execution Flow - Success Path > should process all entry types correctly
[AgentExecutorWrapper] Process exited with code 0 for exec-test-all-types

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Full Execution Flow - Success Path > should process all entry types correctly
[AgentExecutorWrapper] Execution exec-test-all-types completed successfully
[ExecutionChangesService] Execution exec-test-all-types: {
  status: [32m'running'[39m,
  before_commit: [1mnull[22m,
  after_commit: [1mnull[22m,
  parent_execution_id: [1mnull[22m
}
[ExecutionChangesService] Root execution exec-test-all-types: { before_commit: [1mnull[22m, after_commit: [1mnull[22m }
[ExecutionChangesService] Computed beforeCommit: null

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Full Execution Flow - Success Path > should process all entry types correctly
[AgentExecutorWrapper] No file changes detected for execution exec-test-all-types: missing_commits

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Full Execution Flow - Success Path > should process all entry types correctly
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-all-types'[39m,
  eventType: [32m'RUN_FINISHED'[39m,
  sequenceNumber: [33m24[39m,
  totalEvents: [33m25[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-all-types'[39m,
  eventType: [32m'RUN_FINISHED'[39m,
  sequenceNumber: [33m25[39m,
  totalEvents: [33m26[39m
}
[AgentExecutorWrapper] Disconnected AG-UI adapter for exec-test-all-types

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Error Handling > should handle process spawn errors gracefully
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully
[ExecutorFactory] Creating executor { agentType: [32m'claude-code'[39m, workDir: [32m'/tmp/test'[39m }
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m7[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mtrue[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}
[AgentExecutorWrapper] Initialized {
  agentType: [32m'claude-code'[39m,
  adapterName: [32m'claude-code'[39m,
  projectId: [32m'test-project'[39m,
  workDir: [32m'/tmp/test'[39m,
  hasTransport: [33mtrue[39m,
  hasLogsStore: [33mtrue[39m
}

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Error Handling > should handle process spawn errors gracefully
[AgentExecutorWrapper] Starting execution exec-test-spawn-error {
  agentType: [32m'claude-code'[39m,
  taskId: [32m'task-test-1'[39m,
  workDir: [32m'/tmp/test'[39m
}
[AgentExecutorWrapper] Setup AG-UI system for exec-test-spawn-error
[AgentExecutorWrapper] Connected AG-UI adapter to transport for exec-test-spawn-error
[EventBuffer] Created buffer for execution {
  executionId: [32m'exec-test-spawn-error'[39m,
  timestamp: [32m'2025-12-19T06:27:50.817Z'[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-spawn-error'[39m,
  eventType: [32m'RUN_STARTED'[39m,
  sequenceNumber: [33m0[39m,
  totalEvents: [33m1[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-spawn-error'[39m,
  eventType: [32m'RUN_STARTED'[39m,
  sequenceNumber: [33m1[39m,
  totalEvents: [33m2[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-spawn-error'[39m,
  eventType: [32m'STATE_SNAPSHOT'[39m,
  sequenceNumber: [33m2[39m,
  totalEvents: [33m3[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-spawn-error'[39m,
  eventType: [32m'STATE_SNAPSHOT'[39m,
  sequenceNumber: [33m3[39m,
  totalEvents: [33m4[39m
}
[AgentExecutorWrapper] Task metadata for exec-test-spawn-error: {
  agentType: [32m'claude-code'[39m,
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  resume: [90mundefined[39m
}
[AgentExecutorWrapper] Spawning claude-code process for exec-test-spawn-error { taskId: [32m'task-test-1'[39m, workDir: [32m'/tmp/test'[39m, promptLength: [33m11[39m }

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Error Handling > should handle process spawn errors gracefully
[ExecutionChangesService] Execution exec-test-spawn-error: {
  status: [32m'running'[39m,
  before_commit: [1mnull[22m,
  after_commit: [1mnull[22m,
  parent_execution_id: [1mnull[22m
}
[ExecutionChangesService] Root execution exec-test-spawn-error: { before_commit: [1mnull[22m, after_commit: [1mnull[22m }
[ExecutionChangesService] Computed beforeCommit: null

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Error Handling > should handle process spawn errors gracefully
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-spawn-error'[39m,
  eventType: [32m'RUN_ERROR'[39m,
  sequenceNumber: [33m4[39m,
  totalEvents: [33m5[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-spawn-error'[39m,
  eventType: [32m'RUN_ERROR'[39m,
  sequenceNumber: [33m5[39m,
  totalEvents: [33m6[39m
}
[AgentExecutorWrapper] Disconnected AG-UI adapter for exec-test-spawn-error

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Error Handling > should handle process crash errors gracefully
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully
[ExecutorFactory] Creating executor { agentType: [32m'claude-code'[39m, workDir: [32m'/tmp/test'[39m }
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m7[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mtrue[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}
[AgentExecutorWrapper] Initialized {
  agentType: [32m'claude-code'[39m,
  adapterName: [32m'claude-code'[39m,
  projectId: [32m'test-project'[39m,
  workDir: [32m'/tmp/test'[39m,
  hasTransport: [33mtrue[39m,
  hasLogsStore: [33mtrue[39m
}

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Error Handling > should handle process crash errors gracefully
[AgentExecutorWrapper] Starting execution exec-test-crash {
  agentType: [32m'claude-code'[39m,
  taskId: [32m'task-test-1'[39m,
  workDir: [32m'/tmp/test'[39m
}
[AgentExecutorWrapper] Setup AG-UI system for exec-test-crash
[AgentExecutorWrapper] Connected AG-UI adapter to transport for exec-test-crash
[EventBuffer] Created buffer for execution {
  executionId: [32m'exec-test-crash'[39m,
  timestamp: [32m'2025-12-19T06:27:50.872Z'[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-crash'[39m,
  eventType: [32m'RUN_STARTED'[39m,
  sequenceNumber: [33m0[39m,
  totalEvents: [33m1[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-crash'[39m,
  eventType: [32m'RUN_STARTED'[39m,
  sequenceNumber: [33m1[39m,
  totalEvents: [33m2[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-crash'[39m,
  eventType: [32m'STATE_SNAPSHOT'[39m,
  sequenceNumber: [33m2[39m,
  totalEvents: [33m3[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-crash'[39m,
  eventType: [32m'STATE_SNAPSHOT'[39m,
  sequenceNumber: [33m3[39m,
  totalEvents: [33m4[39m
}
[AgentExecutorWrapper] Task metadata for exec-test-crash: {
  agentType: [32m'claude-code'[39m,
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  resume: [90mundefined[39m
}
[AgentExecutorWrapper] Spawning claude-code process for exec-test-crash { taskId: [32m'task-test-1'[39m, workDir: [32m'/tmp/test'[39m, promptLength: [33m11[39m }

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Error Handling > should handle process crash errors gracefully
[AgentExecutorWrapper] claude-code process spawned for exec-test-crash { pid: [90mundefined[39m, spawnfile: [90mundefined[39m }
[AgentExecutorWrapper] Processing normalized output for exec-test-crash

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Error Handling > should handle process crash errors gracefully
[AgentExecutorWrapper] Finished processing 0 entries for exec-test-crash

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Error Handling > should handle process crash errors gracefully
[AgentExecutorWrapper] Output processing completed for exec-test-crash
[AgentExecutorWrapper] Closed stdin for Claude Code process exec-test-crash

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Error Handling > should handle process crash errors gracefully
[AgentExecutorWrapper] Process exited with code 1 for exec-test-crash

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Error Handling > should handle process crash errors gracefully
[ExecutionChangesService] Execution exec-test-crash: {
  status: [32m'running'[39m,
  before_commit: [1mnull[22m,
  after_commit: [1mnull[22m,
  parent_execution_id: [1mnull[22m
}
[ExecutionChangesService] Root execution exec-test-crash: { before_commit: [1mnull[22m, after_commit: [1mnull[22m }
[ExecutionChangesService] Computed beforeCommit: null

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Error Handling > should handle process crash errors gracefully
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-crash'[39m,
  eventType: [32m'RUN_ERROR'[39m,
  sequenceNumber: [33m4[39m,
  totalEvents: [33m5[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-crash'[39m,
  eventType: [32m'RUN_ERROR'[39m,
  sequenceNumber: [33m5[39m,
  totalEvents: [33m6[39m
}
[AgentExecutorWrapper] Disconnected AG-UI adapter for exec-test-crash

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Error Handling > should handle non-zero exit codes
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully
[ExecutorFactory] Creating executor { agentType: [32m'claude-code'[39m, workDir: [32m'/tmp/test'[39m }
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m7[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mtrue[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}
[AgentExecutorWrapper] Initialized {
  agentType: [32m'claude-code'[39m,
  adapterName: [32m'claude-code'[39m,
  projectId: [32m'test-project'[39m,
  workDir: [32m'/tmp/test'[39m,
  hasTransport: [33mtrue[39m,
  hasLogsStore: [33mtrue[39m
}

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Error Handling > should handle non-zero exit codes
[AgentExecutorWrapper] Starting execution exec-test-exit-code {
  agentType: [32m'claude-code'[39m,
  taskId: [32m'task-test-1'[39m,
  workDir: [32m'/tmp/test'[39m
}
[AgentExecutorWrapper] Setup AG-UI system for exec-test-exit-code
[AgentExecutorWrapper] Connected AG-UI adapter to transport for exec-test-exit-code
[EventBuffer] Created buffer for execution {
  executionId: [32m'exec-test-exit-code'[39m,
  timestamp: [32m'2025-12-19T06:27:50.912Z'[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-exit-code'[39m,
  eventType: [32m'RUN_STARTED'[39m,
  sequenceNumber: [33m0[39m,
  totalEvents: [33m1[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-exit-code'[39m,
  eventType: [32m'RUN_STARTED'[39m,
  sequenceNumber: [33m1[39m,
  totalEvents: [33m2[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-exit-code'[39m,
  eventType: [32m'STATE_SNAPSHOT'[39m,
  sequenceNumber: [33m2[39m,
  totalEvents: [33m3[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-exit-code'[39m,
  eventType: [32m'STATE_SNAPSHOT'[39m,
  sequenceNumber: [33m3[39m,
  totalEvents: [33m4[39m
}
[AgentExecutorWrapper] Task metadata for exec-test-exit-code: {
  agentType: [32m'claude-code'[39m,
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  resume: [90mundefined[39m
}
[AgentExecutorWrapper] Spawning claude-code process for exec-test-exit-code { taskId: [32m'task-test-1'[39m, workDir: [32m'/tmp/test'[39m, promptLength: [33m11[39m }

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Error Handling > should handle non-zero exit codes
[AgentExecutorWrapper] claude-code process spawned for exec-test-exit-code { pid: [90mundefined[39m, spawnfile: [90mundefined[39m }
[AgentExecutorWrapper] Processing normalized output for exec-test-exit-code

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Error Handling > should handle non-zero exit codes
[AgentExecutorWrapper] Finished processing 0 entries for exec-test-exit-code

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Error Handling > should handle non-zero exit codes
[AgentExecutorWrapper] Output processing completed for exec-test-exit-code
[AgentExecutorWrapper] Closed stdin for Claude Code process exec-test-exit-code

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Error Handling > should handle non-zero exit codes
[AgentExecutorWrapper] Process exited with code 1 for exec-test-exit-code

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Error Handling > should handle non-zero exit codes
[ExecutionChangesService] Execution exec-test-exit-code: {
  status: [32m'running'[39m,
  before_commit: [1mnull[22m,
  after_commit: [1mnull[22m,
  parent_execution_id: [1mnull[22m
}
[ExecutionChangesService] Root execution exec-test-exit-code: { before_commit: [1mnull[22m, after_commit: [1mnull[22m }
[ExecutionChangesService] Computed beforeCommit: null

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Error Handling > should handle non-zero exit codes
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-exit-code'[39m,
  eventType: [32m'RUN_ERROR'[39m,
  sequenceNumber: [33m4[39m,
  totalEvents: [33m5[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-exit-code'[39m,
  eventType: [32m'RUN_ERROR'[39m,
  sequenceNumber: [33m5[39m,
  totalEvents: [33m6[39m
}
[AgentExecutorWrapper] Disconnected AG-UI adapter for exec-test-exit-code

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Error Handling > should continue processing on individual entry errors
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully
[ExecutorFactory] Creating executor { agentType: [32m'claude-code'[39m, workDir: [32m'/tmp/test'[39m }
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m7[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mtrue[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}
[AgentExecutorWrapper] Initialized {
  agentType: [32m'claude-code'[39m,
  adapterName: [32m'claude-code'[39m,
  projectId: [32m'test-project'[39m,
  workDir: [32m'/tmp/test'[39m,
  hasTransport: [33mtrue[39m,
  hasLogsStore: [33mtrue[39m
}

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Error Handling > should continue processing on individual entry errors
[AgentExecutorWrapper] Starting execution exec-test-entry-error {
  agentType: [32m'claude-code'[39m,
  taskId: [32m'task-test-1'[39m,
  workDir: [32m'/tmp/test'[39m
}
[AgentExecutorWrapper] Setup AG-UI system for exec-test-entry-error
[AgentExecutorWrapper] Connected AG-UI adapter to transport for exec-test-entry-error
[EventBuffer] Created buffer for execution {
  executionId: [32m'exec-test-entry-error'[39m,
  timestamp: [32m'2025-12-19T06:27:50.934Z'[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-entry-error'[39m,
  eventType: [32m'RUN_STARTED'[39m,
  sequenceNumber: [33m0[39m,
  totalEvents: [33m1[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-entry-error'[39m,
  eventType: [32m'RUN_STARTED'[39m,
  sequenceNumber: [33m1[39m,
  totalEvents: [33m2[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-entry-error'[39m,
  eventType: [32m'STATE_SNAPSHOT'[39m,
  sequenceNumber: [33m2[39m,
  totalEvents: [33m3[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-entry-error'[39m,
  eventType: [32m'STATE_SNAPSHOT'[39m,
  sequenceNumber: [33m3[39m,
  totalEvents: [33m4[39m
}
[AgentExecutorWrapper] Task metadata for exec-test-entry-error: {
  agentType: [32m'claude-code'[39m,
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  resume: [90mundefined[39m
}
[AgentExecutorWrapper] Spawning claude-code process for exec-test-entry-error { taskId: [32m'task-test-1'[39m, workDir: [32m'/tmp/test'[39m, promptLength: [33m11[39m }

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Error Handling > should continue processing on individual entry errors
[AgentExecutorWrapper] claude-code process spawned for exec-test-entry-error { pid: [90mundefined[39m, spawnfile: [90mundefined[39m }
[AgentExecutorWrapper] Processing normalized output for exec-test-entry-error

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Error Handling > should continue processing on individual entry errors
[AgentExecutorWrapper] Entry 1 for exec-test-entry-error: {
  index: [33m0[39m,
  kind: [32m'assistant_message'[39m,
  timestamp: [35m2025-12-19T06:27:50.934Z[39m,
  hasMetadata: [33mfalse[39m,
  sessionId: [90mundefined[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-entry-error'[39m,
  eventType: [32m'TEXT_MESSAGE_START'[39m,
  sequenceNumber: [33m4[39m,
  totalEvents: [33m5[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-entry-error'[39m,
  eventType: [32m'TEXT_MESSAGE_START'[39m,
  sequenceNumber: [33m5[39m,
  totalEvents: [33m6[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-entry-error'[39m,
  eventType: [32m'TEXT_MESSAGE_CONTENT'[39m,
  sequenceNumber: [33m6[39m,
  totalEvents: [33m7[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-entry-error'[39m,
  eventType: [32m'TEXT_MESSAGE_CONTENT'[39m,
  sequenceNumber: [33m7[39m,
  totalEvents: [33m8[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-entry-error'[39m,
  eventType: [32m'TEXT_MESSAGE_END'[39m,
  sequenceNumber: [33m8[39m,
  totalEvents: [33m9[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-entry-error'[39m,
  eventType: [32m'TEXT_MESSAGE_END'[39m,
  sequenceNumber: [33m9[39m,
  totalEvents: [33m10[39m
}

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Error Handling > should continue processing on individual entry errors
[AgentExecutorWrapper] Entry 2 for exec-test-entry-error: {
  index: [33m1[39m,
  kind: [32m'assistant_message'[39m,
  timestamp: [35m2025-12-19T06:27:50.934Z[39m,
  hasMetadata: [33mfalse[39m,
  sessionId: [90mundefined[39m
}

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Error Handling > should continue processing on individual entry errors
[AgentExecutorWrapper] Entry 3 for exec-test-entry-error: {
  index: [33m2[39m,
  kind: [32m'assistant_message'[39m,
  timestamp: [35m2025-12-19T06:27:50.934Z[39m,
  hasMetadata: [33mfalse[39m,
  sessionId: [90mundefined[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-entry-error'[39m,
  eventType: [32m'TEXT_MESSAGE_START'[39m,
  sequenceNumber: [33m10[39m,
  totalEvents: [33m11[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-entry-error'[39m,
  eventType: [32m'TEXT_MESSAGE_START'[39m,
  sequenceNumber: [33m11[39m,
  totalEvents: [33m12[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-entry-error'[39m,
  eventType: [32m'TEXT_MESSAGE_CONTENT'[39m,
  sequenceNumber: [33m12[39m,
  totalEvents: [33m13[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-entry-error'[39m,
  eventType: [32m'TEXT_MESSAGE_CONTENT'[39m,
  sequenceNumber: [33m13[39m,
  totalEvents: [33m14[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-entry-error'[39m,
  eventType: [32m'TEXT_MESSAGE_END'[39m,
  sequenceNumber: [33m14[39m,
  totalEvents: [33m15[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-entry-error'[39m,
  eventType: [32m'TEXT_MESSAGE_END'[39m,
  sequenceNumber: [33m15[39m,
  totalEvents: [33m16[39m
}

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Error Handling > should continue processing on individual entry errors
[AgentExecutorWrapper] Finished processing 3 entries for exec-test-entry-error

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Error Handling > should continue processing on individual entry errors
[AgentExecutorWrapper] Output processing completed for exec-test-entry-error
[AgentExecutorWrapper] Closed stdin for Claude Code process exec-test-entry-error

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Error Handling > should continue processing on individual entry errors
[AgentExecutorWrapper] Process exited with code 0 for exec-test-entry-error

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Error Handling > should continue processing on individual entry errors
[AgentExecutorWrapper] Execution exec-test-entry-error completed successfully
[ExecutionChangesService] Execution exec-test-entry-error: {
  status: [32m'running'[39m,
  before_commit: [1mnull[22m,
  after_commit: [1mnull[22m,
  parent_execution_id: [1mnull[22m
}
[ExecutionChangesService] Root execution exec-test-entry-error: { before_commit: [1mnull[22m, after_commit: [1mnull[22m }
[ExecutionChangesService] Computed beforeCommit: null

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Error Handling > should continue processing on individual entry errors
[AgentExecutorWrapper] No file changes detected for execution exec-test-entry-error: missing_commits

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Error Handling > should continue processing on individual entry errors
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-entry-error'[39m,
  eventType: [32m'RUN_FINISHED'[39m,
  sequenceNumber: [33m16[39m,
  totalEvents: [33m17[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-entry-error'[39m,
  eventType: [32m'RUN_FINISHED'[39m,
  sequenceNumber: [33m17[39m,
  totalEvents: [33m18[39m
}
[AgentExecutorWrapper] Disconnected AG-UI adapter for exec-test-entry-error

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Resource Cleanup > should cleanup resources on successful completion
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully
[ExecutorFactory] Creating executor { agentType: [32m'claude-code'[39m, workDir: [32m'/tmp/test'[39m }
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m7[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mtrue[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}
[AgentExecutorWrapper] Initialized {
  agentType: [32m'claude-code'[39m,
  adapterName: [32m'claude-code'[39m,
  projectId: [32m'test-project'[39m,
  workDir: [32m'/tmp/test'[39m,
  hasTransport: [33mtrue[39m,
  hasLogsStore: [33mtrue[39m
}

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Resource Cleanup > should cleanup resources on successful completion
[AgentExecutorWrapper] Starting execution exec-test-cleanup-success {
  agentType: [32m'claude-code'[39m,
  taskId: [32m'task-test-1'[39m,
  workDir: [32m'/tmp/test'[39m
}
[AgentExecutorWrapper] Setup AG-UI system for exec-test-cleanup-success
[AgentExecutorWrapper] Connected AG-UI adapter to transport for exec-test-cleanup-success
[EventBuffer] Created buffer for execution {
  executionId: [32m'exec-test-cleanup-success'[39m,
  timestamp: [32m'2025-12-19T06:27:51.184Z'[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-cleanup-success'[39m,
  eventType: [32m'RUN_STARTED'[39m,
  sequenceNumber: [33m0[39m,
  totalEvents: [33m1[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-cleanup-success'[39m,
  eventType: [32m'RUN_STARTED'[39m,
  sequenceNumber: [33m1[39m,
  totalEvents: [33m2[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-cleanup-success'[39m,
  eventType: [32m'STATE_SNAPSHOT'[39m,
  sequenceNumber: [33m2[39m,
  totalEvents: [33m3[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-cleanup-success'[39m,
  eventType: [32m'STATE_SNAPSHOT'[39m,
  sequenceNumber: [33m3[39m,
  totalEvents: [33m4[39m
}
[AgentExecutorWrapper] Task metadata for exec-test-cleanup-success: {
  agentType: [32m'claude-code'[39m,
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  resume: [90mundefined[39m
}
[AgentExecutorWrapper] Spawning claude-code process for exec-test-cleanup-success { taskId: [32m'task-test-1'[39m, workDir: [32m'/tmp/test'[39m, promptLength: [33m11[39m }

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Resource Cleanup > should cleanup resources on successful completion
[AgentExecutorWrapper] claude-code process spawned for exec-test-cleanup-success { pid: [90mundefined[39m, spawnfile: [90mundefined[39m }
[AgentExecutorWrapper] Processing normalized output for exec-test-cleanup-success

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Resource Cleanup > should cleanup resources on successful completion
[AgentExecutorWrapper] Finished processing 0 entries for exec-test-cleanup-success

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Resource Cleanup > should cleanup resources on successful completion
[AgentExecutorWrapper] Output processing completed for exec-test-cleanup-success
[AgentExecutorWrapper] Closed stdin for Claude Code process exec-test-cleanup-success

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Resource Cleanup > should cleanup resources on successful completion
[AgentExecutorWrapper] Process exited with code 0 for exec-test-cleanup-success

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Resource Cleanup > should cleanup resources on successful completion
[AgentExecutorWrapper] Execution exec-test-cleanup-success completed successfully
[ExecutionChangesService] Execution exec-test-cleanup-success: {
  status: [32m'running'[39m,
  before_commit: [1mnull[22m,
  after_commit: [1mnull[22m,
  parent_execution_id: [1mnull[22m
}
[ExecutionChangesService] Root execution exec-test-cleanup-success: { before_commit: [1mnull[22m, after_commit: [1mnull[22m }
[ExecutionChangesService] Computed beforeCommit: null

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Resource Cleanup > should cleanup resources on successful completion
[AgentExecutorWrapper] No file changes detected for execution exec-test-cleanup-success: missing_commits

stdout | tests/integration/watcher-broadcasts.test.ts > File Watcher WebSocket Broadcasts - Implementation Logic > should simulate onFileChange callback for issue updates
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Resource Cleanup > should cleanup resources on successful completion
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-cleanup-success'[39m,
  eventType: [32m'RUN_FINISHED'[39m,
  sequenceNumber: [33m4[39m,
  totalEvents: [33m5[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-cleanup-success'[39m,
  eventType: [32m'RUN_FINISHED'[39m,
  sequenceNumber: [33m5[39m,
  totalEvents: [33m6[39m
}
[AgentExecutorWrapper] Disconnected AG-UI adapter for exec-test-cleanup-success

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Resource Cleanup > should cleanup resources on error
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully
[ExecutorFactory] Creating executor { agentType: [32m'claude-code'[39m, workDir: [32m'/tmp/test'[39m }
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m7[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mtrue[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}
[AgentExecutorWrapper] Initialized {
  agentType: [32m'claude-code'[39m,
  adapterName: [32m'claude-code'[39m,
  projectId: [32m'test-project'[39m,
  workDir: [32m'/tmp/test'[39m,
  hasTransport: [33mtrue[39m,
  hasLogsStore: [33mtrue[39m
}

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Resource Cleanup > should cleanup resources on error
[AgentExecutorWrapper] Starting execution exec-test-cleanup-error {
  agentType: [32m'claude-code'[39m,
  taskId: [32m'task-test-1'[39m,
  workDir: [32m'/tmp/test'[39m
}
[AgentExecutorWrapper] Setup AG-UI system for exec-test-cleanup-error
[AgentExecutorWrapper] Connected AG-UI adapter to transport for exec-test-cleanup-error
[EventBuffer] Created buffer for execution {
  executionId: [32m'exec-test-cleanup-error'[39m,
  timestamp: [32m'2025-12-19T06:27:51.395Z'[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-cleanup-error'[39m,
  eventType: [32m'RUN_STARTED'[39m,
  sequenceNumber: [33m0[39m,
  totalEvents: [33m1[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-cleanup-error'[39m,
  eventType: [32m'RUN_STARTED'[39m,
  sequenceNumber: [33m1[39m,
  totalEvents: [33m2[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-cleanup-error'[39m,
  eventType: [32m'STATE_SNAPSHOT'[39m,
  sequenceNumber: [33m2[39m,
  totalEvents: [33m3[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-cleanup-error'[39m,
  eventType: [32m'STATE_SNAPSHOT'[39m,
  sequenceNumber: [33m3[39m,
  totalEvents: [33m4[39m
}
[AgentExecutorWrapper] Task metadata for exec-test-cleanup-error: {
  agentType: [32m'claude-code'[39m,
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  resume: [90mundefined[39m
}
[AgentExecutorWrapper] Spawning claude-code process for exec-test-cleanup-error { taskId: [32m'task-test-1'[39m, workDir: [32m'/tmp/test'[39m, promptLength: [33m11[39m }

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Resource Cleanup > should cleanup resources on error
[AgentExecutorWrapper] claude-code process spawned for exec-test-cleanup-error { pid: [90mundefined[39m, spawnfile: [90mundefined[39m }
[AgentExecutorWrapper] Processing normalized output for exec-test-cleanup-error

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Resource Cleanup > should cleanup resources on error
[AgentExecutorWrapper] Finished processing 0 entries for exec-test-cleanup-error

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Resource Cleanup > should cleanup resources on error
[AgentExecutorWrapper] Output processing completed for exec-test-cleanup-error
[AgentExecutorWrapper] Closed stdin for Claude Code process exec-test-cleanup-error

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Resource Cleanup > should cleanup resources on error
[AgentExecutorWrapper] Process exited with code 1 for exec-test-cleanup-error

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Resource Cleanup > should cleanup resources on error
[ExecutionChangesService] Execution exec-test-cleanup-error: {
  status: [32m'running'[39m,
  before_commit: [1mnull[22m,
  after_commit: [1mnull[22m,
  parent_execution_id: [1mnull[22m
}
[ExecutionChangesService] Root execution exec-test-cleanup-error: { before_commit: [1mnull[22m, after_commit: [1mnull[22m }
[ExecutionChangesService] Computed beforeCommit: null

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Resource Cleanup > should cleanup resources on error
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-cleanup-error'[39m,
  eventType: [32m'RUN_ERROR'[39m,
  sequenceNumber: [33m4[39m,
  totalEvents: [33m5[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-cleanup-error'[39m,
  eventType: [32m'RUN_ERROR'[39m,
  sequenceNumber: [33m5[39m,
  totalEvents: [33m6[39m
}
[AgentExecutorWrapper] Disconnected AG-UI adapter for exec-test-cleanup-error

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Cancellation > should handle cancellation correctly
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully
[ExecutorFactory] Creating executor { agentType: [32m'claude-code'[39m, workDir: [32m'/tmp/test'[39m }
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m7[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mtrue[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}
[AgentExecutorWrapper] Initialized {
  agentType: [32m'claude-code'[39m,
  adapterName: [32m'claude-code'[39m,
  projectId: [32m'test-project'[39m,
  workDir: [32m'/tmp/test'[39m,
  hasTransport: [33mtrue[39m,
  hasLogsStore: [33mtrue[39m
}

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Cancellation > should handle cancellation correctly
[AgentExecutorWrapper] Starting execution exec-test-cancel {
  agentType: [32m'claude-code'[39m,
  taskId: [32m'task-test-1'[39m,
  workDir: [32m'/tmp/test'[39m
}
[AgentExecutorWrapper] Setup AG-UI system for exec-test-cancel
[AgentExecutorWrapper] Connected AG-UI adapter to transport for exec-test-cancel
[EventBuffer] Created buffer for execution {
  executionId: [32m'exec-test-cancel'[39m,
  timestamp: [32m'2025-12-19T06:27:51.433Z'[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-cancel'[39m,
  eventType: [32m'RUN_STARTED'[39m,
  sequenceNumber: [33m0[39m,
  totalEvents: [33m1[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-cancel'[39m,
  eventType: [32m'RUN_STARTED'[39m,
  sequenceNumber: [33m1[39m,
  totalEvents: [33m2[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-cancel'[39m,
  eventType: [32m'STATE_SNAPSHOT'[39m,
  sequenceNumber: [33m2[39m,
  totalEvents: [33m3[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-cancel'[39m,
  eventType: [32m'STATE_SNAPSHOT'[39m,
  sequenceNumber: [33m3[39m,
  totalEvents: [33m4[39m
}
[AgentExecutorWrapper] Task metadata for exec-test-cancel: {
  agentType: [32m'claude-code'[39m,
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  resume: [90mundefined[39m
}
[AgentExecutorWrapper] Spawning claude-code process for exec-test-cancel { taskId: [32m'task-test-1'[39m, workDir: [32m'/tmp/test'[39m, promptLength: [33m11[39m }

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Cancellation > should handle cancellation correctly
[AgentExecutorWrapper] claude-code process spawned for exec-test-cancel { pid: [90mundefined[39m, spawnfile: [90mundefined[39m }
[AgentExecutorWrapper] Processing normalized output for exec-test-cancel

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Cancellation > should handle cancellation correctly
[AgentExecutorWrapper] Finished processing 0 entries for exec-test-cancel

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Cancellation > should handle cancellation correctly
[AgentExecutorWrapper] Output processing completed for exec-test-cancel
[AgentExecutorWrapper] Closed stdin for Claude Code process exec-test-cancel

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Cancellation > should handle cancellation correctly
[AgentExecutorWrapper] Cancel execution exec-test-cancel

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Cancellation > should handle cancellation correctly
[AgentExecutorWrapper] Process exited with code 143 for exec-test-cancel

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Cancellation > should handle cancellation correctly
[ExecutionChangesService] Execution exec-test-cancel: {
  status: [32m'stopped'[39m,
  before_commit: [1mnull[22m,
  after_commit: [1mnull[22m,
  parent_execution_id: [1mnull[22m
}
[ExecutionChangesService] Root execution exec-test-cancel: { before_commit: [1mnull[22m, after_commit: [1mnull[22m }
[ExecutionChangesService] Computed beforeCommit: null

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Cancellation > should handle cancellation correctly
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-cancel'[39m,
  eventType: [32m'RUN_ERROR'[39m,
  sequenceNumber: [33m4[39m,
  totalEvents: [33m5[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-cancel'[39m,
  eventType: [32m'RUN_ERROR'[39m,
  sequenceNumber: [33m5[39m,
  totalEvents: [33m6[39m
}
[AgentExecutorWrapper] Disconnected AG-UI adapter for exec-test-cancel

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Session Resumption > should support session resumption
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully
[ExecutorFactory] Creating executor { agentType: [32m'claude-code'[39m, workDir: [32m'/tmp/test'[39m }
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m7[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mtrue[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}
[AgentExecutorWrapper] Initialized {
  agentType: [32m'claude-code'[39m,
  adapterName: [32m'claude-code'[39m,
  projectId: [32m'test-project'[39m,
  workDir: [32m'/tmp/test'[39m,
  hasTransport: [33mtrue[39m,
  hasLogsStore: [33mtrue[39m
}

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Session Resumption > should support session resumption
[AgentExecutorWrapper] Resuming session session-abc-123 for exec-test-resume
[AgentExecutorWrapper] Setup AG-UI system for exec-test-resume
[EventBuffer] Created buffer for execution {
  executionId: [32m'exec-test-resume'[39m,
  timestamp: [32m'2025-12-19T06:27:51.486Z'[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-resume'[39m,
  eventType: [32m'RUN_STARTED'[39m,
  sequenceNumber: [33m0[39m,
  totalEvents: [33m1[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-resume'[39m,
  eventType: [32m'RUN_STARTED'[39m,
  sequenceNumber: [33m1[39m,
  totalEvents: [33m2[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-resume'[39m,
  eventType: [32m'STATE_SNAPSHOT'[39m,
  sequenceNumber: [33m2[39m,
  totalEvents: [33m3[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-resume'[39m,
  eventType: [32m'STATE_SNAPSHOT'[39m,
  sequenceNumber: [33m3[39m,
  totalEvents: [33m4[39m
}

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Session Resumption > should support session resumption
[AgentExecutorWrapper] Processing normalized output for exec-test-resume

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Session Resumption > should support session resumption
[AgentExecutorWrapper] Entry 1 for exec-test-resume: {
  index: [33m0[39m,
  kind: [32m'assistant_message'[39m,
  timestamp: [35m2025-12-19T06:27:51.487Z[39m,
  hasMetadata: [33mfalse[39m,
  sessionId: [90mundefined[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-resume'[39m,
  eventType: [32m'TEXT_MESSAGE_START'[39m,
  sequenceNumber: [33m4[39m,
  totalEvents: [33m5[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-resume'[39m,
  eventType: [32m'TEXT_MESSAGE_START'[39m,
  sequenceNumber: [33m5[39m,
  totalEvents: [33m6[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-resume'[39m,
  eventType: [32m'TEXT_MESSAGE_CONTENT'[39m,
  sequenceNumber: [33m6[39m,
  totalEvents: [33m7[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-resume'[39m,
  eventType: [32m'TEXT_MESSAGE_CONTENT'[39m,
  sequenceNumber: [33m7[39m,
  totalEvents: [33m8[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-resume'[39m,
  eventType: [32m'TEXT_MESSAGE_END'[39m,
  sequenceNumber: [33m8[39m,
  totalEvents: [33m9[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-resume'[39m,
  eventType: [32m'TEXT_MESSAGE_END'[39m,
  sequenceNumber: [33m9[39m,
  totalEvents: [33m10[39m
}

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Session Resumption > should support session resumption
[AgentExecutorWrapper] Finished processing 1 entries for exec-test-resume

stdout | tests/integration/watcher-broadcasts.test.ts > File Watcher WebSocket Broadcasts - Implementation Logic > should simulate onFileChange callback for spec updates
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Session Resumption > should support session resumption
[AgentExecutorWrapper] Using completion state exit code 0 for resumed exec-test-resume
[AgentExecutorWrapper] Execution exec-test-resume completed successfully
[ExecutionChangesService] Execution exec-test-resume: {
  status: [32m'running'[39m,
  before_commit: [1mnull[22m,
  after_commit: [1mnull[22m,
  parent_execution_id: [1mnull[22m
}
[ExecutionChangesService] Root execution exec-test-resume: { before_commit: [1mnull[22m, after_commit: [1mnull[22m }
[ExecutionChangesService] Computed beforeCommit: null

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Session Resumption > should support session resumption
[AgentExecutorWrapper] No file changes detected for execution exec-test-resume: missing_commits

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Session Resumption > should support session resumption
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-resume'[39m,
  eventType: [32m'RUN_FINISHED'[39m,
  sequenceNumber: [33m10[39m,
  totalEvents: [33m11[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-resume'[39m,
  eventType: [32m'RUN_FINISHED'[39m,
  sequenceNumber: [33m11[39m,
  totalEvents: [33m12[39m
}

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Transport Manager Integration > should connect and disconnect adapters correctly
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: false
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully
[ExecutorFactory] Creating executor { agentType: [32m'claude-code'[39m, workDir: [32m'/tmp/test'[39m }
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m7[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mtrue[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}
[AgentExecutorWrapper] Initialized {
  agentType: [32m'claude-code'[39m,
  adapterName: [32m'claude-code'[39m,
  projectId: [32m'test-project'[39m,
  workDir: [32m'/tmp/test'[39m,
  hasTransport: [33mtrue[39m,
  hasLogsStore: [33mtrue[39m
}

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Transport Manager Integration > should connect and disconnect adapters correctly
[AgentExecutorWrapper] Starting execution exec-test-transport {
  agentType: [32m'claude-code'[39m,
  taskId: [32m'task-test-1'[39m,
  workDir: [32m'/tmp/test'[39m
}
[AgentExecutorWrapper] Setup AG-UI system for exec-test-transport
[AgentExecutorWrapper] Connected AG-UI adapter to transport for exec-test-transport
[EventBuffer] Created buffer for execution {
  executionId: [32m'exec-test-transport'[39m,
  timestamp: [32m'2025-12-19T06:27:51.550Z'[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-transport'[39m,
  eventType: [32m'RUN_STARTED'[39m,
  sequenceNumber: [33m0[39m,
  totalEvents: [33m1[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-transport'[39m,
  eventType: [32m'RUN_STARTED'[39m,
  sequenceNumber: [33m1[39m,
  totalEvents: [33m2[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-transport'[39m,
  eventType: [32m'STATE_SNAPSHOT'[39m,
  sequenceNumber: [33m2[39m,
  totalEvents: [33m3[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-transport'[39m,
  eventType: [32m'STATE_SNAPSHOT'[39m,
  sequenceNumber: [33m3[39m,
  totalEvents: [33m4[39m
}
[AgentExecutorWrapper] Task metadata for exec-test-transport: {
  agentType: [32m'claude-code'[39m,
  hasMcpServers: [33mfalse[39m,
  mcpServerNames: [32m'none'[39m,
  hasAppendSystemPrompt: [33mfalse[39m,
  dangerouslySkipPermissions: [90mundefined[39m,
  resume: [90mundefined[39m
}
[AgentExecutorWrapper] Spawning claude-code process for exec-test-transport { taskId: [32m'task-test-1'[39m, workDir: [32m'/tmp/test'[39m, promptLength: [33m11[39m }

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Transport Manager Integration > should connect and disconnect adapters correctly
[AgentExecutorWrapper] claude-code process spawned for exec-test-transport { pid: [90mundefined[39m, spawnfile: [90mundefined[39m }
[AgentExecutorWrapper] Processing normalized output for exec-test-transport

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Transport Manager Integration > should connect and disconnect adapters correctly
[AgentExecutorWrapper] Finished processing 0 entries for exec-test-transport

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Transport Manager Integration > should connect and disconnect adapters correctly
[AgentExecutorWrapper] Output processing completed for exec-test-transport
[AgentExecutorWrapper] Closed stdin for Claude Code process exec-test-transport

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Transport Manager Integration > should connect and disconnect adapters correctly
[AgentExecutorWrapper] Process exited with code 0 for exec-test-transport

stdout | tests/integration/watcher-broadcasts.test.ts > File Watcher WebSocket Broadcasts - Implementation Logic > should include correct projectId in issue broadcasts
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Transport Manager Integration > should connect and disconnect adapters correctly
[AgentExecutorWrapper] Execution exec-test-transport completed successfully
[ExecutionChangesService] Execution exec-test-transport: {
  status: [32m'running'[39m,
  before_commit: [1mnull[22m,
  after_commit: [1mnull[22m,
  parent_execution_id: [1mnull[22m
}
[ExecutionChangesService] Root execution exec-test-transport: { before_commit: [1mnull[22m, after_commit: [1mnull[22m }
[ExecutionChangesService] Computed beforeCommit: null

stdout | tests/integration/watcher-broadcasts.test.ts > File Watcher WebSocket Broadcasts - Implementation Logic > should not broadcast when entity is not found in database
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Transport Manager Integration > should connect and disconnect adapters correctly
[AgentExecutorWrapper] No file changes detected for execution exec-test-transport: missing_commits

stdout | tests/integration/execution/claude-direct-execution.test.ts > Phase 1 Integration Tests - Direct Execution Pattern > Transport Manager Integration > should connect and disconnect adapters correctly
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-transport'[39m,
  eventType: [32m'RUN_FINISHED'[39m,
  sequenceNumber: [33m4[39m,
  totalEvents: [33m5[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'exec-test-transport'[39m,
  eventType: [32m'RUN_FINISHED'[39m,
  sequenceNumber: [33m5[39m,
  totalEvents: [33m6[39m
}
[AgentExecutorWrapper] Disconnected AG-UI adapter for exec-test-transport

stdout | tests/unit/services/execution-lifecycle.test.ts > ExecutionLifecycleService
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/local-server| tests/unit/execution/worktree/conflict-detector.test.ts (12 tests) 22397ms
   âœ“ ConflictDetector > detectConflicts > should detect no conflicts for clean merge  1206ms
   âœ“ ConflictDetector > detectConflicts > should detect JSONL conflicts only  3690ms
   âœ“ ConflictDetector > detectConflicts > should detect code conflicts only  2614ms
   âœ“ ConflictDetector > detectConflicts > should detect mixed JSONL and code conflicts  2729ms
   âœ“ ConflictDetector > detectConflicts > should classify specs.jsonl as spec entity type  1582ms
   âœ“ ConflictDetector > detectConflicts > should handle multiple conflicting files  1529ms
   âœ“ ConflictDetector > detectConflicts > should generate correct summary for plural conflicts  1387ms
   âœ“ ConflictDetector > detectConflicts > should generate correct summary for singular conflict  1166ms
   âœ“ ConflictDetector > conflict classification > should identify content conflicts  1046ms
   âœ“ ConflictDetector > conflict classification > should provide resolution strategies for code conflicts  1207ms
   âœ“ ConflictDetector > edge cases > should handle conflicts in nested directories  1337ms
   âœ“ ConflictDetector > edge cases > should handle .sudocode directory at different paths  1777ms
 âœ“ |@sudocode-ai/local-server| tests/unit/services/project-manager.test.ts (43 tests) 4907ms
   âœ“ ProjectManager > openProject > should add opened project to registry  455ms
   âœ“ ProjectManager > file watcher integration > should not initialize watcher when watchEnabled is false  489ms
   âœ“ ProjectManager > file watcher integration > should stop watcher on project close  314ms
   âœ“ ProjectManager > updateServerUrl > should update server URL for all open projects  703ms
stdout | tests/integration/watcher-broadcasts.test.ts > File Watcher WebSocket Broadcasts - Implementation Logic > should handle multiple file changes with correct broadcasts
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-lifecycle.test.ts > ExecutionLifecycleService > createExecutionWithWorktree > should capture before_commit when creating execution
[ExecutionLifecycle] Captured before_commit: 650195cc672f990074ebea920bae94a818af8912

 âœ“ |@sudocode-ai/local-server| tests/integration/execution/claude-direct-execution.test.ts (11 tests) 2255ms
stdout | tests/unit/services/execution-lifecycle.test.ts > ExecutionLifecycleService > createExecutionWithWorktree > should create target branch when createTargetBranch is true
[ExecutionLifecycle] Created new branch 'new-feature-branch' from 'main'

 âœ“ |@sudocode-ai/local-server| tests/integration/watcher-broadcasts.test.ts (5 tests) 1775ms
stdout | tests/unit/services/execution-lifecycle.test.ts > ExecutionLifecycleService > cleanupExecution > should cleanup execution worktree
Successfully cleaned up worktree for execution 93564e5e-d80e-47fc-82e5-87b786a4c75e

stdout | tests/unit/services/execution-lifecycle.test.ts > ExecutionLifecycleService > cleanupOrphanedWorktrees > should cleanup worktrees without execution records
Cleaning up orphaned worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-lifecycle-a3nVHJ/.sudocode/worktrees/orphaned-exec-id (no execution found)

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > GET /api/workflows/:id > should return workflow by id
[workflows] getEngineForWorkflow: workflow=wf-123, engineType=sequential

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > GET /api/workflows/:id > should return 404 for non-existent workflow
[workflows] getEngineForWorkflow: workflow=wf-unknown, engineType=sequential

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > DELETE /api/workflows/:id > should delete workflow
[workflows] getEngineForWorkflow: workflow=wf-123, engineType=sequential

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > DELETE /api/workflows/:id > should return 404 for non-existent workflow
[workflows] getEngineForWorkflow: workflow=wf-unknown, engineType=sequential

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > POST /api/workflows/:id/start > should start pending workflow
[workflows] getEngineForWorkflow: workflow=wf-123, engineType=sequential

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > POST /api/workflows/:id/start > should return 400 for non-pending workflow
[workflows] getEngineForWorkflow: workflow=wf-123, engineType=sequential

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > POST /api/workflows/:id/start > should return 404 for non-existent workflow
[workflows] getEngineForWorkflow: workflow=wf-unknown, engineType=sequential

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > POST /api/workflows/:id/pause > should pause running workflow
[workflows] getEngineForWorkflow: workflow=wf-123, engineType=sequential

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > POST /api/workflows/:id/pause > should return 400 for non-running workflow
[workflows] getEngineForWorkflow: workflow=wf-123, engineType=sequential

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > POST /api/workflows/:id/resume > should resume paused workflow
[workflows] getEngineForWorkflow: workflow=wf-123, engineType=sequential

stdout | tests/unit/services/execution-lifecycle.test.ts > ExecutionLifecycleService > createWorkflowWorktree > should create workflow worktree with proper branch naming
[ExecutionLifecycle] Created workflow worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-lifecycle-a3nVHJ/.sudocode/worktrees/workflow-wf-12345678 (branch: sudocode/workflow/12345678/my-test-workflow)

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > POST /api/workflows/:id/resume > should return 400 for non-paused workflow
[workflows] getEngineForWorkflow: workflow=wf-123, engineType=sequential

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > POST /api/workflows/:id/cancel > should cancel workflow
[workflows] getEngineForWorkflow: workflow=wf-123, engineType=sequential

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > POST /api/workflows/:id/cancel > should return 400 for terminal state workflow
[workflows] getEngineForWorkflow: workflow=wf-123, engineType=sequential

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > POST /api/workflows/:id/steps/:stepId/retry > should retry failed step
[workflows] getEngineForWorkflow: workflow=wf-123, engineType=sequential

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > POST /api/workflows/:id/steps/:stepId/retry > should return 404 for non-existent step
[workflows] getEngineForWorkflow: workflow=wf-123, engineType=sequential

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > POST /api/workflows/:id/steps/:stepId/skip > should skip step with reason
[workflows] getEngineForWorkflow: workflow=wf-123, engineType=sequential

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > POST /api/workflows/:id/steps/:stepId/skip > should skip step without reason
[workflows] getEngineForWorkflow: workflow=wf-123, engineType=sequential

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > GET /api/workflows/:id/events > should return workflow events
[workflows] getEngineForWorkflow: workflow=wf-123, engineType=sequential

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > GET /api/workflows/:id/events > should return 404 for non-existent workflow
[workflows] getEngineForWorkflow: workflow=wf-unknown, engineType=sequential

stdout | tests/unit/services/execution-lifecycle.test.ts > ExecutionLifecycleService > createWorkflowWorktree > should reuse existing worktree path when provided
[ExecutionLifecycle] Reusing existing worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-reuse-Ak2ZZR (branch: existing-branch)

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > GET /api/workflows/:id/status (MCP) > should return extended workflow status
[workflows] getEngineForWorkflow: workflow=wf-123, defaulting to sequential

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > GET /api/workflows/:id/status (MCP) > should return 404 for non-existent workflow
[workflows] getEngineForWorkflow: workflow=wf-unknown, engineType=sequential

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > GET /api/workflows/:id/status (MCP) > should return 503 when engine not available
[workflows] getEngineForWorkflow: workflow=wf-123, engineType=sequential

stdout | tests/unit/services/execution-lifecycle.test.ts > ExecutionLifecycleService > createWorkflowWorktree > should handle branch name collision with suffix
[ExecutionLifecycle] Created workflow worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-lifecycle-a3nVHJ/.sudocode/worktrees/workflow-wf-12345678 (branch: sudocode/workflow/12345678/my-test-workflow-2)

stdout | tests/unit/services/execution-lifecycle.test.ts > ExecutionLifecycleService > createWorkflowWorktree > should sanitize workflow title in branch name
[ExecutionLifecycle] Created workflow worktree: /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-lifecycle-a3nVHJ/.sudocode/worktrees/workflow-wf-abc123 (branch: sudocode/workflow/abc123/fix-bug-auth-issues)

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > POST /api/workflows/:id/execute (MCP) > should return 400 when issue_id is missing
[workflows] getEngineForWorkflow: workflow=wf-123, engineType=sequential

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > POST /api/workflows/:id/execute (MCP) > should return 400 when worktree_mode is missing
[workflows] getEngineForWorkflow: workflow=wf-123, engineType=sequential

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > POST /api/workflows/:id/execute (MCP) > should return 404 for non-existent workflow
[workflows] getEngineForWorkflow: workflow=wf-unknown, engineType=sequential

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > POST /api/workflows/:id/execute (MCP) > should return 400 when workflow is not running
[workflows] getEngineForWorkflow: workflow=wf-123, engineType=sequential

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > POST /api/workflows/:id/execute (MCP) > should return 400 when issue is not part of workflow
[workflows] getEngineForWorkflow: workflow=wf-123, engineType=sequential

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > POST /api/workflows/:id/execute (MCP) > should return 400 when use_root without worktree_id
[workflows] getEngineForWorkflow: workflow=wf-123, defaulting to sequential

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > POST /api/workflows/:id/execute (MCP) > should return 503 when engine not available
[workflows] getEngineForWorkflow: workflow=wf-123, engineType=sequential

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > POST /api/workflows/:id/complete (MCP) > should complete workflow with summary
[workflows] getEngineForWorkflow: workflow=wf-123, engineType=sequential

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > POST /api/workflows/:id/complete (MCP) > should mark workflow as failed when specified
[workflows] getEngineForWorkflow: workflow=wf-123, engineType=sequential

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > POST /api/workflows/:id/complete (MCP) > should return 400 when summary is missing
[workflows] getEngineForWorkflow: workflow=wf-123, engineType=sequential

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > POST /api/workflows/:id/complete (MCP) > should return 404 for non-existent workflow
[workflows] getEngineForWorkflow: workflow=wf-unknown, engineType=sequential

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > POST /api/workflows/:id/complete (MCP) > should return 503 when engine not available
[workflows] getEngineForWorkflow: workflow=wf-123, engineType=sequential

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > POST /api/workflows/:id/escalate (MCP) > should create escalation and return pending status
[workflows/:id/escalate] Escalation created for workflow wf-123: 85be433e-492b-4510-aafb-0634afb656ec

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > POST /api/workflows/:id/escalate (MCP) > should include options in escalation
[workflows/:id/escalate] Escalation created for workflow wf-123: 7f24f8f9-fcc6-43a2-a3aa-c62a7b9190d8

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > POST /api/workflows/:id/escalate (MCP) > should auto-approve in full_auto mode
[workflows/:id/escalate] Workflow wf-123 is in full_auto mode, auto-approving

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > POST /api/workflows/:id/notify (MCP) > should send notification and return success
[workflows/:id/notify] [INFO] Workflow wf-123: Progress update

stdout | tests/unit/routes/workflows.test.ts > Workflow Routes > POST /api/workflows/:id/notify (MCP) > should accept level parameter
[workflows/:id/notify] [WARNING] Workflow wf-123: Warning!

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > startWorkflow > should spawn orchestrator execution
[OrchestratorWorkflowEngine] startWorkflow called for wf-049f819f

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > startWorkflow > should spawn orchestrator execution
[OrchestratorWorkflowEngine] Creating workflow worktree for wf-049f819f

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > startWorkflow > should spawn orchestrator execution
[BaseWorkflowEngine] Created workflow worktree for wf-049f819f: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > startWorkflow > should spawn orchestrator execution
[OrchestratorWorkflowEngine] Spawning orchestrator for workflow wf-049f819f
[OrchestratorWorkflowEngine] MCP server path: /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js
[OrchestratorWorkflowEngine] MCP server config for workflow wf-049f819f
[OrchestratorWorkflowEngine] To test MCP locally, run:
  node /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js --workflow-id wf-049f819f --server-url http://localhost:3000 --project-id test-project --repo-path /test/repo
[OrchestratorWorkflowEngine] Creating execution with config: {
  "mode": "worktree",
  "baseBranch": "main",
  "reuseWorktreePath": "/test/worktrees/workflow-test",
  "dangerouslySkipPermissions": true,
  "mcpServers": {
    "sudocode-workflow": {
      "command": "node",
      "args": [
        "/Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js",
        "--workflow-id",
        "wf-049f819f",
        "--server-url",
        "http://localhost:3000",
        "--project-id",
        "test-project",
        "--repo-path",
        "/test/repo"
      ]
    }
  },
  "appendSystemPrompt": "\nYou are a workflow orchestrator managing the execution of coding tasks.\nYou have access to workflow MCP tools to control execution flow.\n\nIMPORTANT: You are orchestrating workflow \"wf-049f819f\".\nUse the workflow tools to:\n- Check workflow status with workflow_status\n- Execute issues with execute_issue\n- Inspect results with execution_trajectory and execution_changes\n- Handle failures appropriately based on the workflow config\n- Mark the workflow complete when done with workflow_complete\n"
}

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > startWorkflow > should update workflow status to running
[OrchestratorWorkflowEngine] startWorkflow called for wf-f6c666a0

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > startWorkflow > should update workflow status to running
[OrchestratorWorkflowEngine] Creating workflow worktree for wf-f6c666a0

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > startWorkflow > should update workflow status to running
[BaseWorkflowEngine] Created workflow worktree for wf-f6c666a0: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > startWorkflow > should update workflow status to running
[OrchestratorWorkflowEngine] Spawning orchestrator for workflow wf-f6c666a0
[OrchestratorWorkflowEngine] MCP server path: /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js
[OrchestratorWorkflowEngine] MCP server config for workflow wf-f6c666a0
[OrchestratorWorkflowEngine] To test MCP locally, run:
  node /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js --workflow-id wf-f6c666a0 --server-url http://localhost:3000 --project-id test-project --repo-path /test/repo
[OrchestratorWorkflowEngine] Creating execution with config: {
  "mode": "worktree",
  "baseBranch": "main",
  "reuseWorktreePath": "/test/worktrees/workflow-test",
  "dangerouslySkipPermissions": true,
  "mcpServers": {
    "sudocode-workflow": {
      "command": "node",
      "args": [
        "/Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js",
        "--workflow-id",
        "wf-f6c666a0",
        "--server-url",
        "http://localhost:3000",
        "--project-id",
        "test-project",
        "--repo-path",
        "/test/repo"
      ]
    }
  },
  "appendSystemPrompt": "\nYou are a workflow orchestrator managing the execution of coding tasks.\nYou have access to workflow MCP tools to control execution flow.\n\nIMPORTANT: You are orchestrating workflow \"wf-f6c666a0\".\nUse the workflow tools to:\n- Check workflow status with workflow_status\n- Execute issues with execute_issue\n- Inspect results with execution_trajectory and execution_changes\n- Handle failures appropriately based on the workflow config\n- Mark the workflow complete when done with workflow_complete\n"
}

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > startWorkflow > should store orchestrator execution ID on workflow
[OrchestratorWorkflowEngine] startWorkflow called for wf-b0a54c1b

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > startWorkflow > should store orchestrator execution ID on workflow
[OrchestratorWorkflowEngine] Creating workflow worktree for wf-b0a54c1b

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > startWorkflow > should store orchestrator execution ID on workflow
[BaseWorkflowEngine] Created workflow worktree for wf-b0a54c1b: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > startWorkflow > should store orchestrator execution ID on workflow
[OrchestratorWorkflowEngine] Spawning orchestrator for workflow wf-b0a54c1b
[OrchestratorWorkflowEngine] MCP server path: /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js
[OrchestratorWorkflowEngine] MCP server config for workflow wf-b0a54c1b
[OrchestratorWorkflowEngine] To test MCP locally, run:
  node /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js --workflow-id wf-b0a54c1b --server-url http://localhost:3000 --project-id test-project --repo-path /test/repo
[OrchestratorWorkflowEngine] Creating execution with config: {
  "mode": "worktree",
  "baseBranch": "main",
  "reuseWorktreePath": "/test/worktrees/workflow-test",
  "dangerouslySkipPermissions": true,
  "mcpServers": {
    "sudocode-workflow": {
      "command": "node",
      "args": [
        "/Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js",
        "--workflow-id",
        "wf-b0a54c1b",
        "--server-url",
        "http://localhost:3000",
        "--project-id",
        "test-project",
        "--repo-path",
        "/test/repo"
      ]
    }
  },
  "appendSystemPrompt": "\nYou are a workflow orchestrator managing the execution of coding tasks.\nYou have access to workflow MCP tools to control execution flow.\n\nIMPORTANT: You are orchestrating workflow \"wf-b0a54c1b\".\nUse the workflow tools to:\n- Check workflow status with workflow_status\n- Execute issues with execute_issue\n- Inspect results with execution_trajectory and execution_changes\n- Handle failures appropriately based on the workflow config\n- Mark the workflow complete when done with workflow_complete\n"
}

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > startWorkflow > should emit workflow_started event
[OrchestratorWorkflowEngine] startWorkflow called for wf-9fad5f77

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > startWorkflow > should emit workflow_started event
[OrchestratorWorkflowEngine] Creating workflow worktree for wf-9fad5f77

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > startWorkflow > should emit workflow_started event
[BaseWorkflowEngine] Created workflow worktree for wf-9fad5f77: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > startWorkflow > should emit workflow_started event
[OrchestratorWorkflowEngine] Spawning orchestrator for workflow wf-9fad5f77
[OrchestratorWorkflowEngine] MCP server path: /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js
[OrchestratorWorkflowEngine] MCP server config for workflow wf-9fad5f77
[OrchestratorWorkflowEngine] To test MCP locally, run:
  node /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js --workflow-id wf-9fad5f77 --server-url http://localhost:3000 --project-id test-project --repo-path /test/repo
[OrchestratorWorkflowEngine] Creating execution with config: {
  "mode": "worktree",
  "baseBranch": "main",
  "reuseWorktreePath": "/test/worktrees/workflow-test",
  "dangerouslySkipPermissions": true,
  "mcpServers": {
    "sudocode-workflow": {
      "command": "node",
      "args": [
        "/Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js",
        "--workflow-id",
        "wf-9fad5f77",
        "--server-url",
        "http://localhost:3000",
        "--project-id",
        "test-project",
        "--repo-path",
        "/test/repo"
      ]
    }
  },
  "appendSystemPrompt": "\nYou are a workflow orchestrator managing the execution of coding tasks.\nYou have access to workflow MCP tools to control execution flow.\n\nIMPORTANT: You are orchestrating workflow \"wf-9fad5f77\".\nUse the workflow tools to:\n- Check workflow status with workflow_status\n- Execute issues with execute_issue\n- Inspect results with execution_trajectory and execution_changes\n- Handle failures appropriately based on the workflow config\n- Mark the workflow complete when done with workflow_complete\n"
}

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > startWorkflow > should reject if workflow is not pending
[OrchestratorWorkflowEngine] startWorkflow called for wf-0432dbf9

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > startWorkflow > should reject if workflow is not pending
[OrchestratorWorkflowEngine] Creating workflow worktree for wf-0432dbf9

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > startWorkflow > should reject if workflow is not pending
[BaseWorkflowEngine] Created workflow worktree for wf-0432dbf9: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > startWorkflow > should reject if workflow is not pending
[OrchestratorWorkflowEngine] Spawning orchestrator for workflow wf-0432dbf9
[OrchestratorWorkflowEngine] MCP server path: /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js
[OrchestratorWorkflowEngine] MCP server config for workflow wf-0432dbf9
[OrchestratorWorkflowEngine] To test MCP locally, run:
  node /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js --workflow-id wf-0432dbf9 --server-url http://localhost:3000 --project-id test-project --repo-path /test/repo
[OrchestratorWorkflowEngine] Creating execution with config: {
  "mode": "worktree",
  "baseBranch": "main",
  "reuseWorktreePath": "/test/worktrees/workflow-test",
  "dangerouslySkipPermissions": true,
  "mcpServers": {
    "sudocode-workflow": {
      "command": "node",
      "args": [
        "/Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js",
        "--workflow-id",
        "wf-0432dbf9",
        "--server-url",
        "http://localhost:3000",
        "--project-id",
        "test-project",
        "--repo-path",
        "/test/repo"
      ]
    }
  },
  "appendSystemPrompt": "\nYou are a workflow orchestrator managing the execution of coding tasks.\nYou have access to workflow MCP tools to control execution flow.\n\nIMPORTANT: You are orchestrating workflow \"wf-0432dbf9\".\nUse the workflow tools to:\n- Check workflow status with workflow_status\n- Execute issues with execute_issue\n- Inspect results with execution_trajectory and execution_changes\n- Handle failures appropriately based on the workflow config\n- Mark the workflow complete when done with workflow_complete\n"
}

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > startWorkflow > should reject if workflow is not pending
[OrchestratorWorkflowEngine] startWorkflow called for wf-0432dbf9

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > pauseWorkflow > should update status to paused
[OrchestratorWorkflowEngine] startWorkflow called for wf-e57abd10

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > pauseWorkflow > should update status to paused
[OrchestratorWorkflowEngine] Creating workflow worktree for wf-e57abd10

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > pauseWorkflow > should update status to paused
[BaseWorkflowEngine] Created workflow worktree for wf-e57abd10: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > pauseWorkflow > should update status to paused
[OrchestratorWorkflowEngine] Spawning orchestrator for workflow wf-e57abd10
[OrchestratorWorkflowEngine] MCP server path: /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js
[OrchestratorWorkflowEngine] MCP server config for workflow wf-e57abd10
[OrchestratorWorkflowEngine] To test MCP locally, run:
  node /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js --workflow-id wf-e57abd10 --server-url http://localhost:3000 --project-id test-project --repo-path /test/repo
[OrchestratorWorkflowEngine] Creating execution with config: {
  "mode": "worktree",
  "baseBranch": "main",
  "reuseWorktreePath": "/test/worktrees/workflow-test",
  "dangerouslySkipPermissions": true,
  "mcpServers": {
    "sudocode-workflow": {
      "command": "node",
      "args": [
        "/Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js",
        "--workflow-id",
        "wf-e57abd10",
        "--server-url",
        "http://localhost:3000",
        "--project-id",
        "test-project",
        "--repo-path",
        "/test/repo"
      ]
    }
  },
  "appendSystemPrompt": "\nYou are a workflow orchestrator managing the execution of coding tasks.\nYou have access to workflow MCP tools to control execution flow.\n\nIMPORTANT: You are orchestrating workflow \"wf-e57abd10\".\nUse the workflow tools to:\n- Check workflow status with workflow_status\n- Execute issues with execute_issue\n- Inspect results with execution_trajectory and execution_changes\n- Handle failures appropriately based on the workflow config\n- Mark the workflow complete when done with workflow_complete\n"
}

 âœ“ |@sudocode-ai/local-server| tests/unit/services/execution-lifecycle.test.ts (28 tests) 3449ms
   âœ“ ExecutionLifecycleService > createExecutionWithWorktree > should capture before_commit when creating execution  565ms
   âœ“ ExecutionLifecycleService > createWorkflowWorktree > should reuse existing worktree path when provided  545ms
stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > pauseWorkflow > should update status to paused
[OrchestratorEngine] Cancelling 1 orchestrator executions in chain

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > pauseWorkflow > should update status to paused
[OrchestratorEngine] Cancelling 0 step executions
[OrchestratorEngine] Cancelled 1 total executions for workflow wf-e57abd10

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > pauseWorkflow > should record pause event
[OrchestratorWorkflowEngine] startWorkflow called for wf-bce99857

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > pauseWorkflow > should record pause event
[OrchestratorWorkflowEngine] Creating workflow worktree for wf-bce99857

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > pauseWorkflow > should record pause event
[BaseWorkflowEngine] Created workflow worktree for wf-bce99857: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > pauseWorkflow > should record pause event
[OrchestratorWorkflowEngine] Spawning orchestrator for workflow wf-bce99857
[OrchestratorWorkflowEngine] MCP server path: /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js
[OrchestratorWorkflowEngine] MCP server config for workflow wf-bce99857
[OrchestratorWorkflowEngine] To test MCP locally, run:
  node /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js --workflow-id wf-bce99857 --server-url http://localhost:3000 --project-id test-project --repo-path /test/repo
[OrchestratorWorkflowEngine] Creating execution with config: {
  "mode": "worktree",
  "baseBranch": "main",
  "reuseWorktreePath": "/test/worktrees/workflow-test",
  "dangerouslySkipPermissions": true,
  "mcpServers": {
    "sudocode-workflow": {
      "command": "node",
      "args": [
        "/Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js",
        "--workflow-id",
        "wf-bce99857",
        "--server-url",
        "http://localhost:3000",
        "--project-id",
        "test-project",
        "--repo-path",
        "/test/repo"
      ]
    }
  },
  "appendSystemPrompt": "\nYou are a workflow orchestrator managing the execution of coding tasks.\nYou have access to workflow MCP tools to control execution flow.\n\nIMPORTANT: You are orchestrating workflow \"wf-bce99857\".\nUse the workflow tools to:\n- Check workflow status with workflow_status\n- Execute issues with execute_issue\n- Inspect results with execution_trajectory and execution_changes\n- Handle failures appropriately based on the workflow config\n- Mark the workflow complete when done with workflow_complete\n"
}

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > pauseWorkflow > should record pause event
[OrchestratorEngine] Cancelling 1 orchestrator executions in chain

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > pauseWorkflow > should record pause event
[OrchestratorEngine] Cancelling 0 step executions
[OrchestratorEngine] Cancelled 1 total executions for workflow wf-bce99857

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > pauseWorkflow > should emit workflow_paused event
[OrchestratorWorkflowEngine] startWorkflow called for wf-e182dd60

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > pauseWorkflow > should emit workflow_paused event
[OrchestratorWorkflowEngine] Creating workflow worktree for wf-e182dd60

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > pauseWorkflow > should emit workflow_paused event
[BaseWorkflowEngine] Created workflow worktree for wf-e182dd60: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > pauseWorkflow > should emit workflow_paused event
[OrchestratorWorkflowEngine] Spawning orchestrator for workflow wf-e182dd60
[OrchestratorWorkflowEngine] MCP server path: /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js
[OrchestratorWorkflowEngine] MCP server config for workflow wf-e182dd60
[OrchestratorWorkflowEngine] To test MCP locally, run:
  node /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js --workflow-id wf-e182dd60 --server-url http://localhost:3000 --project-id test-project --repo-path /test/repo
[OrchestratorWorkflowEngine] Creating execution with config: {
  "mode": "worktree",
  "baseBranch": "main",
  "reuseWorktreePath": "/test/worktrees/workflow-test",
  "dangerouslySkipPermissions": true,
  "mcpServers": {
    "sudocode-workflow": {
      "command": "node",
      "args": [
        "/Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js",
        "--workflow-id",
        "wf-e182dd60",
        "--server-url",
        "http://localhost:3000",
        "--project-id",
        "test-project",
        "--repo-path",
        "/test/repo"
      ]
    }
  },
  "appendSystemPrompt": "\nYou are a workflow orchestrator managing the execution of coding tasks.\nYou have access to workflow MCP tools to control execution flow.\n\nIMPORTANT: You are orchestrating workflow \"wf-e182dd60\".\nUse the workflow tools to:\n- Check workflow status with workflow_status\n- Execute issues with execute_issue\n- Inspect results with execution_trajectory and execution_changes\n- Handle failures appropriately based on the workflow config\n- Mark the workflow complete when done with workflow_complete\n"
}

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > pauseWorkflow > should emit workflow_paused event
[OrchestratorEngine] Cancelling 1 orchestrator executions in chain

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > pauseWorkflow > should emit workflow_paused event
[OrchestratorEngine] Cancelling 0 step executions
[OrchestratorEngine] Cancelled 1 total executions for workflow wf-e182dd60

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > pauseWorkflow > should cancel all running executions when pausing
[OrchestratorWorkflowEngine] startWorkflow called for wf-b1f2b047

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > pauseWorkflow > should cancel all running executions when pausing
[OrchestratorWorkflowEngine] Creating workflow worktree for wf-b1f2b047

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > pauseWorkflow > should cancel all running executions when pausing
[BaseWorkflowEngine] Created workflow worktree for wf-b1f2b047: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > pauseWorkflow > should cancel all running executions when pausing
[OrchestratorWorkflowEngine] Spawning orchestrator for workflow wf-b1f2b047
[OrchestratorWorkflowEngine] MCP server path: /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js
[OrchestratorWorkflowEngine] MCP server config for workflow wf-b1f2b047
[OrchestratorWorkflowEngine] To test MCP locally, run:
  node /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js --workflow-id wf-b1f2b047 --server-url http://localhost:3000 --project-id test-project --repo-path /test/repo
[OrchestratorWorkflowEngine] Creating execution with config: {
  "mode": "worktree",
  "baseBranch": "main",
  "reuseWorktreePath": "/test/worktrees/workflow-test",
  "dangerouslySkipPermissions": true,
  "mcpServers": {
    "sudocode-workflow": {
      "command": "node",
      "args": [
        "/Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js",
        "--workflow-id",
        "wf-b1f2b047",
        "--server-url",
        "http://localhost:3000",
        "--project-id",
        "test-project",
        "--repo-path",
        "/test/repo"
      ]
    }
  },
  "appendSystemPrompt": "\nYou are a workflow orchestrator managing the execution of coding tasks.\nYou have access to workflow MCP tools to control execution flow.\n\nIMPORTANT: You are orchestrating workflow \"wf-b1f2b047\".\nUse the workflow tools to:\n- Check workflow status with workflow_status\n- Execute issues with execute_issue\n- Inspect results with execution_trajectory and execution_changes\n- Handle failures appropriately based on the workflow config\n- Mark the workflow complete when done with workflow_complete\n"
}

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > pauseWorkflow > should cancel all running executions when pausing
[OrchestratorEngine] Cancelling 1 orchestrator executions in chain

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > pauseWorkflow > should cancel all running executions when pausing
[OrchestratorEngine] Cancelling 1 step executions

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > pauseWorkflow > should cancel all running executions when pausing
[OrchestratorEngine] Cancelled 2 total executions for workflow wf-b1f2b047

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > pauseWorkflow > should cancel entire orchestrator execution chain when pausing
[OrchestratorWorkflowEngine] startWorkflow called for wf-79336780

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > pauseWorkflow > should cancel entire orchestrator execution chain when pausing
[OrchestratorWorkflowEngine] Creating workflow worktree for wf-79336780

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > pauseWorkflow > should cancel entire orchestrator execution chain when pausing
[BaseWorkflowEngine] Created workflow worktree for wf-79336780: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > pauseWorkflow > should cancel entire orchestrator execution chain when pausing
[OrchestratorWorkflowEngine] Spawning orchestrator for workflow wf-79336780
[OrchestratorWorkflowEngine] MCP server path: /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js
[OrchestratorWorkflowEngine] MCP server config for workflow wf-79336780
[OrchestratorWorkflowEngine] To test MCP locally, run:
  node /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js --workflow-id wf-79336780 --server-url http://localhost:3000 --project-id test-project --repo-path /test/repo
[OrchestratorWorkflowEngine] Creating execution with config: {
  "mode": "worktree",
  "baseBranch": "main",
  "reuseWorktreePath": "/test/worktrees/workflow-test",
  "dangerouslySkipPermissions": true,
  "mcpServers": {
    "sudocode-workflow": {
      "command": "node",
      "args": [
        "/Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js",
        "--workflow-id",
        "wf-79336780",
        "--server-url",
        "http://localhost:3000",
        "--project-id",
        "test-project",
        "--repo-path",
        "/test/repo"
      ]
    }
  },
  "appendSystemPrompt": "\nYou are a workflow orchestrator managing the execution of coding tasks.\nYou have access to workflow MCP tools to control execution flow.\n\nIMPORTANT: You are orchestrating workflow \"wf-79336780\".\nUse the workflow tools to:\n- Check workflow status with workflow_status\n- Execute issues with execute_issue\n- Inspect results with execution_trajectory and execution_changes\n- Handle failures appropriately based on the workflow config\n- Mark the workflow complete when done with workflow_complete\n"
}

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > pauseWorkflow > should cancel entire orchestrator execution chain when pausing
[OrchestratorEngine] Cancelling 2 orchestrator executions in chain

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > pauseWorkflow > should cancel entire orchestrator execution chain when pausing
[OrchestratorEngine] Cancelling 0 step executions
[OrchestratorEngine] Cancelled 2 total executions for workflow wf-79336780

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should update status to running
[OrchestratorWorkflowEngine] startWorkflow called for wf-ea8ebc93

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should update status to running
[OrchestratorWorkflowEngine] Creating workflow worktree for wf-ea8ebc93

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should update status to running
[BaseWorkflowEngine] Created workflow worktree for wf-ea8ebc93: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should update status to running
[OrchestratorWorkflowEngine] Spawning orchestrator for workflow wf-ea8ebc93
[OrchestratorWorkflowEngine] MCP server path: /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js
[OrchestratorWorkflowEngine] MCP server config for workflow wf-ea8ebc93
[OrchestratorWorkflowEngine] To test MCP locally, run:
  node /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js --workflow-id wf-ea8ebc93 --server-url http://localhost:3000 --project-id test-project --repo-path /test/repo
[OrchestratorWorkflowEngine] Creating execution with config: {
  "mode": "worktree",
  "baseBranch": "main",
  "reuseWorktreePath": "/test/worktrees/workflow-test",
  "dangerouslySkipPermissions": true,
  "mcpServers": {
    "sudocode-workflow": {
      "command": "node",
      "args": [
        "/Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js",
        "--workflow-id",
        "wf-ea8ebc93",
        "--server-url",
        "http://localhost:3000",
        "--project-id",
        "test-project",
        "--repo-path",
        "/test/repo"
      ]
    }
  },
  "appendSystemPrompt": "\nYou are a workflow orchestrator managing the execution of coding tasks.\nYou have access to workflow MCP tools to control execution flow.\n\nIMPORTANT: You are orchestrating workflow \"wf-ea8ebc93\".\nUse the workflow tools to:\n- Check workflow status with workflow_status\n- Execute issues with execute_issue\n- Inspect results with execution_trajectory and execution_changes\n- Handle failures appropriately based on the workflow config\n- Mark the workflow complete when done with workflow_complete\n"
}

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should update status to running
[OrchestratorEngine] Cancelling 1 orchestrator executions in chain

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should update status to running
[OrchestratorEngine] Cancelling 0 step executions
[OrchestratorEngine] Cancelled 1 total executions for workflow wf-ea8ebc93

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should update status to running
[OrchestratorWorkflowEngine] MCP server path: /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js
[OrchestratorWorkflowEngine] MCP server config for workflow wf-ea8ebc93
[OrchestratorWorkflowEngine] To test MCP locally, run:
  node /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js --workflow-id wf-ea8ebc93 --server-url http://localhost:3000 --project-id test-project --repo-path /test/repo
[OrchestratorWorkflowEngine] Resuming workflow wf-ea8ebc93 with session session-orch

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should record resume event
[OrchestratorWorkflowEngine] startWorkflow called for wf-6282a8e7

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should record resume event
[OrchestratorWorkflowEngine] Creating workflow worktree for wf-6282a8e7

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should record resume event
[BaseWorkflowEngine] Created workflow worktree for wf-6282a8e7: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should record resume event
[OrchestratorWorkflowEngine] Spawning orchestrator for workflow wf-6282a8e7
[OrchestratorWorkflowEngine] MCP server path: /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js
[OrchestratorWorkflowEngine] MCP server config for workflow wf-6282a8e7
[OrchestratorWorkflowEngine] To test MCP locally, run:
  node /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js --workflow-id wf-6282a8e7 --server-url http://localhost:3000 --project-id test-project --repo-path /test/repo
[OrchestratorWorkflowEngine] Creating execution with config: {
  "mode": "worktree",
  "baseBranch": "main",
  "reuseWorktreePath": "/test/worktrees/workflow-test",
  "dangerouslySkipPermissions": true,
  "mcpServers": {
    "sudocode-workflow": {
      "command": "node",
      "args": [
        "/Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js",
        "--workflow-id",
        "wf-6282a8e7",
        "--server-url",
        "http://localhost:3000",
        "--project-id",
        "test-project",
        "--repo-path",
        "/test/repo"
      ]
    }
  },
  "appendSystemPrompt": "\nYou are a workflow orchestrator managing the execution of coding tasks.\nYou have access to workflow MCP tools to control execution flow.\n\nIMPORTANT: You are orchestrating workflow \"wf-6282a8e7\".\nUse the workflow tools to:\n- Check workflow status with workflow_status\n- Execute issues with execute_issue\n- Inspect results with execution_trajectory and execution_changes\n- Handle failures appropriately based on the workflow config\n- Mark the workflow complete when done with workflow_complete\n"
}

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should record resume event
[OrchestratorEngine] Cancelling 1 orchestrator executions in chain

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should record resume event
[OrchestratorEngine] Cancelling 0 step executions
[OrchestratorEngine] Cancelled 1 total executions for workflow wf-6282a8e7

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should record resume event
[OrchestratorWorkflowEngine] MCP server path: /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js
[OrchestratorWorkflowEngine] MCP server config for workflow wf-6282a8e7
[OrchestratorWorkflowEngine] To test MCP locally, run:
  node /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js --workflow-id wf-6282a8e7 --server-url http://localhost:3000 --project-id test-project --repo-path /test/repo
[OrchestratorWorkflowEngine] Resuming workflow wf-6282a8e7 with session session-orch

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should create new execution with session resume and parent link
[OrchestratorWorkflowEngine] startWorkflow called for wf-1cb4d1de

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should create new execution with session resume and parent link
[OrchestratorWorkflowEngine] Creating workflow worktree for wf-1cb4d1de

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should create new execution with session resume and parent link
[BaseWorkflowEngine] Created workflow worktree for wf-1cb4d1de: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should create new execution with session resume and parent link
[OrchestratorWorkflowEngine] Spawning orchestrator for workflow wf-1cb4d1de
[OrchestratorWorkflowEngine] MCP server path: /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js
[OrchestratorWorkflowEngine] MCP server config for workflow wf-1cb4d1de
[OrchestratorWorkflowEngine] To test MCP locally, run:
  node /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js --workflow-id wf-1cb4d1de --server-url http://localhost:3000 --project-id test-project --repo-path /test/repo
[OrchestratorWorkflowEngine] Creating execution with config: {
  "mode": "worktree",
  "baseBranch": "main",
  "reuseWorktreePath": "/test/worktrees/workflow-test",
  "dangerouslySkipPermissions": true,
  "mcpServers": {
    "sudocode-workflow": {
      "command": "node",
      "args": [
        "/Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js",
        "--workflow-id",
        "wf-1cb4d1de",
        "--server-url",
        "http://localhost:3000",
        "--project-id",
        "test-project",
        "--repo-path",
        "/test/repo"
      ]
    }
  },
  "appendSystemPrompt": "\nYou are a workflow orchestrator managing the execution of coding tasks.\nYou have access to workflow MCP tools to control execution flow.\n\nIMPORTANT: You are orchestrating workflow \"wf-1cb4d1de\".\nUse the workflow tools to:\n- Check workflow status with workflow_status\n- Execute issues with execute_issue\n- Inspect results with execution_trajectory and execution_changes\n- Handle failures appropriately based on the workflow config\n- Mark the workflow complete when done with workflow_complete\n"
}

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should create new execution with session resume and parent link
[OrchestratorEngine] Cancelling 1 orchestrator executions in chain

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should create new execution with session resume and parent link
[OrchestratorEngine] Cancelling 0 step executions
[OrchestratorEngine] Cancelled 1 total executions for workflow wf-1cb4d1de

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should create new execution with session resume and parent link
[OrchestratorWorkflowEngine] MCP server path: /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js
[OrchestratorWorkflowEngine] MCP server config for workflow wf-1cb4d1de
[OrchestratorWorkflowEngine] To test MCP locally, run:
  node /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js --workflow-id wf-1cb4d1de --server-url http://localhost:3000 --project-id test-project --repo-path /test/repo
[OrchestratorWorkflowEngine] Resuming workflow wf-1cb4d1de with session session-orch

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should use custom message when provided
[OrchestratorWorkflowEngine] startWorkflow called for wf-285af006

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should use custom message when provided
[OrchestratorWorkflowEngine] Creating workflow worktree for wf-285af006

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should use custom message when provided
[BaseWorkflowEngine] Created workflow worktree for wf-285af006: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should use custom message when provided
[OrchestratorWorkflowEngine] Spawning orchestrator for workflow wf-285af006
[OrchestratorWorkflowEngine] MCP server path: /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js
[OrchestratorWorkflowEngine] MCP server config for workflow wf-285af006
[OrchestratorWorkflowEngine] To test MCP locally, run:
  node /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js --workflow-id wf-285af006 --server-url http://localhost:3000 --project-id test-project --repo-path /test/repo
[OrchestratorWorkflowEngine] Creating execution with config: {
  "mode": "worktree",
  "baseBranch": "main",
  "reuseWorktreePath": "/test/worktrees/workflow-test",
  "dangerouslySkipPermissions": true,
  "mcpServers": {
    "sudocode-workflow": {
      "command": "node",
      "args": [
        "/Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js",
        "--workflow-id",
        "wf-285af006",
        "--server-url",
        "http://localhost:3000",
        "--project-id",
        "test-project",
        "--repo-path",
        "/test/repo"
      ]
    }
  },
  "appendSystemPrompt": "\nYou are a workflow orchestrator managing the execution of coding tasks.\nYou have access to workflow MCP tools to control execution flow.\n\nIMPORTANT: You are orchestrating workflow \"wf-285af006\".\nUse the workflow tools to:\n- Check workflow status with workflow_status\n- Execute issues with execute_issue\n- Inspect results with execution_trajectory and execution_changes\n- Handle failures appropriately based on the workflow config\n- Mark the workflow complete when done with workflow_complete\n"
}

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should use custom message when provided
[OrchestratorEngine] Cancelling 1 orchestrator executions in chain

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should use custom message when provided
[OrchestratorEngine] Cancelling 0 step executions
[OrchestratorEngine] Cancelled 1 total executions for workflow wf-285af006

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should use custom message when provided
[OrchestratorWorkflowEngine] MCP server path: /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js
[OrchestratorWorkflowEngine] MCP server config for workflow wf-285af006
[OrchestratorWorkflowEngine] To test MCP locally, run:
  node /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js --workflow-id wf-285af006 --server-url http://localhost:3000 --project-id test-project --repo-path /test/repo
[OrchestratorWorkflowEngine] Resuming workflow wf-285af006 with session session-orch

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should update orchestrator execution ID after resume
[OrchestratorWorkflowEngine] startWorkflow called for wf-fa036bd7

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should update orchestrator execution ID after resume
[OrchestratorWorkflowEngine] Creating workflow worktree for wf-fa036bd7

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should update orchestrator execution ID after resume
[BaseWorkflowEngine] Created workflow worktree for wf-fa036bd7: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should update orchestrator execution ID after resume
[OrchestratorWorkflowEngine] Spawning orchestrator for workflow wf-fa036bd7
[OrchestratorWorkflowEngine] MCP server path: /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js
[OrchestratorWorkflowEngine] MCP server config for workflow wf-fa036bd7
[OrchestratorWorkflowEngine] To test MCP locally, run:
  node /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js --workflow-id wf-fa036bd7 --server-url http://localhost:3000 --project-id test-project --repo-path /test/repo
[OrchestratorWorkflowEngine] Creating execution with config: {
  "mode": "worktree",
  "baseBranch": "main",
  "reuseWorktreePath": "/test/worktrees/workflow-test",
  "dangerouslySkipPermissions": true,
  "mcpServers": {
    "sudocode-workflow": {
      "command": "node",
      "args": [
        "/Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js",
        "--workflow-id",
        "wf-fa036bd7",
        "--server-url",
        "http://localhost:3000",
        "--project-id",
        "test-project",
        "--repo-path",
        "/test/repo"
      ]
    }
  },
  "appendSystemPrompt": "\nYou are a workflow orchestrator managing the execution of coding tasks.\nYou have access to workflow MCP tools to control execution flow.\n\nIMPORTANT: You are orchestrating workflow \"wf-fa036bd7\".\nUse the workflow tools to:\n- Check workflow status with workflow_status\n- Execute issues with execute_issue\n- Inspect results with execution_trajectory and execution_changes\n- Handle failures appropriately based on the workflow config\n- Mark the workflow complete when done with workflow_complete\n"
}

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should update orchestrator execution ID after resume
[OrchestratorEngine] Cancelling 1 orchestrator executions in chain

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should update orchestrator execution ID after resume
[OrchestratorEngine] Cancelling 0 step executions
[OrchestratorEngine] Cancelled 1 total executions for workflow wf-fa036bd7

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should update orchestrator execution ID after resume
[OrchestratorWorkflowEngine] MCP server path: /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js
[OrchestratorWorkflowEngine] MCP server config for workflow wf-fa036bd7
[OrchestratorWorkflowEngine] To test MCP locally, run:
  node /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js --workflow-id wf-fa036bd7 --server-url http://localhost:3000 --project-id test-project --repo-path /test/repo
[OrchestratorWorkflowEngine] Resuming workflow wf-fa036bd7 with session session-orch

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should reject if workflow has no session ID
[OrchestratorWorkflowEngine] startWorkflow called for wf-0f8c9526

 âœ“ |@sudocode-ai/local-server| tests/unit/services/project-registry.test.ts (38 tests) 1794ms
stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should reject if workflow has no session ID
[OrchestratorWorkflowEngine] Creating workflow worktree for wf-0f8c9526

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should reject if workflow has no session ID
[BaseWorkflowEngine] Created workflow worktree for wf-0f8c9526: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should reject if workflow has no session ID
[OrchestratorWorkflowEngine] Spawning orchestrator for workflow wf-0f8c9526
[OrchestratorWorkflowEngine] MCP server path: /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js
[OrchestratorWorkflowEngine] MCP server config for workflow wf-0f8c9526
[OrchestratorWorkflowEngine] To test MCP locally, run:
  node /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js --workflow-id wf-0f8c9526 --server-url http://localhost:3000 --project-id test-project --repo-path /test/repo
[OrchestratorWorkflowEngine] Creating execution with config: {
  "mode": "worktree",
  "baseBranch": "main",
  "reuseWorktreePath": "/test/worktrees/workflow-test",
  "dangerouslySkipPermissions": true,
  "mcpServers": {
    "sudocode-workflow": {
      "command": "node",
      "args": [
        "/Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js",
        "--workflow-id",
        "wf-0f8c9526",
        "--server-url",
        "http://localhost:3000",
        "--project-id",
        "test-project",
        "--repo-path",
        "/test/repo"
      ]
    }
  },
  "appendSystemPrompt": "\nYou are a workflow orchestrator managing the execution of coding tasks.\nYou have access to workflow MCP tools to control execution flow.\n\nIMPORTANT: You are orchestrating workflow \"wf-0f8c9526\".\nUse the workflow tools to:\n- Check workflow status with workflow_status\n- Execute issues with execute_issue\n- Inspect results with execution_trajectory and execution_changes\n- Handle failures appropriately based on the workflow config\n- Mark the workflow complete when done with workflow_complete\n"
}

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should reject if workflow is not paused
[OrchestratorWorkflowEngine] startWorkflow called for wf-3046ce3f

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should reject if workflow is not paused
[OrchestratorWorkflowEngine] Creating workflow worktree for wf-3046ce3f

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should reject if workflow is not paused
[BaseWorkflowEngine] Created workflow worktree for wf-3046ce3f: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should reject if workflow is not paused
[OrchestratorWorkflowEngine] Spawning orchestrator for workflow wf-3046ce3f
[OrchestratorWorkflowEngine] MCP server path: /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js
[OrchestratorWorkflowEngine] MCP server config for workflow wf-3046ce3f
[OrchestratorWorkflowEngine] To test MCP locally, run:
  node /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js --workflow-id wf-3046ce3f --server-url http://localhost:3000 --project-id test-project --repo-path /test/repo
[OrchestratorWorkflowEngine] Creating execution with config: {
  "mode": "worktree",
  "baseBranch": "main",
  "reuseWorktreePath": "/test/worktrees/workflow-test",
  "dangerouslySkipPermissions": true,
  "mcpServers": {
    "sudocode-workflow": {
      "command": "node",
      "args": [
        "/Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js",
        "--workflow-id",
        "wf-3046ce3f",
        "--server-url",
        "http://localhost:3000",
        "--project-id",
        "test-project",
        "--repo-path",
        "/test/repo"
      ]
    }
  },
  "appendSystemPrompt": "\nYou are a workflow orchestrator managing the execution of coding tasks.\nYou have access to workflow MCP tools to control execution flow.\n\nIMPORTANT: You are orchestrating workflow \"wf-3046ce3f\".\nUse the workflow tools to:\n- Check workflow status with workflow_status\n- Execute issues with execute_issue\n- Inspect results with execution_trajectory and execution_changes\n- Handle failures appropriately based on the workflow config\n- Mark the workflow complete when done with workflow_complete\n"
}

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should emit workflow_resumed event
[OrchestratorWorkflowEngine] startWorkflow called for wf-be4eccb0

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should emit workflow_resumed event
[OrchestratorWorkflowEngine] Creating workflow worktree for wf-be4eccb0

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should emit workflow_resumed event
[BaseWorkflowEngine] Created workflow worktree for wf-be4eccb0: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should emit workflow_resumed event
[OrchestratorWorkflowEngine] Spawning orchestrator for workflow wf-be4eccb0
[OrchestratorWorkflowEngine] MCP server path: /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js
[OrchestratorWorkflowEngine] MCP server config for workflow wf-be4eccb0
[OrchestratorWorkflowEngine] To test MCP locally, run:
  node /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js --workflow-id wf-be4eccb0 --server-url http://localhost:3000 --project-id test-project --repo-path /test/repo
[OrchestratorWorkflowEngine] Creating execution with config: {
  "mode": "worktree",
  "baseBranch": "main",
  "reuseWorktreePath": "/test/worktrees/workflow-test",
  "dangerouslySkipPermissions": true,
  "mcpServers": {
    "sudocode-workflow": {
      "command": "node",
      "args": [
        "/Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js",
        "--workflow-id",
        "wf-be4eccb0",
        "--server-url",
        "http://localhost:3000",
        "--project-id",
        "test-project",
        "--repo-path",
        "/test/repo"
      ]
    }
  },
  "appendSystemPrompt": "\nYou are a workflow orchestrator managing the execution of coding tasks.\nYou have access to workflow MCP tools to control execution flow.\n\nIMPORTANT: You are orchestrating workflow \"wf-be4eccb0\".\nUse the workflow tools to:\n- Check workflow status with workflow_status\n- Execute issues with execute_issue\n- Inspect results with execution_trajectory and execution_changes\n- Handle failures appropriately based on the workflow config\n- Mark the workflow complete when done with workflow_complete\n"
}

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should emit workflow_resumed event
[OrchestratorEngine] Cancelling 1 orchestrator executions in chain

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should emit workflow_resumed event
[OrchestratorEngine] Cancelling 0 step executions
[OrchestratorEngine] Cancelled 1 total executions for workflow wf-be4eccb0

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should emit workflow_resumed event
[OrchestratorWorkflowEngine] MCP server path: /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js
[OrchestratorWorkflowEngine] MCP server config for workflow wf-be4eccb0
[OrchestratorWorkflowEngine] To test MCP locally, run:
  node /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js --workflow-id wf-be4eccb0 --server-url http://localhost:3000 --project-id test-project --repo-path /test/repo
[OrchestratorWorkflowEngine] Resuming workflow wf-be4eccb0 with session session-orch

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should preserve worktree path on resume
[OrchestratorWorkflowEngine] startWorkflow called for wf-59be2ddc

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should preserve worktree path on resume
[OrchestratorWorkflowEngine] Creating workflow worktree for wf-59be2ddc

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should preserve worktree path on resume
[BaseWorkflowEngine] Created workflow worktree for wf-59be2ddc: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should preserve worktree path on resume
[OrchestratorWorkflowEngine] Spawning orchestrator for workflow wf-59be2ddc
[OrchestratorWorkflowEngine] MCP server path: /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js
[OrchestratorWorkflowEngine] MCP server config for workflow wf-59be2ddc
[OrchestratorWorkflowEngine] To test MCP locally, run:
  node /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js --workflow-id wf-59be2ddc --server-url http://localhost:3000 --project-id test-project --repo-path /test/repo
[OrchestratorWorkflowEngine] Creating execution with config: {
  "mode": "worktree",
  "baseBranch": "main",
  "reuseWorktreePath": "/test/worktrees/workflow-test",
  "dangerouslySkipPermissions": true,
  "mcpServers": {
    "sudocode-workflow": {
      "command": "node",
      "args": [
        "/Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js",
        "--workflow-id",
        "wf-59be2ddc",
        "--server-url",
        "http://localhost:3000",
        "--project-id",
        "test-project",
        "--repo-path",
        "/test/repo"
      ]
    }
  },
  "appendSystemPrompt": "\nYou are a workflow orchestrator managing the execution of coding tasks.\nYou have access to workflow MCP tools to control execution flow.\n\nIMPORTANT: You are orchestrating workflow \"wf-59be2ddc\".\nUse the workflow tools to:\n- Check workflow status with workflow_status\n- Execute issues with execute_issue\n- Inspect results with execution_trajectory and execution_changes\n- Handle failures appropriately based on the workflow config\n- Mark the workflow complete when done with workflow_complete\n"
}

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should preserve worktree path on resume
[OrchestratorEngine] Cancelling 1 orchestrator executions in chain

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should preserve worktree path on resume
[OrchestratorEngine] Cancelling 0 step executions
[OrchestratorEngine] Cancelled 1 total executions for workflow wf-59be2ddc

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > resumeWorkflow > should preserve worktree path on resume
[OrchestratorWorkflowEngine] MCP server path: /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js
[OrchestratorWorkflowEngine] MCP server config for workflow wf-59be2ddc
[OrchestratorWorkflowEngine] To test MCP locally, run:
  node /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js --workflow-id wf-59be2ddc --server-url http://localhost:3000 --project-id test-project --repo-path /test/repo
[OrchestratorWorkflowEngine] Resuming workflow wf-59be2ddc with session session-orch

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should update status to cancelled
[OrchestratorWorkflowEngine] startWorkflow called for wf-f55b7ed4

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should update status to cancelled
[OrchestratorWorkflowEngine] Creating workflow worktree for wf-f55b7ed4

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should update status to cancelled
[BaseWorkflowEngine] Created workflow worktree for wf-f55b7ed4: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should update status to cancelled
[OrchestratorWorkflowEngine] Spawning orchestrator for workflow wf-f55b7ed4
[OrchestratorWorkflowEngine] MCP server path: /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js
[OrchestratorWorkflowEngine] MCP server config for workflow wf-f55b7ed4
[OrchestratorWorkflowEngine] To test MCP locally, run:
  node /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js --workflow-id wf-f55b7ed4 --server-url http://localhost:3000 --project-id test-project --repo-path /test/repo
[OrchestratorWorkflowEngine] Creating execution with config: {
  "mode": "worktree",
  "baseBranch": "main",
  "reuseWorktreePath": "/test/worktrees/workflow-test",
  "dangerouslySkipPermissions": true,
  "mcpServers": {
    "sudocode-workflow": {
      "command": "node",
      "args": [
        "/Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js",
        "--workflow-id",
        "wf-f55b7ed4",
        "--server-url",
        "http://localhost:3000",
        "--project-id",
        "test-project",
        "--repo-path",
        "/test/repo"
      ]
    }
  },
  "appendSystemPrompt": "\nYou are a workflow orchestrator managing the execution of coding tasks.\nYou have access to workflow MCP tools to control execution flow.\n\nIMPORTANT: You are orchestrating workflow \"wf-f55b7ed4\".\nUse the workflow tools to:\n- Check workflow status with workflow_status\n- Execute issues with execute_issue\n- Inspect results with execution_trajectory and execution_changes\n- Handle failures appropriately based on the workflow config\n- Mark the workflow complete when done with workflow_complete\n"
}

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should update status to cancelled
[OrchestratorEngine] Cancelling 1 orchestrator executions in chain

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should update status to cancelled
[OrchestratorEngine] Cancelling 0 step executions
[OrchestratorEngine] Cancelled 1 total executions for workflow wf-f55b7ed4

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should cancel orchestrator execution
[OrchestratorWorkflowEngine] startWorkflow called for wf-b39c5a59

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should cancel orchestrator execution
[OrchestratorWorkflowEngine] Creating workflow worktree for wf-b39c5a59

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should cancel orchestrator execution
[BaseWorkflowEngine] Created workflow worktree for wf-b39c5a59: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should cancel orchestrator execution
[OrchestratorWorkflowEngine] Spawning orchestrator for workflow wf-b39c5a59
[OrchestratorWorkflowEngine] MCP server path: /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js
[OrchestratorWorkflowEngine] MCP server config for workflow wf-b39c5a59
[OrchestratorWorkflowEngine] To test MCP locally, run:
  node /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js --workflow-id wf-b39c5a59 --server-url http://localhost:3000 --project-id test-project --repo-path /test/repo
[OrchestratorWorkflowEngine] Creating execution with config: {
  "mode": "worktree",
  "baseBranch": "main",
  "reuseWorktreePath": "/test/worktrees/workflow-test",
  "dangerouslySkipPermissions": true,
  "mcpServers": {
    "sudocode-workflow": {
      "command": "node",
      "args": [
        "/Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js",
        "--workflow-id",
        "wf-b39c5a59",
        "--server-url",
        "http://localhost:3000",
        "--project-id",
        "test-project",
        "--repo-path",
        "/test/repo"
      ]
    }
  },
  "appendSystemPrompt": "\nYou are a workflow orchestrator managing the execution of coding tasks.\nYou have access to workflow MCP tools to control execution flow.\n\nIMPORTANT: You are orchestrating workflow \"wf-b39c5a59\".\nUse the workflow tools to:\n- Check workflow status with workflow_status\n- Execute issues with execute_issue\n- Inspect results with execution_trajectory and execution_changes\n- Handle failures appropriately based on the workflow config\n- Mark the workflow complete when done with workflow_complete\n"
}

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should cancel orchestrator execution
[OrchestratorEngine] Cancelling 1 orchestrator executions in chain

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should cancel orchestrator execution
[OrchestratorEngine] Cancelling 0 step executions
[OrchestratorEngine] Cancelled 1 total executions for workflow wf-b39c5a59

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should emit workflow_cancelled event
[OrchestratorWorkflowEngine] startWorkflow called for wf-c23ae5f4

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should emit workflow_cancelled event
[OrchestratorWorkflowEngine] Creating workflow worktree for wf-c23ae5f4

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should emit workflow_cancelled event
[BaseWorkflowEngine] Created workflow worktree for wf-c23ae5f4: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should emit workflow_cancelled event
[OrchestratorWorkflowEngine] Spawning orchestrator for workflow wf-c23ae5f4
[OrchestratorWorkflowEngine] MCP server path: /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js
[OrchestratorWorkflowEngine] MCP server config for workflow wf-c23ae5f4
[OrchestratorWorkflowEngine] To test MCP locally, run:
  node /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js --workflow-id wf-c23ae5f4 --server-url http://localhost:3000 --project-id test-project --repo-path /test/repo
[OrchestratorWorkflowEngine] Creating execution with config: {
  "mode": "worktree",
  "baseBranch": "main",
  "reuseWorktreePath": "/test/worktrees/workflow-test",
  "dangerouslySkipPermissions": true,
  "mcpServers": {
    "sudocode-workflow": {
      "command": "node",
      "args": [
        "/Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js",
        "--workflow-id",
        "wf-c23ae5f4",
        "--server-url",
        "http://localhost:3000",
        "--project-id",
        "test-project",
        "--repo-path",
        "/test/repo"
      ]
    }
  },
  "appendSystemPrompt": "\nYou are a workflow orchestrator managing the execution of coding tasks.\nYou have access to workflow MCP tools to control execution flow.\n\nIMPORTANT: You are orchestrating workflow \"wf-c23ae5f4\".\nUse the workflow tools to:\n- Check workflow status with workflow_status\n- Execute issues with execute_issue\n- Inspect results with execution_trajectory and execution_changes\n- Handle failures appropriately based on the workflow config\n- Mark the workflow complete when done with workflow_complete\n"
}

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should emit workflow_cancelled event
[OrchestratorEngine] Cancelling 1 orchestrator executions in chain

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should emit workflow_cancelled event
[OrchestratorEngine] Cancelling 0 step executions
[OrchestratorEngine] Cancelled 1 total executions for workflow wf-c23ae5f4

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should reject if workflow is already cancelled
[OrchestratorWorkflowEngine] startWorkflow called for wf-e521a250

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should reject if workflow is already cancelled
[OrchestratorWorkflowEngine] Creating workflow worktree for wf-e521a250

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should reject if workflow is already cancelled
[BaseWorkflowEngine] Created workflow worktree for wf-e521a250: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should reject if workflow is already cancelled
[OrchestratorWorkflowEngine] Spawning orchestrator for workflow wf-e521a250
[OrchestratorWorkflowEngine] MCP server path: /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js
[OrchestratorWorkflowEngine] MCP server config for workflow wf-e521a250
[OrchestratorWorkflowEngine] To test MCP locally, run:
  node /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js --workflow-id wf-e521a250 --server-url http://localhost:3000 --project-id test-project --repo-path /test/repo
[OrchestratorWorkflowEngine] Creating execution with config: {
  "mode": "worktree",
  "baseBranch": "main",
  "reuseWorktreePath": "/test/worktrees/workflow-test",
  "dangerouslySkipPermissions": true,
  "mcpServers": {
    "sudocode-workflow": {
      "command": "node",
      "args": [
        "/Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js",
        "--workflow-id",
        "wf-e521a250",
        "--server-url",
        "http://localhost:3000",
        "--project-id",
        "test-project",
        "--repo-path",
        "/test/repo"
      ]
    }
  },
  "appendSystemPrompt": "\nYou are a workflow orchestrator managing the execution of coding tasks.\nYou have access to workflow MCP tools to control execution flow.\n\nIMPORTANT: You are orchestrating workflow \"wf-e521a250\".\nUse the workflow tools to:\n- Check workflow status with workflow_status\n- Execute issues with execute_issue\n- Inspect results with execution_trajectory and execution_changes\n- Handle failures appropriately based on the workflow config\n- Mark the workflow complete when done with workflow_complete\n"
}

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should reject if workflow is already cancelled
[OrchestratorEngine] Cancelling 1 orchestrator executions in chain

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should reject if workflow is already cancelled
[OrchestratorEngine] Cancelling 0 step executions
[OrchestratorEngine] Cancelled 1 total executions for workflow wf-e521a250

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should cancel entire execution chain including follow-ups
[OrchestratorWorkflowEngine] startWorkflow called for wf-5b7ce4fe

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should cancel entire execution chain including follow-ups
[OrchestratorWorkflowEngine] Creating workflow worktree for wf-5b7ce4fe

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should cancel entire execution chain including follow-ups
[BaseWorkflowEngine] Created workflow worktree for wf-5b7ce4fe: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should cancel entire execution chain including follow-ups
[OrchestratorWorkflowEngine] Spawning orchestrator for workflow wf-5b7ce4fe
[OrchestratorWorkflowEngine] MCP server path: /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js
[OrchestratorWorkflowEngine] MCP server config for workflow wf-5b7ce4fe
[OrchestratorWorkflowEngine] To test MCP locally, run:
  node /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js --workflow-id wf-5b7ce4fe --server-url http://localhost:3000 --project-id test-project --repo-path /test/repo
[OrchestratorWorkflowEngine] Creating execution with config: {
  "mode": "worktree",
  "baseBranch": "main",
  "reuseWorktreePath": "/test/worktrees/workflow-test",
  "dangerouslySkipPermissions": true,
  "mcpServers": {
    "sudocode-workflow": {
      "command": "node",
      "args": [
        "/Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js",
        "--workflow-id",
        "wf-5b7ce4fe",
        "--server-url",
        "http://localhost:3000",
        "--project-id",
        "test-project",
        "--repo-path",
        "/test/repo"
      ]
    }
  },
  "appendSystemPrompt": "\nYou are a workflow orchestrator managing the execution of coding tasks.\nYou have access to workflow MCP tools to control execution flow.\n\nIMPORTANT: You are orchestrating workflow \"wf-5b7ce4fe\".\nUse the workflow tools to:\n- Check workflow status with workflow_status\n- Execute issues with execute_issue\n- Inspect results with execution_trajectory and execution_changes\n- Handle failures appropriately based on the workflow config\n- Mark the workflow complete when done with workflow_complete\n"
}

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should cancel entire execution chain including follow-ups
[OrchestratorEngine] Cancelling 3 orchestrator executions in chain

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should cancel entire execution chain including follow-ups
[OrchestratorEngine] Cancelling 0 step executions
[OrchestratorEngine] Cancelled 3 total executions for workflow wf-5b7ce4fe

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should cancel step executions linked to workflow
[OrchestratorWorkflowEngine] startWorkflow called for wf-d5fe0d7e

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should cancel step executions linked to workflow
[OrchestratorWorkflowEngine] Creating workflow worktree for wf-d5fe0d7e

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should cancel step executions linked to workflow
[BaseWorkflowEngine] Created workflow worktree for wf-d5fe0d7e: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should cancel step executions linked to workflow
[OrchestratorWorkflowEngine] Spawning orchestrator for workflow wf-d5fe0d7e
[OrchestratorWorkflowEngine] MCP server path: /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js
[OrchestratorWorkflowEngine] MCP server config for workflow wf-d5fe0d7e
[OrchestratorWorkflowEngine] To test MCP locally, run:
  node /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js --workflow-id wf-d5fe0d7e --server-url http://localhost:3000 --project-id test-project --repo-path /test/repo
[OrchestratorWorkflowEngine] Creating execution with config: {
  "mode": "worktree",
  "baseBranch": "main",
  "reuseWorktreePath": "/test/worktrees/workflow-test",
  "dangerouslySkipPermissions": true,
  "mcpServers": {
    "sudocode-workflow": {
      "command": "node",
      "args": [
        "/Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js",
        "--workflow-id",
        "wf-d5fe0d7e",
        "--server-url",
        "http://localhost:3000",
        "--project-id",
        "test-project",
        "--repo-path",
        "/test/repo"
      ]
    }
  },
  "appendSystemPrompt": "\nYou are a workflow orchestrator managing the execution of coding tasks.\nYou have access to workflow MCP tools to control execution flow.\n\nIMPORTANT: You are orchestrating workflow \"wf-d5fe0d7e\".\nUse the workflow tools to:\n- Check workflow status with workflow_status\n- Execute issues with execute_issue\n- Inspect results with execution_trajectory and execution_changes\n- Handle failures appropriately based on the workflow config\n- Mark the workflow complete when done with workflow_complete\n"
}

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should cancel step executions linked to workflow
[OrchestratorEngine] Cancelling 1 orchestrator executions in chain

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should cancel step executions linked to workflow
[OrchestratorEngine] Cancelling 2 step executions

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should cancel step executions linked to workflow
[OrchestratorEngine] Cancelled 3 total executions for workflow wf-d5fe0d7e

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should not cancel already completed executions
[OrchestratorWorkflowEngine] startWorkflow called for wf-c2020a1b

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should not cancel already completed executions
[OrchestratorWorkflowEngine] Creating workflow worktree for wf-c2020a1b

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should not cancel already completed executions
[BaseWorkflowEngine] Created workflow worktree for wf-c2020a1b: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should not cancel already completed executions
[OrchestratorWorkflowEngine] Spawning orchestrator for workflow wf-c2020a1b
[OrchestratorWorkflowEngine] MCP server path: /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js
[OrchestratorWorkflowEngine] MCP server config for workflow wf-c2020a1b
[OrchestratorWorkflowEngine] To test MCP locally, run:
  node /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js --workflow-id wf-c2020a1b --server-url http://localhost:3000 --project-id test-project --repo-path /test/repo
[OrchestratorWorkflowEngine] Creating execution with config: {
  "mode": "worktree",
  "baseBranch": "main",
  "reuseWorktreePath": "/test/worktrees/workflow-test",
  "dangerouslySkipPermissions": true,
  "mcpServers": {
    "sudocode-workflow": {
      "command": "node",
      "args": [
        "/Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js",
        "--workflow-id",
        "wf-c2020a1b",
        "--server-url",
        "http://localhost:3000",
        "--project-id",
        "test-project",
        "--repo-path",
        "/test/repo"
      ]
    }
  },
  "appendSystemPrompt": "\nYou are a workflow orchestrator managing the execution of coding tasks.\nYou have access to workflow MCP tools to control execution flow.\n\nIMPORTANT: You are orchestrating workflow \"wf-c2020a1b\".\nUse the workflow tools to:\n- Check workflow status with workflow_status\n- Execute issues with execute_issue\n- Inspect results with execution_trajectory and execution_changes\n- Handle failures appropriately based on the workflow config\n- Mark the workflow complete when done with workflow_complete\n"
}

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should not cancel already completed executions
[OrchestratorEngine] Cancelling 1 orchestrator executions in chain

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > cancelWorkflow > should not cancel already completed executions
[OrchestratorEngine] Cancelling 0 step executions
[OrchestratorEngine] Cancelled 1 total executions for workflow wf-c2020a1b

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > retryStep > should record retry event
[OrchestratorWorkflowEngine] startWorkflow called for wf-5229673f

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > retryStep > should record retry event
[OrchestratorWorkflowEngine] Creating workflow worktree for wf-5229673f

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > retryStep > should record retry event
[BaseWorkflowEngine] Created workflow worktree for wf-5229673f: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > retryStep > should record retry event
[OrchestratorWorkflowEngine] Spawning orchestrator for workflow wf-5229673f
[OrchestratorWorkflowEngine] MCP server path: /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js
[OrchestratorWorkflowEngine] MCP server config for workflow wf-5229673f
[OrchestratorWorkflowEngine] To test MCP locally, run:
  node /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js --workflow-id wf-5229673f --server-url http://localhost:3000 --project-id test-project --repo-path /test/repo
[OrchestratorWorkflowEngine] Creating execution with config: {
  "mode": "worktree",
  "baseBranch": "main",
  "reuseWorktreePath": "/test/worktrees/workflow-test",
  "dangerouslySkipPermissions": true,
  "mcpServers": {
    "sudocode-workflow": {
      "command": "node",
      "args": [
        "/Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js",
        "--workflow-id",
        "wf-5229673f",
        "--server-url",
        "http://localhost:3000",
        "--project-id",
        "test-project",
        "--repo-path",
        "/test/repo"
      ]
    }
  },
  "appendSystemPrompt": "\nYou are a workflow orchestrator managing the execution of coding tasks.\nYou have access to workflow MCP tools to control execution flow.\n\nIMPORTANT: You are orchestrating workflow \"wf-5229673f\".\nUse the workflow tools to:\n- Check workflow status with workflow_status\n- Execute issues with execute_issue\n- Inspect results with execution_trajectory and execution_changes\n- Handle failures appropriately based on the workflow config\n- Mark the workflow complete when done with workflow_complete\n"
}

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > skipStep > should record skip event with reason
[OrchestratorWorkflowEngine] startWorkflow called for wf-12e67937

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > skipStep > should record skip event with reason
[OrchestratorWorkflowEngine] Creating workflow worktree for wf-12e67937

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > skipStep > should record skip event with reason
[BaseWorkflowEngine] Created workflow worktree for wf-12e67937: /test/worktrees/workflow-test (branch: sudocode/workflow/test/test-workflow)

stdout | tests/unit/workflow/engines/orchestrator-engine.test.ts > OrchestratorWorkflowEngine > skipStep > should record skip event with reason
[OrchestratorWorkflowEngine] Spawning orchestrator for workflow wf-12e67937
[OrchestratorWorkflowEngine] MCP server path: /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js
[OrchestratorWorkflowEngine] MCP server config for workflow wf-12e67937
[OrchestratorWorkflowEngine] To test MCP locally, run:
  node /Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js --workflow-id wf-12e67937 --server-url http://localhost:3000 --project-id test-project --repo-path /test/repo
[OrchestratorWorkflowEngine] Creating execution with config: {
  "mode": "worktree",
  "baseBranch": "main",
  "reuseWorktreePath": "/test/worktrees/workflow-test",
  "dangerouslySkipPermissions": true,
  "mcpServers": {
    "sudocode-workflow": {
      "command": "node",
      "args": [
        "/Users/randy/sudocodeai/sudocode/server/dist/workflow/mcp/index.js",
        "--workflow-id",
        "wf-12e67937",
        "--server-url",
        "http://localhost:3000",
        "--project-id",
        "test-project",
        "--repo-path",
        "/test/repo"
      ]
    }
  },
  "appendSystemPrompt": "\nYou are a workflow orchestrator managing the execution of coding tasks.\nYou have access to workflow MCP tools to control execution flow.\n\nIMPORTANT: You are orchestrating workflow \"wf-12e67937\".\nUse the workflow tools to:\n- Check workflow status with workflow_status\n- Execute issues with execute_issue\n- Inspect results with execution_trajectory and execution_changes\n- Handle failures appropriately based on the workflow config\n- Mark the workflow complete when done with workflow_complete\n"
}

 âœ“ |@sudocode-ai/local-server| tests/unit/routes/workflows.test.ts (54 tests) 3739ms
stdout | tests/integration/workflow/mcp-protocol.test.ts > Workflow MCP Protocol > should handle escalate_to_user in human_in_the_loop mode
[workflows] getEngineForWorkflow: workflow=wf-test1, engineType=sequential
[workflows/:id/escalate] Escalation created for workflow wf-test1: 8e9668a2-48d9-4304-843c-d74f6fb2e9ca

 âœ“ |@sudocode-ai/local-server| tests/unit/workflow/engines/orchestrator-engine.test.ts (39 tests) 2585ms
stdout | tests/unit/workflow/services/wakeup-service.test.ts > WorkflowWakeupService > recordEvent > should schedule wakeup after recording event
[WakeupService] Stopping previous orchestrator execution orch-exec-1 before creating follow-up

stdout | tests/unit/feedback.test.ts > Feedback API
Initializing new database for test-project-7bf36aef at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-feedback-ahjtDa/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/feedback.test.ts > Feedback API
Project context initialized: test-project-7bf36aef at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-feedback-ahjtDa/test-project

stdout | tests/unit/feedback.test.ts > Feedback API
[project-manager] Starting workflow recovery for test-project-7bf36aef...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/feedback.test.ts > Feedback API
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/feedback.test.ts > Feedback API
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/feedback.test.ts > Feedback API
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/feedback.test.ts > Feedback API
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/feedback.test.ts > Feedback API
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/feedback.test.ts > Feedback API
[WakeupService] State recovery complete

stdout | tests/unit/feedback.test.ts > Feedback API
[project-manager] Workflow recovery complete for test-project-7bf36aef
[integration-sync] Starting for project test-project-7bf36aef
[integration-sync] No enabled integrations found

stdout | tests/unit/feedback.test.ts > Feedback API
Project opened successfully: test-project-7bf36aef at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-feedback-ahjtDa/test-project

stdout | tests/unit/workflow/services/wakeup-service.test.ts > WorkflowWakeupService > scheduleWakeup > should debounce multiple calls
[WakeupService] Stopping previous orchestrator execution orch-exec-1 before creating follow-up

stdout | tests/unit/workflow/services/wakeup-service.test.ts > WorkflowWakeupService > scheduleWakeup > should reset timer on new event
[WakeupService] Stopping previous orchestrator execution orch-exec-1 before creating follow-up

stdout | tests/unit/workflow/services/wakeup-service.test.ts > WorkflowWakeupService > triggerWakeup > should create follow-up execution with wakeup message
[WakeupService] Stopping previous orchestrator execution orch-exec-1 before creating follow-up

stdout | tests/unit/workflow/services/wakeup-service.test.ts > WorkflowWakeupService > triggerWakeup > should update workflow orchestrator execution ID
[WakeupService] Stopping previous orchestrator execution orch-exec-1 before creating follow-up

stdout | tests/unit/workflow/services/wakeup-service.test.ts > WorkflowWakeupService > triggerWakeup > should mark events as processed after wakeup
[WakeupService] Stopping previous orchestrator execution orch-exec-1 before creating follow-up

stdout | tests/unit/workflow/services/wakeup-service.test.ts > WorkflowWakeupService > triggerWakeup > should emit orchestrator_wakeup event
[WakeupService] Stopping previous orchestrator execution orch-exec-1 before creating follow-up

stdout | tests/unit/workflow/services/wakeup-service.test.ts > WorkflowWakeupService > triggerWakeup > should skip wakeup if workflow is paused
Skipping wakeup for workflow wf-test: status is paused

stdout | tests/unit/workflow/services/wakeup-service.test.ts > WorkflowWakeupService > triggerWakeup > should skip wakeup if no unprocessed events
No unprocessed events for workflow wf-test

stdout | tests/unit/workflow/services/wakeup-service.test.ts > WorkflowWakeupService > triggerWakeup > should cancel previous execution before creating follow-up when still running
[WakeupService] Stopping previous orchestrator execution orch-exec-1 before creating follow-up

stdout | tests/unit/workflow/services/wakeup-service.test.ts > WorkflowWakeupService > triggerWakeup > should cancel previous execution in pending state
[WakeupService] Stopping previous orchestrator execution orch-exec-1 before creating follow-up

stdout | tests/unit/workflow/services/wakeup-service.test.ts > WorkflowWakeupService > triggerWakeup > should cancel previous execution in preparing state
[WakeupService] Stopping previous orchestrator execution orch-exec-1 before creating follow-up

stdout | tests/unit/workflow/services/wakeup-service.test.ts > WorkflowWakeupService > triggerWakeup > should continue creating follow-up even if cancel fails
[WakeupService] Stopping previous orchestrator execution orch-exec-1 before creating follow-up

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should establish SSE connection
Initializing new database for test-project-0e2931d7 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-stream-8DaFrg/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should establish SSE connection
Project context initialized: test-project-0e2931d7 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-stream-8DaFrg/test-project

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should establish SSE connection
[project-manager] Starting workflow recovery for test-project-0e2931d7...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should establish SSE connection
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should establish SSE connection
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should establish SSE connection
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should establish SSE connection
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should establish SSE connection
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should establish SSE connection
[WakeupService] State recovery complete

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should establish SSE connection
[project-manager] Workflow recovery complete for test-project-0e2931d7
[integration-sync] Starting for project test-project-0e2931d7
[integration-sync] No enabled integrations found

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should establish SSE connection
Project opened successfully: test-project-0e2931d7 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-stream-8DaFrg/test-project

stdout | tests/unit/workflow/services/wakeup-await.test.ts > WorkflowWakeupService Await Functionality > registerAwait > should register an await condition and return await ID
[WakeupService] Registered await 796d2408-1945-4a39-aaca-e604c2c6f773 for workflow wf-test {
  eventTypes: [ [32m'step_completed'[39m, [32m'step_failed'[39m ],
  executionIds: [90mundefined[39m
}

stdout | tests/unit/workflow/services/wakeup-await.test.ts > WorkflowWakeupService Await Functionality > registerAwait > should calculate timeout_at when timeout_seconds is provided
[WakeupService] Scheduled 300s timeout for await dfd2e0a7-54b1-4886-83cd-acb4c6c69801
[WakeupService] Registered await dfd2e0a7-54b1-4886-83cd-acb4c6c69801 for workflow wf-test { eventTypes: [ [32m'step_completed'[39m ], executionIds: [90mundefined[39m }

stdout | tests/unit/workflow/services/wakeup-await.test.ts > WorkflowWakeupService Await Functionality > registerAwait > should store pending await that can be retrieved
[WakeupService] Registered await fefca3d0-bb05-44ce-925f-8526cbacae2c for workflow wf-test { eventTypes: [ [32m'step_completed'[39m ], executionIds: [ [32m'exec-1'[39m ] }

stdout | tests/unit/workflow/services/wakeup-await.test.ts > WorkflowWakeupService Await Functionality > registerAwait > should replace existing await for same workflow
[WakeupService] Registered await 67acb467-efb2-4709-8941-0e90ed88a8fe for workflow wf-test { eventTypes: [ [32m'step_completed'[39m ], executionIds: [90mundefined[39m }
[WakeupService] Registered await c8c323c4-3fff-48b2-b3e8-074e8b5c62dc for workflow wf-test {
  eventTypes: [ [32m'step_failed'[39m, [32m'user_response'[39m ],
  executionIds: [90mundefined[39m
}

stdout | tests/unit/workflow/services/wakeup-await.test.ts > WorkflowWakeupService Await Functionality > await condition matching > should trigger immediate wakeup when event matches await condition
[WakeupService] Registered await 8045f111-9394-498f-9607-8d848457bb7b for workflow wf-test { eventTypes: [ [32m'step_completed'[39m ], executionIds: [90mundefined[39m }
[WakeupService] Resolved await 8045f111-9394-498f-9607-8d848457bb7b for workflow wf-test { resolvedBy: [32m'step_completed'[39m }
[WakeupService] Stopping previous orchestrator execution orch-exec-1 before creating follow-up

stdout | tests/unit/workflow/services/wakeup-await.test.ts > WorkflowWakeupService Await Functionality > await condition matching > should not trigger immediate wakeup for non-matching event type
[WakeupService] Registered await b6fe7378-8752-4276-9309-174ef0924a9b for workflow wf-test { eventTypes: [ [32m'step_failed'[39m ], executionIds: [90mundefined[39m }

stdout | tests/unit/workflow/services/wakeup-await.test.ts > WorkflowWakeupService Await Functionality > await condition matching > should not trigger immediate wakeup for non-matching event type
[WakeupService] Stopping previous orchestrator execution orch-exec-1 before creating follow-up

stdout | tests/unit/workflow/services/wakeup-await.test.ts > WorkflowWakeupService Await Functionality > await condition matching > should filter by execution ID when specified
[WakeupService] Registered await a68f1cbf-b3c1-45c5-bce4-9aec7e656fa6 for workflow wf-test { eventTypes: [ [32m'step_completed'[39m ], executionIds: [ [32m'exec-2'[39m ] }

stdout | tests/unit/workflow/services/wakeup-await.test.ts > WorkflowWakeupService Await Functionality > await condition matching > should filter by execution ID when specified
[WakeupService] Resolved await a68f1cbf-b3c1-45c5-bce4-9aec7e656fa6 for workflow wf-test { resolvedBy: [32m'step_completed'[39m }
[WakeupService] Stopping previous orchestrator execution orch-exec-1 before creating follow-up

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should establish SSE connection
Shutting down ProjectManager...
Closing project: test-project-0e2931d7
Shutting down project context: test-project-0e2931d7

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should establish SSE connection
[integration-sync] Stopping for project test-project-0e2931d7
[integration-sync] Service stopped for test-project-0e2931d7

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should establish SSE connection
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-0e2931d7

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should establish SSE connection
Project closed: test-project-0e2931d7

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should establish SSE connection
ProjectManager shutdown complete

stdout | tests/unit/feedback.test.ts > Feedback API
Shutting down ProjectManager...
Closing project: test-project-7bf36aef
Shutting down project context: test-project-7bf36aef

stdout | tests/unit/feedback.test.ts > Feedback API
[integration-sync] Stopping for project test-project-7bf36aef
[integration-sync] Service stopped for test-project-7bf36aef

stdout | tests/unit/feedback.test.ts > Feedback API
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-7bf36aef

stdout | tests/unit/workflow/services/wakeup-await.test.ts > WorkflowWakeupService Await Functionality > await condition matching > should clear pending await after it is satisfied
[WakeupService] Registered await 575e9643-371a-4428-bf5e-1e14449caa5e for workflow wf-test { eventTypes: [ [32m'step_completed'[39m ], executionIds: [90mundefined[39m }
[WakeupService] Resolved await 575e9643-371a-4428-bf5e-1e14449caa5e for workflow wf-test { resolvedBy: [32m'step_completed'[39m }
[WakeupService] Stopping previous orchestrator execution orch-exec-1 before creating follow-up

stdout | tests/unit/workflow/services/wakeup-await.test.ts > WorkflowWakeupService Await Functionality > await timeout > should trigger wakeup when timeout expires
[WakeupService] Scheduled 5s timeout for await 1e1ff175-be70-48dd-ad1b-4d995eed10f6
[WakeupService] Registered await 1e1ff175-be70-48dd-ad1b-4d995eed10f6 for workflow wf-test { eventTypes: [ [32m'step_completed'[39m ], executionIds: [90mundefined[39m }

stdout | tests/unit/workflow/services/wakeup-await.test.ts > WorkflowWakeupService Await Functionality > await timeout > should trigger wakeup when timeout expires
[WakeupService] Resolved await 1e1ff175-be70-48dd-ad1b-4d995eed10f6 for workflow wf-test { resolvedBy: [32m'timeout'[39m }
[WakeupService] Stopping previous orchestrator execution orch-exec-1 before creating follow-up

stdout | tests/unit/workflow/services/wakeup-await.test.ts > WorkflowWakeupService Await Functionality > await timeout > should resolve await with 'timeout' when timeout expires
[WakeupService] Scheduled 5s timeout for await 2aaba5d8-8e1c-4099-9b43-ef4cc2126b8f
[WakeupService] Registered await 2aaba5d8-8e1c-4099-9b43-ef4cc2126b8f for workflow wf-test { eventTypes: [ [32m'step_completed'[39m ], executionIds: [90mundefined[39m }

stdout | tests/unit/workflow/services/wakeup-await.test.ts > WorkflowWakeupService Await Functionality > await timeout > should resolve await with 'timeout' when timeout expires
[WakeupService] Resolved await 2aaba5d8-8e1c-4099-9b43-ef4cc2126b8f for workflow wf-test { resolvedBy: [32m'timeout'[39m }
[WakeupService] Stopping previous orchestrator execution orch-exec-1 before creating follow-up

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should set SSE headers
Initializing new database for test-project-584c54c3 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-stream-gYpb3r/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should set SSE headers
Project context initialized: test-project-584c54c3 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-stream-gYpb3r/test-project

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should set SSE headers
[project-manager] Starting workflow recovery for test-project-584c54c3...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should set SSE headers
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should set SSE headers
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should set SSE headers
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should set SSE headers
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should set SSE headers
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should set SSE headers
[WakeupService] State recovery complete

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should set SSE headers
[project-manager] Workflow recovery complete for test-project-584c54c3
[integration-sync] Starting for project test-project-584c54c3
[integration-sync] No enabled integrations found

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should set SSE headers
Project opened successfully: test-project-584c54c3 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-stream-gYpb3r/test-project

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should set SSE headers
Shutting down ProjectManager...
Closing project: test-project-584c54c3
Shutting down project context: test-project-584c54c3

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should set SSE headers
[integration-sync] Stopping for project test-project-584c54c3
[integration-sync] Service stopped for test-project-584c54c3

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should set SSE headers
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-584c54c3

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should set SSE headers
Project closed: test-project-584c54c3

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should set SSE headers
ProjectManager shutdown complete

stdout | tests/unit/feedback.test.ts > Feedback API
Project closed: test-project-7bf36aef

stdout | tests/unit/feedback.test.ts > Feedback API
ProjectManager shutdown complete

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should handle different execution IDs
Initializing new database for test-project-db37040a at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-stream-LXAVzj/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should handle different execution IDs
Project context initialized: test-project-db37040a at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-stream-LXAVzj/test-project

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should handle different execution IDs
[project-manager] Starting workflow recovery for test-project-db37040a...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should handle different execution IDs
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should handle different execution IDs
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should handle different execution IDs
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should handle different execution IDs
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should handle different execution IDs
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should handle different execution IDs
[WakeupService] State recovery complete

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should handle different execution IDs
[project-manager] Workflow recovery complete for test-project-db37040a
[integration-sync] Starting for project test-project-db37040a
[integration-sync] No enabled integrations found

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should handle different execution IDs
Project opened successfully: test-project-db37040a at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-stream-LXAVzj/test-project

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should handle different execution IDs
Shutting down ProjectManager...
Closing project: test-project-db37040a
Shutting down project context: test-project-db37040a

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should handle different execution IDs
[integration-sync] Stopping for project test-project-db37040a
[integration-sync] Service stopped for test-project-db37040a

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should handle different execution IDs
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-db37040a

stdout | tests/unit/workflow/services/wakeup-await.test.ts > WorkflowWakeupService Await Functionality > await timeout > should clear timeout when await is satisfied before timeout
[WakeupService] Scheduled 10s timeout for await 91f6f96e-d94d-4912-95cb-d7bef1c6479c
[WakeupService] Registered await 91f6f96e-d94d-4912-95cb-d7bef1c6479c for workflow wf-test { eventTypes: [ [32m'step_completed'[39m ], executionIds: [90mundefined[39m }
[WakeupService] Resolved await 91f6f96e-d94d-4912-95cb-d7bef1c6479c for workflow wf-test { resolvedBy: [32m'step_completed'[39m }
[WakeupService] Stopping previous orchestrator execution orch-exec-1 before creating follow-up

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should handle different execution IDs
Project closed: test-project-db37040a

stdout | tests/unit/workflow/services/wakeup-await.test.ts > WorkflowWakeupService Await Functionality > await timeout > should not trigger timeout if await was replaced
[WakeupService] Scheduled 5s timeout for await 55247489-eb04-43f4-b904-ac53981ed0fd
[WakeupService] Registered await 55247489-eb04-43f4-b904-ac53981ed0fd for workflow wf-test { eventTypes: [ [32m'step_completed'[39m ], executionIds: [90mundefined[39m }

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should handle different execution IDs
ProjectManager shutdown complete

stdout | tests/unit/workflow/services/wakeup-await.test.ts > WorkflowWakeupService Await Functionality > await timeout > should not trigger timeout if await was replaced
[WakeupService] Scheduled 10s timeout for await 2dfb0722-4e18-4f0e-88e8-bb8440a893e4
[WakeupService] Registered await 2dfb0722-4e18-4f0e-88e8-bb8440a893e4 for workflow wf-test { eventTypes: [ [32m'step_failed'[39m ], executionIds: [90mundefined[39m }

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should generate unique client IDs for each connection
Initializing new database for test-project-3add1562 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-stream-CcV6Go/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should generate unique client IDs for each connection
Project context initialized: test-project-3add1562 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-stream-CcV6Go/test-project

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should generate unique client IDs for each connection
[project-manager] Starting workflow recovery for test-project-3add1562...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should generate unique client IDs for each connection
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should generate unique client IDs for each connection
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should generate unique client IDs for each connection
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should generate unique client IDs for each connection
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should generate unique client IDs for each connection
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should generate unique client IDs for each connection
[WakeupService] State recovery complete

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should generate unique client IDs for each connection
[project-manager] Workflow recovery complete for test-project-3add1562
[integration-sync] Starting for project test-project-3add1562
[integration-sync] No enabled integrations found

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should generate unique client IDs for each connection
Project opened successfully: test-project-3add1562 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-stream-CcV6Go/test-project

stdout | tests/unit/workflow/services/wakeup-await.test.ts > WorkflowWakeupService Await Functionality > await timeout > should not trigger timeout if await was replaced
[WakeupService] Resolved await 2dfb0722-4e18-4f0e-88e8-bb8440a893e4 for workflow wf-test { resolvedBy: [32m'timeout'[39m }
[WakeupService] Stopping previous orchestrator execution orch-exec-1 before creating follow-up

stdout | tests/unit/workflow/services/wakeup-await.test.ts > WorkflowWakeupService Await Functionality > getAndClearResolvedAwait > should return resolved await context after event triggers it
[WakeupService] Registered await bff74b7f-ab52-47e5-ad59-665d43163694 for workflow wf-test {
  eventTypes: [ [32m'step_completed'[39m, [32m'step_failed'[39m ],
  executionIds: [ [32m'exec-1'[39m ]
}
[WakeupService] Resolved await bff74b7f-ab52-47e5-ad59-665d43163694 for workflow wf-test { resolvedBy: [32m'step_completed'[39m }
[WakeupService] Stopping previous orchestrator execution orch-exec-1 before creating follow-up

stdout | tests/unit/workflow/services/wakeup-await.test.ts > WorkflowWakeupService Await Functionality > getAndClearResolvedAwait > should clear resolved await after retrieval
[WakeupService] Registered await f6d45018-6baf-4c96-bc5c-f46817c0d442 for workflow wf-test { eventTypes: [ [32m'step_completed'[39m ], executionIds: [90mundefined[39m }
[WakeupService] Resolved await f6d45018-6baf-4c96-bc5c-f46817c0d442 for workflow wf-test { resolvedBy: [32m'step_completed'[39m }
[WakeupService] Stopping previous orchestrator execution orch-exec-1 before creating follow-up

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should generate unique client IDs for each connection
Shutting down ProjectManager...
Closing project: test-project-3add1562
Shutting down project context: test-project-3add1562

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should generate unique client IDs for each connection
[integration-sync] Stopping for project test-project-3add1562
[integration-sync] Service stopped for test-project-3add1562

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should generate unique client IDs for each connection
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-3add1562

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should generate unique client IDs for each connection
Project closed: test-project-3add1562

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should generate unique client IDs for each connection
ProjectManager shutdown complete

stdout | tests/unit/workflow/services/wakeup-await.test.ts > WorkflowWakeupService Await Functionality > clearAwaitState > should clear pending await and timeout
[WakeupService] Scheduled 10s timeout for await 4e218cee-1c86-4b7d-9734-c45926eace7b
[WakeupService] Registered await 4e218cee-1c86-4b7d-9734-c45926eace7b for workflow wf-test { eventTypes: [ [32m'step_completed'[39m ], executionIds: [90mundefined[39m }

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should support multiple concurrent connections
Initializing new database for test-project-1a86926c at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-stream-WPBZcD/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should support multiple concurrent connections
Project context initialized: test-project-1a86926c at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-stream-WPBZcD/test-project

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should support multiple concurrent connections
[project-manager] Starting workflow recovery for test-project-1a86926c...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should support multiple concurrent connections
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should support multiple concurrent connections
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should support multiple concurrent connections
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/workflow/services/wakeup-await.test.ts > WorkflowWakeupService Await Functionality > stop > should clear all await state on stop
[WakeupService] Scheduled 5s timeout for await b09a38e9-b11a-40a8-890d-d2e77f52657a
[WakeupService] Registered await b09a38e9-b11a-40a8-890d-d2e77f52657a for workflow wf-1 { eventTypes: [ [32m'step_completed'[39m ], executionIds: [90mundefined[39m }
[WakeupService] Scheduled 5s timeout for await 5f093283-6a39-4c4b-a515-3b945a10389f
[WakeupService] Registered await 5f093283-6a39-4c4b-a515-3b945a10389f for workflow wf-2 { eventTypes: [ [32m'step_failed'[39m ], executionIds: [90mundefined[39m }

stdout | tests/unit/workflow/services/wakeup-await.test.ts > WorkflowWakeupService Await Functionality > multiple event types > should match any of the specified event types
[WakeupService] Registered await f6f50042-8c16-45d9-bf53-0d125de60285 for workflow wf-test {
  eventTypes: [ [32m'step_completed'[39m, [32m'step_failed'[39m, [32m'user_response'[39m ],
  executionIds: [90mundefined[39m
}
[WakeupService] Resolved await f6f50042-8c16-45d9-bf53-0d125de60285 for workflow wf-test { resolvedBy: [32m'step_failed'[39m }
[WakeupService] Stopping previous orchestrator execution orch-exec-1 before creating follow-up

stdout | tests/unit/workflow/services/wakeup-await.test.ts > WorkflowWakeupService Await Functionality > multiple event types > should not match event types not in the list
[WakeupService] Registered await d4579af7-6b5e-4afa-b612-0b144586614f for workflow wf-test { eventTypes: [ [32m'step_completed'[39m ], executionIds: [90mundefined[39m }

stdout | tests/unit/workflow/services/wakeup-await.test.ts > WorkflowWakeupService Await Functionality > escalation events > should match escalation_resolved event type
[WakeupService] Registered await 258407cb-611a-4465-a32e-5fa04582a557 for workflow wf-test { eventTypes: [ [32m'escalation_resolved'[39m ], executionIds: [90mundefined[39m }
[WakeupService] Resolved await 258407cb-611a-4465-a32e-5fa04582a557 for workflow wf-test { resolvedBy: [32m'escalation_resolved'[39m }
[WakeupService] Stopping previous orchestrator execution orch-exec-1 before creating follow-up

stdout | tests/unit/workflow/services/wakeup-await.test.ts > WorkflowWakeupService Await Functionality > escalation events > should match user_response event type
[WakeupService] Registered await 14555cb4-8373-4e71-b0a1-44e860d73585 for workflow wf-test { eventTypes: [ [32m'user_response'[39m ], executionIds: [90mundefined[39m }
[WakeupService] Resolved await 14555cb4-8373-4e71-b0a1-44e860d73585 for workflow wf-test { resolvedBy: [32m'user_response'[39m }
[WakeupService] Stopping previous orchestrator execution orch-exec-1 before creating follow-up

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should support multiple concurrent connections
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should support multiple concurrent connections
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should support multiple concurrent connections
[WakeupService] State recovery complete

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should support multiple concurrent connections
[project-manager] Workflow recovery complete for test-project-1a86926c
[integration-sync] Starting for project test-project-1a86926c
[integration-sync] No enabled integrations found

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should support multiple concurrent connections
Project opened successfully: test-project-1a86926c at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-stream-WPBZcD/test-project

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should support multiple concurrent connections
Shutting down ProjectManager...
Closing project: test-project-1a86926c
Shutting down project context: test-project-1a86926c

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should support multiple concurrent connections
[integration-sync] Stopping for project test-project-1a86926c
[integration-sync] Service stopped for test-project-1a86926c

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should support multiple concurrent connections
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-1a86926c

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should support multiple concurrent connections
Project closed: test-project-1a86926c

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > GET /:executionId/stream > should support multiple concurrent connections
ProjectManager shutdown complete

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > Integration > should allow streaming events after connection
Initializing new database for test-project-f998311a at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-stream-tCQ6qR/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > Integration > should allow streaming events after connection
Project context initialized: test-project-f998311a at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-stream-tCQ6qR/test-project

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > Integration > should allow streaming events after connection
[project-manager] Starting workflow recovery for test-project-f998311a...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > Integration > should allow streaming events after connection
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > Integration > should allow streaming events after connection
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > Integration > should allow streaming events after connection
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > Integration > should allow streaming events after connection
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > Integration > should allow streaming events after connection
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > Integration > should allow streaming events after connection
[WakeupService] State recovery complete

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > Integration > should allow streaming events after connection
[project-manager] Workflow recovery complete for test-project-f998311a
[integration-sync] Starting for project test-project-f998311a
[integration-sync] No enabled integrations found

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > Integration > should allow streaming events after connection
Project opened successfully: test-project-f998311a at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-stream-tCQ6qR/test-project

 âœ“ |@sudocode-ai/local-server| tests/unit/workflow/services/wakeup-service.test.ts (24 tests) 2861ms
   âœ“ WorkflowWakeupService > recordEvent > should insert event into database  542ms
   âœ“ WorkflowWakeupService > markEventsProcessed > should set processed_at on events  315ms
stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > Integration > should allow streaming events after connection
Shutting down ProjectManager...
Closing project: test-project-f998311a
Shutting down project context: test-project-f998311a

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > Integration > should allow streaming events after connection
[integration-sync] Stopping for project test-project-f998311a
[integration-sync] Service stopped for test-project-f998311a

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > Integration > should allow streaming events after connection
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-f998311a

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > Integration > should allow streaming events after connection
Project closed: test-project-f998311a

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > Integration > should allow streaming events after connection
ProjectManager shutdown complete

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > Integration > should isolate events between different executions
Initializing new database for test-project-87002323 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-stream-Tj5SJ2/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > Integration > should isolate events between different executions
Project context initialized: test-project-87002323 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-stream-Tj5SJ2/test-project

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > Integration > should isolate events between different executions
[project-manager] Starting workflow recovery for test-project-87002323...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > Integration > should isolate events between different executions
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > Integration > should isolate events between different executions
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > Integration > should isolate events between different executions
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > Integration > should isolate events between different executions
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > Integration > should isolate events between different executions
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > Integration > should isolate events between different executions
[WakeupService] State recovery complete

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > Integration > should isolate events between different executions
[project-manager] Workflow recovery complete for test-project-87002323
[integration-sync] Starting for project test-project-87002323
[integration-sync] No enabled integrations found

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > Integration > should isolate events between different executions
Project opened successfully: test-project-87002323 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-exec-stream-Tj5SJ2/test-project

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > Integration > should isolate events between different executions
Shutting down ProjectManager...
Closing project: test-project-87002323
Shutting down project context: test-project-87002323

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > Integration > should isolate events between different executions
[integration-sync] Stopping for project test-project-87002323
[integration-sync] Service stopped for test-project-87002323

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > Integration > should isolate events between different executions
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-87002323

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > Integration > should isolate events between different executions
Project closed: test-project-87002323

stdout | tests/unit/routes/executions-stream.test.ts > Execution Stream Routes > Integration > should isolate events between different executions
ProjectManager shutdown complete

stdout | tests/integration/workflow/mcp-protocol.test.ts > Workflow MCP Protocol > should handle notify_user
[workflows/:id/notify] [INFO] Workflow wf-test1: Progress update: Step 1 complete

 âœ“ |@sudocode-ai/local-server| tests/unit/feedback.test.ts (29 tests) 3332ms
 âœ“ |@sudocode-ai/local-server| tests/unit/workflow/services/wakeup-await.test.ts (21 tests) 2218ms
stdout | tests/unit/issues.test.ts > Issues API
Initializing new database for test-project-1bb1ebd1 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-issues-o9cCtQ/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/issues.test.ts > Issues API
Project context initialized: test-project-1bb1ebd1 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-issues-o9cCtQ/test-project

stdout | tests/unit/issues.test.ts > Issues API
[project-manager] Starting workflow recovery for test-project-1bb1ebd1...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/issues.test.ts > Issues API
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/issues.test.ts > Issues API
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/issues.test.ts > Issues API
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/issues.test.ts > Issues API
[WakeupService] Found 0 workflows with unprocessed events

 âœ“ |@sudocode-ai/local-server| tests/unit/routes/executions-stream.test.ts (7 tests) 2947ms
   âœ“ Execution Stream Routes > GET /:executionId/stream > should establish SSE connection  705ms
   âœ“ Execution Stream Routes > GET /:executionId/stream > should support multiple concurrent connections  367ms
stdout | tests/unit/issues.test.ts > Issues API
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/issues.test.ts > Issues API
[WakeupService] State recovery complete

stdout | tests/unit/issues.test.ts > Issues API
[project-manager] Workflow recovery complete for test-project-1bb1ebd1
[integration-sync] Starting for project test-project-1bb1ebd1
[integration-sync] No enabled integrations found

stdout | tests/unit/issues.test.ts > Issues API
Project opened successfully: test-project-1bb1ebd1 at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-issues-o9cCtQ/test-project

 âœ“ |@sudocode-ai/local-server| tests/integration/workflow/mcp-protocol.test.ts (7 tests) 22577ms
   âœ“ Workflow MCP Protocol > should list available tools  1737ms
   âœ“ Workflow MCP Protocol > should handle workflow_status tool call  3709ms
   âœ“ Workflow MCP Protocol > should handle workflow_complete tool call  3012ms
   âœ“ Workflow MCP Protocol > should return error for unknown tool  2723ms
   âœ“ Workflow MCP Protocol > should handle execution_status for non-existent execution  3122ms
   âœ“ Workflow MCP Protocol > should handle escalate_to_user in human_in_the_loop mode  2847ms
   âœ“ Workflow MCP Protocol > should handle notify_user  3744ms
stdout | tests/unit/specs.test.ts > Specs API
Initializing new database for test-project-b816c8fc at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-specs-lAi60v/test-project/.sudocode/cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/specs.test.ts > Specs API
Project context initialized: test-project-b816c8fc at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-specs-lAi60v/test-project

stdout | tests/unit/specs.test.ts > Specs API
[project-manager] Starting workflow recovery for test-project-b816c8fc...
[SequentialWorkflowEngine] Starting workflow recovery...
[SequentialWorkflowEngine] Found 0 workflows to recover
[SequentialWorkflowEngine] Workflow recovery complete

stdout | tests/unit/specs.test.ts > Specs API
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/specs.test.ts > Specs API
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/specs.test.ts > Specs API
[WakeupService] Starting state recovery...
[WakeupService] Found 0 pending awaits to recover

stdout | tests/unit/specs.test.ts > Specs API
[WakeupService] Found 0 workflows with unprocessed events

stdout | tests/unit/specs.test.ts > Specs API
[WakeupService] Found 0 execution timeouts to recover

stdout | tests/unit/specs.test.ts > Specs API
[WakeupService] State recovery complete

stdout | tests/unit/specs.test.ts > Specs API
[project-manager] Workflow recovery complete for test-project-b816c8fc
[integration-sync] Starting for project test-project-b816c8fc
[integration-sync] No enabled integrations found

stdout | tests/unit/specs.test.ts > Specs API
Project opened successfully: test-project-b816c8fc at /var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-specs-lAi60v/test-project

stdout | tests/unit/issues.test.ts > Issues API
Shutting down ProjectManager...
Closing project: test-project-1bb1ebd1
Shutting down project context: test-project-1bb1ebd1

stdout | tests/unit/issues.test.ts > Issues API
[integration-sync] Stopping for project test-project-1bb1ebd1
[integration-sync] Service stopped for test-project-1bb1ebd1

stdout | tests/unit/issues.test.ts > Issues API
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-1bb1ebd1

stdout | tests/unit/issues.test.ts > Issues API
Project closed: test-project-1bb1ebd1

stdout | tests/unit/issues.test.ts > Issues API
ProjectManager shutdown complete

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Lifecycle - start() > should start without errors when no config exists
[integration-sync] Starting for project test-project
[integration-sync] No enabled integrations found

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Lifecycle - start() > should start without errors when no config exists
[integration-sync] Stopping for project test-project
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Lifecycle - start() > should start without creating coordinator when no providers enabled
[integration-sync] Starting for project test-project
[integration-sync] No enabled integrations found

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Lifecycle - start() > should start without creating coordinator when no providers enabled
[integration-sync] Stopping for project test-project
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Lifecycle - start() > should load enabled providers and create coordinator
[integration-sync] Starting for project test-project
[integration-sync] Found 1 enabled provider(s): beads

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Lifecycle - start() > should load enabled providers and create coordinator
[integration-sync] Registered provider 'beads' (plugin: Beads v1.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Lifecycle - start() > should load enabled providers and create coordinator
[integration-sync] Service started for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Lifecycle - start() > should load enabled providers and create coordinator
[integration-sync] Stopping for project test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Lifecycle - start() > should load enabled providers and create coordinator
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Lifecycle - start() > should skip providers when plugin not installed
[integration-sync] Starting for project test-project
[integration-sync] Found 1 enabled provider(s): unknown

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Lifecycle - start() > should skip providers when plugin not installed
[integration-sync] Service started for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Lifecycle - start() > should skip providers when plugin not installed
[integration-sync] Stopping for project test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Lifecycle - start() > should skip providers when plugin not installed
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Lifecycle - start() > should not start twice
[integration-sync] Starting for project test-project
[integration-sync] No enabled integrations found

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Lifecycle - start() > should not start twice
[integration-sync] Service already running for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Lifecycle - start() > should not start twice
[integration-sync] Stopping for project test-project
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Lifecycle - start() > should initialize provider status correctly
[integration-sync] Starting for project test-project
[integration-sync] Found 1 enabled provider(s): beads

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Lifecycle - start() > should initialize provider status correctly
[integration-sync] Registered provider 'beads' (plugin: Beads v1.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Lifecycle - start() > should initialize provider status correctly
[integration-sync] Service started for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Lifecycle - start() > should initialize provider status correctly
[integration-sync] Stopping for project test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Lifecycle - start() > should initialize provider status correctly
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Lifecycle - stop() > should stop cleanly
[integration-sync] Starting for project test-project
[integration-sync] Found 1 enabled provider(s): beads

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Lifecycle - stop() > should stop cleanly
[integration-sync] Registered provider 'beads' (plugin: Beads v1.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Lifecycle - stop() > should stop cleanly
[integration-sync] Service started for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Lifecycle - stop() > should stop cleanly
[integration-sync] Stopping for project test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Lifecycle - stop() > should stop cleanly
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Lifecycle - stop() > should be idempotent
[integration-sync] Starting for project test-project
[integration-sync] No enabled integrations found

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Lifecycle - stop() > should be idempotent
[integration-sync] Stopping for project test-project
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Lifecycle - reload() > should stop and restart service
[integration-sync] Starting for project test-project
[integration-sync] No enabled integrations found

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Lifecycle - reload() > should stop and restart service
[integration-sync] Reloading config for test-project
[integration-sync] Stopping for project test-project
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Lifecycle - reload() > should stop and restart service
[integration-sync] Starting for project test-project
[integration-sync] No enabled integrations found

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Lifecycle - reload() > should stop and restart service
[integration-sync] Stopping for project test-project
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncAll() > should throw if not started
[integration-sync] Starting for project test-project
[integration-sync] Found 1 enabled provider(s): beads

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncAll() > should throw if not started
[integration-sync] Registered provider 'beads' (plugin: Beads v1.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncAll() > should throw if not started
[integration-sync] Service started for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncAll() > should throw if not started
[integration-sync] Stopping for project test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncAll() > should throw if not started
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncAll() > should sync all providers and broadcast events
[integration-sync] Starting for project test-project
[integration-sync] Found 1 enabled provider(s): beads

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncAll() > should sync all providers and broadcast events
[integration-sync] Registered provider 'beads' (plugin: Beads v1.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncAll() > should sync all providers and broadcast events
[integration-sync] Service started for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncAll() > should sync all providers and broadcast events
[integration-sync] Stopping for project test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncAll() > should sync all providers and broadcast events
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncAll() > should update provider status on success
[integration-sync] Starting for project test-project
[integration-sync] Found 1 enabled provider(s): beads

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncAll() > should update provider status on success
[integration-sync] Registered provider 'beads' (plugin: Beads v1.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncAll() > should update provider status on success
[integration-sync] Service started for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncAll() > should update provider status on success
[integration-sync] Stopping for project test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncAll() > should update provider status on success
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncAll() > should update provider status on error
[integration-sync] Starting for project test-project
[integration-sync] Found 1 enabled provider(s): beads

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncAll() > should update provider status on error
[integration-sync] Registered provider 'beads' (plugin: Beads v1.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncAll() > should update provider status on error
[integration-sync] Service started for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncAll() > should update provider status on error
[integration-sync] Stopping for project test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncAll() > should update provider status on error
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncProvider() > should throw if not started
[integration-sync] Starting for project test-project
[integration-sync] Found 1 enabled provider(s): beads

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncProvider() > should throw if not started
[integration-sync] Registered provider 'beads' (plugin: Beads v1.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncProvider() > should throw if not started
[integration-sync] Service started for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncProvider() > should throw if not started
[integration-sync] Stopping for project test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncProvider() > should throw if not started
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncProvider() > should sync specific provider and broadcast events
[integration-sync] Starting for project test-project
[integration-sync] Found 1 enabled provider(s): beads

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncProvider() > should sync specific provider and broadcast events
[integration-sync] Registered provider 'beads' (plugin: Beads v1.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncProvider() > should sync specific provider and broadcast events
[integration-sync] Service started for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncProvider() > should sync specific provider and broadcast events
[integration-sync] Stopping for project test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncProvider() > should sync specific provider and broadcast events
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncProvider() > should broadcast error event on failure
[integration-sync] Starting for project test-project
[integration-sync] Found 1 enabled provider(s): beads

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncProvider() > should broadcast error event on failure
[integration-sync] Registered provider 'beads' (plugin: Beads v1.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncProvider() > should broadcast error event on failure
[integration-sync] Service started for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncProvider() > should broadcast error event on failure
[integration-sync] Stopping for project test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncProvider() > should broadcast error event on failure
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncEntity() > should return empty array if not started
[integration-sync] Starting for project test-project
[integration-sync] Found 1 enabled provider(s): beads

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncEntity() > should return empty array if not started
[integration-sync] Registered provider 'beads' (plugin: Beads v1.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncEntity() > should return empty array if not started
[integration-sync] Service started for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncEntity() > should return empty array if not started
[integration-sync] Stopping for project test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncEntity() > should return empty array if not started
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncEntity() > should sync specific entity
[integration-sync] Starting for project test-project
[integration-sync] Found 1 enabled provider(s): beads

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncEntity() > should sync specific entity
[integration-sync] Registered provider 'beads' (plugin: Beads v1.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncEntity() > should sync specific entity
[integration-sync] Service started for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncEntity() > should sync specific entity
[integration-sync] Stopping for project test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Sync Operations - syncEntity() > should sync specific entity
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > linkEntity() > should throw if not started
[integration-sync] Starting for project test-project
[integration-sync] Found 1 enabled provider(s): beads

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > linkEntity() > should throw if not started
[integration-sync] Registered provider 'beads' (plugin: Beads v1.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > linkEntity() > should throw if not started
[integration-sync] Service started for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > linkEntity() > should throw if not started
[integration-sync] Stopping for project test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > linkEntity() > should throw if not started
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > linkEntity() > should link entity with options
[integration-sync] Starting for project test-project
[integration-sync] Found 1 enabled provider(s): beads

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > linkEntity() > should link entity with options
[integration-sync] Registered provider 'beads' (plugin: Beads v1.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > linkEntity() > should link entity with options
[integration-sync] Service started for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > linkEntity() > should link entity with options
[integration-sync] Stopping for project test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > linkEntity() > should link entity with options
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > unlinkEntity() > should throw if not started
[integration-sync] Starting for project test-project
[integration-sync] Found 1 enabled provider(s): beads

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > unlinkEntity() > should throw if not started
[integration-sync] Registered provider 'beads' (plugin: Beads v1.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > unlinkEntity() > should throw if not started
[integration-sync] Service started for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > unlinkEntity() > should throw if not started
[integration-sync] Stopping for project test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > unlinkEntity() > should throw if not started
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > unlinkEntity() > should unlink entity
[integration-sync] Starting for project test-project
[integration-sync] Found 1 enabled provider(s): beads

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > unlinkEntity() > should unlink entity
[integration-sync] Registered provider 'beads' (plugin: Beads v1.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > unlinkEntity() > should unlink entity
[integration-sync] Service started for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > unlinkEntity() > should unlink entity
[integration-sync] Stopping for project test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > unlinkEntity() > should unlink entity
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > handleEntityDeleted() > should return empty array if not started
[integration-sync] Starting for project test-project
[integration-sync] Found 1 enabled provider(s): beads

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > handleEntityDeleted() > should return empty array if not started
[integration-sync] Registered provider 'beads' (plugin: Beads v1.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > handleEntityDeleted() > should return empty array if not started
[integration-sync] Service started for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > handleEntityDeleted() > should return empty array if not started
[integration-sync] Stopping for project test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > handleEntityDeleted() > should return empty array if not started
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > handleEntityDeleted() > should return empty array for empty external links
[integration-sync] Starting for project test-project
[integration-sync] Found 1 enabled provider(s): beads

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > handleEntityDeleted() > should return empty array for empty external links
[integration-sync] Registered provider 'beads' (plugin: Beads v1.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > handleEntityDeleted() > should return empty array for empty external links
[integration-sync] Service started for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > handleEntityDeleted() > should return empty array for empty external links
[integration-sync] Stopping for project test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > handleEntityDeleted() > should return empty array for empty external links
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > handleEntityDeleted() > should delegate to coordinator with external links
[integration-sync] Starting for project test-project
[integration-sync] Found 1 enabled provider(s): beads

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > handleEntityDeleted() > should delegate to coordinator with external links
[integration-sync] Registered provider 'beads' (plugin: Beads v1.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > handleEntityDeleted() > should delegate to coordinator with external links
[integration-sync] Service started for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > handleEntityDeleted() > should delegate to coordinator with external links
[integration-sync] Stopping for project test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > handleEntityDeleted() > should delegate to coordinator with external links
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > handleEntityDeleted() > should handle coordinator errors gracefully
[integration-sync] Starting for project test-project
[integration-sync] Found 1 enabled provider(s): beads

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > handleEntityDeleted() > should handle coordinator errors gracefully
[integration-sync] Registered provider 'beads' (plugin: Beads v1.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > handleEntityDeleted() > should handle coordinator errors gracefully
[integration-sync] Service started for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > handleEntityDeleted() > should handle coordinator errors gracefully
[integration-sync] Stopping for project test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > handleEntityDeleted() > should handle coordinator errors gracefully
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > handleEntityDeleted() > should work with mixed sync_enabled links
[integration-sync] Starting for project test-project
[integration-sync] Found 1 enabled provider(s): beads

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > handleEntityDeleted() > should work with mixed sync_enabled links
[integration-sync] Registered provider 'beads' (plugin: Beads v1.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > handleEntityDeleted() > should work with mixed sync_enabled links
[integration-sync] Service started for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > handleEntityDeleted() > should work with mixed sync_enabled links
[integration-sync] Stopping for project test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Link Management > handleEntityDeleted() > should work with mixed sync_enabled links
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Status and Info > should return all provider statuses
[integration-sync] Starting for project test-project
[integration-sync] Found 2 enabled provider(s): beads, jira

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Status and Info > should return all provider statuses
[integration-sync] Registered provider 'beads' (plugin: Test v1.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Status and Info > should return all provider statuses
[integration-sync] Registered provider 'jira' (plugin: Test v1.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Status and Info > should return all provider statuses
[integration-sync] Service started for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Status and Info > should return all provider statuses
[integration-sync] Stopping for project test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Status and Info > should return all provider statuses
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Status and Info > should return specific provider status
[integration-sync] Starting for project test-project
[integration-sync] Found 2 enabled provider(s): beads, jira

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Status and Info > should return specific provider status
[integration-sync] Registered provider 'beads' (plugin: Test v1.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Status and Info > should return specific provider status
[integration-sync] Registered provider 'jira' (plugin: Test v1.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Status and Info > should return specific provider status
[integration-sync] Service started for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Status and Info > should return specific provider status
[integration-sync] Stopping for project test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Status and Info > should return specific provider status
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Status and Info > should return null for unknown provider
[integration-sync] Starting for project test-project
[integration-sync] Found 2 enabled provider(s): beads, jira

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Status and Info > should return null for unknown provider
[integration-sync] Registered provider 'beads' (plugin: Test v1.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Status and Info > should return null for unknown provider
[integration-sync] Registered provider 'jira' (plugin: Test v1.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Status and Info > should return null for unknown provider
[integration-sync] Service started for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Status and Info > should return null for unknown provider
[integration-sync] Stopping for project test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Status and Info > should return null for unknown provider
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Status and Info > should report active status
[integration-sync] Starting for project test-project
[integration-sync] Found 2 enabled provider(s): beads, jira

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Status and Info > should report active status
[integration-sync] Registered provider 'beads' (plugin: Test v1.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Status and Info > should report active status
[integration-sync] Registered provider 'jira' (plugin: Test v1.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Status and Info > should report active status
[integration-sync] Service started for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Status and Info > should report active status
[integration-sync] Stopping for project test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Status and Info > should report active status
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Status and Info > should return registered provider names
[integration-sync] Starting for project test-project
[integration-sync] Found 2 enabled provider(s): beads, jira

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Status and Info > should return registered provider names
[integration-sync] Registered provider 'beads' (plugin: Test v1.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Status and Info > should return registered provider names
[integration-sync] Registered provider 'jira' (plugin: Test v1.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Status and Info > should return registered provider names
[integration-sync] Service started for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Status and Info > should return registered provider names
[integration-sync] Stopping for project test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Status and Info > should return registered provider names
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Polling > should start polling for providers with auto_sync and supportsPolling
[integration-sync] Starting for project test-project
[integration-sync] Found 1 enabled provider(s): beads

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Polling > should start polling for providers with auto_sync and supportsPolling
[integration-sync] Registered provider 'beads' (plugin: Beads v1.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Polling > should start polling for providers with auto_sync and supportsPolling
[integration-sync] Started polling for 'beads' every 60s
[integration-sync] Service started for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Polling > should start polling for providers with auto_sync and supportsPolling
[integration-sync] Polling provider 'beads'

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Polling > should start polling for providers with auto_sync and supportsPolling
[integration-sync] Stopping for project test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Polling > should start polling for providers with auto_sync and supportsPolling
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Polling > should not poll providers that support watching
[integration-sync] Starting for project test-project
[integration-sync] Found 1 enabled provider(s): beads

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Polling > should not poll providers that support watching
[integration-sync] Registered provider 'beads' (plugin: Beads v1.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Polling > should not poll providers that support watching
[integration-sync] Provider 'beads' uses real-time watching, skipping polling
[integration-sync] Service started for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Polling > should not poll providers that support watching
[integration-sync] Stopping for project test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Polling > should not poll providers that support watching
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Polling > should enforce minimum poll interval
[integration-sync] Starting for project test-project
[integration-sync] Found 1 enabled provider(s): beads

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Polling > should enforce minimum poll interval
[integration-sync] Registered provider 'beads' (plugin: Beads v1.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Polling > should enforce minimum poll interval
[integration-sync] Started polling for 'beads' every 30s
[integration-sync] Service started for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Polling > should enforce minimum poll interval
[integration-sync] Polling provider 'beads'

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Polling > should enforce minimum poll interval
[integration-sync] Stopping for project test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Polling > should enforce minimum poll interval
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Polling > should stop polling on service stop
[integration-sync] Starting for project test-project
[integration-sync] Found 1 enabled provider(s): beads

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Polling > should stop polling on service stop
[integration-sync] Registered provider 'beads' (plugin: Beads v1.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Polling > should stop polling on service stop
[integration-sync] Started polling for 'beads' every 60s
[integration-sync] Service started for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Polling > should stop polling on service stop
[integration-sync] Stopping for project test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Polling > should stop polling on service stop
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Config Loading > should return empty config when file does not exist
[integration-sync] Starting for project test-project
[integration-sync] No enabled integrations found

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Config Loading > should return empty config when file does not exist
[integration-sync] Stopping for project test-project
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Config Loading > should handle invalid JSON gracefully
[integration-sync] Starting for project test-project
[integration-sync] No enabled integrations found

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Config Loading > should handle invalid JSON gracefully
[integration-sync] Stopping for project test-project
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Config Loading > should handle config without integrations key
[integration-sync] Starting for project test-project
[integration-sync] No enabled integrations found

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Config Loading > should handle config without integrations key
[integration-sync] Stopping for project test-project
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Config Loading > should use custom plugin ID when specified
[integration-sync] Starting for project test-project
[integration-sync] Found 1 enabled provider(s): mybeads

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Config Loading > should use custom plugin ID when specified
[integration-sync] Registered provider 'mybeads' (plugin: Custom Beads v2.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Config Loading > should use custom plugin ID when specified
[integration-sync] Service started for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Config Loading > should use custom plugin ID when specified
[integration-sync] Stopping for project test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Config Loading > should use custom plugin ID when specified
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Error Handling > should handle plugin load errors gracefully
[integration-sync] Starting for project test-project
[integration-sync] Found 1 enabled provider(s): beads

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Error Handling > should handle plugin load errors gracefully
[integration-sync] Service started for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Error Handling > should handle plugin load errors gracefully
[integration-sync] Stopping for project test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Error Handling > should handle plugin load errors gracefully
[integration-sync] Service stopped for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Error Handling > should handle polling errors without stopping service
[integration-sync] Starting for project test-project
[integration-sync] Found 1 enabled provider(s): beads

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Error Handling > should handle polling errors without stopping service
[integration-sync] Registered provider 'beads' (plugin: Beads v1.0.0)

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Error Handling > should handle polling errors without stopping service
[integration-sync] Started polling for 'beads' every 60s
[integration-sync] Service started for test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Error Handling > should handle polling errors without stopping service
[integration-sync] Polling provider 'beads'

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Error Handling > should handle polling errors without stopping service
[integration-sync] Stopping for project test-project

stdout | tests/unit/services/integration-sync-service.test.ts > IntegrationSyncService > Error Handling > should handle polling errors without stopping service
[integration-sync] Service stopped for test-project

stdout | tests/unit/specs.test.ts > Specs API
Shutting down ProjectManager...
Closing project: test-project-b816c8fc
Shutting down project context: test-project-b816c8fc

stdout | tests/unit/specs.test.ts > Specs API
[integration-sync] Stopping for project test-project-b816c8fc
[integration-sync] Service stopped for test-project-b816c8fc

stdout | tests/unit/specs.test.ts > Specs API
[EventBuffer] All buffers cleared { count: [33m0[39m }
Project context shutdown complete: test-project-b816c8fc

stdout | tests/unit/specs.test.ts > Specs API
Project closed: test-project-b816c8fc

stdout | tests/unit/specs.test.ts > Specs API
ProjectManager shutdown complete

stdout | tests/unit/workflow/services/wakeup-timeout.test.ts > Execution Timeout > timeout start and clear > should start execution timeout
[WakeupService] Started 5000ms timeout for execution exec-123 (deadline: 2025-12-19T06:28:08.229Z)
[WakeupService] Started 3000ms timeout for execution exec-456 (deadline: 2025-12-19T06:28:06.229Z)

stdout | tests/unit/workflow/services/wakeup-timeout.test.ts > Execution Timeout > timeout start and clear > should clear timeout when execution completes normally
[WakeupService] Started 5000ms timeout for execution exec-123 (deadline: 2025-12-19T06:28:08.286Z)
[WakeupService] Cleared timeout for execution exec-123

stdout | tests/unit/workflow/services/wakeup-timeout.test.ts > Execution Timeout > timeout start and clear > should replace timeout when starting for same execution
[WakeupService] Started 5000ms timeout for execution exec-123 (deadline: 2025-12-19T06:28:08.294Z)
[WakeupService] Cleared timeout for execution exec-123
[WakeupService] Started 10000ms timeout for execution exec-123 (deadline: 2025-12-19T06:28:13.294Z)

stdout | tests/unit/workflow/services/wakeup-timeout.test.ts > Execution Timeout > timeout expiration > should cancel execution when timeout expires
[WakeupService] Started 5000ms timeout for execution exec-123 (deadline: 2025-12-19T06:28:08.295Z)

stdout | tests/unit/workflow/services/wakeup-timeout.test.ts > Execution Timeout > timeout expiration > should record step_failed event with timeout reason
[WakeupService] Started 5000ms timeout for execution exec-123 (deadline: 2025-12-19T06:28:08.298Z)

stdout | tests/unit/workflow/services/wakeup-timeout.test.ts > Execution Timeout > timeout expiration > should handle cancel failure gracefully
[WakeupService] Started 5000ms timeout for execution exec-123 (deadline: 2025-12-19T06:28:08.302Z)

stdout | tests/unit/workflow/services/wakeup-timeout.test.ts > Execution Timeout > concurrent timeouts > should handle multiple concurrent timeouts
[WakeupService] Started 3000ms timeout for execution exec-1 (deadline: 2025-12-19T06:28:06.303Z)
[WakeupService] Started 5000ms timeout for execution exec-2 (deadline: 2025-12-19T06:28:08.303Z)
[WakeupService] Started 7000ms timeout for execution exec-3 (deadline: 2025-12-19T06:28:10.303Z)

stdout | tests/unit/workflow/services/wakeup-timeout.test.ts > Execution Timeout > concurrent timeouts > should clear specific timeout without affecting others
[WakeupService] Started 3000ms timeout for execution exec-1 (deadline: 2025-12-19T06:28:06.467Z)
[WakeupService] Started 5000ms timeout for execution exec-2 (deadline: 2025-12-19T06:28:08.467Z)
[WakeupService] Cleared timeout for execution exec-1

stdout | tests/unit/workflow/services/wakeup-timeout.test.ts > Execution Timeout > cleanup > should cleanup all timeouts on service stop
[WakeupService] Started 3000ms timeout for execution exec-1 (deadline: 2025-12-19T06:28:06.472Z)
[WakeupService] Started 5000ms timeout for execution exec-2 (deadline: 2025-12-19T06:28:08.472Z)

stdout | tests/unit/routes/workflows-escalation.test.ts > Workflow Escalation API > POST /api/workflows/:id/escalation/respond > should resolve a pending escalation with approve action
[workflows] getEngineForWorkflow: workflow=wf-test1, engineType=sequential

stdout | tests/unit/routes/workflows-escalation.test.ts > Workflow Escalation API > POST /api/workflows/:id/escalation/respond > should resolve with reject action
[workflows] getEngineForWorkflow: workflow=wf-test1, engineType=sequential

stdout | tests/unit/routes/workflows-escalation.test.ts > Workflow Escalation API > POST /api/workflows/:id/escalation/respond > should resolve with custom action and message
[workflows] getEngineForWorkflow: workflow=wf-test1, engineType=sequential

stdout | tests/unit/routes/workflows-escalation.test.ts > Workflow Escalation API > POST /api/workflows/:id/escalation/respond > should record escalation_resolved event with correct data
[workflows] getEngineForWorkflow: workflow=wf-test1, engineType=sequential

stdout | tests/unit/routes/workflows-escalation.test.ts > Workflow Escalation API > POST /api/workflows/:id/escalation/respond > should return workflow data in response
[workflows] getEngineForWorkflow: workflow=wf-test1, engineType=sequential

 âœ“ |@sudocode-ai/local-server| tests/unit/issues.test.ts (21 tests) 2224ms
 âœ“ |@sudocode-ai/local-server| tests/unit/workflow/dependency-analyzer.test.ts (28 tests) 1185ms
 âœ“ |@sudocode-ai/local-server| tests/unit/services/integration-sync-service.test.ts (44 tests) 1351ms
 âœ“ |@sudocode-ai/local-server| tests/unit/services/execution-logs-store.test.ts (34 tests) 2079ms
 âœ“ |@sudocode-ai/local-server| tests/unit/specs.test.ts (19 tests) 2097ms
 âœ“ |@sudocode-ai/local-server| tests/unit/workflow/services/wakeup-timeout.test.ts (10 tests) 1339ms
 âœ“ |@sudocode-ai/local-server| tests/unit/routes/workflows-escalation.test.ts (17 tests) 1576ms
stdout | tests/unit/services/websocket-initialization.test.ts > WebSocket Initialization Error Handling > should successfully initialize when server is valid
[websocket] WebSocket server initialized on path: /ws
[websocket] Heartbeat started (interval: 30000ms)
[websocket] Shutting down WebSocket server...
[websocket] Heartbeat stopped

stdout | tests/unit/services/websocket-initialization.test.ts > WebSocket Initialization Error Handling > should successfully initialize when server is valid
[websocket] WebSocket server closed

stdout | tests/unit/services/websocket-initialization.test.ts > WebSocket Initialization Error Handling > should warn when initializing multiple times
[websocket] WebSocket server initialized on path: /ws
[websocket] Heartbeat started (interval: 30000ms)
[websocket] Shutting down WebSocket server...
[websocket] Heartbeat stopped

stdout | tests/unit/services/websocket-initialization.test.ts > WebSocket Initialization Error Handling > should warn when initializing multiple times
[websocket] WebSocket server closed

 âœ“ |@sudocode-ai/local-server| tests/unit/workflow/mcp/workflow-tools.test.ts (13 tests) 1164ms
 âœ“ |@sudocode-ai/local-server| tests/unit/services/version-service.test.ts (6 tests) 1085ms
stdout | tests/unit/routes/workflows-await.test.ts > Workflow Await Events API > POST /api/workflows/:id/await-events > should register await condition and return await ID
[workflows] getEngineForWorkflow: workflow=wf-123, engineType=orchestrator

stdout | tests/unit/routes/workflows-await.test.ts > Workflow Await Events API > POST /api/workflows/:id/await-events > should register await condition and return await ID
[workflows/:id/await-events] Registered await await-123 for workflow wf-123 {
  eventTypes: [ [32m'step_completed'[39m, [32m'step_failed'[39m ],
  executionIds: [90mundefined[39m
}

stdout | tests/unit/routes/workflows-await.test.ts > Workflow Await Events API > POST /api/workflows/:id/await-events > should call wakeupService.registerAwait with correct params
[workflows] getEngineForWorkflow: workflow=wf-123, engineType=orchestrator

stdout | tests/unit/routes/workflows-await.test.ts > Workflow Await Events API > POST /api/workflows/:id/await-events > should call wakeupService.registerAwait with correct params
[workflows/:id/await-events] Registered await await-123 for workflow wf-123 {
  eventTypes: [ [32m'step_completed'[39m ],
  executionIds: [ [32m'exec-1'[39m, [32m'exec-2'[39m ]
}

 âœ“ |@sudocode-ai/local-server| tests/unit/services/websocket-initialization.test.ts (5 tests) 1459ms
stdout | tests/unit/routes/workflows-await.test.ts > Workflow Await Events API > POST /api/workflows/:id/await-events > should return 404 for non-existent workflow
[workflows] getEngineForWorkflow: workflow=wf-unknown, engineType=orchestrator

stdout | tests/unit/routes/workflows-await.test.ts > Workflow Await Events API > POST /api/workflows/:id/await-events > should return 400 when workflow is not running
[workflows] getEngineForWorkflow: workflow=wf-123, engineType=orchestrator

stdout | tests/unit/routes/workflows-await.test.ts > Workflow Await Events API > POST /api/workflows/:id/await-events > should return 400 when workflow is completed
[workflows] getEngineForWorkflow: workflow=wf-123, engineType=orchestrator

stdout | tests/unit/routes/workflows-await.test.ts > Workflow Await Events API > POST /api/workflows/:id/await-events > should return 400 when engine does not support await
[workflows] getEngineForWorkflow: workflow=wf-123, engineType=orchestrator

stdout | tests/unit/routes/workflows-await.test.ts > Workflow Await Events API > POST /api/workflows/:id/await-events > should accept all valid event types
[workflows] getEngineForWorkflow: workflow=wf-123, engineType=orchestrator

stdout | tests/unit/routes/workflows-await.test.ts > Workflow Await Events API > POST /api/workflows/:id/await-events > should accept all valid event types
[workflows/:id/await-events] Registered await await-123 for workflow wf-123 {
  eventTypes: [
    [32m'step_completed'[39m,
    [32m'step_failed'[39m,
    [32m'user_response'[39m,
    [32m'escalation_resolved'[39m,
    [32m'timeout'[39m
  ],
  executionIds: [90mundefined[39m
}

stdout | tests/unit/routes/workflows-await.test.ts > Workflow Await Events API > POST /api/workflows/:id/await-events > should work without optional parameters
[workflows] getEngineForWorkflow: workflow=wf-123, engineType=orchestrator

stdout | tests/unit/routes/workflows-await.test.ts > Workflow Await Events API > POST /api/workflows/:id/await-events > should work without optional parameters
[workflows/:id/await-events] Registered await await-456 for workflow wf-123 { eventTypes: [ [32m'step_completed'[39m ], executionIds: [90mundefined[39m }

stdout | tests/unit/routes/workflows-await.test.ts > Workflow Await Events API > POST /api/workflows/:id/await-events > should return 503 when engine not available
[workflows] getEngineForWorkflow: workflow=wf-123, engineType=orchestrator

 âœ“ |@sudocode-ai/local-server| tests/unit/workflow/base-workflow-engine.test.ts (59 tests) 1659ms
 âœ“ |@sudocode-ai/local-server| tests/unit/execution/output/claude-to-ag-ui.test.ts (29 tests) 1338ms
 âœ“ |@sudocode-ai/local-server| tests/unit/routes/editors.test.ts (12 tests) 1722ms
 âœ“ |@sudocode-ai/local-server| tests/unit/routes/workflows-await.test.ts (12 tests) 1685ms
stdout | tests/unit/workflow/engines/crash-recovery.test.ts > Crash Recovery > orphaned workflow detection > should detect workflows with dead orchestrator
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovering workflow wf-orphan (orchestrator status: completed)

stdout | tests/unit/workflow/engines/crash-recovery.test.ts > Crash Recovery > orphaned workflow detection > should detect workflows with dead orchestrator
[OrchestratorEngine] Recovery complete: 1/1 workflows recovered

stdout | tests/unit/workflow/engines/crash-recovery.test.ts > Crash Recovery > orphaned workflow detection > should skip workflows with running orchestrator
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/1 workflows recovered

stdout | tests/unit/workflow/engines/crash-recovery.test.ts > Crash Recovery > orphaned workflow detection > should skip workflows without orchestrator execution
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/1 workflows recovered

stdout | tests/unit/workflow/engines/crash-recovery.test.ts > Crash Recovery > orphaned workflow detection > should skip workflows not in running status
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovery complete: 0/0 workflows recovered

stdout | tests/unit/workflow/engines/crash-recovery.test.ts > Crash Recovery > recovery actions > should record recovery event
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovering workflow wf-orphan (orchestrator status: failed)

stdout | tests/unit/workflow/engines/crash-recovery.test.ts > Crash Recovery > recovery actions > should record recovery event
[OrchestratorEngine] Recovery complete: 1/1 workflows recovered

stdout | tests/unit/workflow/engines/crash-recovery.test.ts > Crash Recovery > recovery actions > should handle recovery errors gracefully
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovering workflow wf-orphan (orchestrator status: failed)

 âœ“ |@sudocode-ai/local-server| tests/unit/services/execution-logs-store-normalized.test.ts (19 tests) 1538ms
stdout | tests/unit/workflow/engines/crash-recovery.test.ts > Crash Recovery > recovery actions > should handle recovery errors gracefully
[OrchestratorEngine] Recovery complete: 0/1 workflows recovered

stdout | tests/unit/workflow/engines/crash-recovery.test.ts > Crash Recovery > recovery actions > should recover multiple orphaned workflows
[OrchestratorEngine] Checking for orphaned workflows...
[OrchestratorEngine] Recovering workflow wf-orphan-1 (orchestrator status: failed)

stdout | tests/unit/workflow/engines/crash-recovery.test.ts > Crash Recovery > recovery actions > should recover multiple orphaned workflows
[OrchestratorEngine] Recovering workflow wf-orphan-2 (orchestrator status: completed)

stdout | tests/unit/workflow/engines/crash-recovery.test.ts > Crash Recovery > recovery actions > should recover multiple orphaned workflows
[OrchestratorEngine] Recovery complete: 2/2 workflows recovered

stdout | tests/unit/workflow/engines/crash-recovery.test.ts > Crash Recovery > stale execution cleanup > should mark stale running executions as failed
[OrchestratorEngine] Checking for stale executions...
[OrchestratorEngine] Marking stale execution exec-stale as failed
[OrchestratorEngine] Marked 1 stale executions as failed

stdout | tests/unit/workflow/engines/crash-recovery.test.ts > Crash Recovery > stale execution cleanup > should not affect executions without workflow context
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/workflow/engines/crash-recovery.test.ts > Crash Recovery > stale execution cleanup > should handle multiple stale executions
[OrchestratorEngine] Checking for stale executions...
[OrchestratorEngine] Marking stale execution exec-stale-1 as failed
[OrchestratorEngine] Marking stale execution exec-stale-2 as failed
[OrchestratorEngine] Marked 2 stale executions as failed

stdout | tests/unit/workflow/engines/crash-recovery.test.ts > Crash Recovery > stale execution cleanup > should not log when no stale executions found
[OrchestratorEngine] Checking for stale executions...

stdout | tests/unit/services/agent-registry.test.ts > AgentRegistryService > Claude Code adapter > should have working buildProcessConfig
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m4[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mfalse[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}

 âœ“ |@sudocode-ai/local-server| tests/unit/workflow/mcp/execution-tools.test.ts (17 tests) 1237ms
stdout | tests/unit/execution/executors/executor-factory.test.ts > ExecutorFactory > createExecutorForAgent > should create AgentExecutorWrapper for claude-code agent
[ExecutorFactory] Creating executor { agentType: [32m'claude-code'[39m, workDir: [32m'/tmp/test'[39m }
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m7[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mtrue[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}
[AgentExecutorWrapper] Initialized {
  agentType: [32m'claude-code'[39m,
  adapterName: [32m'claude-code'[39m,
  projectId: [32m'test-project'[39m,
  workDir: [32m'/tmp/test'[39m,
  hasTransport: [33mtrue[39m,
  hasLogsStore: [33mtrue[39m
}

stdout | tests/unit/execution/executors/executor-factory.test.ts > ExecutorFactory > createExecutorForAgent > should create AgentExecutorWrapper for codex agent
[ExecutorFactory] Creating executor { agentType: [32m'codex'[39m, workDir: [32m'/tmp/test'[39m }
[ExecutorFactory] Using AgentExecutorWrapper for codex
[AgentExecutorWrapper] Initialized {
  agentType: [32m'codex'[39m,
  adapterName: [32m'codex'[39m,
  projectId: [32m'test-project'[39m,
  workDir: [32m'/tmp/test'[39m,
  hasTransport: [33mtrue[39m,
  hasLogsStore: [33mtrue[39m
}

stdout | tests/unit/execution/executors/executor-factory.test.ts > ExecutorFactory > createExecutorForAgent > should throw AgentNotFoundError for unknown agent type
[ExecutorFactory] Creating executor { agentType: [32m'unknown-agent'[39m, workDir: [32m'/tmp/test'[39m }

stdout | tests/unit/execution/executors/executor-factory.test.ts > ExecutorFactory > createExecutorForAgent > should create AgentExecutorWrapper for copilot
[ExecutorFactory] Creating executor { agentType: [32m'copilot'[39m, workDir: [32m'/tmp/test'[39m }
[ExecutorFactory] Using AgentExecutorWrapper for copilot
[AgentExecutorWrapper] Initialized {
  agentType: [32m'copilot'[39m,
  adapterName: [32m'copilot'[39m,
  projectId: [32m'test-project'[39m,
  workDir: [32m'/tmp/test'[39m,
  hasTransport: [33mtrue[39m,
  hasLogsStore: [33mtrue[39m
}

stdout | tests/unit/execution/executors/executor-factory.test.ts > ExecutorFactory > createExecutorForAgent > should create AgentExecutorWrapper for cursor
[ExecutorFactory] Creating executor { agentType: [32m'cursor'[39m, workDir: [32m'/tmp/test'[39m }
[ExecutorFactory] Using AgentExecutorWrapper for cursor
[AgentExecutorWrapper] Initialized {
  agentType: [32m'cursor'[39m,
  adapterName: [32m'cursor'[39m,
  projectId: [32m'test-project'[39m,
  workDir: [32m'/tmp/test'[39m,
  hasTransport: [33mtrue[39m,
  hasLogsStore: [33mtrue[39m
}

stdout | tests/unit/execution/executors/executor-factory.test.ts > ExecutorFactory > createExecutorForAgent > should validate config before creating executor
[ExecutorFactory] Creating executor { agentType: [32m'claude-code'[39m, workDir: [32m'/tmp/test'[39m }

stdout | tests/unit/execution/executors/executor-factory.test.ts > ExecutorFactory > createExecutorForAgent > should throw AgentConfigValidationError with validation errors
[ExecutorFactory] Creating executor { agentType: [32m'claude-code'[39m, workDir: [32m'/tmp/test'[39m }

stdout | tests/unit/execution/executors/executor-factory.test.ts > ExecutorFactory > createExecutorForAgent > should create executor with valid config
[ExecutorFactory] Creating executor { agentType: [32m'claude-code'[39m, workDir: [32m'/tmp/test'[39m }
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m7[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mtrue[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}
[AgentExecutorWrapper] Initialized {
  agentType: [32m'claude-code'[39m,
  adapterName: [32m'claude-code'[39m,
  projectId: [32m'test-project'[39m,
  workDir: [32m'/tmp/test'[39m,
  hasTransport: [33mtrue[39m,
  hasLogsStore: [33mtrue[39m
}

stdout | tests/unit/execution/executors/executor-factory.test.ts > ExecutorFactory > adapter defaults > should apply adapter defaults when config fields are missing
[ExecutorFactory] Creating executor {
  agentType: [32m'claude-code'[39m,
  workDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-executor-factory-bZwEKJ'[39m
}
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m7[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mtrue[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}
[AgentExecutorWrapper] Initialized {
  agentType: [32m'claude-code'[39m,
  adapterName: [32m'claude-code'[39m,
  projectId: [32m'test-project'[39m,
  workDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-executor-factory-bZwEKJ'[39m,
  hasTransport: [33mfalse[39m,
  hasLogsStore: [33mtrue[39m
}

stdout | tests/unit/execution/executors/executor-factory.test.ts > ExecutorFactory > adapter defaults > should apply adapter defaults when config fields are explicitly undefined
[ExecutorFactory] Creating executor {
  agentType: [32m'claude-code'[39m,
  workDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-executor-factory-bZwEKJ'[39m
}
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m7[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mtrue[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}
[AgentExecutorWrapper] Initialized {
  agentType: [32m'claude-code'[39m,
  adapterName: [32m'claude-code'[39m,
  projectId: [32m'test-project'[39m,
  workDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-executor-factory-bZwEKJ'[39m,
  hasTransport: [33mfalse[39m,
  hasLogsStore: [33mtrue[39m
}

stdout | tests/unit/execution/executors/executor-factory.test.ts > ExecutorFactory > adapter defaults > should allow config to override adapter defaults when explicitly set
[ExecutorFactory] Creating executor {
  agentType: [32m'claude-code'[39m,
  workDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-executor-factory-bZwEKJ'[39m
}
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m5[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mfalse[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}
[AgentExecutorWrapper] Initialized {
  agentType: [32m'claude-code'[39m,
  adapterName: [32m'claude-code'[39m,
  projectId: [32m'test-project'[39m,
  workDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-executor-factory-bZwEKJ'[39m,
  hasTransport: [33mfalse[39m,
  hasLogsStore: [33mtrue[39m
}

stdout | tests/unit/execution/executors/executor-factory.test.ts > ExecutorFactory > adapter defaults > should preserve defaults when creating task-specific executor with undefined metadata
[ExecutorFactory] Creating executor {
  agentType: [32m'claude-code'[39m,
  workDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-executor-factory-bZwEKJ'[39m
}
[ExecutorFactory] Using AgentExecutorWrapper for claude-code
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m7[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mtrue[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}
[AgentExecutorWrapper] Initialized {
  agentType: [32m'claude-code'[39m,
  adapterName: [32m'claude-code'[39m,
  projectId: [32m'test-project'[39m,
  workDir: [32m'/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/sudocode-test-executor-factory-bZwEKJ'[39m,
  hasTransport: [33mfalse[39m,
  hasLogsStore: [33mtrue[39m
}

 âœ“ |@sudocode-ai/local-server| tests/unit/workflow/engines/crash-recovery.test.ts (11 tests) 1543ms
 âœ“ |@sudocode-ai/local-server| tests/unit/services/agent-registry.test.ts (24 tests) 1177ms
 âœ“ |@sudocode-ai/local-server| tests/unit/workflow/mcp/escalation-tools.test.ts (12 tests) 1477ms
 âœ“ |@sudocode-ai/local-server| tests/unit/execution/executors/executor-factory.test.ts (18 tests) 1593ms
stdout | tests/integration/codex-integration.test.ts > Codex Agent Integration
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/local-server| tests/unit/routes/agents.test.ts (7 tests) 1938ms
 âœ“ |@sudocode-ai/local-server| tests/integration/codex-integration.test.ts (23 tests) 1755ms
 âœ“ |@sudocode-ai/local-server| tests/unit/execution/output/ag-ui-adapter.test.ts (25 tests) 1581ms
   âœ“ AgUiEventAdapter > event listener registration > should handle listener errors gracefully  306ms
stdout | tests/unit/executions.test.ts > Executions Service
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/local-server| tests/unit/services/execution-workflow-integration.test.ts (11 tests) 2038ms
   âœ“ Execution-Workflow Integration > execution event callbacks > should notify callbacks on execution completion  477ms
 âœ“ |@sudocode-ai/local-server| tests/unit/services/prompt-templates.test.ts (24 tests) 1344ms
 âœ“ |@sudocode-ai/local-server| tests/unit/workflow/mcp/inspection-tools.test.ts (14 tests) 1212ms
 âœ“ |@sudocode-ai/local-server| tests/unit/executions.test.ts (19 tests) 1333ms
 âœ“ |@sudocode-ai/local-server| tests/unit/workflow/mcp/api-client.test.ts (24 tests) 1206ms
 âœ“ |@sudocode-ai/local-server| tests/unit/execution/adapters/shared/config-presets.test.ts (21 tests) 1164ms
stdout | tests/integration/copilot-integration.test.ts > Copilot Agent Integration
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/execution/worktree/manager.test.ts > WorktreeManager > createWorktree > should create branch if createBranch is true
[WorktreeManager] Setting up isolated worktree environment { repoPath: [32m'/repo'[39m, worktreePath: [32m'/worktree/feature'[39m }
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/repo/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/worktree/feature/.sudocode'[39m
}
[WorktreeManager] .sudocode directory already exists in worktree
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/repo/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/worktree/feature/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mtrue[39m
}
[WorktreeManager] Synced issues.jsonl from main repo to worktree { mainFileSize: [33m1000[39m, worktreeFileSize: [33m1000[39m }
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/repo/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/worktree/feature/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mtrue[39m
}
[WorktreeManager] Synced specs.jsonl from main repo to worktree { mainFileSize: [33m1000[39m, worktreeFileSize: [33m1000[39m }
[WorktreeManager] Copied config.json from main repo to worktree

stdout | tests/unit/execution/worktree/manager.test.ts > WorktreeManager > createWorktree > should create branch if createBranch is true
[WorktreeManager] Successfully initialized local database in worktree at /worktree/feature/.sudocode/cache.db
[WorktreeManager] Database file created { path: [32m'/worktree/feature/.sudocode/cache.db'[39m, size: [33m1000[39m }
[WorktreeManager] Worktree environment setup complete

stdout | tests/unit/execution/worktree/manager.test.ts > WorktreeManager > createWorktree > should create branch from HEAD when baseBranch is not provided
[WorktreeManager] Setting up isolated worktree environment { repoPath: [32m'/repo'[39m, worktreePath: [32m'/worktree/feature'[39m }
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/repo/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/worktree/feature/.sudocode'[39m
}
[WorktreeManager] .sudocode directory already exists in worktree
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/repo/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/worktree/feature/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mtrue[39m
}
[WorktreeManager] Synced issues.jsonl from main repo to worktree { mainFileSize: [33m1000[39m, worktreeFileSize: [33m1000[39m }
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/repo/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/worktree/feature/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mtrue[39m
}
[WorktreeManager] Synced specs.jsonl from main repo to worktree { mainFileSize: [33m1000[39m, worktreeFileSize: [33m1000[39m }
[WorktreeManager] Copied config.json from main repo to worktree

stdout | tests/unit/execution/worktree/manager.test.ts > WorktreeManager > createWorktree > should create branch from HEAD when baseBranch is not provided
[WorktreeManager] Successfully initialized local database in worktree at /worktree/feature/.sudocode/cache.db
[WorktreeManager] Database file created { path: [32m'/worktree/feature/.sudocode/cache.db'[39m, size: [33m1000[39m }
[WorktreeManager] Worktree environment setup complete

stdout | tests/unit/execution/worktree/manager.test.ts > WorktreeManager > createWorktree > should not create branch if createBranch is false
[WorktreeManager] Setting up isolated worktree environment { repoPath: [32m'/repo'[39m, worktreePath: [32m'/worktree/feature'[39m }
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/repo/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/worktree/feature/.sudocode'[39m
}
[WorktreeManager] .sudocode directory already exists in worktree
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/repo/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/worktree/feature/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mtrue[39m
}
[WorktreeManager] Synced issues.jsonl from main repo to worktree { mainFileSize: [33m1000[39m, worktreeFileSize: [33m1000[39m }
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/repo/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/worktree/feature/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mtrue[39m
}
[WorktreeManager] Synced specs.jsonl from main repo to worktree { mainFileSize: [33m1000[39m, worktreeFileSize: [33m1000[39m }
[WorktreeManager] Copied config.json from main repo to worktree

stdout | tests/unit/execution/worktree/manager.test.ts > WorktreeManager > createWorktree > should not create branch if createBranch is false
[WorktreeManager] Successfully initialized local database in worktree at /worktree/feature/.sudocode/cache.db
[WorktreeManager] Database file created { path: [32m'/worktree/feature/.sudocode/cache.db'[39m, size: [33m1000[39m }
[WorktreeManager] Worktree environment setup complete

stdout | tests/unit/execution/worktree/manager.test.ts > WorktreeManager > createWorktree > should call git worktree add
[WorktreeManager] Setting up isolated worktree environment { repoPath: [32m'/repo'[39m, worktreePath: [32m'/worktree/feature'[39m }
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/repo/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/worktree/feature/.sudocode'[39m
}
[WorktreeManager] .sudocode directory already exists in worktree
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/repo/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/worktree/feature/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mtrue[39m
}
[WorktreeManager] Synced issues.jsonl from main repo to worktree { mainFileSize: [33m1000[39m, worktreeFileSize: [33m1000[39m }
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/repo/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/worktree/feature/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mtrue[39m
}
[WorktreeManager] Synced specs.jsonl from main repo to worktree { mainFileSize: [33m1000[39m, worktreeFileSize: [33m1000[39m }
[WorktreeManager] Copied config.json from main repo to worktree

stdout | tests/unit/execution/worktree/manager.test.ts > WorktreeManager > createWorktree > should call git worktree add
[WorktreeManager] Successfully initialized local database in worktree at /worktree/feature/.sudocode/cache.db
[WorktreeManager] Database file created { path: [32m'/worktree/feature/.sudocode/cache.db'[39m, size: [33m1000[39m }
[WorktreeManager] Worktree environment setup complete

stdout | tests/unit/execution/worktree/manager.test.ts > WorktreeManager > createWorktree > should configure sparse checkout when enabled
[WorktreeManager] Setting up isolated worktree environment { repoPath: [32m'/repo'[39m, worktreePath: [32m'/worktree/feature'[39m }
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/repo/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/worktree/feature/.sudocode'[39m
}
[WorktreeManager] .sudocode directory already exists in worktree
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/repo/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/worktree/feature/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mtrue[39m
}
[WorktreeManager] Synced issues.jsonl from main repo to worktree { mainFileSize: [33m1000[39m, worktreeFileSize: [33m1000[39m }
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/repo/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/worktree/feature/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mtrue[39m
}
[WorktreeManager] Synced specs.jsonl from main repo to worktree { mainFileSize: [33m1000[39m, worktreeFileSize: [33m1000[39m }
[WorktreeManager] Copied config.json from main repo to worktree

stdout | tests/unit/execution/worktree/manager.test.ts > WorktreeManager > createWorktree > should configure sparse checkout when enabled
[WorktreeManager] Successfully initialized local database in worktree at /worktree/feature/.sudocode/cache.db
[WorktreeManager] Database file created { path: [32m'/worktree/feature/.sudocode/cache.db'[39m, size: [33m1000[39m }
[WorktreeManager] Worktree environment setup complete

 âœ“ |@sudocode-ai/local-server| tests/unit/execution/adapters/codex-adapter.test.ts (23 tests) 1423ms
stdout | tests/unit/execution/worktree/manager.test.ts > WorktreeManager > createWorktree > should not configure sparse checkout when disabled
[WorktreeManager] Setting up isolated worktree environment { repoPath: [32m'/repo'[39m, worktreePath: [32m'/worktree/feature'[39m }
[WorktreeManager] Directory paths {
  mainSudocodeDir: [32m'/repo/.sudocode'[39m,
  worktreeSudocodeDir: [32m'/worktree/feature/.sudocode'[39m
}
[WorktreeManager] .sudocode directory already exists in worktree
[WorktreeManager] Processing issues.jsonl {
  mainFile: [32m'/repo/.sudocode/issues.jsonl'[39m,
  worktreeFile: [32m'/worktree/feature/.sudocode/issues.jsonl'[39m,
  mainFileExists: [33mtrue[39m
}
[WorktreeManager] Synced issues.jsonl from main repo to worktree { mainFileSize: [33m1000[39m, worktreeFileSize: [33m1000[39m }
[WorktreeManager] Processing specs.jsonl {
  mainFile: [32m'/repo/.sudocode/specs.jsonl'[39m,
  worktreeFile: [32m'/worktree/feature/.sudocode/specs.jsonl'[39m,
  mainFileExists: [33mtrue[39m
}
[WorktreeManager] Synced specs.jsonl from main repo to worktree { mainFileSize: [33m1000[39m, worktreeFileSize: [33m1000[39m }
[WorktreeManager] Copied config.json from main repo to worktree

stdout | tests/unit/execution/worktree/manager.test.ts > WorktreeManager > createWorktree > should not configure sparse checkout when disabled
[WorktreeManager] Successfully initialized local database in worktree at /worktree/feature/.sudocode/cache.db
[WorktreeManager] Database file created { path: [32m'/worktree/feature/.sudocode/cache.db'[39m, size: [33m1000[39m }
[WorktreeManager] Worktree environment setup complete

stdout | tests/unit/services/websocket-project-scoped.test.ts > WebSocketManager - Project-Scoped Subscriptions > Broadcasting > should only broadcast to subscribers of specific project
[websocket] Broadcasted issue_updated for project-1:issue:i-001 to 2 clients

stdout | tests/unit/services/websocket-project-scoped.test.ts > WebSocketManager - Project-Scoped Subscriptions > Broadcasting > should broadcast to "all" subscribers
[websocket] Broadcasted issue_updated for project-1:issue:i-001 to 2 clients

stdout | tests/unit/services/websocket-project-scoped.test.ts > WebSocketManager - Project-Scoped Subscriptions > Broadcasting > should not broadcast to subscribers of different projects
[websocket] Broadcasted issue_updated for project-1:issue:i-001 to 1 clients

stdout | tests/unit/services/websocket-project-scoped.test.ts > WebSocketManager - Project-Scoped Subscriptions > Broadcasting > should include projectId in all broadcast messages
[websocket] Broadcasted issue_updated for project-123:issue:i-001 to 1 clients

stdout | tests/unit/services/websocket-project-scoped.test.ts > WebSocketManager - Project-Scoped Subscriptions > Project Lifecycle Events > should broadcast project_opened event to all project subscribers
[websocket] Broadcasted project_opened for project-123 to 1 clients

stdout | tests/unit/services/websocket-project-scoped.test.ts > WebSocketManager - Project-Scoped Subscriptions > Project Lifecycle Events > should broadcast project_closed event
[websocket] Broadcasted project_closed for project-123 to 1 clients

stdout | tests/unit/services/websocket-project-scoped.test.ts > WebSocketManager - Project-Scoped Subscriptions > Multi-Project Isolation > should maintain separate subscription spaces for different projects
[websocket] Broadcasted issue_updated for project-1:issue:i-001 to 1 clients
[websocket] Broadcasted issue_updated for project-2:issue:i-001 to 1 clients

 âœ“ |@sudocode-ai/local-server| tests/unit/execution/transport/sse-transport.test.ts (35 tests) 1472ms
 âœ“ |@sudocode-ai/local-server| tests/integration/copilot-integration.test.ts (28 tests) 1499ms
 âœ“ |@sudocode-ai/local-server| tests/unit/execution/worktree/manager.test.ts (17 tests) 1351ms
 âœ“ |@sudocode-ai/local-server| tests/unit/services/websocket-project-scoped.test.ts (12 tests) 1394ms
 âœ“ |@sudocode-ai/local-server| tests/unit/services/prompt-resolver.test.ts (30 tests) 1424ms
stdout | tests/unit/services/project-context.test.ts > ProjectContext > initialization > should initialize successfully
Project context initialized: test-12345678 at /path

stdout | tests/unit/services/project-context.test.ts > ProjectContext > shutdown > should shutdown all services in correct order
Shutting down project context: test-12345678

stdout | tests/unit/services/project-context.test.ts > ProjectContext > shutdown > should shutdown all services in correct order
Project context shutdown complete: test-12345678

stdout | tests/unit/services/project-context.test.ts > ProjectContext > shutdown > should shutdown without watcher if not set
Shutting down project context: test-12345678

stdout | tests/unit/services/project-context.test.ts > ProjectContext > shutdown > should shutdown without watcher if not set
Project context shutdown complete: test-12345678

stdout | tests/unit/services/project-context.test.ts > ProjectContext > shutdown > should propagate errors from shutdown
Shutting down project context: test-12345678

 âœ“ |@sudocode-ai/local-server| tests/unit/execution/adapters/cursor-adapter.test.ts (21 tests) 1121ms
stdout | tests/unit/execution/transport/transport-manager.test.ts > TransportManager > constructor > should create manager with SSE transport
[EventBuffer] All buffers cleared { count: [33m0[39m }

stdout | tests/unit/execution/transport/transport-manager.test.ts > TransportManager > constructor > should start with no connected adapters
[EventBuffer] All buffers cleared { count: [33m0[39m }

stdout | tests/unit/execution/transport/transport-manager.test.ts > TransportManager > connectAdapter > should connect adapter and forward events to transport
[EventBuffer] All buffers cleared { count: [33m0[39m }

stdout | tests/unit/execution/transport/transport-manager.test.ts > TransportManager > connectAdapter > should use broadcastToRun when runId is provided
[EventBuffer] Created buffer for execution { executionId: [32m'run-123'[39m, timestamp: [32m'2025-12-19T06:28:19.867Z'[39m }
[EventBuffer] Event added to buffer {
  executionId: [32m'run-123'[39m,
  eventType: [32m'RUN_STARTED'[39m,
  sequenceNumber: [33m0[39m,
  totalEvents: [33m1[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'run-123'[39m,
  eventType: [32m'RUN_STARTED'[39m,
  sequenceNumber: [33m1[39m,
  totalEvents: [33m2[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'run-123'[39m,
  eventType: [32m'STATE_SNAPSHOT'[39m,
  sequenceNumber: [33m2[39m,
  totalEvents: [33m3[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'run-123'[39m,
  eventType: [32m'STATE_SNAPSHOT'[39m,
  sequenceNumber: [33m3[39m,
  totalEvents: [33m4[39m
}

stdout | tests/unit/execution/transport/transport-manager.test.ts > TransportManager > connectAdapter > should use broadcastToRun when runId is provided
[EventBuffer] All buffers cleared { count: [33m1[39m }

stdout | tests/unit/execution/transport/transport-manager.test.ts > TransportManager > connectAdapter > should support multiple adapters
[EventBuffer] All buffers cleared { count: [33m0[39m }

stdout | tests/unit/execution/transport/transport-manager.test.ts > TransportManager > connectAdapter > should increment adapter count
[EventBuffer] All buffers cleared { count: [33m0[39m }

stdout | tests/unit/execution/transport/transport-manager.test.ts > TransportManager > disconnectAdapter > should disconnect adapter and stop forwarding events
[EventBuffer] All buffers cleared { count: [33m0[39m }

stdout | tests/unit/execution/transport/transport-manager.test.ts > TransportManager > disconnectAdapter > should return false for non-existent adapter
[EventBuffer] All buffers cleared { count: [33m0[39m }

stdout | tests/unit/execution/transport/transport-manager.test.ts > TransportManager > disconnectAdapter > should decrement adapter count
[EventBuffer] All buffers cleared { count: [33m0[39m }

stdout | tests/unit/execution/transport/transport-manager.test.ts > TransportManager > broadcast > should broadcast event to all clients
[EventBuffer] All buffers cleared { count: [33m0[39m }

stdout | tests/unit/execution/transport/transport-manager.test.ts > TransportManager > broadcastToRun > should broadcast event to specific run
[EventBuffer] Created buffer for execution { executionId: [32m'run-123'[39m, timestamp: [32m'2025-12-19T06:28:19.873Z'[39m }
[EventBuffer] Event added to buffer {
  executionId: [32m'run-123'[39m,
  eventType: [32m'TOOL_CALL_START'[39m,
  sequenceNumber: [33m0[39m,
  totalEvents: [33m1[39m
}

stdout | tests/unit/execution/transport/transport-manager.test.ts > TransportManager > broadcastToRun > should broadcast event to specific run
[EventBuffer] All buffers cleared { count: [33m1[39m }

stdout | tests/unit/execution/transport/transport-manager.test.ts > TransportManager > getSseTransport > should return SSE transport instance
[EventBuffer] All buffers cleared { count: [33m0[39m }

stdout | tests/unit/execution/transport/transport-manager.test.ts > TransportManager > getSseTransport > should return same transport instance
[EventBuffer] All buffers cleared { count: [33m0[39m }

stdout | tests/unit/execution/transport/transport-manager.test.ts > TransportManager > getAdapterCount > should return correct count
[EventBuffer] All buffers cleared { count: [33m0[39m }

stdout | tests/unit/execution/transport/transport-manager.test.ts > TransportManager > shutdown > should disconnect all adapters
[EventBuffer] All buffers cleared { count: [33m0[39m }

stdout | tests/unit/execution/transport/transport-manager.test.ts > TransportManager > shutdown > should disconnect all adapters
[EventBuffer] All buffers cleared { count: [33m0[39m }

stdout | tests/unit/execution/transport/transport-manager.test.ts > TransportManager > shutdown > should shutdown SSE transport
[EventBuffer] All buffers cleared { count: [33m0[39m }

stdout | tests/unit/execution/transport/transport-manager.test.ts > TransportManager > shutdown > should shutdown SSE transport
[EventBuffer] All buffers cleared { count: [33m0[39m }

stdout | tests/unit/execution/transport/transport-manager.test.ts > TransportManager > shutdown > should be idempotent
[EventBuffer] All buffers cleared { count: [33m0[39m }
[EventBuffer] All buffers cleared { count: [33m0[39m }

stdout | tests/unit/execution/transport/transport-manager.test.ts > TransportManager > shutdown > should be idempotent
[EventBuffer] All buffers cleared { count: [33m0[39m }

stdout | tests/unit/execution/transport/transport-manager.test.ts > TransportManager > shutdown > should stop forwarding events after shutdown
[EventBuffer] All buffers cleared { count: [33m0[39m }

stdout | tests/unit/execution/transport/transport-manager.test.ts > TransportManager > shutdown > should stop forwarding events after shutdown
[EventBuffer] All buffers cleared { count: [33m0[39m }

stdout | tests/unit/execution/transport/transport-manager.test.ts > TransportManager > integration scenarios > should handle complete adapter lifecycle
[EventBuffer] Created buffer for execution { executionId: [32m'run-123'[39m, timestamp: [32m'2025-12-19T06:28:19.882Z'[39m }
[EventBuffer] Event added to buffer {
  executionId: [32m'run-123'[39m,
  eventType: [32m'RUN_STARTED'[39m,
  sequenceNumber: [33m0[39m,
  totalEvents: [33m1[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'run-123'[39m,
  eventType: [32m'RUN_STARTED'[39m,
  sequenceNumber: [33m1[39m,
  totalEvents: [33m2[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'run-123'[39m,
  eventType: [32m'STATE_SNAPSHOT'[39m,
  sequenceNumber: [33m2[39m,
  totalEvents: [33m3[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'run-123'[39m,
  eventType: [32m'STATE_SNAPSHOT'[39m,
  sequenceNumber: [33m3[39m,
  totalEvents: [33m4[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'run-123'[39m,
  eventType: [32m'STATE_SNAPSHOT'[39m,
  sequenceNumber: [33m4[39m,
  totalEvents: [33m5[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'run-123'[39m,
  eventType: [32m'STATE_SNAPSHOT'[39m,
  sequenceNumber: [33m5[39m,
  totalEvents: [33m6[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'run-123'[39m,
  eventType: [32m'RUN_FINISHED'[39m,
  sequenceNumber: [33m6[39m,
  totalEvents: [33m7[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'run-123'[39m,
  eventType: [32m'RUN_FINISHED'[39m,
  sequenceNumber: [33m7[39m,
  totalEvents: [33m8[39m
}

stdout | tests/unit/execution/transport/transport-manager.test.ts > TransportManager > integration scenarios > should handle complete adapter lifecycle
[EventBuffer] All buffers cleared { count: [33m1[39m }

stdout | tests/unit/execution/transport/transport-manager.test.ts > TransportManager > integration scenarios > should support run-specific and global broadcasts simultaneously
[EventBuffer] Created buffer for execution { executionId: [32m'run-123'[39m, timestamp: [32m'2025-12-19T06:28:19.884Z'[39m }
[EventBuffer] Event added to buffer {
  executionId: [32m'run-123'[39m,
  eventType: [32m'RUN_STARTED'[39m,
  sequenceNumber: [33m0[39m,
  totalEvents: [33m1[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'run-123'[39m,
  eventType: [32m'RUN_STARTED'[39m,
  sequenceNumber: [33m1[39m,
  totalEvents: [33m2[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'run-123'[39m,
  eventType: [32m'STATE_SNAPSHOT'[39m,
  sequenceNumber: [33m2[39m,
  totalEvents: [33m3[39m
}
[EventBuffer] Event added to buffer {
  executionId: [32m'run-123'[39m,
  eventType: [32m'STATE_SNAPSHOT'[39m,
  sequenceNumber: [33m3[39m,
  totalEvents: [33m4[39m
}

stdout | tests/unit/execution/transport/transport-manager.test.ts > TransportManager > integration scenarios > should support run-specific and global broadcasts simultaneously
[EventBuffer] All buffers cleared { count: [33m1[39m }

stdout | tests/unit/execution/transport/transport-manager.test.ts > TransportManager > integration scenarios > should handle rapid event emissions
[EventBuffer] All buffers cleared { count: [33m0[39m }

 âœ“ |@sudocode-ai/local-server| tests/unit/workflow/workflow-event-emitter.test.ts (29 tests) 1281ms
 âœ“ |@sudocode-ai/local-server| tests/unit/services/file-search/registry.test.ts (26 tests) 1242ms
 âœ“ |@sudocode-ai/local-server| tests/unit/services/project-context.test.ts (13 tests) 1242ms
 âœ“ |@sudocode-ai/local-server| tests/unit/execution/transport/transport-manager.test.ts (21 tests) 1366ms
stdout | tests/unit/routes/executions-commit.test.ts > POST /api/executions/:executionId/commit > should commit changes in worktree mode
[Commit] Execution exec-123: hasWorktree=true, workingDir=/test/worktree, targetBranch=feature/test-branch, mode=worktree
[Commit] Git status in /test/worktree: { modified: [ [32m'file1.ts'[39m ], staged: [], untracked: [ [32m'file2.ts'[39m ] }
[Commit] Staged all changes with git add -A
[Commit] Files staged: file1.ts, file2.ts

stdout | tests/unit/routes/executions-commit.test.ts > POST /api/executions/:executionId/commit > should commit changes in worktree mode
[Commit] git commit output: commit successful
[Commit] Successfully committed 2 files: def456

stdout | tests/unit/routes/executions-commit.test.ts > POST /api/executions/:executionId/commit > should commit changes in local mode
[Commit] Execution exec-123: hasWorktree=false, workingDir=/test/project, targetBranch=main, mode=local
[Commit] Git status in /test/project: { modified: [ [32m'file1.ts'[39m ], staged: [], untracked: [ [32m'file2.ts'[39m ] }
[Commit] Staged all changes with git add -A
[Commit] Files staged: file1.ts, file2.ts

stdout | tests/unit/routes/executions-commit.test.ts > POST /api/executions/:executionId/commit > should commit changes in local mode
[Commit] git commit output: commit successful
[Commit] Successfully committed 2 files: def456

stdout | tests/unit/routes/executions-commit.test.ts > POST /api/executions/:executionId/commit > should return 400 if no uncommitted files in working directory
[Commit] Execution exec-123: hasWorktree=true, workingDir=/test/worktree, targetBranch=feature/test-branch, mode=worktree
[Commit] Git status in /test/worktree: { modified: [], staged: [], untracked: [] }

stdout | tests/unit/routes/executions-commit.test.ts > POST /api/executions/:executionId/commit > should allow commits even when execution already has after_commit
[Commit] Execution exec-123: hasWorktree=true, workingDir=/test/worktree, targetBranch=feature/test-branch, mode=worktree
[Commit] Git status in /test/worktree: { modified: [ [32m'file1.ts'[39m ], staged: [], untracked: [ [32m'file2.ts'[39m ] }
[Commit] Staged all changes with git add -A
[Commit] Files staged: file1.ts, file2.ts

stdout | tests/unit/routes/executions-commit.test.ts > POST /api/executions/:executionId/commit > should allow commits even when execution already has after_commit
[Commit] git commit output: commit successful
[Commit] Successfully committed 2 files: def456

stdout | tests/unit/routes/executions-commit.test.ts > POST /api/executions/:executionId/commit > should handle git command failures gracefully
[Commit] Execution exec-123: hasWorktree=true, workingDir=/test/worktree, targetBranch=feature/test-branch, mode=worktree
[Commit] Git status in /test/worktree: { modified: [ [32m'file1.ts'[39m ], staged: [], untracked: [] }

stdout | tests/unit/routes/executions-commit.test.ts > POST /api/executions/:executionId/commit > should properly escape special characters in commit message
[Commit] Execution exec-123: hasWorktree=true, workingDir=/test/worktree, targetBranch=feature/test-branch, mode=worktree
[Commit] Git status in /test/worktree: { modified: [ [32m'file1.ts'[39m ], staged: [], untracked: [ [32m'file2.ts'[39m ] }
[Commit] Staged all changes with git add -A
[Commit] Files staged: file1.ts, file2.ts

stdout | tests/unit/routes/executions-commit.test.ts > POST /api/executions/:executionId/commit > should properly escape special characters in commit message
[Commit] git commit output: commit successful
[Commit] Successfully committed 2 files: def456

 âœ“ |@sudocode-ai/local-server| tests/unit/execution/executors/agent-executor-wrapper-files-changed.test.ts (12 tests) 1198ms
 âœ“ |@sudocode-ai/local-server| tests/unit/routes/executions-commit.test.ts (8 tests) 1679ms
 âœ“ |@sudocode-ai/local-server| tests/unit/routes/files.test.ts (9 tests) 1220ms
 âœ“ |@sudocode-ai/local-server| tests/unit/services/prompt-template-engine.test.ts (34 tests) 1175ms
 âœ“ |@sudocode-ai/local-server| tests/unit/execution/worktree/git-cli.test.ts (30 tests) 1222ms
 âœ“ |@sudocode-ai/local-server| tests/unit/routes/config.test.ts (11 tests) 1306ms
 âœ“ |@sudocode-ai/local-server| tests/unit/routes/issues-delete-propagation.test.ts (7 tests) 1217ms
 âœ“ |@sudocode-ai/local-server| tests/unit/workflow/services/prompt-builder.test.ts (30 tests) 1098ms
stdout | tests/unit/execution/process/builders/claude.test.ts > Claude Code Configuration Builder > buildClaudeArgs > should build basic args with print and output format
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m4[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mfalse[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}

stdout | tests/unit/execution/process/builders/claude.test.ts > Claude Code Configuration Builder > buildClaudeArgs > should add model flag when specified
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m2[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mfalse[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'sonnet'[39m
}

stdout | tests/unit/execution/process/builders/claude.test.ts > Claude Code Configuration Builder > buildClaudeArgs > should add fallback model flag when specified
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m4[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mfalse[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'opus'[39m
}

stdout | tests/unit/execution/process/builders/claude.test.ts > Claude Code Configuration Builder > buildClaudeArgs > should add allowed tools
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m4[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mfalse[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}

stdout | tests/unit/execution/process/builders/claude.test.ts > Claude Code Configuration Builder > buildClaudeArgs > should add disallowed tools
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m3[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mfalse[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}

stdout | tests/unit/execution/process/builders/claude.test.ts > Claude Code Configuration Builder > buildClaudeArgs > should disallow AskUserQuestion by default
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m6[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mfalse[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}

stdout | tests/unit/execution/process/builders/claude.test.ts > Claude Code Configuration Builder > buildClaudeArgs > should add tools list
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m2[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mfalse[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}

stdout | tests/unit/execution/process/builders/claude.test.ts > Claude Code Configuration Builder > buildClaudeArgs > should add system prompt
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m2[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mfalse[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}

stdout | tests/unit/execution/process/builders/claude.test.ts > Claude Code Configuration Builder > buildClaudeArgs > should add append system prompt
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m2[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mfalse[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}

stdout | tests/unit/execution/process/builders/claude.test.ts > Claude Code Configuration Builder > buildClaudeArgs > should add multiple add-dir flags
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m4[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mfalse[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}

stdout | tests/unit/execution/process/builders/claude.test.ts > Claude Code Configuration Builder > buildClaudeArgs > should add mcp config flags
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m5[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mfalse[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mtrue[39m, mcpConfigCount: [33m2[39m },
  model: [32m'not set'[39m
}

stdout | tests/unit/execution/process/builders/claude.test.ts > Claude Code Configuration Builder > buildClaudeArgs > should add permission flags
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m3[39m,
  permissionArgs: {
    dangerouslySkipPermissions: [33mtrue[39m,
    permissionMode: [32m'bypassPermissions'[39m
  },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}

stdout | tests/unit/execution/process/builders/claude.test.ts > Claude Code Configuration Builder > buildClaudeArgs > should add allow-dangerously-skip-permissions flag
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m1[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mfalse[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}

stdout | tests/unit/execution/process/builders/claude.test.ts > Claude Code Configuration Builder > buildClaudeArgs > should add session management flags
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m1[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mfalse[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}

stdout | tests/unit/execution/process/builders/claude.test.ts > Claude Code Configuration Builder > buildClaudeArgs > should add resume with session ID
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m3[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mfalse[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}

stdout | tests/unit/execution/process/builders/claude.test.ts > Claude Code Configuration Builder > buildClaudeArgs > should add session ID
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m2[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mfalse[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}

stdout | tests/unit/execution/process/builders/claude.test.ts > Claude Code Configuration Builder > buildClaudeArgs > should add json schema
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m6[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mfalse[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}

stdout | tests/unit/execution/process/builders/claude.test.ts > Claude Code Configuration Builder > buildClaudeArgs > should add include-partial-messages flag
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m5[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mfalse[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}

stdout | tests/unit/execution/process/builders/claude.test.ts > Claude Code Configuration Builder > buildClaudeArgs > should add debug flag as boolean
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m1[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mfalse[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}

stdout | tests/unit/execution/process/builders/claude.test.ts > Claude Code Configuration Builder > buildClaudeArgs > should add debug flag with filter string
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m2[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mfalse[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}

stdout | tests/unit/execution/process/builders/claude.test.ts > Claude Code Configuration Builder > buildClaudeArgs > should add settings and setting-sources
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m4[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mfalse[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}

stdout | tests/unit/execution/process/builders/claude.test.ts > Claude Code Configuration Builder > buildClaudeArgs > should add prompt as last argument
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m3[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mfalse[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'sonnet'[39m
}

stdout | tests/unit/execution/process/builders/claude.test.ts > Claude Code Configuration Builder > buildClaudeConfig > should build ProcessConfig with correct executable
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m0[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mfalse[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}

stdout | tests/unit/execution/process/builders/claude.test.ts > Claude Code Configuration Builder > buildClaudeConfig > should use default claude path when not specified
[buildClaudeArgs] Built CLI arguments: {
  totalArgs: [33m0[39m,
  permissionArgs: { dangerouslySkipPermissions: [33mfalse[39m, permissionMode: [32m'not set'[39m },
  mcpArgs: { hasMcpConfig: [33mfalse[39m, mcpConfigCount: [33m0[39m },
  model: [32m'not set'[39m
}

 âœ“ |@sudocode-ai/local-server| tests/unit/execution/process/builders/claude.test.ts (34 tests) 1147ms
 âœ“ |@sudocode-ai/local-server| tests/unit/watcher-regex.test.ts (9 tests) 1148ms
 âœ“ |@sudocode-ai/local-server| tests/unit/execution/adapters/shared/config-utils.test.ts (23 tests) 1226ms
 âœ“ |@sudocode-ai/local-server| tests/unit/services/agent-registry-cache.test.ts (7 tests) 1118ms
 âœ“ |@sudocode-ai/local-server| tests/unit/execution/output/normalized-to-ag-ui-adapter.test.ts (23 tests) 1186ms
 âœ“ |@sudocode-ai/local-server| tests/unit/routes/plugins.test.ts (26 tests) 1432ms
 âœ“ |@sudocode-ai/local-server| tests/unit/workers/worker-ipc.test.ts (39 tests) 1176ms
stdout | tests/unit/export.test.ts > Export Operations > specToJSONL > should convert spec with relationships and tags to JSONL format
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/export.test.ts > Export Operations > specToJSONL > should handle spec with no relationships or tags
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/export.test.ts > Export Operations > issueToJSONL > should convert issue with relationships and tags to JSONL format
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/export.test.ts > Export Operations > exportSpecsToJSONL > should export all specs including archived
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/export.test.ts > Export Operations > exportSpecsToJSONL > should support incremental export with since parameter
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > detectChanges > should detect added entities (using UUID matching)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > detectChanges > should detect updated entities (using UUID matching)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/merge-commands.test.ts > Merge Commands Integration > handleResolveConflicts > should resolve conflicts in issues.jsonl
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/merge-commands.test.ts > Merge Commands Integration > handleResolveConflicts > should resolve conflicts in issues.jsonl
Resolving conflicts in issues.jsonl...

stdout | tests/integration/merge-commands.test.ts > Merge Commands Integration > handleResolveConflicts > should resolve conflicts in issues.jsonl

âœ“ Re-imported to database

issues.jsonl:
  Input:  4 issues
  Output: 4 issues
  Resolved 1 conflict(s):
    - Renamed ID to resolve hash collision (different UUIDs)
  âœ“ Resolved and written

stdout | tests/unit/import.test.ts > Import Operations > detectChanges > should detect deleted entities (using UUID matching)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/export.test.ts > Export Operations > exportIssuesToJSONL > should export all issues including archived
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/merge-commands.test.ts > Merge Commands Integration > handleResolveConflicts > should handle --dry-run mode without writing
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/merge-commands.test.ts > Merge Commands Integration > handleResolveConflicts > should handle --dry-run mode without writing

issues.jsonl:
  Input:  2 issues
  Output: 2 issues
  Resolved 1 conflict(s):
    - Renamed ID to resolve hash collision (different UUIDs)
  (dry-run - no changes written)

stdout | tests/unit/import.test.ts > Import Operations > detectChanges > should detect unchanged entities
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/sync-commands.test.ts > Sync Commands - Auto Direction Detection > Sync direction detection > should sync TO markdown when JSONL is newer
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > detectChanges > should treat same UUID with different ID as update (entity was renamed)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/export.test.ts > Export Operations > exportToJSONL > should export both specs and issues to JSONL files
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/merge-commands.test.ts > Merge Commands Integration > handleResolveConflicts > should handle no conflicts gracefully
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/merge-commands.test.ts > Merge Commands Integration > handleResolveConflicts > should handle no conflicts gracefully
âœ“ No merge conflicts found in JSONL files

stdout | tests/unit/import.test.ts > Import Operations > detectCollisions > should detect ID collisions when UUIDs differ (different entities with same ID)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/issue-commands.test.ts > Issue CLI Commands > handleIssueCreate > should create an issue with minimal options
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > detectCollisions > should not detect collision when UUIDs match (same entity)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/issue-commands.test.ts > Issue CLI Commands > handleIssueCreate > should create an issue with all options
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > detectCollisions > should not detect collision for different IDs (even if content is same)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/merge-commands.test.ts > Merge Commands Integration > handleResolveConflicts > should resolve conflicts in specs.jsonl
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/merge-commands.test.ts > Merge Commands Integration > handleResolveConflicts > should resolve conflicts in specs.jsonl
Resolving conflicts in specs.jsonl...

stdout | tests/integration/merge-commands.test.ts > Merge Commands Integration > handleResolveConflicts > should resolve conflicts in specs.jsonl

âœ“ Re-imported to database

specs.jsonl:
  Input:  2 specs
  Output: 1 specs
  Resolved 1 conflict(s):
    - Kept most recent version, merged 2 versions
  âœ“ Resolved and written

stdout | tests/unit/import.test.ts > Import Operations > countReferences > should count references to an entity
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/local-server| tests/unit/services/workflow-broadcast-service.test.ts (13 tests) 1216ms
stdout | tests/unit/import.test.ts > Import Operations > countReferences > should return 0 for unreferenced entity
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/export.test.ts > Export Operations > exportToJSONL > should use custom file paths
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > updateTextReferences > should update all text references
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/export.test.ts > Export Operations > ExportDebouncer > should debounce multiple export triggers
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > importFromJSONL > should import new specs and issues
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/issue-commands.test.ts > Issue CLI Commands > handleIssueCreate > should output JSON when jsonOutput is true
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/issue-commands.test.ts > Issue CLI Commands > handleIssueList > should list all issues
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > importFromJSONL > should detect and report collisions in dry-run mode (same ID, different UUID)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/issue-commands.test.ts > Issue CLI Commands > handleIssueList > should filter issues by priority
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > importFromJSONL > should update existing entities (same UUID, different content)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/issue-commands.test.ts > Issue CLI Commands > handleIssueList > should filter issues by assignee
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/issue-commands.test.ts > Issue CLI Commands > handleIssueList > should reject invalid status filter
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > importFromJSONL > should delete entities not in JSONL (UUID not present)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > importFromJSONL > should resolve ID collisions by renumbering incoming entity
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > importFromJSONL > should use timestamps to determine collision resolution (newer gets renumbered)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/sync-commands.test.ts > Sync Commands - Auto Direction Detection > Sync direction detection > should sync FROM markdown when markdown is newer
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/merge-commands.test.ts > Merge Commands Integration > handleResolveConflicts > should handle malformed JSON gracefully
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/merge-commands.test.ts > Merge Commands Integration > handleResolveConflicts > should handle malformed JSON gracefully
Resolving conflicts in issues.jsonl...

stdout | tests/unit/cli/sync-commands.test.ts > Sync Commands - Auto Direction Detection > Sync direction detection > should report no-sync when no files exist
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/sync-commands.test.ts > Sync Commands - Auto Direction Detection > Sync direction detection > should sync FROM markdown when only markdown exists
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/merge-commands.test.ts > Merge Commands Integration > handleResolveConflicts > should handle malformed JSON gracefully

âœ“ Re-imported to database

issues.jsonl:
  Input:  2 issues
  Output: 2 issues
  âœ“ Resolved and written

stdout | tests/unit/export.test.ts > Export Operations > ExportDebouncer > should cancel pending export
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/sync-commands.test.ts > Sync Commands - Auto Direction Detection > Sync direction detection > should sync TO markdown when only JSONL exists
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/export.test.ts > Export Operations > ExportDebouncer > should flush pending export immediately
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/issue-commands.test.ts > Issue CLI Commands > handleIssueShow > should show issue details
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/sync-commands.test.ts > Sync Commands - Auto Direction Detection > Sync direction detection > should prefer database when mixed timestamps exist
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/merge-commands.test.ts > Merge Commands Integration > handleMergeDriver > should perform three-way merge successfully
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/id-generator.test.ts > ID Generator > generateSpecId > should generate hash-based spec IDs
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/id-generator.test.ts > ID Generator > generateSpecId > should generate hash IDs regardless of config prefix
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/export.test.ts > Export Operations > ExportDebouncer > should handle execute when not pending
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/export.test.ts > Export Operations > createDebouncedExport > should create a debouncer instance
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/export.test.ts > Export Operations > Deterministic Array Sorting > should sort relationships by to_id, to_type, then type
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/export.test.ts > Export Operations > Deterministic Array Sorting > should sort tags alphabetically
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/export.test.ts > Export Operations > Deterministic Array Sorting > should produce identical output regardless of insertion order
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/issue-commands.test.ts > Issue CLI Commands > handleIssueShow > should handle non-existent issue
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > importFromJSONL > should handle reverse case (local is newer, incoming is older)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/cli| tests/unit/export.test.ts (16 tests) 1596ms
stdout | tests/unit/cli/issue-commands.test.ts > Issue CLI Commands > handleIssueUpdate > should update issue status
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/id-generator.test.ts > ID Generator > generateSpecId > should adapt hash length based on database count
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > importFromJSONL > should import relationships with entity types
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > importFromJSONL > should import cross-type relationships (spec to issue)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > Timestamp Preservation > should preserve timestamps when importing new issues from JSONL
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/sync-commands.test.ts > Sync Commands - Auto Direction Detection > Content stability across syncs > should set JSONL file mtime to match content timestamps
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/sync-commands.test.ts > Sync Commands - Auto Direction Detection > Content stability across syncs > should preserve content across multiple sync operations
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/id-generator.test.ts > ID Generator > generateSpecId > should generate unique IDs for each spec
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/issue-commands.test.ts > Issue CLI Commands > handleIssueUpdate > should update multiple fields
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/merge-commands.test.ts > Merge Commands Integration > handleMergeDriver > should handle additions on both sides
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/issue-commands.test.ts > Issue CLI Commands > handleIssueUpdate > should update issue description (content field)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/issue-commands.test.ts > Issue CLI Commands > handleIssueUpdate > should export to JSONL after update
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/issue-commands.test.ts > Issue CLI Commands > handleIssueUpdate > should update issue parent
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/issue-commands.test.ts > Issue CLI Commands > handleIssueUpdate > should reject invalid status values
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/issue-commands.test.ts > Issue CLI Commands > handleIssueClose > should close a single issue
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/issue-commands.test.ts > Issue CLI Commands > handleIssueClose > should close multiple issues
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/id-generator.test.ts > ID Generator > generateIssueId > should generate hash-based issue IDs
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/merge-commands.test.ts > Merge Commands Integration > handleMergeDriver > should not log on successful merge
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > Timestamp Preservation > should preserve timestamps when importing new specs from JSONL
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > Timestamp Preservation > should preserve timestamps when updating existing issues from JSONL
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > Timestamp Preservation > should preserve closed_at timestamp when importing closed issues
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/merge-commands.test.ts > Merge Commands Integration > handleMergeDriver > should log only on merge failure
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/sync-commands.test.ts > Sync Commands - Auto Direction Detection > Manual sync overrides > should respect --from-markdown flag regardless of timestamps
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/sync-commands.test.ts > Sync Commands - Auto Direction Detection > Manual sync overrides > should respect --to-markdown flag regardless of timestamps
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/sync-commands.test.ts > Sync Commands - Auto Direction Detection > Real-world scenarios > should sync correctly after user edits markdown file
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/id-generator.test.ts > ID Generator > generateIssueId > should generate hash IDs regardless of config prefix
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/merge-commands.test.ts > Merge Commands Integration > handleInitMergeDriver > should create .git/config entry
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/sync-commands.test.ts > Sync Commands - Auto Direction Detection > Real-world scenarios > should sync correctly after external tool updates JSONL
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/merge-commands.test.ts > Merge Commands Integration > handleInitMergeDriver > should create .git/config entry
âœ“ Created /private/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/merge-integration-EuzalC/.git/config with merge driver
âœ“ Created .gitattributes with merge driver
âœ“ Created .gitignore with merge-driver.log

Testing merge driver setup...

stdout | tests/unit/id-generator.test.ts > ID Generator > generateIssueId > should maintain separate ID spaces for specs and issues
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > Timestamp Preservation > should preserve updated_at when updating existing specs from JSONL
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > Timestamp Preservation > should not modify JSONL after import when timestamps are identical
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > Feedback timestamp preservation > should preserve feedback timestamps during import/export cycle
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/sync-commands.test.ts > Export and Import Commands > handleExport > should export database to JSONL files
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/sync-commands.test.ts > Export and Import Commands > handleExport > should output JSON when jsonOutput is true
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/sync-commands.test.ts > Export and Import Commands > handleExport > should export to default directory when no output specified
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/sync-commands.test.ts > Export and Import Commands > handleExport > should handle export with no data
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/sync-commands.test.ts > Export and Import Commands > handleExport > should create output directory if it doesn't exist
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/sync-commands.test.ts > Export and Import Commands > handleExport > should overwrite existing JSONL files
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/sync-commands.test.ts > Export and Import Commands > handleImport > should import specs and issues from JSONL files
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/id-generator.test.ts > ID Generator > Hash ID Generation > getAdaptiveHashLength > returns 4 for small count
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/merge-commands.test.ts > Merge Commands Integration > handleInitMergeDriver > should create .git/config entry
âœ“ Merge driver is working correctly

stdout | tests/unit/cli/issue-commands.test.ts > Issue CLI Commands > handleIssueClose > should handle errors for non-existent issues
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/merge-commands.test.ts > Merge Commands Integration > handleInitMergeDriver > should create .gitattributes entry
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/merge-commands.test.ts > Merge Commands Integration > handleInitMergeDriver > should create .gitattributes entry
âœ“ Created /private/var/folders/7q/kzw4r1097550cv15mm8qpn380000gn/T/merge-integration-FTQF8d/.git/config with merge driver
âœ“ Created .gitattributes with merge driver
âœ“ Created .gitignore with merge-driver.log

Testing merge driver setup...

stdout | tests/unit/cli/issue-commands.test.ts > Issue CLI Commands > handleIssueDelete > should soft delete (close) a single issue by default
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/issue-commands.test.ts > Issue CLI Commands > handleIssueDelete > should hard delete (permanently remove) issue with --hard flag
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/merge-commands.test.ts > Merge Commands Integration > handleInitMergeDriver > should create .gitattributes entry
âœ“ Merge driver is working correctly

stdout | tests/unit/id-generator.test.ts > ID Generator > Hash ID Generation > getAdaptiveHashLength > returns 5 for medium count
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > Feedback timestamp preservation > should preserve feedback timestamps during import/export cycle
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > Feedback timestamp preservation > should preserve feedback timestamps during re-import (sync scenario)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > Legacy JSONL backward compatibility > should import feedback from legacy JSONL format (issue_id/spec_id)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > Legacy JSONL backward compatibility > should update feedback references when issue IDs are renumbered during collision resolution
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/id-generator.test.ts > ID Generator > Hash ID Generation > getAdaptiveHashLength > returns 6 for large count
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/merge-commands.test.ts > Merge Commands Integration > handleInitMergeDriver > should not create .gitattributes for global install
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/issue-commands.test.ts > Issue CLI Commands > handleIssueDelete > should delete multiple issues (soft delete)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/id-generator.test.ts > ID Generator > Hash ID Generation > getAdaptiveHashLength > returns 7 for very large count
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/sync-commands.test.ts > Export and Import Commands > handleImport > should output JSON when jsonOutput is true
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/issue-commands.test.ts > Issue CLI Commands > handleIssueDelete > should delete multiple issues (hard delete)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > Relationship Preservation During Updates > should preserve incoming 'implements' relationships when spec is updated
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/merge-commands.test.ts > Merge Commands Integration > handleInitMergeDriver > should handle already configured merge driver
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/issue-commands.test.ts > Issue CLI Commands > handleIssueDelete > should handle non-existent issue gracefully
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/merge-commands.test.ts > Merge Commands Integration > handleInitMergeDriver > should handle already configured merge driver
Merge driver already configured in git config
âœ“ Created .gitattributes with merge driver
âœ“ Created .gitignore with merge-driver.log

Testing merge driver setup...

stdout | tests/unit/cli/sync-commands.test.ts > Export and Import Commands > handleImport > should handle import with empty JSONL files
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/id-generator.test.ts > ID Generator > Hash ID Generation > getAdaptiveHashLength > returns 8 for huge count
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > Relationship Preservation During Updates > should preserve incoming relationships when issue is updated
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > Relationship Preservation During Updates > should preserve multiple incoming relationships from different issues
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/id-generator.test.ts > ID Generator > Hash ID Generation > hashUUIDToBase36 > produces deterministic output
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/merge-commands.test.ts > Merge Commands Integration > handleInitMergeDriver > should handle already configured merge driver
âœ“ Merge driver is working correctly

stdout | tests/unit/import.test.ts > Import Operations > JSONL Stability > should produce stable JSONL after import-export cycle with relationships
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/sync-commands.test.ts > Export and Import Commands > handleImport > should import relationships from JSONL
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/issue-commands.test.ts > Issue CLI Commands > handleIssueDelete > should handle mixed batch delete (some exist, some don't)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/id-generator.test.ts > ID Generator > Hash ID Generation > hashUUIDToBase36 > produces different hashes for different UUIDs
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/merge-commands.test.ts > Merge Commands Integration > handleInitMergeDriver > should fail gracefully when not in git repo
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/id-generator.test.ts > ID Generator > Hash ID Generation > hashUUIDToBase36 > respects length parameter
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > JSONL Stability > should not lose relationships after multiple import-export cycles
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/sync-commands.test.ts > Export and Import Commands > handleImport > should handle missing JSONL files gracefully
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/sync-commands.test.ts > Export and Import Commands > handleImport > should perform round-trip export and import correctly
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/merge-commands.test.ts > Merge Commands Integration > End-to-end workflow > should resolve conflicts and maintain data integrity
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/merge-commands.test.ts > Merge Commands Integration > End-to-end workflow > should resolve conflicts and maintain data integrity
Resolving conflicts in issues.jsonl...

stdout | tests/unit/cli/issue-commands.test.ts > Issue CLI Commands > handleIssueDelete > should output JSON with results for all operations
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > Resilient Relationship Import > should skip relationships to missing specs and collect warnings
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > Resilient Relationship Import > should skip relationships to missing issues and collect warnings
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > Resilient Relationship Import > should collect multiple warnings for multiple missing entities
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/sync-commands.test.ts > Export and Import Commands > Auto-initialization > should auto-initialize when directory is not initialized
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/id-generator.test.ts > ID Generator > Hash ID Generation > hashUUIDToBase36 > produces only base36 characters
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/id-generator.test.ts > ID Generator > Hash ID Generation > isLegacyID > recognizes legacy issue format
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/id-generator.test.ts > ID Generator > Hash ID Generation > isLegacyID > recognizes legacy spec format
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/merge-commands.test.ts > Merge Commands Integration > End-to-end workflow > should resolve conflicts and maintain data integrity

âœ“ Re-imported to database

issues.jsonl:
  Input:  6 issues
  Output: 5 issues
  Resolved 1 conflict(s):
    - Kept most recent version, merged 2 versions
  âœ“ Resolved and written

 âœ“ |@sudocode-ai/cli| tests/integration/merge-commands.test.ts (15 tests) 3084ms
   âœ“ Merge Commands Integration > handleResolveConflicts > should resolve conflicts in specs.jsonl  308ms
   âœ“ Merge Commands Integration > handleMergeDriver > should perform three-way merge successfully  420ms
   âœ“ Merge Commands Integration > handleInitMergeDriver > should create .git/config entry  329ms
   âœ“ Merge Commands Integration > End-to-end workflow > should resolve conflicts and maintain data integrity  496ms
stdout | tests/unit/cli/issue-commands.test.ts > Issue CLI Commands > handleIssueDelete > should output JSON for hard delete
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/issue-commands.test.ts > Issue CLI Commands > Markdown Sync After Operations > should create markdown file when creating an issue
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/issue-commands.test.ts > Issue CLI Commands > Markdown Sync After Operations > should update markdown file when updating an issue
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/sync-commands.test.ts > Export and Import Commands > Auto-initialization > should proceed with sync after auto-initialization
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/issue-commands.test.ts > Issue CLI Commands > Markdown Sync After Operations > should update markdown file when closing an issue
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/issue-commands.test.ts > Issue CLI Commands > Markdown Sync After Operations > should preserve markdown content when updating frontmatter
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/id-generator.test.ts > ID Generator > Hash ID Generation > isLegacyID > rejects hash format
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/id-generator.test.ts > ID Generator > Hash ID Generation > isLegacyID > rejects invalid formats
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > Resilient Relationship Import > should import valid relationships while skipping invalid ones
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > Resilient Relationship Import > should have no warnings when all relationships are valid
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/id-generator.test.ts > ID Generator > Hash ID Generation > isHashID > recognizes hash issue format
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/sync-commands.test.ts > Export and Import Commands > Auto-initialization > should not re-initialize on second sync call
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/cli| tests/unit/cli/issue-commands.test.ts (30 tests) 3176ms
   âœ“ Issue CLI Commands > handleIssueShow > should handle non-existent issue  310ms
   âœ“ Issue CLI Commands > handleIssueClose > should close multiple issues  451ms
   âœ“ Issue CLI Commands > handleIssueDelete > should handle mixed batch delete (some exist, some don't)  463ms
stdout | tests/unit/import.test.ts > Import Operations > Parent-Child Import Ordering > should import issues when parent is defined after child in JSONL
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > Parent-Child Import Ordering > should import specs when parent is defined after child in JSONL
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/id-generator.test.ts > ID Generator > Hash ID Generation > isHashID > recognizes hash spec format
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/id-generator.test.ts > ID Generator > Hash ID Generation > isHashID > rejects legacy format
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/sync-commands.test.ts > Export and Import Commands > Database Timestamp-Based Sync Direction > should sync to-markdown when database is newer than markdown files
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > Parent-Child Import Ordering > should handle multi-level hierarchy when grandparent is defined last
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > external_links Import Behavior > should clear external_links in SQLite when JSONL has no external_links field
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > external_links Import Behavior > should clear external_links in SQLite when JSONL has empty external_links array
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > external_links Import Behavior > should preserve external_links when JSONL has non-empty external_links
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/import.test.ts > Import Operations > external_links Import Behavior > should clear external_links for issues when JSONL has no external_links field
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/id-generator.test.ts > ID Generator > Hash ID Generation > isHashID > rejects invalid formats
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/id-generator.test.ts > ID Generator > Hash ID Generation > generateSpecId with hash IDs > returns hash format ID and UUID
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/id-generator.test.ts > ID Generator > Hash ID Generation > generateSpecId with hash IDs > returns 4-char hash for first spec
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/id-generator.test.ts > ID Generator > Hash ID Generation > generateIssueId with hash IDs > returns hash format ID and UUID
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/id-generator.test.ts > ID Generator > Hash ID Generation > generateIssueId with hash IDs > returns 4-char hash for first issue
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/sync-commands.test.ts > Export and Import Commands > Database Timestamp-Based Sync Direction > should sync from-markdown when markdown files are newer than database
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/sync-commands.test.ts > Export and Import Commands > Database Timestamp-Based Sync Direction > should prefer database (to-markdown) in mixed state conflicts
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/cli| tests/unit/import.test.ts (47 tests) 4606ms
   âœ“ Import Operations > importFromJSONL > should use timestamps to determine collision resolution (newer gets renumbered)  416ms
   âœ“ Import Operations > Feedback timestamp preservation > should preserve feedback timestamps during import/export cycle  369ms
   âœ“ Import Operations > JSONL Stability > should not lose relationships after multiple import-export cycles  492ms
 âœ“ |@sudocode-ai/cli| tests/unit/id-generator.test.ts (28 tests) 3824ms
   âœ“ ID Generator > generateIssueId > should generate hash-based issue IDs  384ms
   âœ“ ID Generator > Hash ID Generation > hashUUIDToBase36 > respects length parameter  437ms
stdout | tests/unit/operations/feedback.test.ts > Feedback Operations > generateFeedbackId > should generate UUID for feedback ID
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/sync-commands.test.ts > Export and Import Commands > Database Timestamp-Based Sync Direction > should handle no-sync when everything is in sync
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/cli| tests/unit/cli/sync-commands.test.ts (31 tests) 4863ms
   âœ“ Sync Commands - Auto Direction Detection > Sync direction detection > should sync TO markdown when JSONL is newer  648ms
   âœ“ Sync Commands - Auto Direction Detection > Content stability across syncs > should set JSONL file mtime to match content timestamps  401ms
   âœ“ Sync Commands - Auto Direction Detection > Content stability across syncs > should preserve content across multiple sync operations  376ms
   âœ“ Export and Import Commands > handleImport > should output JSON when jsonOutput is true  483ms
   âœ“ Export and Import Commands > Database Timestamp-Based Sync Direction > should sync to-markdown when database is newer than markdown files  308ms
   âœ“ Export and Import Commands > Database Timestamp-Based Sync Direction > should sync from-markdown when markdown files are newer than database  392ms
stdout | tests/unit/operations/feedback.test.ts > Feedback Operations > generateFeedbackId > should generate unique IDs for each feedback
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Feedback Operations > generateFeedbackId > should allow custom IDs (for backward compatibility with legacy FB-XXX format)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Feedback Operations > createFeedback > should create feedback with all fields
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Feedback Operations > createFeedback > should create feedback with defaults
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Feedback Operations > createFeedback > should throw error on invalid foreign key
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/relationship-commands.test.ts > Relationship CLI Commands > handleLink > should create relationship between two specs
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Feedback Operations > createFeedback > should validate feedback_type
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Feedback Operations > getFeedback > should retrieve feedback by ID
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Feedback Operations > getFeedback > should return null for non-existent ID
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Feedback Operations > updateFeedback > should update content
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/relationship-commands.test.ts > Relationship CLI Commands > handleLink > should create relationship between two issues
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/relationship-commands.test.ts > Relationship CLI Commands > handleLink > should create relationship from issue to spec
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/relationship-commands.test.ts > Relationship CLI Commands > handleLink > should create relationship from spec to issue
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Feedback Operations > updateFeedback > should update dismissed and resolution
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/relationship-commands.test.ts > Relationship CLI Commands > handleLink > should support all relationship types
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Feedback Operations > updateFeedback > should update anchor
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Feedback Operations > updateFeedback > should throw error for non-existent ID
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Feedback Operations > dismissFeedback > should dismiss feedback with resolution
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Feedback Operations > deleteFeedback > should delete feedback
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Feedback Operations > deleteFeedback > should return false for non-existent ID
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Feedback Operations > listFeedback > should list all feedback
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Feedback Operations > listFeedback > should filter by from_id (issue)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Feedback Operations > listFeedback > should filter by to_id (spec)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Feedback Operations > listFeedback > should filter by dismissed status
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Feedback Operations > listFeedback > should filter by feedback_type
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Feedback Operations > listFeedback > should combine filters
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Feedback Operations > listFeedback > should respect limit
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/relationship-commands.test.ts > Relationship CLI Commands > handleLink > should handle non-existent from entity
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/relationship-commands.test.ts > Relationship CLI Commands > handleLink > should handle non-existent to entity
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Feedback Operations > getFeedbackForIssue > should get all feedback for an issue
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Feedback Operations > getFeedbackForSpec > should get all feedback for a spec
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Feedback Operations > getActiveFeedbackForSpec > should get only active feedback for a spec
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Feedback Operations > countFeedbackByDismissed > should count all feedback by dismissed status
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Feedback Operations > countFeedbackByDismissed > should count feedback for specific spec
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Feedback Operations > Foreign key constraints > should cascade delete when issue is deleted
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Feedback Operations > Foreign key constraints > should cascade delete when spec is deleted
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Feedback Operations > Anchor JSON serialization > should correctly serialize and deserialize complex anchors
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/relationship-commands.test.ts > Relationship CLI Commands > handleLink > should reject invalid relationship type
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Generalized Feedback Operations > getEntityTypeFromId > should infer spec from s- prefix
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > createIssue > should create an issue with all fields
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > createIssue > should create an issue with defaults
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > createIssue > should upsert on duplicate ID (idempotent import)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/relationship-commands.test.ts > Relationship CLI Commands > handleLink > should reject empty relationship type
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/relationship-commands.test.ts > Relationship CLI Commands > handleLink > should output JSON when jsonOutput is true
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/relationship-commands.test.ts > Relationship CLI Commands > handleLink > should sync relationship to markdown for spec entities
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/relationship-commands.test.ts > Relationship CLI Commands > handleLink > should sync relationship to markdown for issue entities
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/relationship-commands.test.ts > Relationship CLI Commands > handleLink > should create multiple relationships from same entity
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Generalized Feedback Operations > getEntityTypeFromId > should infer issue from i- prefix
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Generalized Feedback Operations > getEntityTypeFromId > should infer from legacy IDs
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Generalized Feedback Operations > getEntityTypeFromId > should throw on invalid ID
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Generalized Feedback Operations > Issueâ†’Spec feedback > should create feedback from issue to spec
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Generalized Feedback Operations > Issueâ†’Spec feedback > should list feedback for a spec
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > createIssue > should throw error when parent_id does not exist
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Generalized Feedback Operations > Issueâ†’Issue feedback > should create feedback from issue to issue
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/feedback-commands.test.ts > Feedback CLI Commands > handleFeedbackAdd > should create feedback with line number anchor
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > createIssue > should create issue with valid parent_id
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > updateIssue > should update issue fields
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > updateIssue > should set closed_at when closing
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > updateIssue > should clear closed_at when reopening
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Generalized Feedback Operations > Issueâ†’Issue feedback > should list feedback from an issue
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/cli| tests/unit/cli/relationship-commands.test.ts (13 tests) 2953ms
   âœ“ Relationship CLI Commands > handleLink > should create relationship between two specs  410ms
   âœ“ Relationship CLI Commands > handleLink > should support all relationship types  593ms
   âœ“ Relationship CLI Commands > handleLink > should handle non-existent from entity  326ms
   âœ“ Relationship CLI Commands > handleLink > should create multiple relationships from same entity  481ms
stdout | tests/unit/operations/feedback.test.ts > Generalized Feedback Operations > Issueâ†’Issue feedback > should list feedback for an issue (receiving)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Generalized Feedback Operations > Issueâ†’Issue feedback > should support feedback without anchors (general)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > updateIssue > should throw error when updating with non-existent parent_id
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Generalized Feedback Operations > Mixed feedback scenarios > should handle multiple feedback paths
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/feedback-commands.test.ts > Feedback CLI Commands > handleFeedbackAdd > should create feedback with text search anchor
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > updateIssue > should update issue with valid parent_id
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Generalized Feedback Operations > Filtering > should filter by from_id
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Generalized Feedback Operations > Filtering > should filter by to_id
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/feedback.test.ts > Generalized Feedback Operations > Filtering > should filter by feedback_type
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/feedback-commands.test.ts > Feedback CLI Commands > handleFeedbackAdd > should fail when text not found
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/feedback-commands.test.ts > Feedback CLI Commands > handleFeedbackAdd > should create feedback without anchor when neither line nor text specified
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > closeIssue and reopenIssue > should close an issue
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > closeIssue and reopenIssue > should reopen an issue
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > listIssues > should list all issues including archived when no filter provided
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > listIssues > should filter by status
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > listIssues > should filter by priority
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > listIssues > should filter by assignee
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > listIssues > should filter by archived status - exclude archived
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/feedback-commands.test.ts > Feedback CLI Commands > handleFeedbackAdd > should output JSON format
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > listIssues > should filter by archived status - only archived
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/feedback-commands.test.ts > Feedback CLI Commands > handleFeedbackAdd > should export to JSONL after adding feedback
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/feedback-commands.test.ts > Feedback CLI Commands > handleFeedbackAdd > should reject invalid feedback type
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > searchIssues > should search by title
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/feedback-commands.test.ts > Feedback CLI Commands > handleFeedbackList > should list all feedback
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/cli| tests/unit/operations/feedback.test.ts (45 tests) 3744ms
   âœ“ Feedback Operations > generateFeedbackId > should generate unique IDs for each feedback  302ms
   âœ“ Feedback Operations > listFeedback > should filter by from_id (issue)  303ms
stdout | tests/unit/cli/init-command.test.ts > Init Command > fresh initialization > should create all required files and directories
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/feedback-commands.test.ts > Feedback CLI Commands > handleFeedbackList > should filter feedback by issue
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/feedback-commands.test.ts > Feedback CLI Commands > handleFeedbackList > should filter feedback by type
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/feedback-commands.test.ts > Feedback CLI Commands > handleFeedbackList > should output JSON format
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/feedback-commands.test.ts > Feedback CLI Commands > handleFeedbackList > should handle empty results
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > searchIssues > should search by content (OAuth)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > searchIssues > should search by content (PostgreSQL)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > searchIssues > should search and filter by status
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > searchIssues > should search and filter by priority
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > searchIssues > should search and filter by assignee
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > searchIssues > should search and filter by multiple criteria
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > searchIssues > should return empty array when search matches but filters do not
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > Automatic Unblocking on Issue Close > should automatically unblock when blocker issue is closed (blocks relationship)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > Automatic Unblocking on Issue Close > should automatically unblock when dependency issue is closed (depends-on relationship)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > Automatic Unblocking on Issue Close > should keep status blocked when closing one of multiple blockers
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > Automatic Unblocking on Issue Close > should handle mixed blocks and depends-on relationships
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > Automatic Unblocking on Issue Close > should not unblock if blocked issue is not in blocked status
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > Automatic Unblocking on Issue Close > should work with updateIssue when status changes to closed
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > Automatic Unblocking on Issue Close > should not trigger unblocking when reopening a closed issue
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > Blocked Status Management > should update blocked issue status when blocker is closed
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/feedback-commands.test.ts > Feedback CLI Commands > handleFeedbackShow > should show feedback details
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/feedback-commands.test.ts > Feedback CLI Commands > handleFeedbackShow > should output JSON format
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/feedback-commands.test.ts > Feedback CLI Commands > handleFeedbackShow > should handle non-existent feedback
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/feedback-commands.test.ts > Feedback CLI Commands > handleFeedbackDismiss > should dismiss feedback
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/init-command.test.ts > Init Command > preserving existing files > should preserve existing specs.jsonl
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/feedback-commands.test.ts > Feedback CLI Commands > handleFeedbackDismiss > should export to JSONL after dismissing feedback
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/feedback-commands.test.ts > Feedback CLI Commands > handleFeedbackStale > should list stale anchors
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/init-command.test.ts > Init Command > preserving existing files > should preserve existing issues.jsonl
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/feedback-commands.test.ts > Feedback CLI Commands > handleFeedbackStale > should handle no stale anchors
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > Blocked Status Management > should keep status as blocked when other blockers remain open
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/spec-commands.test.ts > Spec CLI Commands > handleSpecCreate > should create a spec in database
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > Timestamp Preservation > should accept and preserve custom timestamps when creating issues
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > Timestamp Preservation > should preserve custom updated_at when updating issues
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/spec-commands.test.ts > Spec CLI Commands > handleSpecList > should list all specs
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/spec-commands.test.ts > Spec CLI Commands > handleSpecList > should filter specs by priority
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/init-command.test.ts > Init Command > preserving existing files > should preserve existing cache.db
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > Timestamp Preservation > should preserve custom closed_at when updating issues
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/feedback-commands.test.ts > Feedback CLI Commands > handleFeedbackRelocate > should relocate feedback to new line number
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > Timestamp Preservation > should auto-generate timestamps when not provided
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/feedback-commands.test.ts > Feedback CLI Commands > handleFeedbackRelocate > should preserve original location when relocating
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/spec-commands.test.ts > Spec CLI Commands > handleSpecList > should output JSON format
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/feedback-commands.test.ts > Feedback CLI Commands > handleFeedbackRelocate > should handle non-existent feedback
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/spec-commands.test.ts > Spec CLI Commands > handleSpecList > should handle empty results
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/spec-commands.test.ts > Spec CLI Commands > handleSpecShow > should show spec details
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/spec-commands.test.ts > Spec CLI Commands > handleSpecShow > should output JSON format
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/issues.test.ts > Issue Operations > Timestamp Preservation > should auto-generate updated_at when updating without providing it
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/init-command.test.ts > Init Command > preserving existing files > should preserve all existing files
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/cli| tests/unit/operations/issues.test.ts (40 tests) 2584ms
   âœ“ Issue Operations > searchIssues > should search by content (OAuth)  366ms
   âœ“ Issue Operations > Blocked Status Management > should keep status as blocked when other blockers remain open  413ms
stdout | tests/unit/cli/feedback-commands.test.ts > Feedback CLI Commands > handleFeedbackRelocate > should handle invalid line number
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/feedback-commands.test.ts > Feedback CLI Commands > handleFeedbackRelocate > should handle negative line number
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/spec-commands.test.ts > Spec CLI Commands > handleSpecShow > should handle non-existent spec
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/spec-commands.test.ts > Spec CLI Commands > handleSpecUpdate > should update spec title
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/init-command.test.ts > Init Command > mixed scenarios > should create missing files while preserving existing ones
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/init-command.test.ts > Init Command > importing from existing JSONL files > should import specs from existing specs.jsonl on init
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/feedback-commands.test.ts > Feedback CLI Commands > handleFeedbackRelocate > should handle zero line number
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/feedback-commands.test.ts > Feedback CLI Commands > handleFeedbackRelocate > should output JSON when jsonOutput is true
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/feedback-commands.test.ts > Feedback CLI Commands > handleFeedbackRelocate > should export to JSONL after relocating feedback
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/spec-commands.test.ts > Spec CLI Commands > handleSpecUpdate > should update spec priority
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/cli| tests/unit/cli/feedback-commands.test.ts (27 tests) 2654ms
   âœ“ Feedback CLI Commands > handleFeedbackList > should list all feedback  382ms
   âœ“ Feedback CLI Commands > handleFeedbackDismiss > should export to JSONL after dismissing feedback  340ms
   âœ“ Feedback CLI Commands > handleFeedbackRelocate > should handle invalid line number  377ms
stdout | tests/unit/cli/init-command.test.ts > Init Command > importing from existing JSONL files > should import issues from existing issues.jsonl on init
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/spec-commands.test.ts > Spec CLI Commands > handleSpecUpdate > should update spec description
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/cli| tests/unit/cli/plugin-commands.test.ts (21 tests) 1657ms
   âœ“ Plugin Commands > handlePluginList > should list available plugins in JSON format  1189ms
stdout | tests/unit/cli/spec-commands.test.ts > Spec CLI Commands > handleSpecUpdate > should update spec tags
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/spec-commands.test.ts > Spec CLI Commands > handleSpecUpdate > should update spec parent
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/init-command.test.ts > Init Command > importing from existing JSONL files > should import both specs and issues from JSONL files
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/spec-commands.test.ts > Spec CLI Commands > handleSpecUpdate > should update multiple fields at once
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/init-command.test.ts > Init Command > importing from existing JSONL files > should not import when JSONL files are empty
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/spec-commands.test.ts > Spec CLI Commands > handleSpecUpdate > should handle non-existent spec
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/cli| tests/unit/cli/init-command.test.ts (10 tests) 2592ms
   âœ“ Init Command > preserving existing files > should preserve existing specs.jsonl  372ms
   âœ“ Init Command > preserving existing files > should preserve existing issues.jsonl  371ms
   âœ“ Init Command > mixed scenarios > should create missing files while preserving existing ones  384ms
   âœ“ Init Command > importing from existing JSONL files > should import specs from existing specs.jsonl on init  321ms
   âœ“ Init Command > importing from existing JSONL files > should import issues from existing issues.jsonl on init  340ms
stdout | tests/unit/cli/spec-commands.test.ts > Spec CLI Commands > handleSpecUpdate > should output JSON format
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/spec-commands.test.ts > Spec CLI Commands > handleSpecUpdate > should preserve existing markdown content when updating frontmatter only
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/spec-commands.test.ts > Spec CLI Commands > handleSpecDelete > should delete spec and remove markdown file
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/spec-commands.test.ts > Spec CLI Commands > handleSpecDelete > should handle multiple spec deletions
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/spec-commands.test.ts > Spec CLI Commands > handleSpecDelete > should handle non-existent spec
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/spec-commands.test.ts > Spec CLI Commands > handleSpecDelete > should handle missing markdown file gracefully
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/spec-commands.test.ts > Spec CLI Commands > handleSpecDelete > should output JSON format for deletions
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/cli| tests/unit/cli/spec-commands.test.ts (22 tests) 2242ms
   âœ“ Spec CLI Commands > handleSpecUpdate > should update spec title  462ms
stdout | tests/unit/cli/query-commands.test.ts > Query CLI Commands > handleReady > should show message when no ready issues exist
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/query-commands.test.ts > Query CLI Commands > handleReady > should list ready issues
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/query-commands.test.ts > Query CLI Commands > handleReady > should exclude blocked issues from ready list
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/sync.test.ts > Markdown â†” JSONL Sync > syncMarkdownToJSONL > should create new spec from markdown
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/sync.test.ts > Markdown â†” JSONL Sync > syncMarkdownToJSONL > should update existing spec from markdown
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/sync.test.ts > Markdown â†” JSONL Sync > syncMarkdownToJSONL > should update existing spec from markdown
[sync] File renamed: spec.md â†’ test-sync/spec-001.md

stdout | tests/unit/cli/query-commands.test.ts > Query CLI Commands > handleReady > should exclude closed issues from ready list
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/sync.test.ts > Markdown â†” JSONL Sync > syncMarkdownToJSONL > should create new issue from markdown
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/sync.test.ts > Markdown â†” JSONL Sync > syncMarkdownToJSONL > should sync cross-references as relationships
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/sync.test.ts > Markdown â†” JSONL Sync > syncMarkdownToJSONL > should store anchor information in relationship metadata
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/query-commands.test.ts > Query CLI Commands > handleReady > should exclude archived issues from ready list
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/sync.test.ts > Markdown â†” JSONL Sync > syncMarkdownToJSONL > should store anchors for references with relationship types
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/specs.test.ts > Spec Operations > createSpec > should create a spec with all fields
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/specs.test.ts > Spec Operations > createSpec > should create a spec with default values
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/specs.test.ts > Spec Operations > createSpec > should upsert on duplicate ID (idempotent import)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/specs.test.ts > Spec Operations > createSpec > should throw error when parent_id does not exist
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/specs.test.ts > Spec Operations > createSpec > should create spec with valid parent_id
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/query-commands.test.ts > Query CLI Commands > handleReady > should show assignees when present
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/query-commands.test.ts > Query CLI Commands > handleReady > should sort by priority (DESC) and created_at
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/query-commands.test.ts > Query CLI Commands > handleReady > should output JSON when jsonOutput is true
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/query-commands.test.ts > Query CLI Commands > handleReady > should output empty JSON array when no ready issues
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/query-commands.test.ts > Query CLI Commands > handleBlocked > should show message when no blocked issues exist
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/sync.test.ts > Markdown â†” JSONL Sync > syncMarkdownToJSONL > should handle missing id in frontmatter when autoInitialize is disabled
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/sync.test.ts > Markdown â†” JSONL Sync > syncMarkdownToJSONL > should determine entity type from file path
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/specs.test.ts > Spec Operations > getSpec > should retrieve an existing spec
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/relationships.test.ts > Relationship Operations > addRelationship > should create a relationship
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/query-commands.test.ts > Query CLI Commands > handleBlocked > should list blocked issues
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/relationships.test.ts > Relationship Operations > addRelationship > should return existing relationship when adding duplicate
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/relationships.test.ts > Relationship Operations > addRelationship > should throw error when from_id does not exist
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/relationships.test.ts > Relationship Operations > addRelationship > should throw error when to_id does not exist
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/relationships.test.ts > Relationship Operations > addRelationship > should throw error for invalid relationship type
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/relationships.test.ts > Relationship Operations > addRelationship > should throw error for empty relationship type
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/relationships.test.ts > Relationship Operations > addRelationship > should validate relationship type before checking entity existence
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/relationships.test.ts > Relationship Operations > removeRelationship > should remove an existing relationship
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/sync.test.ts > Markdown â†” JSONL Sync > syncMarkdownToJSONL > should handle ID conflict by preferring file path
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/sync.test.ts > Markdown â†” JSONL Sync > syncMarkdownToJSONL > should prevent duplicate specs when ID changes
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/specs.test.ts > Spec Operations > getSpec > should return null for non-existent spec
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/sync.test.ts > Markdown â†” JSONL Sync > syncMarkdownToJSONL > should handle file rename by updating file_path
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/sync.test.ts > Markdown â†” JSONL Sync > syncMarkdownToJSONL > should handle file rename by updating file_path
[sync] File renamed: specs/original-name.md â†’ specs/new-name.md

stdout | tests/unit/operations/specs.test.ts > Spec Operations > getSpecByFilePath > should retrieve a spec by its file path
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/sync.test.ts > Markdown â†” JSONL Sync > syncMarkdownToJSONL > should warn about path conflict when renaming to occupied path
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/sync.test.ts > Markdown â†” JSONL Sync > syncMarkdownToJSONL > should warn about path conflict when renaming to occupied path
[sync] File renamed: specs/spec-a.md â†’ specs/spec-b.md

stdout | tests/unit/operations/specs.test.ts > Spec Operations > getSpecByFilePath > should return null for non-existent file path
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/specs.test.ts > Spec Operations > getSpecByFilePath > should distinguish between different specs with similar paths
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/sync.test.ts > Markdown â†” JSONL Sync > syncJSONLToMarkdown > should create markdown from spec
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/specs.test.ts > Spec Operations > updateSpec > should update spec fields
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/sync.test.ts > Markdown â†” JSONL Sync > syncJSONLToMarkdown > should update existing markdown frontmatter only
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/mcp| tests/unit/client.test.ts (20 tests) 546ms
   âœ“ SudocodeClient > exec > should timeout after specified duration  305ms
stdout | tests/unit/operations/relationships.test.ts > Relationship Operations > removeRelationship > should return false for non-existent relationship
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/specs.test.ts > Spec Operations > updateSpec > should archive a spec
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/sync.test.ts > Markdown â†” JSONL Sync > syncJSONLToMarkdown > should exclude internal metadata fields from frontmatter
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/query-commands.test.ts > Query CLI Commands > handleBlocked > should not list ready issues in blocked list
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/specs.test.ts > Spec Operations > updateSpec > should unarchive a spec
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/specs.test.ts > Spec Operations > updateSpec > should throw error for non-existent spec
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/relationships.test.ts > Relationship Operations > getOutgoingRelationships > should get all outgoing relationships
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/specs.test.ts > Spec Operations > updateSpec > should throw error when updating with non-existent parent_id
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/sync.test.ts > Markdown â†” JSONL Sync > syncJSONLToMarkdown > should create markdown from issue
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/sync.test.ts > Markdown â†” JSONL Sync > syncJSONLToMarkdown > should include relationships in frontmatter
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/relationships.test.ts > Relationship Operations > getOutgoingRelationships > should filter by relationship type
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/query-commands.test.ts > Query CLI Commands > handleBlocked > should exclude blocked issues when blocker is closed
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/relationships.test.ts > Relationship Operations > getIncomingRelationships > should get all incoming relationships
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/relationships.test.ts > Relationship Operations > getIncomingRelationships > should filter by relationship type
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/relationships.test.ts > Relationship Operations > getDependencies and getDependents > should get dependencies
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/specs.test.ts > Spec Operations > updateSpec > should update spec with valid parent_id
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/specs.test.ts > Spec Operations > deleteSpec > should delete an existing spec
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/sync.test.ts > Markdown â†” JSONL Sync > syncJSONLToMarkdown > should handle non-existent entity
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/specs.test.ts > Spec Operations > deleteSpec > should return false for non-existent spec
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/sync.test.ts > Markdown â†” JSONL Sync > bidirectional sync > should preserve relationships added outside frontmatter
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/specs.test.ts > Spec Operations > listSpecs > should list all specs including archived when no filter provided
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/sync.test.ts > Markdown â†” JSONL Sync > bidirectional sync > should preserve relationships added outside frontmatter
[sync] File renamed: main.md â†’ test-sync/spec-001.md

stdout | tests/unit/sync.test.ts > Markdown â†” JSONL Sync > bidirectional sync > should complete full round-trip sync without data loss
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/specs.test.ts > Spec Operations > listSpecs > should filter by priority
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/cli| tests/unit/sync.test.ts (20 tests) 1984ms
stdout | tests/unit/cli/query-commands.test.ts > Query CLI Commands > handleBlocked > should sort by priority (DESC) and created_at
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/relationships.test.ts > Relationship Operations > getDependencies and getDependents > should get dependents
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/relationships.test.ts > Relationship Operations > removeAllRelationships > should remove all relationships for an entity
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/relationships.test.ts > Relationship Operations > Automatic Blocked Status Management > should automatically set status to blocked when blocks relationship is added
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/relationships.test.ts > Relationship Operations > Automatic Blocked Status Management > should not set status to blocked if blocker is already closed
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/tags.test.ts > Tag Operations > addTag > should add a tag to an entity
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/relationships.test.ts > Relationship Operations > Automatic Blocked Status Management > should automatically unblock when last blocks relationship is removed
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/tags.test.ts > Tag Operations > addTag > should handle duplicate tags gracefully
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/relationships.test.ts > Relationship Operations > Automatic Blocked Status Management > should keep status as blocked when removing one of multiple blockers
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/tags.test.ts > Tag Operations > addTags > should add multiple tags at once
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/specs.test.ts > Spec Operations > listSpecs > should respect limit
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/relationships.test.ts > Relationship Operations > Automatic Blocked Status Management > should not change status when adding non-blocks relationship
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/tags.test.ts > Tag Operations > getTags > should get all tags for an entity
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/specs.test.ts > Spec Operations > listSpecs > should filter by archived status - exclude archived
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/tags.test.ts > Tag Operations > getTags > should return empty array for entity with no tags
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/relationships.test.ts > Relationship Operations > Automatic Blocked Status Management for depends-on > should automatically set status to blocked when depends-on relationship is added
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/specs.test.ts > Spec Operations > listSpecs > should filter by archived status - only archived
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/relationships.test.ts > Relationship Operations > Automatic Blocked Status Management for depends-on > should not set status to blocked if dependency is already closed
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/tags.test.ts > Tag Operations > removeTag > should remove a tag
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/relationships.test.ts > Relationship Operations > Automatic Blocked Status Management for depends-on > should automatically unblock when last depends-on relationship is removed
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/tags.test.ts > Tag Operations > removeTag > should return false for non-existent tag
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/tags.test.ts > Tag Operations > hasTag > should return true for existing tag
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/specs.test.ts > Spec Operations > searchSpecs > should exclude archived specs when filter is set to false
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/relationships.test.ts > Relationship Operations > Automatic Blocked Status Management for depends-on > should work with mixed blocks and depends-on relationships
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/tags.test.ts > Tag Operations > hasTag > should return false for non-existent tag
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/specs.test.ts > Spec Operations > searchSpecs > should include archived specs when filter is set to true
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/specs.test.ts > Spec Operations > searchSpecs > should search by title
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/relationships.test.ts > Relationship Operations > removeOutgoingRelationships > should remove only outgoing relationships
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/round-trip.test.ts > Round-Trip Data Consistency Tests > API â†’ DB â†’ JSONL â†’ Markdown Flow > should maintain spec consistency through full round trip
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/specs.test.ts > Spec Operations > searchSpecs > should search by content
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/tags.test.ts > Tag Operations > getEntitiesByTag > should get all entities with a tag
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/relationships.test.ts > Relationship Operations > removeOutgoingRelationships > should preserve incoming 'implements' relationships when spec is updated
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/specs.test.ts > Spec Operations > searchSpecs > should return empty for no matches
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/relationships.test.ts > Relationship Operations > removeOutgoingRelationships > should return 0 when entity has no outgoing relationships
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/specs.test.ts > Spec Operations > searchSpecs > should search and filter by priority
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/tags.test.ts > Tag Operations > getEntitiesByTag > should filter by entity type
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/tags.test.ts > Tag Operations > getAllTags > should get all unique tags
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/query-commands.test.ts > Query CLI Commands > handleBlocked > should output JSON when jsonOutput is true
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/specs.test.ts > Spec Operations > searchSpecs > should search with multiple matches
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/specs.test.ts > Spec Operations > searchSpecs > should search and filter with no matching filters
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/specs.test.ts > Spec Operations > searchSpecs > should respect limit parameter
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/cli| tests/unit/operations/specs.test.ts (32 tests) 1918ms
   âœ“ Spec Operations > createSpec > should create spec with valid parent_id  330ms
stdout | tests/unit/operations/tags.test.ts > Tag Operations > getAllTags > should filter by entity type
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/tags.test.ts > Tag Operations > removeAllTags > should remove all tags from an entity
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/tags.test.ts > Tag Operations > setTags > should replace all tags
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/cli| tests/unit/operations/tags.test.ts (15 tests) 649ms
stdout | tests/unit/operations/relationships.test.ts > Relationship Operations > Deterministic Ordering > should return outgoing relationships in deterministic order regardless of creation order
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/relationships.test.ts > Relationship Operations > Deterministic Ordering > should order outgoing relationships by to_id when created_at is same
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/relationships.test.ts > Relationship Operations > Deterministic Ordering > should order incoming relationships deterministically by from_id
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/relationships.test.ts > Relationship Operations > Cascade Delete on Entity Deletion > should cascade delete all relationships when spec is deleted
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/relationships.test.ts > Relationship Operations > Cascade Delete on Entity Deletion > should cascade delete all relationships when issue is deleted
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/cli| tests/unit/operations/relationships.test.ts (33 tests) 1582ms
   âœ“ Relationship Operations > removeRelationship > should return false for non-existent relationship  323ms
   âœ“ Relationship Operations > getDependencies and getDependents > should get dependents  338ms
stdout | tests/integration/round-trip.test.ts > Round-Trip Data Consistency Tests > API â†’ DB â†’ JSONL â†’ Markdown Flow > should maintain issue consistency through full round trip
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/round-trip.test.ts > Round-Trip Data Consistency Tests > API â†’ DB â†’ JSONL â†’ Markdown Flow > should preserve spec updates through round trip
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/query-commands.test.ts > Query CLI Commands > handleBlocked > should output empty JSON array when no blocked issues
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/cli| tests/unit/cli/query-commands.test.ts (16 tests) 4132ms
   âœ“ Query CLI Commands > handleReady > should exclude closed issues from ready list  375ms
   âœ“ Query CLI Commands > handleBlocked > should list blocked issues  695ms
   âœ“ Query CLI Commands > handleBlocked > should sort by priority (DESC) and created_at  363ms
   âœ“ Query CLI Commands > handleBlocked > should output JSON when jsonOutput is true  1783ms
stdout | tests/integration/round-trip.test.ts > Round-Trip Data Consistency Tests > Markdown â†’ DB â†’ JSONL Flow > should sync new markdown spec to DB and JSONL
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/round-trip.test.ts > Round-Trip Data Consistency Tests > Markdown â†’ DB â†’ JSONL Flow > should sync markdown updates to DB and JSONL
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/round-trip.test.ts > Round-Trip Data Consistency Tests > JSONL â†’ DB â†’ Markdown Flow > should import new entities from JSONL
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/round-trip.test.ts > Round-Trip Data Consistency Tests > JSONL â†’ DB â†’ Markdown Flow > should update existing entities from JSONL
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/round-trip.test.ts > Round-Trip Data Consistency Tests > Relationship Preservation Across Flows > should preserve implements relationship when spec is updated via API
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/round-trip.test.ts > Round-Trip Data Consistency Tests > Relationship Preservation Across Flows > should preserve implements relationship when spec is updated via Markdown
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/cli| tests/unit/cli/server-commands.test.ts (9 tests) 54ms
stdout | tests/integration/round-trip.test.ts > Round-Trip Data Consistency Tests > Relationship Preservation Across Flows > should preserve multiple relationships when issue is updated
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/transactions.test.ts > Transaction Operations > transaction > should commit on success
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/transactions.test.ts > Transaction Operations > transaction > should rollback on error
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/transactions.test.ts > Transaction Operations > transaction > should handle nested transactions
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/round-trip.test.ts > Round-Trip Data Consistency Tests > Relationship Preservation Across Flows > should preserve bidirectional relationships (blocks/depends-on)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/transactions.test.ts > Transaction Operations > batchTransaction > should execute multiple operations in a transaction
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/transactions.test.ts > Transaction Operations > batchTransaction > should rollback all operations on error
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/transactions.test.ts > Transaction Operations > SavepointTransaction > should commit savepoint on success
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/round-trip.test.ts > Round-Trip Data Consistency Tests > Full Watcher Simulation > should handle spec update â†’ export â†’ import cycle without losing data
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/cli| tests/unit/jsonl.test.ts (27 tests) 506ms
 âœ“ |@sudocode-ai/cli| tests/unit/operations/external-links.test.ts (35 tests) 575ms
   âœ“ External Link Operations > Issue External Links > addExternalLinkToIssue > should throw for non-existent issue  319ms
stdout | tests/unit/operations/transactions.test.ts > Transaction Operations > SavepointTransaction > should rollback savepoint on error
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/transactions.test.ts > Transaction Operations > SavepointTransaction > should allow manual commit
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/operations/transactions.test.ts > Transaction Operations > SavepointTransaction > should allow manual rollback
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/round-trip.test.ts > Round-Trip Data Consistency Tests > Full Watcher Simulation > should handle concurrent spec and issue updates
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/cli| tests/unit/operations/transactions.test.ts (9 tests) 640ms
stdout | tests/integration/round-trip.test.ts > Round-Trip Data Consistency Tests > Edge Cases and Regression Prevention > should handle spec with no relationships
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/reference-commands.test.ts > Reference CLI Commands > handleAddReference > should add reference to spec using line number (inline)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/reference-commands.test.ts > Reference CLI Commands > handleAddReference > should add reference to spec using text search
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/reference-commands.test.ts > Reference CLI Commands > handleAddReference > should add reference with display text
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/status-commands.test.ts > Status CLI Commands > handleStatus > should show zero counts when no entities exist
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/status-commands.test.ts > Status CLI Commands > handleStatus > should count specs correctly
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/round-trip.test.ts > Round-Trip Data Consistency Tests > Edge Cases and Regression Prevention > should handle issue with outgoing relationship being updated
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/round-trip.test.ts > Round-Trip Data Consistency Tests > Edge Cases and Regression Prevention > should preserve archived status through round trip
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/reference-commands.test.ts > Reference CLI Commands > handleAddReference > should add reference with relationship type
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/status-commands.test.ts > Status CLI Commands > handleStatus > should count issues by status correctly
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/reference-commands.test.ts > Reference CLI Commands > handleAddReference > should add reference with newline format
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/status-commands.test.ts > Status CLI Commands > handleStatus > should count ready issues correctly
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/reference-commands.test.ts > Reference CLI Commands > handleAddReference > should add reference to issue
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/status-commands.test.ts > Status CLI Commands > handleStatus > should count blocked issues correctly
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/reference-commands.test.ts > Reference CLI Commands > handleAddReference > should handle entity not found
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/status-commands.test.ts > Status CLI Commands > handleStatus > should output JSON when jsonOutput is true
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/reference-commands.test.ts > Reference CLI Commands > handleAddReference > should handle missing line and text options
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/reference-commands.test.ts > Reference CLI Commands > handleAddReference > should handle both line and text specified
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/status-commands.test.ts > Status CLI Commands > handleStatus > should show all status types in breakdown
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/round-trip.test.ts > Round-Trip Data Consistency Tests > Edge Cases and Regression Prevention > should handle empty tags array
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/integration/round-trip.test.ts > Round-Trip Data Consistency Tests > Edge Cases and Regression Prevention > should handle special characters in content
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/cli| tests/integration/round-trip.test.ts (18 tests) 5051ms
   âœ“ Round-Trip Data Consistency Tests > API â†’ DB â†’ JSONL â†’ Markdown Flow > should maintain spec consistency through full round trip  1476ms
   âœ“ Round-Trip Data Consistency Tests > Markdown â†’ DB â†’ JSONL Flow > should sync new markdown spec to DB and JSONL  714ms
   âœ“ Round-Trip Data Consistency Tests > Markdown â†’ DB â†’ JSONL Flow > should sync markdown updates to DB and JSONL  1058ms
   âœ“ Round-Trip Data Consistency Tests > Relationship Preservation Across Flows > should preserve implements relationship when spec is updated via Markdown  347ms
   âœ“ Round-Trip Data Consistency Tests > Edge Cases and Regression Prevention > should handle issue with outgoing relationship being updated  336ms
stdout | tests/unit/cli/status-commands.test.ts > Status CLI Commands > handleStats > should show comprehensive statistics
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/reference-commands.test.ts > Reference CLI Commands > handleAddReference > should handle invalid line number
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/reference-commands.test.ts > Reference CLI Commands > handleAddReference > should handle text not found
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/reference-commands.test.ts > Reference CLI Commands > handleAddReference > should output JSON format
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/reference-commands.test.ts > Reference CLI Commands > handleAddReference > should update database content
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/status-commands.test.ts > Status CLI Commands > handleStats > should count relationships by type
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/cli| tests/unit/cli/reference-commands.test.ts (13 tests) 1416ms
   âœ“ Reference CLI Commands > handleAddReference > should update database content  317ms
stdout | tests/unit/cli/status-commands.test.ts > Status CLI Commands > handleStats > should track recent activity for last 7 days
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/status-commands.test.ts > Status CLI Commands > handleStats > should track closed issues in recent activity
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/status-commands.test.ts > Status CLI Commands > handleStats > should output JSON with all statistics
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/status-commands.test.ts > Status CLI Commands > handleStats > should show zero relationships when none exist
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/cli/status-commands.test.ts > Status CLI Commands > handleStats > should count multiple relationship types correctly
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 âœ“ |@sudocode-ai/cli| tests/unit/cli/status-commands.test.ts (14 tests) 2023ms
   âœ“ Status CLI Commands > handleStats > should count relationships by type  439ms
   âœ“ Status CLI Commands > handleStats > should output JSON with all statistics  699ms
 âœ“ |@sudocode-ai/cli| tests/unit/merge-resolver.test.ts (26 tests) 239ms
 âœ“ |@sudocode-ai/cli| tests/unit/operations/feedback-anchors.test.ts (86 tests) 293ms
 âœ“ |@sudocode-ai/local-server| tests/unit/services/editor-service.test.ts (17 tests) 141ms
 âœ“ |@sudocode-ai/cli| tests/unit/integrations/sync-coordinator.test.ts (48 tests) 448ms
 âœ“ |@sudocode-ai/cli| tests/unit/markdown.test.ts (44 tests) 457ms
 âœ“ |@sudocode-ai/cli| tests/unit/integrations/conflict-resolver.test.ts (22 tests) 6ms
 âœ“ |@sudocode-ai/mcp| tests/unit/server.test.ts (13 tests) 535ms
 âœ“ |@sudocode-ai/cli| tests/unit/integrations/config-resolver.test.ts (14 tests) 17ms
 âœ“ |@sudocode-ai/cli| tests/unit/integrations/base-provider.test.ts (32 tests) 133ms
 âœ“ |@sudocode-ai/cli| tests/unit/update-checker.test.ts (13 tests) 37ms
 âœ“ |@sudocode-ai/cli| tests/unit/cli/update-commands.test.ts (14 tests) 89ms
 â†“ |@sudocode-ai/local-server| tests/integration/issue-broadcasts.test.ts (4 tests | 4 skipped)
 â†“ |@sudocode-ai/local-server| tests/integration/multi-project.test.ts (16 tests | 16 skipped)
 â†“ |@sudocode-ai/local-server| tests/unit/services/execution-worker-pool.test.ts (34 tests | 34 skipped)
stdout | tests/integration/port-scanning.test.ts > Port Scanning Integration Tests
[test] Conflicting HTTP server on port 13700

stdout | tests/integration/port-scanning.test.ts > Port Scanning Integration Tests
[test] Conflicting WebSocket server on port 13700/ws

 â†“ |@sudocode-ai/local-server| tests/e2e/workflow/mcp-e2e.test.ts (11 tests | 11 skipped)
stdout | tests/unit/services/execution-service-mcp-detection.test.ts > ExecutionService - MCP Detection > detectSudocodeMcp > should return true when sudocode-mcp package is available in PATH
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-mcp-detection.test.ts > ExecutionService - MCP Detection > detectSudocodeMcp > should return false when sudocode-mcp package is not available
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-mcp-detection.test.ts > ExecutionService - MCP Detection > detectSudocodeMcp > should return false on detection errors (logs warning, doesn't throw)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

 â†“ |@sudocode-ai/local-server| tests/e2e/workflow/sequential-workflow.test.ts (16 tests | 16 skipped)
 â†“ |@sudocode-ai/local-server| tests/e2e/workflow/orchestrator-workflow.test.ts (16 tests | 16 skipped)
 âœ“ |@sudocode-ai/local-server| tests/integration/port-scanning.test.ts (2 tests) 1257ms
stdout | tests/unit/services/execution-service-mcp-detection.test.ts > ExecutionService - MCP Detection > detectAgentMcp - claude-code > should return true when settings.json has sudocode plugin enabled
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-mcp-detection.test.ts > ExecutionService - MCP Detection > detectAgentMcp - claude-code > should return true when settings.json has sudocode plugin enabled
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service-mcp-detection.test.ts > ExecutionService - MCP Detection > detectAgentMcp - claude-code > should return false when settings.json exists but plugin is not enabled
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-mcp-detection.test.ts > ExecutionService - MCP Detection > detectAgentMcp - claude-code > should return false when settings.json exists but plugin is not enabled
[ExecutionService] sudocode-mcp not detected for claude-code (plugin not enabled)

stdout | tests/unit/services/execution-service-mcp-detection.test.ts > ExecutionService - MCP Detection > detectAgentMcp - claude-code > should return false when settings.json doesn't exist
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-mcp-detection.test.ts > ExecutionService - MCP Detection > detectAgentMcp - claude-code > should return true when settings.json is malformed JSON (conservative behavior, logs error)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-mcp-detection.test.ts > ExecutionService - MCP Detection > detectAgentMcp - claude-code > should return false when enabledPlugins['sudocode@sudocode-marketplace'] is false
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-mcp-detection.test.ts > ExecutionService - MCP Detection > detectAgentMcp - claude-code > should return false when enabledPlugins['sudocode@sudocode-marketplace'] is false
[ExecutionService] sudocode-mcp not detected for claude-code (plugin not enabled)

stdout | tests/unit/services/execution-service-mcp-detection.test.ts > ExecutionService - MCP Detection > detectAgentMcp - claude-code > should return false when enabledPlugins['sudocode@sudocode-marketplace'] is missing
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-mcp-detection.test.ts > ExecutionService - MCP Detection > detectAgentMcp - claude-code > should return false when enabledPlugins['sudocode@sudocode-marketplace'] is missing
[ExecutionService] sudocode-mcp not detected for claude-code (plugin not enabled)

stdout | tests/unit/services/execution-service-mcp-detection.test.ts > ExecutionService - MCP Detection > detectAgentMcp - claude-code > should handle file read errors gracefully (returns true - conservative, logs warning)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-mcp-detection.test.ts > ExecutionService - MCP Detection > detectAgentMcp - other agents > should return true for copilot agent (unsupported, defaults to safe behavior)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-mcp-detection.test.ts > ExecutionService - MCP Detection > detectAgentMcp - other agents > should return true for cursor agent (unsupported, defaults to safe behavior)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-mcp-detection.test.ts > ExecutionService - MCP Detection > detectAgentMcp - other agents > should return true for codex agent (unsupported, defaults to safe behavior)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-mcp-detection.test.ts > ExecutionService - MCP Detection > Integration - buildExecutionConfig > should throw error when detectSudocodeMcp() returns false
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-mcp-detection.test.ts > ExecutionService - MCP Detection > Integration - buildExecutionConfig > should add sudocode-mcp to mcpServers when detectAgentMcp() returns false
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-mcp-detection.test.ts > ExecutionService - MCP Detection > Integration - buildExecutionConfig > should add sudocode-mcp to mcpServers when detectAgentMcp() returns false
[ExecutionService] sudocode-mcp not detected for claude-code (plugin not enabled)

stdout | tests/unit/services/execution-service-mcp-detection.test.ts > ExecutionService - MCP Detection > Integration - buildExecutionConfig > should add sudocode-mcp to mcpServers when detectAgentMcp() returns false
[ExecutionService] Adding sudocode-mcp to mcpServers (auto-injection)

stdout | tests/unit/services/execution-service-mcp-detection.test.ts > ExecutionService - MCP Detection > Integration - buildExecutionConfig > should skip injection when detectAgentMcp() returns true (plugin already configured)
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-mcp-detection.test.ts > ExecutionService - MCP Detection > Integration - buildExecutionConfig > should skip injection when detectAgentMcp() returns true (plugin already configured)
[ExecutionService] sudocode-mcp detected for claude-code (plugin enabled)

stdout | tests/unit/services/execution-service-mcp-detection.test.ts > ExecutionService - MCP Detection > Integration - buildExecutionConfig > should skip injection when detectAgentMcp() returns true (plugin already configured)
[ExecutionService] Removing sudocode-mcp from CLI config (using plugin instead)

stdout | tests/unit/services/execution-service-mcp-detection.test.ts > ExecutionService - MCP Detection > Integration - buildExecutionConfig > should preserve user-provided MCP servers when auto-injecting
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-mcp-detection.test.ts > ExecutionService - MCP Detection > Integration - buildExecutionConfig > should preserve user-provided MCP servers when auto-injecting
[ExecutionService] sudocode-mcp not detected for claude-code (plugin not enabled)

stdout | tests/unit/services/execution-service-mcp-detection.test.ts > ExecutionService - MCP Detection > Integration - buildExecutionConfig > should preserve user-provided MCP servers when auto-injecting
[ExecutionService] Adding sudocode-mcp to mcpServers (auto-injection)

stdout | tests/unit/services/execution-service-mcp-detection.test.ts > ExecutionService - MCP Detection > Integration - buildExecutionConfig > should not duplicate sudocode-mcp if user already provided it
Running 5 pending migration(s)...
  Applying migration 1: generalize-feedback-table
  âœ“ Migration 1 applied successfully
  Applying migration 2: add-normalized-entry-support
  âœ“ Migration 2 applied successfully
  Applying migration 3: remove-agent-type-constraints
  âœ“ Migration 3 applied successfully
  Applying migration 4: add-external-links-column
  [migration-4] Starting add-external-links-column migration
  [migration-4] specs table exists: true
  [migration-4] specs.external_links column exists: true
  [migration-4] issues table exists: true
  [migration-4] issues.external_links column exists: true
  [migration-4] Migration complete
  âœ“ Migration 4 applied successfully
  Applying migration 5: make-feedback-from-id-nullable
  âœ“ Migration 5 applied successfully

stdout | tests/unit/services/execution-service-mcp-detection.test.ts > ExecutionService - MCP Detection > Integration - buildExecutionConfig > should not duplicate sudocode-mcp if user already provided it
[ExecutionService] sudocode-mcp not detected for claude-code (plugin not enabled)

stdout | tests/unit/services/execution-service-mcp-detection.test.ts > ExecutionService - MCP Detection > Integration - buildExecutionConfig > should not duplicate sudocode-mcp if user already provided it
[ExecutionService] Skipping sudocode-mcp injection (user provided in config)

 âœ“ |@sudocode-ai/local-server| tests/unit/services/execution-service-mcp-detection.test.ts (18 tests) 1196ms
stdout | tests/unit/routes/update.test.ts > Update API Routes > POST /api/update/install > should successfully install update for sudocode metapackage
[update] Installing sudocode...
[update] Successfully installed sudocode

stdout | tests/unit/routes/update.test.ts > Update API Routes > POST /api/update/install > should fall back to @sudocode-ai/cli when metapackage not installed
[update] Installing @sudocode-ai/cli...
[update] Successfully installed @sudocode-ai/cli

stdout | tests/unit/routes/update.test.ts > Update API Routes > POST /api/update/install > should retry with --force on EEXIST error
[update] Installing sudocode...
[update] EEXIST error, retrying with --force...
[update] Successfully installed sudocode

stdout | tests/unit/routes/update.test.ts > Update API Routes > POST /api/update/install > should return 500 on installation failure
[update] Installing sudocode...

stdout | tests/unit/routes/update.test.ts > Update API Routes > POST /api/update/restart > should respond with success before restarting
[update] Server restart requested

stdout | tests/unit/routes/update.test.ts
[update] Spawning new server process...
[update] Exiting current process...

 âœ“ |@sudocode-ai/local-server| tests/unit/execution/adapters/copilot-adapter.test.ts (19 tests) 1182ms
 âœ“ |@sudocode-ai/local-server| tests/unit/routes/update.test.ts (13 tests) 1559ms
 âœ“ |@sudocode-ai/mcp| tests/unit/specs.test.ts (15 tests) 29ms
 âœ“ |@sudocode-ai/mcp| tests/unit/relationships.test.ts (3 tests) 22ms
 âœ“ |@sudocode-ai/cli| tests/unit/filename-generator.test.ts (19 tests) 48ms
 âœ“ |@sudocode-ai/mcp| tests/unit/issues.test.ts (17 tests) 274ms
 âœ“ |@sudocode-ai/mcp| tests/unit/references.test.ts (8 tests) 12ms
 âœ“ |@sudocode-ai/mcp| tests/unit/feedback.test.ts (6 tests) 34ms
 â†“ |@sudocode-ai/local-server| tests/integration/websocket.test.ts (8 tests | 8 skipped)
 âœ“ |@sudocode-ai/cli| tests/unit/operations/references.test.ts (18 tests) 69ms
 âœ“ |@sudocode-ai/cli| tests/unit/integrations/config-validator.test.ts (12 tests) 41ms
 â†“ |@sudocode-ai/local-server| tests/integration/spec-broadcasts.test.ts (4 tests | 4 skipped)
 â†“ |@sudocode-ai/local-server| tests/e2e/copilot-execution.test.ts (18 tests | 18 skipped)
 â†“ |@sudocode-ai/local-server| tests/e2e/claude-execution.test.ts (15 tests | 15 skipped)
 â†“ |@sudocode-ai/local-server| tests/e2e/codex-full-stack.test.ts (8 tests | 8 skipped)
 â†“ |@sudocode-ai/local-server| tests/e2e/cursor-execution.test.ts (12 tests | 12 skipped)
 âœ“ |@sudocode-ai/local-server| tests/unit/services/external-refresh-service.test.ts (17 tests) 1297ms
 âœ“ |@sudocode-ai/local-ui| tests/hooks/useContextSearch.test.ts (17 tests) 5149ms
   âœ“ useContextSearch > Basic functionality > should return empty results initially when query is empty  441ms
   âœ“ useContextSearch > Basic functionality > should not search when enabled is false  508ms
   âœ“ useContextSearch > Search execution > should search all sources when query is provided  331ms
   âœ“ useContextSearch > Search execution > should merge results from all sources  329ms
   âœ“ useContextSearch > Search execution > should filter specs by query  338ms
   âœ“ useContextSearch > Search execution > should filter issues by query  337ms
   âœ“ useContextSearch > Search execution > should match by entity ID  348ms
   âœ“ useContextSearch > Result ranking > should assign high match scores to exact matches  375ms
   âœ“ useContextSearch > Result ranking > should limit results to 15 total  431ms
   âœ“ useContextSearch > Result formatting > should format file results correctly  338ms
   âœ“ useContextSearch > Result formatting > should format spec results with [[id]] syntax  337ms
   âœ“ useContextSearch > Result formatting > should format issue results with [[id]] syntax  321ms
   âœ“ useContextSearch > Recent mentions tracking > should boost recently used results  328ms
   âœ“ useContextSearch > Error handling > should continue with other results if one search fails  356ms
stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should not render when open is false
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should render when open is true
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should display feedback textarea with placeholder
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should allow typing feedback
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should allow typing feedback
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

 âœ“ |@sudocode-ai/local-ui| tests/components/ui/ContextSearchTextarea.test.tsx (15 tests) 5466ms
   âœ“ ContextSearchTextarea > Basic rendering > should be disabled when disabled prop is true  402ms
   âœ“ ContextSearchTextarea > @ detection and search > should trigger search when typing @query  399ms
   âœ“ ContextSearchTextarea > @ detection and search > should show dropdown with results  650ms
   âœ“ ContextSearchTextarea > @ detection and search > should hide dropdown when space after @  479ms
   âœ“ ContextSearchTextarea > Keyboard navigation > should navigate results with ArrowDown  365ms
   âœ“ ContextSearchTextarea > Keyboard navigation > should close dropdown with Escape  346ms
   âœ“ ContextSearchTextarea > Result selection > should insert file path when clicking file result  430ms
   âœ“ ContextSearchTextarea > Result selection > should insert [[spec-id]] when clicking spec result  427ms
   âœ“ ContextSearchTextarea > Result selection > should insert [[issue-id]] when clicking issue result  550ms
   âœ“ ContextSearchTextarea > Result selection > should insert result with Enter key  440ms
   âœ“ ContextSearchTextarea > Edge cases > should not trigger dropdown for email addresses  419ms
   âœ“ ContextSearchTextarea > Edge cases > should trigger dropdown after whitespace before @  359ms
stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should disable submit button when feedback is empty
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should enable submit button when feedback is provided
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should enable submit button when feedback is provided
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should call onSubmit with feedback when submit button clicked
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should call onSubmit with feedback when submit button clicked
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should trim whitespace from feedback before submitting
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should trim whitespace from feedback before submitting
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should keep submit button disabled for whitespace-only feedback
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should keep submit button disabled for whitespace-only feedback
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should show loading state while submitting
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should show loading state while submitting
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should display error message when submission fails
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should display error message when submission fails
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/TiptapEditor.test.tsx > TiptapEditor > should handle entity mentions in content
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/TiptapEditor.test.tsx > TiptapEditor > should handle entity mentions in content
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should display generic error when submission fails without error message
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should display generic error when submission fails without error message
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should call onCancel when cancel button clicked
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should clear feedback and error when canceled
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should clear feedback and error when canceled
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should clear feedback after successful submission
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should clear feedback after successful submission
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should not allow cancel while submitting
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should not allow cancel while submitting
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

 â¯ |@sudocode-ai/local-ui| tests/components/TiptapEditor.test.tsx (14 tests | 2 failed) 12395ms
   âœ“ TiptapEditor > should render editor with content  1480ms
   âœ“ TiptapEditor > should not call onChange when initially loading content  436ms
   âœ“ TiptapEditor > should not call onChange when content prop changes externally  624ms
   âœ“ TiptapEditor > should call onChange when editor triggers onUpdate 259ms
   âœ“ TiptapEditor > should not call onChange with duplicate content  1664ms
   âœ“ TiptapEditor > should handle empty content without calling onChange  304ms
   âœ“ TiptapEditor > should handle entity mentions in content  648ms
   âœ“ TiptapEditor > should handle rapid content changes without race conditions  381ms
   âœ“ TiptapEditor > Line Numbers > should display line numbers matching markdown source lines  913ms
   âœ“ TiptapEditor > Line Numbers > should handle ordered lists with correct line numbers  742ms
   âœ“ TiptapEditor > Line Numbers > should handle multiple consecutive paragraphs  607ms
   âœ“ TiptapEditor > Line Numbers > should handle mixed content with accurate line mapping  2245ms
   Ã— TiptapEditor > Line Numbers > should handle leading empty lines and show correct line numbers 1382ms
     â†’ expected null to be '3' // Object.is equality
   Ã— TiptapEditor > Line Numbers > should handle document starting with paragraph after empty lines 694ms
     â†’ expected null to be '4' // Object.is equality
stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should clear error when typing new feedback
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should clear error when typing new feedback
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should submit on Enter key press
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should submit on Enter key press
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should create newline on Shift+Enter key press
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should create newline on Shift+Enter key press
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should not submit on Enter when feedback is empty
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should not submit on Enter when feedback is empty
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should not submit on Enter when feedback is whitespace only
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should not submit on Enter when feedback is whitespace only
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should not submit on Enter while already submitting
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/FollowUpDialog.test.tsx > FollowUpDialog > should not submit on Enter while already submitting
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

 âœ“ |@sudocode-ai/local-ui| tests/components/executions/FollowUpDialog.test.tsx (22 tests) 29106ms
   âœ“ FollowUpDialog > should not render when open is false  470ms
   âœ“ FollowUpDialog > should render when open is true  688ms
   âœ“ FollowUpDialog > should allow typing feedback  3822ms
   âœ“ FollowUpDialog > should enable submit button when feedback is provided  1205ms
   âœ“ FollowUpDialog > should call onSubmit with feedback when submit button clicked  1880ms
   âœ“ FollowUpDialog > should trim whitespace from feedback before submitting  1800ms
   âœ“ FollowUpDialog > should show loading state while submitting  916ms
   âœ“ FollowUpDialog > should display generic error when submission fails without error message  987ms
   âœ“ FollowUpDialog > should clear feedback and error when canceled  950ms
   âœ“ FollowUpDialog > should clear feedback after successful submission  3039ms
   âœ“ FollowUpDialog > should not allow cancel while submitting  1516ms
   âœ“ FollowUpDialog > should clear error when typing new feedback  2213ms
   âœ“ FollowUpDialog > should submit on Enter key press  1907ms
   âœ“ FollowUpDialog > should create newline on Shift+Enter key press  2573ms
   âœ“ FollowUpDialog > should not submit on Enter when feedback is empty  2071ms
   âœ“ FollowUpDialog > should not submit on Enter when feedback is whitespace only  439ms
   âœ“ FollowUpDialog > should not submit on Enter while already submitting  1798ms
stdout | tests/components/issues/IssueEditor.test.tsx > IssueEditor > should render empty form when creating new issue
[WebSocket] Connecting to: ws://localhost:3000/ws

 â¯ |@sudocode-ai/local-ui| tests/components/relationships/RelationshipForm.test.tsx (24 tests | 2 failed) 36552ms
   âœ“ RelationshipForm > rendering > should render form with all fields  1346ms
   âœ“ RelationshipForm > rendering > should render as a card by default 178ms
   âœ“ RelationshipForm > rendering > should render inline when inline prop is true 67ms
   âœ“ RelationshipForm > rendering > should show cancel button when onCancel is provided  717ms
   âœ“ RelationshipForm > rendering > should not show cancel button when onCancel is not provided  526ms
   âœ“ RelationshipForm > entity combobox > should show placeholder for issue by default 163ms
   âœ“ RelationshipForm > entity combobox > should open dropdown and show issues when clicked  2274ms
   âœ“ RelationshipForm > entity combobox > should filter issues based on search input  1759ms
   âœ“ RelationshipForm > entity combobox > should select an entity when clicked  1135ms
   âœ“ RelationshipForm > entity type selection > should change to specs when spec type is selected  1130ms
   âœ“ RelationshipForm > entity type selection > should show specs in dropdown when spec type is selected  2473ms
   âœ“ RelationshipForm > entity type selection > should clear selection when entity type is changed  1640ms
   âœ“ RelationshipForm > relationship type selection > should default to "related" type 188ms
   âœ“ RelationshipForm > relationship type selection > should allow changing relationship type  1635ms
   âœ“ RelationshipForm > form submission > should call onSubmit with correct parameters when form is submitted  3037ms
   âœ“ RelationshipForm > form submission > should reset form after successful submission  1105ms
   âœ“ RelationshipForm > form submission > should disable submit button when target ID is empty  1082ms
   âœ“ RelationshipForm > form submission > should enable submit button when target ID is provided  2071ms
   âœ“ RelationshipForm > form submission > should disable inputs during submission  1152ms
   âœ“ RelationshipForm > cancel functionality > should call onCancel when cancel button is clicked  826ms
   âœ“ RelationshipForm > cancel functionality > should disable cancel button during submission  3966ms
   Ã— RelationshipForm > integration tests > should submit with spec type and implements relationship 5146ms
     â†’ Test timed out in 5000ms.
If this is a long-running test, pass a timeout value as the last argument or configure it globally with "testTimeout".
   Ã— RelationshipForm > integration tests > should handle multiple form submissions 2229ms
     â†’ expected "spy" to be called with arguments: [ 'i-002', 'issue', 'related' ][90m

Number of calls: [1m0[22m
[39m

Ignored nodes: comments, script, style
[36m<html>[39m
  [36m<head />[39m
  [36m<body[39m
    [33mstyle[39m=[32m""[39m
  [36m>[39m
    [36m<div>[39m
      [36m<div[39m
        [33mclass[39m=[32m"bg-card text-card-foreground p-4"[39m
      [36m>[39m
        [36m<form[39m
          [33mclass[39m=[32m"space-y-4"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"space-y-2"[39m
          [36m>[39m
            [36m<label[39m
              [33mclass[39m=[32m"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"[39m
              [33mfor[39m=[32m"target-id"[39m
            [36m>[39m
              [0mTarget Entity[0m
            [36m</label>[39m
            [36m<div[39m
              [33mclass[39m=[32m"flex gap-2"[39m
            [36m>[39m
              [36m<button[39m
                [33maria-autocomplete[39m=[32m"none"[39m
                [33maria-controls[39m=[32m"radix-:r8e:"[39m
                [33maria-expanded[39m=[32m"false"[39m
                [33mclass[39m=[32m"flex h-10 items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1 w-[120px]"[39m
                [33mdata-state[39m=[32m"closed"[39m
                [33mdir[39m=[32m"ltr"[39m
                [33mrole[39m=[32m"combobox"[39m
                [33mtype[39m=[32m"button"[39m
              [36m>[39m
                [36m<span[39m
                  [33mstyle[39m=[32m"pointer-events: none;"[39m
                [36m>[39m
                  [0mIssue[0m
                [36m</span>[39m
                [36m<svg[39m
                  [33maria-hidden[39m=[32m"true"[39m
                  [33mclass[39m=[32m"lucide lucide-chevron-down h-4 w-4 opacity-50"[39m
                  [33mfill[39m=[32m"none"[39m
                  [33mheight[39m=[32m"24"[39m
                  [33mstroke[39m=[32m"currentColor"[39m
                  [33mstroke-linecap[39m=[32m"round"[39m
                  [33mstroke-linejoin[39m=[32m"round"[39m
                  [33mstroke-width[39m=[32m"2"[39m
                  [33mviewBox[39m=[32m"0 0 24 24"[39m
                  [33mwidth[39m=[32m"24"[39m
                  [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                [36m>[39m
                  [36m<path[39m
                    [33md[39m=[32m"m6 9 6 6 6-6"[39m
                  [36m/>[39m
                [36m</svg>[39m
              [36m</button>[39m
              [36m<select[39m
                [33maria-hidden[39m=[32m"true"[39m
                [33mstyle[39m=[32m"position: absolute; border: 0px; width: 1px; height: 1px; padding: 0px; margin: -1px; overflow: hidden; clip: rect(0px, 0px, 0px, 0px); white-space: nowrap; word-wrap: normal;"[39m
                [33mtabindex[39m=[32m"-1"[39m
              [36m>[39m
                [36m<option[39m
                  [33mselected[39m=[32m""[39m
                  [33mvalue[39m=[32m"issue"[39m
                [36m>[39m
                  [0mIssue[0m
                [36m</option>[39m
                [36m<option[39m
                  [33mvalue[39m=[32m"spec"[39m
                [36m>[39m
                  [0mSpec[0m
                [36m</option>[39m
              [36m</select>[39m
              [36m<button[39m
                [33maria-controls[39m=[32m"radix-:r8f:"[39m
                [33maria-expanded[39m=[32m"false"[39m
                [33maria-haspopup[39m=[32m"dialog"[39m
                [33mclass[39m=[32m"inline-flex items-center whitespace-nowrap text-sm ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring/40 disabled:pointer-events-none disabled:opacity-50 disabled:cursor-not-allowed rounded-md border border-input bg-background text-foreground hover:bg-accent hover:text-accent-foreground dark:border-input/50 dark:hover:bg-accent/50 h-10 px-4 py-2 flex-1 justify-between font-normal"[39m
                [33mdata-state[39m=[32m"closed"[39m
                [33mrole[39m=[32m"combobox"[39m
                [33mtype[39m=[32m"button"[39m
              [36m>[39m
                [36m<span[39m
                  [33mclass[39m=[32m"text-muted-foreground"[39m
                [36m>[39m
                  [0mSearch issues...[0m
                [36m</span>[39m
                [36m<svg[39m
                  [33mclass[39m=[32m"lucide lucide-chevrons-up-down ml-2 h-4 w-4 shrink-0 opacity-50"[39m
                  [33mfill[39m=[32m"none"[39m
                  [33mheight[39m=[32m"24"[39m
                  [33mstroke[39m=[32m"currentColor"[39m
                  [33mstroke-linecap[39m=[32m"round"[39m
                  [33mstroke-linejoin[39m=[32m"round"[39m
                  [33mstroke-width[39m=[32m"2"[39m
                  [33mviewBox[39m=[32m"0 0 24 24"[39m
                  [33mwidth[39m=[32m"24"[39m
                  [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                [36m>[39m
                  [36m<path[39m
                    [33md[39m=[32m"m7 15 5 5 5-5"[39m
                  [36m/>[39m
                  [36m<path[39m
                    [33md[39m=[32m"m7 9 5-5 5 5"[39m
                  [36m/>[39m
                [36m</svg>[39m
              [36m</button>[39m
            [36m</div>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"space-y-2"[39m
          [36m>[39m
            [36m<label[39m
              [33mclass[39m=[32m"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"[39m
              [33mfor[39m=[32m"relationship-type"[39m
            [36m>[39m
              [0mRelationship Type[0m
            [36m</label>[39m
            [36m<button[39m
              [33maria-autocomplete[39m=[32m"none"[39m
              [33maria-controls[39m=[32m"radix-:r8g:"[39m
              [33maria-expanded[39m=[32m"false"[39m
              [33mclass[39m=[32m"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1"[39m
              [33mdata-state[39m=[32m"closed"[39m
              [33mdir[39m=[32m"ltr"[39m
              [33mid[39m=[32m"relationship-type"[39m
              [33mrole[39m=[32m"combobox"[39m
              [33mtype[39m=[32m"button"[39m
            [36m>[39m
              [36m<span[39m
                [33mstyle[39m=[32m"pointer-events: none;"[39m
              [36m>[39m
                [0mRelated to[0m
              [36m</span>[39m
              [36m<svg[39m
                [33maria-hidden[39m=[32m"true"[39m
                [33mclass[39m=[32m"lucide lucide-chevron-down h-4 w-4 opacity-50"[39m
                [33mfill[39m=[32m"none"[39m
                [33mheight[39m=[32m"24"[39m
                [33mstroke[39m=[32m"currentColor"[39m
                [33mstroke-linecap[39m=[32m"round"[39m
                [33mstroke-linejoin[39m=[32m"round"[39m
                [33mstroke-width[39m=[32m"2"[39m
                [33mviewBox[39m=[32m"0 0 24 24"[39m
                [33mwidth[39m=[32m"24"[39m
                [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
              [36m>[39m
                [36m<path[39m
                  [33md[39m=[32m"m6 9 6 6 6-6"[39m
                [36m/>[39m
              [36m</svg>[39m
            [36m</button>[39m
            [36m<select[39m
              [33maria-hidden[39m=[32m"true"[39m
              [33mstyle[39m=[32m"position: absolute; border: 0px; width: 1px; height: 1px; padding: 0px; margin: -1px; overflow: hidden; clip: rect(0px, 0px, 0px, 0px); white-space: nowrap; word-wrap: normal;"[39m
              [33mtabindex[39m=[32m"-1"[39m
            [36m>[39m
              [36m<option[39m
                [33mvalue[39m=[32m"blocks"[39m
              [36m>[39m
                [0mBlocks[0m
              [36m</option>[39m
              [36m<option[39m
                [33mselected[39m=[32m""[39m
                [33mvalue[39m=[32m"related"[39m
              [36m>[39m
                [0mRelated to[0m
              [36m</option>[39m
              [36m<option[39m
                [33mvalue[39m=[32m"discovered-from"[39m
              [36m>[39m
                [0mDiscovered from[0m
              [36m</option>[39m
              [36m<option[39m
                [33mvalue[39m=[32m"implements"[39m
              [36m>[39m
                [0mImplements[0m
              [36m</option>[39m
              [36m<option[39m
                [33mvalue[39m=[32m"references"[39m
              [36m>[39m
                [0mReferences[0m
              [36m</option>[39m
              [36m<option[39m
                [33mvalue[39m=[32m"depends-on"[39m
              [36m>[39m
                [0mDepends on[0m
              [36m</option>[39m
            [36m</select>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"flex justify-end gap-2"[39m
          [36m>[39m
            [36m<button[39m
              [33mclass[39m=[32m"inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring/40 disabled:pointer-events-none disabled:opacity-50 disabled:cursor-not-allowed rounded-md bg-primary text-primary-foreground hover:bg-primary/90 border border-primary dark:border-primary/50 dark:text-white h-10 px-4 py-2"[39m
              [33mdisabled[39m=[32m""[39m
              [33mtype[39m=[32m"submit"[39m
            [36m>[39m
              [0mCreate[0m
            [36m</button>[39m
          [36m</div>[39m
        [36m</form>[39m
      [36m</div>[39m
    [36m</div>[39m
  [36m</body>[39m
[36m</html>[39m
   âœ“ RelationshipForm > integration tests > should filter out the current entity from the list  688ms
stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should render issue details with editable fields
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssueEditor.test.tsx > IssueEditor > should render pre-filled form when editing existing issue
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssueEditor.test.tsx > IssueEditor > should show validation error when title is empty
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssueEditor.test.tsx > IssueEditor > should show validation error when title is empty
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should render close button when onClose is provided
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssueEditor.test.tsx > IssueEditor > should show validation error when title exceeds 200 characters
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssueEditor.test.tsx > IssueEditor > should show validation error when title exceeds 200 characters
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should call onClose when close button is clicked
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel-autoscroll.test.tsx > IssuePanel - Auto-scroll > Auto-scroll enablement > should enable auto-scroll when execution starts running
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should call onClose when close button is clicked
[WebSocket] Connected
[WebSocket] Resubscribed to: test-project-123:issue:ISSUE-001
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should call onClose when close button is clicked
[WebSocket] Unsubscribed from: test-project-123:execution:*
[WebSocket] Subscribed to: test-project-123:execution:*

stdout | tests/components/issues/IssuePanel-autoscroll.test.tsx > IssuePanel - Auto-scroll > Auto-scroll enablement > should show scroll-to-bottom button when container is scrollable
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should render save status when onUpdate is provided
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssueEditor.test.tsx > IssueEditor > should call onSave with form data when valid
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssueEditor.test.tsx > IssueEditor > should call onSave with form data when valid
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should render Delete button when onDelete is provided
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/CreateIssueDialog.test.tsx > CreateIssueDialog > should not render when isOpen is false
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should show unsaved changes status when fields are modified
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel-autoscroll.test.tsx > IssuePanel - Auto-scroll > Auto-scroll enablement > should show button based on scrollability, not execution status
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should show unsaved changes status when fields are modified
[WebSocket] Connected
[WebSocket] Resubscribed to: test-project-123:issue:ISSUE-001
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/issues/IssueEditor.test.tsx > IssueEditor > should call onCancel when cancel button is clicked
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should show unsaved changes status when fields are modified
[WebSocket] Unsubscribed from: test-project-123:execution:*
[WebSocket] Subscribed to: test-project-123:execution:*

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should show unsaved changes status when fields are modified
[WebSocket] Message received: subscribed projectId: [90mundefined[39m
[WebSocket] Message received: unsubscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/components/issues/IssueEditor.test.tsx > IssueEditor > should disable form when isLoading is true
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel-autoscroll.test.tsx > IssuePanel - Auto-scroll > Manual scroll detection > should disable auto-scroll when user scrolls up
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/CreateIssueDialog.test.tsx > CreateIssueDialog > should render when isOpen is true
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssueEditor.test.tsx > IssueEditor > should update form when issue prop changes
[WebSocket] Connecting to: ws://localhost:3000/ws

 â¯ |@sudocode-ai/local-ui| tests/components/issues/IssueEditor.test.tsx (10 tests | 2 failed | 2 skipped) 17991ms
   âœ“ IssueEditor > should render empty form when creating new issue  2734ms
   âœ“ IssueEditor > should render pre-filled form when editing existing issue  961ms
   âœ“ IssueEditor > should show validation error when title is empty  1546ms
   Ã— IssueEditor > should show validation error when title exceeds 200 characters 5346ms
     â†’ Test timed out in 5000ms.
If this is a long-running test, pass a timeout value as the last argument or configure it globally with "testTimeout".
   Ã— IssueEditor > should call onSave with form data when valid 5256ms
     â†’ Test timed out in 5000ms.
If this is a long-running test, pass a timeout value as the last argument or configure it globally with "testTimeout".
   âœ“ IssueEditor > should call onCancel when cancel button is clicked  696ms
   âœ“ IssueEditor > should disable form when isLoading is true  448ms
   â†“ IssueEditor > should update status via selector (skipped due to jsdom/Radix UI portal limitations)
   â†“ IssueEditor > should update priority via selector (skipped due to jsdom/Radix UI portal limitations)
   âœ“ IssueEditor > should update form when issue prop changes  1002ms
stdout | tests/components/issues/IssuePanel-autoscroll.test.tsx > IssuePanel - Auto-scroll > Manual scroll detection > should disable auto-scroll when user scrolls up
[WebSocket] Connected
[WebSocket] Resubscribed to: test-project-123:issue:ISSUE-001
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Initial Rendering > should render the component
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/CreateIssueDialog.test.tsx > CreateIssueDialog > should call onCreate with form data when saved
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/CreateIssueDialog.test.tsx > CreateIssueDialog > should call onCreate with form data when saved
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Initial Rendering > should load repository info on mount
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel-autoscroll.test.tsx > IssuePanel - Auto-scroll > Manual scroll detection > should re-enable auto-scroll when user scrolls back to bottom
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should auto-save changes after debounce
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Initial Rendering > should load available agents on mount
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should auto-save changes after debounce
[WebSocket] Connected
[WebSocket] Resubscribed to: test-project-123:issue:ISSUE-001
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/issues/IssuePanel-autoscroll.test.tsx > IssuePanel - Auto-scroll > Scroll-to-bottom FAB button > should show FAB button when auto-scroll is disabled and execution is running
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should auto-save changes after debounce
[WebSocket] Unsubscribed from: test-project-123:execution:*
[WebSocket] Subscribed to: test-project-123:execution:*

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should auto-save changes after debounce
[WebSocket] Message received: subscribed projectId: [90mundefined[39m
[WebSocket] Message received: unsubscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Agent Selection > should display agent selector with default selection
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel-autoscroll.test.tsx > IssuePanel - Auto-scroll > Scroll-to-bottom FAB button > should show FAB button when auto-scroll is disabled and execution is running
[WebSocket] Connected
[WebSocket] Resubscribed to: test-project-123:issue:ISSUE-001
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/issues/CreateIssueDialog.test.tsx > CreateIssueDialog > should accept defaultStatus prop
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Agent Selection > should show only implemented agents in dropdown when opened
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel-autoscroll.test.tsx > IssuePanel - Auto-scroll > Scroll-to-bottom FAB button > should show FAB button when container is scrollable, regardless of execution status
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Agent Selection > should show only implemented agents in dropdown when opened
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Agent Selection > should show only implemented agents in dropdown when opened
[WebSocket] Unsubscribed from: test-project-123:execution:*
[WebSocket] Subscribed to: test-project-123:execution:*

stdout | tests/components/issues/CreateIssueDialog.test.tsx > CreateIssueDialog > should call onClose when cancel is clicked without changes
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Agent Selection > should show only implemented agents in dropdown when opened
[WebSocket] Message received: unsubscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/components/issues/IssuePanel-autoscroll.test.tsx > IssuePanel - Auto-scroll > Scroll-to-bottom FAB button > should scroll to bottom and re-enable auto-scroll when FAB is clicked
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should show delete confirmation dialog when Delete button is clicked
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel-autoscroll.test.tsx > IssuePanel - Auto-scroll > Scroll-to-bottom FAB button > should scroll to bottom and re-enable auto-scroll when FAB is clicked
[WebSocket] Connected
[WebSocket] Resubscribed to: test-project-123:issue:ISSUE-001
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/issues/IssuePanel-autoscroll.test.tsx > IssuePanel - Auto-scroll > Scroll-to-bottom FAB button > should scroll to bottom and re-enable auto-scroll when FAB is clicked
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/components/issues/IssuePanel-autoscroll.test.tsx > IssuePanel - Auto-scroll > MutationObserver content changes > should auto-scroll when content changes are detected during execution
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel-autoscroll.test.tsx > IssuePanel - Auto-scroll > MutationObserver content changes > should auto-scroll when content changes are detected during execution
[WebSocket] Connected
[WebSocket] Resubscribed to: test-project-123:issue:ISSUE-001
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/issues/IssuePanel-autoscroll.test.tsx > IssuePanel - Auto-scroll > MutationObserver content changes > should auto-scroll when content changes are detected during execution
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/components/issues/IssuePanel-autoscroll.test.tsx > IssuePanel - Auto-scroll > MutationObserver content changes > should not auto-scroll when content changes but auto-scroll is disabled
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel-autoscroll.test.tsx > IssuePanel - Auto-scroll > MutationObserver content changes > should not auto-scroll when content changes but auto-scroll is disabled
[WebSocket] Connected
[WebSocket] Resubscribed to: test-project-123:issue:ISSUE-001
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/issues/IssuePanel-autoscroll.test.tsx > IssuePanel - Auto-scroll > MutationObserver content changes > should not auto-scroll when content changes but auto-scroll is disabled
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/components/issues/IssuePanel-autoscroll.test.tsx > IssuePanel - Auto-scroll > MutationObserver content changes > should not auto-scroll when content changes but execution is not running
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/CreateIssueDialog.test.tsx > CreateIssueDialog > should disable form when isCreating is true
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/CreateIssueDialog.test.tsx > CreateIssueDialog > should render IssueEditor with correct props
[WebSocket] Connecting to: ws://localhost:3000/ws

 âœ“ |@sudocode-ai/local-ui| tests/components/issues/CreateIssueDialog.test.tsx (9 tests | 2 skipped) 11460ms
   âœ“ CreateIssueDialog > should not render when isOpen is false  536ms
   âœ“ CreateIssueDialog > should render when isOpen is true  2858ms
   âœ“ CreateIssueDialog > should call onCreate with form data when saved  3617ms
   âœ“ CreateIssueDialog > should accept defaultStatus prop  1345ms
   âœ“ CreateIssueDialog > should call onClose when cancel is clicked without changes  1435ms
   âœ“ CreateIssueDialog > should disable form when isCreating is true  833ms
   âœ“ CreateIssueDialog > should render IssueEditor with correct props  825ms
stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Agent Selection > should exclude unimplemented agents from dropdown
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Agent Selection > should exclude unimplemented agents from dropdown
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Agent Selection > should exclude unimplemented agents from dropdown
[WebSocket] Unsubscribed from: test-project-123:execution:*
[WebSocket] Subscribed to: test-project-123:execution:*

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Agent Selection > should exclude unimplemented agents from dropdown
[WebSocket] Message received: unsubscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Agent Selection > should call onSelectOpenChange when agent selector opens
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Agent Selection > should call onSelectOpenChange when agent selector opens
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Agent Selection > should call onSelectOpenChange when agent selector opens
[WebSocket] Unsubscribed from: test-project-123:execution:*
[WebSocket] Subscribed to: test-project-123:execution:*

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Agent Selection > should call onSelectOpenChange when agent selector opens
[WebSocket] Message received: unsubscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Execution Mode Selection > should display execution mode selector
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Execution Mode Selection > should allow changing execution mode
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Execution Mode Selection > should allow changing execution mode
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Execution Mode Selection > should allow changing execution mode
[WebSocket] Unsubscribed from: test-project-123:execution:*
[WebSocket] Subscribed to: test-project-123:execution:*

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Execution Mode Selection > should allow changing execution mode
[WebSocket] Message received: unsubscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Branch Display > should show branch display when baseBranch is set
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should show delete confirmation dialog when Delete button is clicked
[WebSocket] Connected
[WebSocket] Resubscribed to: test-project-123:issue:ISSUE-001
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should show delete confirmation dialog when Delete button is clicked
[WebSocket] Unsubscribed from: test-project-123:execution:*
[WebSocket] Subscribed to: test-project-123:execution:*

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should call onDelete when delete is confirmed
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should call onDelete when delete is confirmed
[WebSocket] Connected
[WebSocket] Resubscribed to: test-project-123:issue:ISSUE-001
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should call onDelete when delete is confirmed
[WebSocket] Unsubscribed from: test-project-123:execution:*
[WebSocket] Subscribed to: test-project-123:execution:*

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should call onDelete when delete is confirmed
[WebSocket] Message received: subscribed projectId: [90mundefined[39m
[WebSocket] Message received: unsubscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/components/issues/IssuePanel-autoscroll.test.tsx > IssuePanel - Auto-scroll > MutationObserver content changes > should not auto-scroll when content changes but execution is not running
[WebSocket] Connected
[WebSocket] Resubscribed to: test-project-123:issue:ISSUE-001
[WebSocket] Message received: pong projectId: [90mundefined[39m

 â¯ |@sudocode-ai/local-ui| tests/components/issues/IssuePanel-autoscroll.test.tsx (11 tests | 1 failed) 24244ms
   Ã— IssuePanel - Auto-scroll > Auto-scroll enablement > should enable auto-scroll when execution starts running 5740ms
     â†’ Test timed out in 5000ms.
If this is a long-running test, pass a timeout value as the last argument or configure it globally with "testTimeout".
   âœ“ IssuePanel - Auto-scroll > Auto-scroll enablement > should show scroll-to-bottom button when container is scrollable  5001ms
   âœ“ IssuePanel - Auto-scroll > Auto-scroll enablement > should show button based on scrollability, not execution status  1890ms
   âœ“ IssuePanel - Auto-scroll > Manual scroll detection > should disable auto-scroll when user scrolls up  1885ms
   âœ“ IssuePanel - Auto-scroll > Manual scroll detection > should re-enable auto-scroll when user scrolls back to bottom  1700ms
   âœ“ IssuePanel - Auto-scroll > Scroll-to-bottom FAB button > should show FAB button when auto-scroll is disabled and execution is running  2201ms
   âœ“ IssuePanel - Auto-scroll > Scroll-to-bottom FAB button > should show FAB button when container is scrollable, regardless of execution status  786ms
   âœ“ IssuePanel - Auto-scroll > Scroll-to-bottom FAB button > should scroll to bottom and re-enable auto-scroll when FAB is clicked  2554ms
   âœ“ IssuePanel - Auto-scroll > MutationObserver content changes > should auto-scroll when content changes are detected during execution  747ms
   âœ“ IssuePanel - Auto-scroll > MutationObserver content changes > should not auto-scroll when content changes but auto-scroll is disabled  1042ms
   âœ“ IssuePanel - Auto-scroll > MutationObserver content changes > should not auto-scroll when content changes but execution is not running  551ms
stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Branch Display > should display current branch in worktree mode
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should not call onDelete when deletion is cancelled
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should not call onDelete when deletion is cancelled
[WebSocket] Connected
[WebSocket] Resubscribed to: test-project-123:issue:ISSUE-001
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Branch Display > should hide branch display in local mode
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should not call onDelete when deletion is cancelled
[WebSocket] Unsubscribed from: test-project-123:execution:*
[WebSocket] Subscribed to: test-project-123:execution:*

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Branch Display > should hide branch display in local mode
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Branch Display > should hide branch display in local mode
[WebSocket] Unsubscribed from: test-project-123:execution:*
[WebSocket] Subscribed to: test-project-123:execution:*

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Branch Display > should hide branch display in local mode
[WebSocket] Message received: unsubscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should not call onDelete when deletion is cancelled
[WebSocket] Message received: subscribed projectId: [90mundefined[39m
[WebSocket] Message received: unsubscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Branch Display > should show current branch from repository
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Prompt Input > should allow entering a prompt
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Prompt Input > should allow entering a prompt
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Prompt Input > should allow entering a prompt
[WebSocket] Unsubscribed from: test-project-123:execution:*
[WebSocket] Subscribed to: test-project-123:execution:*

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Prompt Input > should allow entering a prompt
[WebSocket] Message received: unsubscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Prompt Input > should disable prompt input while loading
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Prompt Input > should show running placeholder when execution is running
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should show Saving status and disable Delete button when isUpdating is true
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should disable Delete button when isDeleting is true
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/workflows/EscalationPanel.test.tsx > EscalationPanel > should render the escalation message
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/workflows/EscalationPanel.test.tsx > EscalationPanel > should render predefined options as radio buttons
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/workflows/EscalationPanel.test.tsx > EscalationPanel > should not render options section when no options provided
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/workflows/EscalationPanel.test.tsx > EscalationPanel > should render custom feedback textarea
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/workflows/EscalationPanel.test.tsx > EscalationPanel > should render context when provided
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/workflows/EscalationPanel.test.tsx > EscalationPanel > should call onRespond with approve action when Approve clicked
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/workflows/EscalationPanel.test.tsx > EscalationPanel > should call onRespond with reject action when Reject clicked
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/workflows/EscalationPanel.test.tsx > EscalationPanel > should call onRespond with reject action when Reject clicked
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/workflows/EscalationPanel.test.tsx > EscalationPanel > should call onRespond with custom action when custom message submitted
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/workflows/EscalationPanel.test.tsx > EscalationPanel > should call onRespond with custom action when custom message submitted
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Run Button > should be enabled when prompt is empty for first messages
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Run Button > should be disabled when prompt is empty for follow-ups
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Run Button > should be enabled when prompt is filled
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should display formatted timestamps
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should not show closed_at when issue is not closed
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Run Button > should be enabled when prompt is filled
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Run Button > should be enabled when prompt is filled
[WebSocket] Unsubscribed from: test-project-123:execution:*
[WebSocket] Subscribed to: test-project-123:execution:*

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Run Button > should be enabled when prompt is filled
[WebSocket] Message received: unsubscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/components/workflows/EscalationPanel.test.tsx > EscalationPanel > should include selected option in approve action
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should show closed_at when issue is closed
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/workflows/EscalationPanel.test.tsx > EscalationPanel > should include selected option in approve action
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Run Button > should be disabled when component is disabled
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/workflows/EscalationPanel.test.tsx > EscalationPanel > should clear option when typing custom message
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/workflows/EscalationPanel.test.tsx > EscalationPanel > should clear option when typing custom message
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should not show assignee section when assignee is undefined
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Run Button > should call onStart with config, prompt, and agentType when clicked
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Run Button > should call onStart with config, prompt, and agentType when clicked
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Run Button > should call onStart with config, prompt, and agentType when clicked
[WebSocket] Unsubscribed from: test-project-123:execution:*
[WebSocket] Subscribed to: test-project-123:execution:*

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should not show parent section when parent_id is undefined
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/workflows/EscalationPanel.test.tsx > EscalationPanel > should not show Send Response button when custom message is empty
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/workflows/EscalationPanel.test.tsx > EscalationPanel > should show Send Response button when custom message has content
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Run Button > should call onStart with config, prompt, and agentType when clicked
[WebSocket] Message received: unsubscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/components/workflows/EscalationPanel.test.tsx > EscalationPanel > should show Send Response button when custom message has content
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/workflows/EscalationPanel.test.tsx > EscalationPanel > should disable buttons when isResponding is true
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/workflows/EscalationPanel.test.tsx > EscalationPanel > should disable textarea when isResponding is true
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > Children Badges > should render child badges when issues prop contains children
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/workflows/EscalationPanel.test.tsx > EscalationPanel > should show loading indicator in buttons when isResponding is true
[WebSocket] Connecting to: ws://localhost:3000/ws

 â¯ |@sudocode-ai/local-ui| tests/pages/SpecDetailPage.test.tsx (16 tests | 2 failed) 38673ms
   âœ“ SpecDetailPage > should render spec with editable title and priority  4147ms
   âœ“ SpecDetailPage > should show save status indicator  1074ms
   Ã— SpecDetailPage > should update title and trigger auto-save 5440ms
     â†’ Test timed out in 5000ms.
If this is a long-running test, pass a timeout value as the last argument or configure it globally with "testTimeout".
   Ã— SpecDetailPage > should update priority and trigger auto-save 5307ms
     â†’ Test timed out in 5000ms.
If this is a long-running test, pass a timeout value as the last argument or configure it globally with "testTimeout".
   âœ“ SpecDetailPage > should show loading state 14ms
   âœ“ SpecDetailPage > should show error state when spec not found 18ms
   âœ“ SpecDetailPage > should show feedback panel toggle button  1418ms
   âœ“ SpecDetailPage > should display spec metadata  1495ms
   âœ“ SpecDetailPage > should display parent spec when spec has parent_id  1283ms
   âœ“ SpecDetailPage > should display child specs when spec has children  1914ms
   âœ“ SpecDetailPage > should display singular "Child:" label when spec has one child  1531ms
   âœ“ SpecDetailPage > should show updating status when saving  1138ms
   âœ“ SpecDetailPage > should not trigger auto-save when navigating to a different spec  4258ms
   âœ“ SpecDetailPage > should not call updateSpec with empty content when opening a spec  2895ms
   âœ“ SpecDetailPage > should clear auto-save timer when navigating between specs  3645ms
   âœ“ SpecDetailPage > should save pending changes on unmount using correct spec ID  3082ms
stdout | tests/components/workflows/EscalationPanel.test.tsx > EscalationPanel > should show loading indicator in buttons when isResponding is true
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

 âœ“ |@sudocode-ai/local-ui| tests/components/workflows/EscalationPanel.test.tsx (15 tests) 7602ms
   âœ“ EscalationPanel > should render the escalation message  949ms
   âœ“ EscalationPanel > should call onRespond with approve action when Approve clicked  534ms
   âœ“ EscalationPanel > should call onRespond with reject action when Reject clicked  311ms
   âœ“ EscalationPanel > should call onRespond with custom action when custom message submitted  1628ms
   âœ“ EscalationPanel > should include selected option in approve action  825ms
   âœ“ EscalationPanel > should clear option when typing custom message  1254ms
   âœ“ EscalationPanel > should show Send Response button when custom message has content  801ms
   âœ“ EscalationPanel > should show loading indicator in buttons when isResponding is true  639ms
stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Run Button > should pass selected agentType when different agent is selected
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Run Button > should pass selected agentType when different agent is selected
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Run Button > should pass selected agentType when different agent is selected
[WebSocket] Unsubscribed from: test-project-123:execution:*
[WebSocket] Subscribed to: test-project-123:execution:*

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > Children Badges > should render singular "Child:" label when there is only one child
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Run Button > should pass selected agentType when different agent is selected
[WebSocket] Message received: unsubscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > Children Badges > should not show children section when there are no child issues
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > Children Badges > should not show children section when issues prop is empty
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > Children Badges > should not show children section when issues prop is not provided
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/pages/IssuesPage.test.tsx > IssuesPage > Recent Executions Fetching > should fetch recent executions with since and includeRunning params
[SSE]. Connecting to SSE stream {
  executionId: [32m'exec-001'[39m,
  projectId: [32m'test-project-123'[39m,
  url: [32m'/api/executions/exec-001/stream?projectId=test-project-123'[39m,
  timestamp: [32m'2025-12-19T06:30:57.835Z'[39m
}

stdout | tests/pages/IssuesPage.test.tsx > IssuesPage > Recent Executions Fetching > should not call individual list() for each issue
[SSE]. Connecting to SSE stream {
  executionId: [32m'exec-001'[39m,
  projectId: [32m'test-project-123'[39m,
  url: [32m'/api/executions/exec-001/stream?projectId=test-project-123'[39m,
  timestamp: [32m'2025-12-19T06:30:58.036Z'[39m
}

stdout | tests/pages/IssuesPage.test.tsx > IssuesPage > Recent Executions Fetching > should map latest execution per issue correctly
[SSE]. Connecting to SSE stream {
  executionId: [32m'exec-001'[39m,
  projectId: [32m'test-project-123'[39m,
  url: [32m'/api/executions/exec-001/stream?projectId=test-project-123'[39m,
  timestamp: [32m'2025-12-19T06:30:58.448Z'[39m
}

 âœ“ |@sudocode-ai/local-ui| tests/pages/IssuesPage.test.tsx (20 tests) 20495ms
   âœ“ IssuesPage > should display issues when loaded  959ms
   âœ“ IssuesPage > should show issue count  589ms
   âœ“ IssuesPage > should render kanban board with status columns  545ms
   âœ“ IssuesPage > should show issue detail panel when issue is clicked  4984ms
   âœ“ IssuesPage > Blocked Status > should group issues by their backend-managed status  496ms
   âœ“ IssuesPage > URL Hash Navigation > should open issue panel when hash matches an issue ID  3421ms
   âœ“ IssuesPage > URL Hash Navigation > should not open panel when hash does not match any issue  623ms
   âœ“ IssuesPage > URL Hash Navigation > should not open panel when hash is empty  390ms
   âœ“ IssuesPage > URL Hash Navigation > should handle bare hash without clearing it  670ms
   âœ“ IssuesPage > URL Hash Navigation > should update hash when issue is clicked  2311ms
   âœ“ IssuesPage > URL Hash Navigation > should open correct issue when multiple issues exist  2892ms
   âœ“ IssuesPage > Recent Executions Fetching > should fetch recent executions with since and includeRunning params  371ms
   âœ“ IssuesPage > Recent Executions Fetching > should not call individual list() for each issue  406ms
   âœ“ IssuesPage > WebSocket Execution Updates > should register message handler for execution events  347ms
   âœ“ IssuesPage > WebSocket Execution Updates > should handle component lifecycle with WebSocket subscriptions  573ms
stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Run Button > should use default prompt "Implement issue [[issueId]]" when submitting empty prompt for first message
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Run Button > should use default prompt "Implement issue [[issueId]]" when submitting empty prompt for first message
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Run Button > should use default prompt "Implement issue [[issueId]]" when submitting empty prompt for first message
[WebSocket] Unsubscribed from: test-project-123:execution:*
[WebSocket] Subscribed to: test-project-123:execution:*

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Run Button > should use default prompt "Implement issue [[issueId]]" when submitting empty prompt for first message
[WebSocket] Message received: unsubscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Run Button > should not use default prompt for follow-ups with empty prompt
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Settings Dialog > should open settings dialog when settings button is clicked
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Settings Dialog > should open settings dialog when settings button is clicked
[WebSocket] Connected

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Settings Dialog > should open settings dialog when settings button is clicked
[WebSocket] Unsubscribed from: test-project-123:execution:*
[WebSocket] Subscribed to: test-project-123:execution:*

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Settings Dialog > should open settings dialog when settings button is clicked
[WebSocket] Message received: pong projectId: [90mundefined[39m
[WebSocket] Message received: unsubscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Loading States > should disable controls while loading repository info
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Loading States > should disable agent selector while loading agents
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Config Persistence > should use previous execution config when provided
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Config Persistence > should save config to localStorage when execution starts
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Config Persistence > should save config to localStorage when execution starts
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Config Persistence > should save config to localStorage when execution starts
[WebSocket] Unsubscribed from: test-project-123:execution:*
[WebSocket] Subscribed to: test-project-123:execution:*

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Config Persistence > should save config to localStorage when execution starts
[WebSocket] Message received: unsubscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Config Persistence > should load config from localStorage when no previous execution
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Config Persistence > should handle invalid config in localStorage gracefully
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Config Persistence > should handle corrupted JSON in localStorage gracefully
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Config Persistence > should not save invalid config to localStorage
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Config Persistence > should not save invalid config to localStorage
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Config Persistence > should not save invalid config to localStorage
[WebSocket] Unsubscribed from: test-project-123:execution:*
[WebSocket] Subscribed to: test-project-123:execution:*

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Config Persistence > should not save invalid config to localStorage
[WebSocket] Message received: unsubscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should render Archive button when issue is not archived
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should render Unarchive button when issue is archived
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should call onArchive when Archive button is clicked
[WebSocket] Connecting to: ws://localhost:3000/ws

 âœ“ |@sudocode-ai/local-ui| tests/components/executions/CopilotConfigForm.test.tsx (21 tests) 8742ms
   âœ“ CopilotConfigForm > rendering > should render all configuration options  1625ms
   âœ“ CopilotConfigForm > rendering > should render with default values  611ms
   âœ“ CopilotConfigForm > rendering > should display model description  1014ms
   âœ“ CopilotConfigForm > model selection > should call onChange when model is changed  1409ms
   âœ“ CopilotConfigForm > model selection > should display default model when not specified  421ms
   âœ“ CopilotConfigForm > model selection > should support all available models  649ms
   âœ“ CopilotConfigForm > allow all tools toggle > should call onChange when allowAllTools is toggled off  323ms
   âœ“ CopilotConfigForm > advanced settings > should update allowTool when input changes  388ms
   âœ“ CopilotConfigForm > config updates > should preserve other config values when updating allowAllTools  341ms
 âœ“ |@sudocode-ai/local-ui| tests/components/executions/CodexConfigForm.test.tsx (17 tests) 8627ms
   âœ“ CodexConfigForm > rendering > should render all basic configuration options  1823ms
   âœ“ CodexConfigForm > rendering > should show advanced settings when expanded  1689ms
   âœ“ CodexConfigForm > rendering > should render with default values  1061ms
   âœ“ CodexConfigForm > model selection > should call onChange when model is changed  603ms
   âœ“ CodexConfigForm > switch interactions > should toggle Full Auto mode  333ms
   âœ“ CodexConfigForm > advanced settings > should disable sandbox and approval when fullAuto is enabled  347ms
   âœ“ CodexConfigForm > advanced settings > should change sandbox policy  829ms
   âœ“ CodexConfigForm > advanced settings > should change approval policy  539ms
   âœ“ CodexConfigForm > validation > should disable sandbox and approval controls when fullAuto is true  338ms
stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Config Persistence > should prefer previous execution over localStorage
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Config Persistence > should validate previous execution config
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Config Persistence > should merge lastExecution.mode with localStorage settings when no full config provided
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Config Persistence > should merge lastExecution.mode with localStorage settings when no full config provided
[WebSocket] Connected

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Config Persistence > should merge lastExecution.mode with localStorage settings when no full config provided
[WebSocket] Unsubscribed from: test-project-123:execution:*
[WebSocket] Subscribed to: test-project-123:execution:*

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Config Persistence > should merge lastExecution.mode with localStorage settings when no full config provided
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Config Persistence > should merge lastExecution.mode with localStorage settings when no full config provided
[WebSocket] Message received: unsubscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Config Persistence > should use defaults when lastExecution.mode provided but no localStorage
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should call onUnarchive when Unarchive button is clicked
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Config Persistence > should use defaults when lastExecution.mode provided but no localStorage
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Config Persistence > should use defaults when lastExecution.mode provided but no localStorage
[WebSocket] Unsubscribed from: test-project-123:execution:*
[WebSocket] Subscribed to: test-project-123:execution:*

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Config Persistence > should use defaults when lastExecution.mode provided but no localStorage
[WebSocket] Message received: unsubscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should show follow-up placeholder text
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should not call repository API in follow-up mode
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should not call repository API in follow-up mode
[WebSocket] Connected

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should not call repository API in follow-up mode
[WebSocket] Unsubscribed from: test-project-123:execution:*
[WebSocket] Subscribed to: test-project-123:execution:*

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should disable agent selector in follow-up mode
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should disable mode selector in follow-up mode
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should show inherited branch in follow-up mode
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should disable settings button in follow-up mode
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should show "Submit" as run button label in follow-up mode
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should inherit agent type from parent execution
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should inherit agent type from parent execution
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should inherit agent type from parent execution
[WebSocket] Unsubscribed from: test-project-123:execution:*
[WebSocket] Subscribed to: test-project-123:execution:*

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should inherit agent type from parent execution
[WebSocket] Message received: unsubscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should disable Archive button when isUpdating is true
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should call onClose when ESC key is pressed
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/entities/EntityBadge.test.tsx > EntityBadge > issue badge > should render issue badge with correct variant
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/entities/EntityBadge.test.tsx > EntityBadge > issue badge > should render as a link to issue page
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/entities/EntityBadge.test.tsx > EntityBadge > issue badge > should display custom displayText when provided
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/entities/EntityBadge.test.tsx > EntityBadge > issue badge > should render GitBranch icon for issues
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/entities/EntityBadge.test.tsx > EntityBadge > spec badge > should render spec badge with correct variant
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should cancel execution on first ESC press, then close panel on second ESC press
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/entities/EntityBadge.test.tsx > EntityBadge > spec badge > should render as a link to spec page
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/entities/EntityBadge.test.tsx > EntityBadge > spec badge > should render FileText icon for specs
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/entities/EntityBadge.test.tsx > EntityBadge > linkToEntity prop > should render as link when linkToEntity is true (default)
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/entities/EntityBadge.test.tsx > EntityBadge > linkToEntity prop > should not render as link when linkToEntity is false
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/entities/EntityBadge.test.tsx > EntityBadge > relationshipType prop > should display relationship type annotation when provided
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/entities/EntityBadge.test.tsx > EntityBadge > relationshipType prop > should not display relationship annotation when not provided
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/entities/EntityBadge.test.tsx > EntityBadge > showHoverCard prop > should show hover card on hover when showHoverCard is true (default)
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should allow custom placeholder
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should toggle to new execution mode with Ctrl+K
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should toggle to new execution mode with Ctrl+K
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should toggle to new execution mode with Ctrl+K
[WebSocket] Unsubscribed from: test-project-123:execution:*
[WebSocket] Subscribed to: test-project-123:execution:*

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should toggle to new execution mode with Ctrl+K
[WebSocket] Message received: unsubscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/components/entities/EntityBadge.test.tsx > EntityBadge > showHoverCard prop > should show hover card on hover when showHoverCard is true (default)
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/entities/EntityBadge.test.tsx > EntityBadge > showHoverCard prop > should not show hover card when showHoverCard is false
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/entities/EntityBadge.test.tsx > EntityBadge > showHoverCard prop > should not show hover card when showHoverCard is false
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should not call onClose when ESC is pressed while delete dialog is open
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should toggle back to continue mode with Ctrl+K when forcing new
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should toggle back to continue mode with Ctrl+K when forcing new
[WebSocket] Connected

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should toggle back to continue mode with Ctrl+K when forcing new
[WebSocket] Unsubscribed from: test-project-123:execution:*
[WebSocket] Subscribed to: test-project-123:execution:*

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should toggle back to continue mode with Ctrl+K when forcing new
[WebSocket] Message received: pong projectId: [90mundefined[39m
[WebSocket] Message received: unsubscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/components/entities/EntityBadge.test.tsx > EntityBadge > hover card content - issue > should display issue details in hover card
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/entities/EntityBadge.test.tsx > EntityBadge > hover card content - issue > should display issue details in hover card
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should show correct placeholder when forcing new execution
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should not call onClose when ESC is pressed while delete dialog is open
[WebSocket] Connected
[WebSocket] Resubscribed to: test-project-123:issue:ISSUE-001
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should pass forceNew parameter to onStart when forcing new execution
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should pass forceNew parameter to onStart when forcing new execution
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should not call onClose when ESC is pressed while delete dialog is open
[WebSocket] Unsubscribed from: test-project-123:execution:*
[WebSocket] Subscribed to: test-project-123:execution:*

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should not call onClose when ESC is pressed while delete dialog is open
[WebSocket] Message received: subscribed projectId: [90mundefined[39m
[WebSocket] Message received: unsubscribed projectId: [90mundefined[39m

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > should not call onClose when ESC is pressed while delete dialog is open
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should pass forceNew parameter to onStart when forcing new execution
[WebSocket] Unsubscribed from: test-project-123:execution:*
[WebSocket] Subscribed to: test-project-123:execution:*

stdout | tests/components/entities/EntityBadge.test.tsx > EntityBadge > hover card content - issue > should show loading state while fetching
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/entities/EntityBadge.test.tsx > EntityBadge > hover card content - issue > should show loading state while fetching
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should pass forceNew parameter to onStart when forcing new execution
[WebSocket] Message received: unsubscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/components/entities/EntityBadge.test.tsx > EntityBadge > hover card content - spec > should display spec details in hover card
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/entities/EntityBadge.test.tsx > EntityBadge > hover card content - spec > should display spec details in hover card
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > Follow-up Mode and New Execution Button > should show "New conversation" button when there is a completed execution
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/entities/EntityBadge.test.tsx > EntityBadge > hover card content - spec > should show "No implementing issues" when none exist
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/entities/EntityBadge.test.tsx > EntityBadge > hover card content - spec > should show "No implementing issues" when none exist
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/entities/EntityBadge.test.tsx > EntityBadge > className prop > should apply custom className to badge
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/entities/EntityBadge.test.tsx > EntityBadge > showTitle prop > should not fetch title when showTitle is false (default)
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > Follow-up Mode and New Execution Button > should not show "New conversation" button when there are no executions
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/entities/EntityBadge.test.tsx > EntityBadge > showTitle prop > should fetch and display issue title when showTitle is true
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/entities/EntityBadge.test.tsx > EntityBadge > showTitle prop > should fetch and display spec title when showTitle is true
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/entities/EntityBadge.test.tsx > EntityBadge > showTitle prop > should truncate long titles with ellipsis
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should not toggle mode with Ctrl+K when not in follow-up mode
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/entities/EntityBadge.test.tsx > EntityBadge > showTitle prop > should show loading state while fetching title
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/entities/EntityBadge.test.tsx > EntityBadge > showTitle prop > should prefer displayText over showTitle
[WebSocket] Connecting to: ws://localhost:3000/ws

 âœ“ |@sudocode-ai/local-ui| tests/components/entities/EntityBadge.test.tsx (24 tests) 6915ms
   âœ“ EntityBadge > issue badge > should render issue badge with correct variant  426ms
   âœ“ EntityBadge > spec badge > should render as a link to spec page  344ms
   âœ“ EntityBadge > showHoverCard prop > should show hover card on hover when showHoverCard is true (default)  1045ms
   âœ“ EntityBadge > showHoverCard prop > should not show hover card when showHoverCard is false  645ms
   âœ“ EntityBadge > hover card content - issue > should display issue details in hover card  849ms
   âœ“ EntityBadge > hover card content - issue > should show loading state while fetching  554ms
   âœ“ EntityBadge > hover card content - spec > should display spec details in hover card  742ms
   âœ“ EntityBadge > hover card content - spec > should show "No implementing issues" when none exist  644ms
   âœ“ EntityBadge > showTitle prop > should truncate long titles with ellipsis  369ms
stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should not toggle mode with Ctrl+K when not in follow-up mode
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should not toggle mode with Ctrl+K when not in follow-up mode
[WebSocket] Unsubscribed from: test-project-123:execution:*
[WebSocket] Subscribed to: test-project-123:execution:*

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should not toggle mode with Ctrl+K when not in follow-up mode
[WebSocket] Message received: unsubscribed projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should not toggle mode with Ctrl+K when not in follow-up mode
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should not toggle mode with Ctrl+K when allowModeToggle is false
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should not toggle mode with Ctrl+K when allowModeToggle is false
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > Follow-up Mode and New Execution Button > should not show "New conversation" button when execution is still running
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should not toggle mode with Ctrl+K when allowModeToggle is false
[WebSocket] Unsubscribed from: test-project-123:execution:*
[WebSocket] Subscribed to: test-project-123:execution:*

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should not toggle mode with Ctrl+K when allowModeToggle is false
[WebSocket] Message received: unsubscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should not show ctrl+k hint in placeholder when allowModeToggle is false
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should not show ctrl+k hint when forcing new and allowModeToggle is false
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/AgentConfigPanel.test.tsx > AgentConfigPanel > Follow-up Mode > should show inherited values in disabled selectors
[WebSocket] Connecting to: ws://localhost:3000/ws

 âœ“ |@sudocode-ai/local-ui| tests/components/executions/AgentConfigPanel.test.tsx (55 tests) 43177ms
   âœ“ AgentConfigPanel > Initial Rendering > should render the component  2130ms
   âœ“ AgentConfigPanel > Initial Rendering > should load repository info on mount  659ms
   âœ“ AgentConfigPanel > Initial Rendering > should load available agents on mount  1578ms
   âœ“ AgentConfigPanel > Agent Selection > should display agent selector with default selection  1082ms
   âœ“ AgentConfigPanel > Agent Selection > should show only implemented agents in dropdown when opened  2132ms
   âœ“ AgentConfigPanel > Agent Selection > should exclude unimplemented agents from dropdown  1200ms
   âœ“ AgentConfigPanel > Agent Selection > should call onSelectOpenChange when agent selector opens  872ms
   âœ“ AgentConfigPanel > Execution Mode Selection > should allow changing execution mode  782ms
   âœ“ AgentConfigPanel > Branch Display > should show branch display when baseBranch is set  431ms
   âœ“ AgentConfigPanel > Branch Display > should display current branch in worktree mode  335ms
   âœ“ AgentConfigPanel > Branch Display > should hide branch display in local mode  1178ms
   âœ“ AgentConfigPanel > Branch Display > should show current branch from repository  694ms
   âœ“ AgentConfigPanel > Prompt Input > should allow entering a prompt  1982ms
   âœ“ AgentConfigPanel > Prompt Input > should disable prompt input while loading  358ms
   âœ“ AgentConfigPanel > Run Button > should be enabled when prompt is empty for first messages  497ms
   âœ“ AgentConfigPanel > Run Button > should be disabled when prompt is empty for follow-ups  313ms
   âœ“ AgentConfigPanel > Run Button > should be enabled when prompt is filled  2095ms
   âœ“ AgentConfigPanel > Run Button > should be disabled when component is disabled  595ms
   âœ“ AgentConfigPanel > Run Button > should call onStart with config, prompt, and agentType when clicked  2445ms
   âœ“ AgentConfigPanel > Run Button > should pass selected agentType when different agent is selected  4705ms
   âœ“ AgentConfigPanel > Settings Dialog > should open settings dialog when settings button is clicked  591ms
   âœ“ AgentConfigPanel > Loading States > should disable controls while loading repository info  392ms
   âœ“ AgentConfigPanel > Loading States > should disable agent selector while loading agents  567ms
   âœ“ AgentConfigPanel > Config Persistence > should save config to localStorage when execution starts  1175ms
   âœ“ AgentConfigPanel > Config Persistence > should not save invalid config to localStorage  336ms
   âœ“ AgentConfigPanel > Config Persistence > should merge lastExecution.mode with localStorage settings when no full config provided  380ms
   âœ“ AgentConfigPanel > Config Persistence > should use defaults when lastExecution.mode provided but no localStorage  960ms
   âœ“ AgentConfigPanel > Follow-up Mode > should not call repository API in follow-up mode  375ms
   âœ“ AgentConfigPanel > Follow-up Mode > should disable mode selector in follow-up mode  572ms
   âœ“ AgentConfigPanel > Follow-up Mode > should show inherited branch in follow-up mode  510ms
   âœ“ AgentConfigPanel > Follow-up Mode > should show "Submit" as run button label in follow-up mode  371ms
   âœ“ AgentConfigPanel > Follow-up Mode > should inherit agent type from parent execution  2842ms
   âœ“ AgentConfigPanel > Follow-up Mode > should allow custom placeholder  409ms
   âœ“ AgentConfigPanel > Follow-up Mode > should toggle to new execution mode with Ctrl+K  558ms
   âœ“ AgentConfigPanel > Follow-up Mode > should show correct placeholder when forcing new execution  498ms
   âœ“ AgentConfigPanel > Follow-up Mode > should pass forceNew parameter to onStart when forcing new execution  2813ms
   âœ“ AgentConfigPanel > Follow-up Mode > should not toggle mode with Ctrl+K when not in follow-up mode  703ms
   âœ“ AgentConfigPanel > Follow-up Mode > should not toggle mode with Ctrl+K when allowModeToggle is false  606ms
   âœ“ AgentConfigPanel > Follow-up Mode > should show inherited values in disabled selectors  578ms
stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > Follow-up Mode and New Execution Button > should hide "New conversation" button after clicking it
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > Follow-up Mode and New Execution Button > should hide "New conversation" button after clicking it
[WebSocket] Connected
[WebSocket] Resubscribed to: test-project-123:issue:ISSUE-001
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > Follow-up Mode and New Execution Button > should hide "New conversation" button after clicking it
[WebSocket] Unsubscribed from: test-project-123:execution:*
[WebSocket] Subscribed to: test-project-123:execution:*

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > Follow-up Mode and New Execution Button > should hide "New conversation" button after clicking it
[WebSocket] Message received: subscribed projectId: [90mundefined[39m
[WebSocket] Message received: unsubscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/components/issues/IssuePanel-modal-esc-propagation.test.tsx > IssuePanel - ESC Modal Propagation > Test 1: ESC in sub-modal should not close parent modal > should close only DeleteIssueDialog when ESC is pressed, keeping IssuePanel open
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > Follow-up Mode and New Execution Button > should update placeholder text when clicking "New conversation" button
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > Follow-up Mode and New Execution Button > should update placeholder text when clicking "New conversation" button
[WebSocket] Connected
[WebSocket] Resubscribed to: test-project-123:issue:ISSUE-001
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > Follow-up Mode and New Execution Button > should update placeholder text when clicking "New conversation" button
[WebSocket] Unsubscribed from: test-project-123:execution:*
[WebSocket] Subscribed to: test-project-123:execution:*

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > Follow-up Mode and New Execution Button > should update placeholder text when clicking "New conversation" button
[WebSocket] Message received: subscribed projectId: [90mundefined[39m
[WebSocket] Message received: unsubscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/components/issues/IssuePanel-modal-esc-propagation.test.tsx > IssuePanel - ESC Modal Propagation > Test 1: ESC in sub-modal should not close parent modal > should close only DeleteIssueDialog when ESC is pressed, keeping IssuePanel open
[WebSocket] Connected
[WebSocket] Resubscribed to: test-project-123:issue:i-test
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > Follow-up Mode and New Execution Button > should follow the latest execution in chain
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel-modal-esc-propagation.test.tsx > IssuePanel - ESC Modal Propagation > Test 1: ESC in sub-modal should not close parent modal > should close only DeleteIssueDialog when ESC is pressed, keeping IssuePanel open
[WebSocket] Unsubscribed from: test-project-123:execution:*
[WebSocket] Subscribed to: test-project-123:execution:*

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > Follow-up Mode and New Execution Button > should follow the latest execution in chain
[WebSocket] Connected
[WebSocket] Resubscribed to: test-project-123:issue:ISSUE-001
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > Follow-up Mode and New Execution Button > should follow the latest execution in chain
[WebSocket] Unsubscribed from: test-project-123:execution:*
[WebSocket] Subscribed to: test-project-123:execution:*

stdout | tests/components/issues/IssuePanel.test.tsx > IssuePanel > Follow-up Mode and New Execution Button > should disable input when execution is running
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel-modal-esc-propagation.test.tsx > IssuePanel - ESC Modal Propagation > Test 1: ESC in sub-modal should not close parent modal > should allow multiple sub-modal open/close cycles without affecting IssuePanel
[WebSocket] Connecting to: ws://localhost:3000/ws

 â¯ |@sudocode-ai/local-ui| tests/components/issues/IssuePanel.test.tsx (37 tests | 1 failed) 64633ms
   âœ“ IssuePanel > should render issue details with editable fields  4219ms
   âœ“ IssuePanel > should render close button when onClose is provided  1722ms
   âœ“ IssuePanel > should call onClose when close button is clicked  4777ms
   âœ“ IssuePanel > should render save status when onUpdate is provided  1966ms
   âœ“ IssuePanel > should render Delete button when onDelete is provided  2111ms
   âœ“ IssuePanel > should show unsaved changes status when fields are modified  4474ms
   Ã— IssuePanel > should auto-save changes after debounce 5472ms
     â†’ Test timed out in 5000ms.
If this is a long-running test, pass a timeout value as the last argument or configure it globally with "testTimeout".
   âœ“ IssuePanel > should show delete confirmation dialog when Delete button is clicked  1679ms
   âœ“ IssuePanel > should call onDelete when delete is confirmed  1686ms
   âœ“ IssuePanel > should not call onDelete when deletion is cancelled  2478ms
   âœ“ IssuePanel > should show Saving status and disable Delete button when isUpdating is true  1762ms
   âœ“ IssuePanel > should disable Delete button when isDeleting is true  841ms
   âœ“ IssuePanel > should display formatted timestamps  611ms
   âœ“ IssuePanel > should not show closed_at when issue is not closed  1006ms
   âœ“ IssuePanel > should show closed_at when issue is closed  1203ms
   âœ“ IssuePanel > should not show assignee section when assignee is undefined  822ms
   âœ“ IssuePanel > should not show parent section when parent_id is undefined  1033ms
   âœ“ IssuePanel > Children Badges > should render child badges when issues prop contains children  1058ms
   âœ“ IssuePanel > Children Badges > should render singular "Child:" label when there is only one child  1117ms
   âœ“ IssuePanel > Children Badges > should not show children section when there are no child issues  2690ms
   âœ“ IssuePanel > Children Badges > should not show children section when issues prop is empty  887ms
   âœ“ IssuePanel > Children Badges > should not show children section when issues prop is not provided  426ms
   âœ“ IssuePanel > should render Archive button when issue is not archived  880ms
   âœ“ IssuePanel > should render Unarchive button when issue is archived  1147ms
   âœ“ IssuePanel > should call onArchive when Archive button is clicked  2042ms
   âœ“ IssuePanel > should call onUnarchive when Unarchive button is clicked  970ms
   âœ“ IssuePanel > should disable Archive button when isUpdating is true  1342ms
   âœ“ IssuePanel > should call onClose when ESC key is pressed  2206ms
   âœ“ IssuePanel > should cancel execution on first ESC press, then close panel on second ESC press  1283ms
   âœ“ IssuePanel > should not call onClose when ESC is pressed while delete dialog is open  2633ms
   âœ“ IssuePanel > Follow-up Mode and New Execution Button > should show "New conversation" button when there is a completed execution  1484ms
   âœ“ IssuePanel > Follow-up Mode and New Execution Button > should not show "New conversation" button when there are no executions  663ms
   âœ“ IssuePanel > Follow-up Mode and New Execution Button > should not show "New conversation" button when execution is still running  1359ms
   âœ“ IssuePanel > Follow-up Mode and New Execution Button > should hide "New conversation" button after clicking it  1215ms
   âœ“ IssuePanel > Follow-up Mode and New Execution Button > should update placeholder text when clicking "New conversation" button  1342ms
   âœ“ IssuePanel > Follow-up Mode and New Execution Button > should follow the latest execution in chain  1345ms
   âœ“ IssuePanel > Follow-up Mode and New Execution Button > should disable input when execution is running  670ms
stdout | tests/components/issues/IssuePanel-modal-esc-propagation.test.tsx > IssuePanel - ESC Modal Propagation > Test 1: ESC in sub-modal should not close parent modal > should allow multiple sub-modal open/close cycles without affecting IssuePanel
[WebSocket] Connected
[WebSocket] Resubscribed to: test-project-123:issue:i-test
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/issues/IssuePanel-modal-esc-propagation.test.tsx > IssuePanel - ESC Modal Propagation > Test 1: ESC in sub-modal should not close parent modal > should allow multiple sub-modal open/close cycles without affecting IssuePanel
[WebSocket] Unsubscribed from: test-project-123:execution:*
[WebSocket] Subscribed to: test-project-123:execution:*

stdout | tests/components/issues/IssuePanel-modal-esc-propagation.test.tsx > IssuePanel - ESC Modal Propagation > Test 1: ESC in sub-modal should not close parent modal > should allow multiple sub-modal open/close cycles without affecting IssuePanel
[WebSocket] Message received: subscribed projectId: [90mundefined[39m
[WebSocket] Message received: unsubscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/components/issues/IssuePanel-modal-esc-propagation.test.tsx > IssuePanel - ESC Modal Propagation > Test 2: ESC in sub-modal should not stop execution > should close only DeleteIssueDialog when ESC is pressed, without stopping the running execution
[WebSocket] Connecting to: ws://localhost:3000/ws

 âœ“ |@sudocode-ai/local-ui| tests/components/executions/BranchSelector.test.tsx (15 tests) 12022ms
   âœ“ BranchSelector > renders with the selected branch value  652ms
   âœ“ BranchSelector > renders placeholder when no value is selected  347ms
   âœ“ BranchSelector > opens dropdown and shows all branches  1480ms
   âœ“ BranchSelector > filters branches based on search term  1043ms
   âœ“ BranchSelector > calls onChange when selecting a branch  689ms
   âœ“ BranchSelector > shows "Create branch" option when search term is a new branch name  773ms
   âœ“ BranchSelector > shows current branch in create option  829ms
   âœ“ BranchSelector > does not show create option for existing branch names  631ms
   âœ“ BranchSelector > calls onChange with isNew=true when creating a new branch  866ms
   âœ“ BranchSelector > does not show create option when allowCreate is false  662ms
   âœ“ BranchSelector > validates branch name - rejects names starting with dash  619ms
   âœ“ BranchSelector > validates branch name - rejects names with spaces  1725ms
   âœ“ BranchSelector > shows "No branches or worktrees found" when filter returns empty and create is not allowed  1392ms
stdout | tests/components/issues/IssuePanel-modal-esc-propagation.test.tsx > IssuePanel - ESC Modal Propagation > Test 2: ESC in sub-modal should not stop execution > should close only DeleteIssueDialog when ESC is pressed, without stopping the running execution
[WebSocket] Connected
[WebSocket] Resubscribed to: test-project-123:issue:i-test
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/issues/IssuePanel-modal-esc-propagation.test.tsx > IssuePanel - ESC Modal Propagation > Test 2: ESC in sub-modal should not stop execution > should close only DeleteIssueDialog when ESC is pressed, without stopping the running execution
[WebSocket] Unsubscribed from: test-project-123:execution:*
[WebSocket] Subscribed to: test-project-123:execution:*

stdout | tests/components/issues/IssuePanel-modal-esc-propagation.test.tsx > IssuePanel - ESC Modal Propagation > Test 2: ESC in sub-modal should not stop execution > should close only DeleteIssueDialog when ESC is pressed, without stopping the running execution
[WebSocket] Message received: subscribed projectId: [90mundefined[39m
[WebSocket] Message received: unsubscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/components/issues/IssuePanel-modal-esc-propagation.test.tsx > IssuePanel - ESC Modal Propagation > Test 2: ESC in sub-modal should not stop execution > should handle ESC correctly when execution starts after DeleteIssueDialog is already open
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/IssuePanel-modal-esc-propagation.test.tsx > IssuePanel - ESC Modal Propagation > Test 2: ESC in sub-modal should not stop execution > should handle ESC correctly when execution starts after DeleteIssueDialog is already open
[WebSocket] Connected
[WebSocket] Resubscribed to: test-project-123:issue:i-test
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/issues/IssuePanel-modal-esc-propagation.test.tsx > IssuePanel - ESC Modal Propagation > Test 2: ESC in sub-modal should not stop execution > should handle ESC correctly when execution starts after DeleteIssueDialog is already open
[WebSocket] Unsubscribed from: test-project-123:execution:*
[WebSocket] Subscribed to: test-project-123:execution:*

stdout | tests/components/issues/IssuePanel-modal-esc-propagation.test.tsx > IssuePanel - ESC Modal Propagation > Test 2: ESC in sub-modal should not stop execution > should handle ESC correctly when execution starts after DeleteIssueDialog is already open
[WebSocket] Message received: subscribed projectId: [90mundefined[39m
[WebSocket] Message received: unsubscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

 â¯ |@sudocode-ai/local-ui| tests/components/issues/IssuePanel-modal-esc-propagation.test.tsx (4 tests | 2 failed) 13611ms
   Ã— IssuePanel - ESC Modal Propagation > Test 1: ESC in sub-modal should not close parent modal > should close only DeleteIssueDialog when ESC is pressed, keeping IssuePanel open 5190ms
     â†’ Test timed out in 5000ms.
If this is a long-running test, pass a timeout value as the last argument or configure it globally with "testTimeout".
   Ã— IssuePanel - ESC Modal Propagation > Test 1: ESC in sub-modal should not close parent modal > should allow multiple sub-modal open/close cycles without affecting IssuePanel 2585ms
     â†’ expected "spy" to not be called at all, but actually been called 2 times[90m

Received: 

[1m  1st spy call:

[22m    Array []

[1m  2nd spy call:

[22m    Array []
[39m[90m

Number of calls: [1m2[22m
[39m
   âœ“ IssuePanel - ESC Modal Propagation > Test 2: ESC in sub-modal should not stop execution > should close only DeleteIssueDialog when ESC is pressed, without stopping the running execution  3385ms
   âœ“ IssuePanel - ESC Modal Propagation > Test 2: ESC in sub-modal should not stop execution > should handle ESC correctly when execution starts after DeleteIssueDialog is already open  2356ms
 âœ“ |@sudocode-ai/local-ui| tests/components/issues/IssuePanel-executions-websocket.test.tsx (8 tests) 13257ms
   âœ“ IssuePanel - Execution WebSocket Handling > should subscribe to issue WebSocket updates on mount  2997ms
   âœ“ IssuePanel - Execution WebSocket Handling > should unsubscribe from issue updates on unmount  1872ms
   âœ“ IssuePanel - Execution WebSocket Handling > should register handler that responds to execution_created messages  1262ms
   âœ“ IssuePanel - Execution WebSocket Handling > should register handler that responds to execution_updated messages  1202ms
   âœ“ IssuePanel - Execution WebSocket Handling > should register handler that responds to execution_status_changed messages  1334ms
   âœ“ IssuePanel - Execution WebSocket Handling > should register handler that responds to execution_deleted messages  2021ms
   âœ“ IssuePanel - Execution WebSocket Handling > should handle non-execution messages without errors  1289ms
   âœ“ IssuePanel - Execution WebSocket Handling > should resubscribe when issue changes  1253ms
 âœ“ |@sudocode-ai/local-ui| tests/hooks/useExecutionLogs.test.ts (18 tests) 1828ms
stdout | tests/components/relationships/RelationshipList.test.tsx > RelationshipList > empty state > should show empty message when no relationships and showEmpty is true
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/relationships/RelationshipList.test.tsx > RelationshipList > empty state > should render nothing when no relationships and showEmpty is false
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/relationships/RelationshipList.test.tsx > RelationshipList > grouping > should group relationships into outgoing and incoming
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/relationships/RelationshipList.test.tsx > RelationshipList > grouping > should only show outgoing section when no incoming relationships
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/relationships/RelationshipList.test.tsx > RelationshipList > grouping > should only show incoming section when no outgoing relationships
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/relationships/RelationshipList.test.tsx > RelationshipList > relationship rendering > should render outgoing relationships with correct labels
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/relationships/RelationshipList.test.tsx > RelationshipList > relationship rendering > should render incoming relationships with inverse labels
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/relationships/RelationshipList.test.tsx > RelationshipList > relationship rendering > should display target entity IDs with titles
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/relationships/RelationshipList.test.tsx > RelationshipList > relationship rendering > should display entity type icons
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/relationships/RelationshipList.test.tsx > RelationshipList > navigation > should render entities as links
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/relationships/RelationshipList.test.tsx > RelationshipList > navigation > should render entities with proper badges
[WebSocket] Connecting to: ws://localhost:3000/ws

 âœ“ |@sudocode-ai/local-ui| tests/hooks/useSpecs.test.tsx (16 tests) 3130ms
   âœ“ useSpecs > should create a spec  671ms
   âœ“ useSpecs > should update a spec  355ms
   âœ“ useSpecs > should unarchive a spec  344ms
   âœ“ useSpec - Project Switching > should include projectId in query key  347ms
 âœ“ |@sudocode-ai/local-ui| tests/components/specs/AddFeedbackDialog.test.tsx (9 tests) 15617ms
   âœ“ AddFeedbackDialog > should render trigger button  1137ms
   âœ“ AddFeedbackDialog > should open dialog when button clicked  951ms
   âœ“ AddFeedbackDialog > should show line number in dialog description when provided  714ms
   âœ“ AddFeedbackDialog > should render feedback form inside dialog  873ms
   âœ“ AddFeedbackDialog > should close dialog when cancel clicked  569ms
   âœ“ AddFeedbackDialog > should call onSubmit and close dialog when form submitted  3019ms
   âœ“ AddFeedbackDialog > should include anchor when lineNumber provided  3621ms
   âœ“ AddFeedbackDialog > should include text snippet in anchor when provided  4540ms
stdout | tests/components/relationships/RelationshipList.test.tsx > RelationshipList > deletion > should show delete buttons when onDelete is provided
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/relationships/RelationshipList.test.tsx > RelationshipList > deletion > should not show delete buttons when onDelete is not provided
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/relationships/RelationshipList.test.tsx > RelationshipList > deletion > should call onDelete with relationship when delete button is clicked
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/relationships/RelationshipList.test.tsx > RelationshipList > edge cases > should handle relationships with all relationship types
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/relationships/RelationshipList.test.tsx > RelationshipList > edge cases > should handle bidirectional relationships correctly
[WebSocket] Connecting to: ws://localhost:3000/ws

 âœ“ |@sudocode-ai/local-ui| tests/components/relationships/RelationshipList.test.tsx (16 tests) 8274ms
   âœ“ RelationshipList > empty state > should show empty message when no relationships and showEmpty is true  636ms
   âœ“ RelationshipList > empty state > should render nothing when no relationships and showEmpty is false  301ms
   âœ“ RelationshipList > grouping > should group relationships into outgoing and incoming  423ms
   âœ“ RelationshipList > grouping > should only show incoming section when no outgoing relationships  480ms
   âœ“ RelationshipList > relationship rendering > should render incoming relationships with inverse labels  440ms
   âœ“ RelationshipList > relationship rendering > should display target entity IDs with titles  1226ms
   âœ“ RelationshipList > relationship rendering > should display entity type icons  811ms
   âœ“ RelationshipList > navigation > should render entities with proper badges  963ms
   âœ“ RelationshipList > deletion > should call onDelete with relationship when delete button is clicked  1662ms
   âœ“ RelationshipList > edge cases > should handle relationships with all relationship types  819ms
 âœ“ |@sudocode-ai/local-ui| tests/pages/SpecsPage.test.tsx (17 tests) 17319ms
   âœ“ SpecsPage > should show loading state initially  1729ms
   âœ“ SpecsPage > should display specs when loaded  393ms
   âœ“ SpecsPage > should show spec count  564ms
   âœ“ SpecsPage > should display spec priorities  389ms
   âœ“ SpecsPage > should display spec file paths  618ms
   âœ“ SpecsPage > should truncate long content  409ms
   âœ“ SpecsPage > should handle API error gracefully  496ms
   âœ“ SpecsPage > Sorting functionality > should sort by priority by default (low to high, then newest)  474ms
   âœ“ SpecsPage > Sorting functionality > should sort by newest when selected  3818ms
   âœ“ SpecsPage > Sorting functionality > should sort by last updated when selected  2860ms
   âœ“ SpecsPage > Sorting functionality > should persist sort preference to localStorage  2349ms
   âœ“ SpecsPage > Sorting functionality > should load sort preference from localStorage on mount  379ms
   âœ“ SpecsPage > Sorting functionality > should handle localStorage errors gracefully  546ms
   âœ“ SpecsPage > Sorting functionality > should maintain sort order when filtering specs  1616ms
stdout | tests/components/workflows/OrchestratorGuidancePanel.test.tsx > OrchestratorGuidancePanel > should render the guidance panel with input
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/workflows/OrchestratorGuidancePanel.test.tsx > OrchestratorGuidancePanel > should show running status when orchestrator is running
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/workflows/OrchestratorGuidancePanel.test.tsx > OrchestratorGuidancePanel > should show idle status when orchestrator is not running
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/workflows/OrchestratorGuidancePanel.test.tsx > OrchestratorGuidancePanel > should have disabled send button when message is empty
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/workflows/OrchestratorGuidancePanel.test.tsx > OrchestratorGuidancePanel > should enable send button when message has content
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/workflows/OrchestratorGuidancePanel.test.tsx > OrchestratorGuidancePanel > should enable send button when message has content
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/workflows/OrchestratorGuidancePanel.test.tsx > OrchestratorGuidancePanel > should call createFollowUp API when submit button is clicked
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/workflows/OrchestratorGuidancePanel.test.tsx > OrchestratorGuidancePanel > should call createFollowUp API when submit button is clicked
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/workflows/OrchestratorGuidancePanel.test.tsx > OrchestratorGuidancePanel > should submit on Enter key press
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/workflows/OrchestratorGuidancePanel.test.tsx > OrchestratorGuidancePanel > should submit on Enter key press
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

 â¯ |@sudocode-ai/local-ui| tests/pages/ExecutionsPage.test.tsx (48 tests | 1 failed) 37494ms
   âœ“ ExecutionsPage > Initial Rendering > renders page title  410ms
   âœ“ ExecutionsPage > Initial Rendering > renders grid configuration controls  429ms
   âœ“ ExecutionsPage > Initial Rendering > shows default column and row values 186ms
   âœ“ ExecutionsPage > Initial Rendering > renders empty state when no execution chains  328ms
   âœ“ ExecutionsPage > Loading State > shows loading spinner when data is loading 39ms
   âœ“ ExecutionsPage > Error State > shows error message when data fetch fails 72ms
   âœ“ ExecutionsPage > Error State > calls refetch when retry button clicked  1091ms
   âœ“ ExecutionsPage > Grid Configuration > increments columns when plus button clicked  435ms
   âœ“ ExecutionsPage > Grid Configuration > decrements columns when minus button clicked 144ms
   âœ“ ExecutionsPage > Grid Configuration > increments rows when plus button clicked  465ms
   âœ“ ExecutionsPage > Grid Configuration > disables minus button at minimum columns  316ms
   âœ“ ExecutionsPage > Grid Configuration > disables plus button at maximum columns  684ms
   âœ“ ExecutionsPage > Grid Configuration > persists column configuration to localStorage  547ms
   âœ“ ExecutionsPage > Grid Configuration > persists row configuration to localStorage  526ms
   âœ“ ExecutionsPage > Pagination > shows pagination info when multiple pages exist  1135ms
   âœ“ ExecutionsPage > Pagination > shows next page button when not on last page  1471ms
   âœ“ ExecutionsPage > Pagination > navigates to next page when next button clicked  1243ms
   âœ“ ExecutionsPage > Pagination > disables next button on last page  1581ms
   âœ“ ExecutionsPage > Pagination > disables previous button on first page  958ms
   âœ“ ExecutionsPage > Keyboard Navigation > navigates to next page with arrow right key  695ms
   âœ“ ExecutionsPage > Keyboard Navigation > navigates to previous page with arrow left key  1445ms
   âœ“ ExecutionsPage > Keyboard Navigation > does not navigate beyond first page with arrow left  1315ms
   âœ“ ExecutionsPage > Keyboard Navigation > does not navigate beyond last page with arrow right  1161ms
   âœ“ ExecutionsPage > Execution Count Display > renders page with multiple executions  525ms
   âœ“ ExecutionsPage > Execution Count Display > renders page with single execution 28ms
   âœ“ ExecutionsPage > LocalStorage Persistence > loads column configuration from localStorage  562ms
   âœ“ ExecutionsPage > LocalStorage Persistence > loads row configuration from localStorage 186ms
   âœ“ ExecutionsPage > LocalStorage Persistence > uses default values for invalid localStorage data 208ms
   âœ“ ExecutionsPage > LocalStorage Persistence > loads status filters from localStorage  430ms
   âœ“ ExecutionsPage > LocalStorage Persistence > loads issue status filters from localStorage  322ms
   âœ“ ExecutionsPage > LocalStorage Persistence > loads sidebar collapsed state from localStorage 71ms
   âœ“ ExecutionsPage > Status Filters > renders filter button  515ms
   âœ“ ExecutionsPage > Status Filters > shows filter count badge when status filters are loaded from localStorage  712ms
   âœ“ ExecutionsPage > Status Filters > shows filter count badge when issue status filters are loaded from localStorage 54ms
   âœ“ ExecutionsPage > Status Filters > shows combined filter count for both filter types  739ms
   âœ“ ExecutionsPage > Status Filters > shows no badge when no filters are active  1969ms
   âœ“ ExecutionsPage > Status Filters > loads multiple status filters from localStorage  789ms
   âœ“ ExecutionsPage > Status Filters > loads multiple issue status filters from localStorage  559ms
   âœ“ ExecutionsPage > Issue Status Filtering > applies issue status filter from localStorage  684ms
   âœ“ ExecutionsPage > Issue Status Filtering > shows correct filter count with multiple issue status filters  1342ms
   âœ“ ExecutionsPage > Issue Status Filtering > combines execution status and issue status filter counts  495ms
   âœ“ ExecutionsPage > Issue Status Filtering > creates issue status map from issues 42ms
   âœ“ ExecutionsPage > Sidebar Collapse Persistence > calls panel collapse when sidebar toggle is clicked  356ms
   âœ“ ExecutionsPage > Sidebar Collapse Persistence > persists sidebar collapsed state to localStorage  511ms
   âœ“ ExecutionsPage > Sidebar Collapse Persistence > loads sidebar collapsed state from localStorage on mount  557ms
   âœ“ ExecutionsPage > Select All / Deselect All > allows deselecting all executions via the "All" checkbox  2485ms
   Ã— ExecutionsPage > Select All / Deselect All > allows selecting all executions after they were deselected 5468ms
     â†’ Test timed out in 5000ms.
If this is a long-running test, pass a timeout value as the last argument or configure it globally with "testTimeout".
   âœ“ ExecutionsPage > Select All / Deselect All > deselect all state persists and is not reset by useEffect  1199ms
stdout | tests/components/workflows/OrchestratorGuidancePanel.test.tsx > OrchestratorGuidancePanel > should not submit on Shift+Enter (allows newline)
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/workflows/OrchestratorGuidancePanel.test.tsx > OrchestratorGuidancePanel > should not submit on Shift+Enter (allows newline)
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/workflows/OrchestratorGuidancePanel.test.tsx > OrchestratorGuidancePanel > should clear input and show success toast on successful submit
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/workflows/OrchestratorGuidancePanel.test.tsx > OrchestratorGuidancePanel > should clear input and show success toast on successful submit
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/workflows/OrchestratorGuidancePanel.test.tsx > OrchestratorGuidancePanel > should show error toast on failed submit
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/workflows/OrchestratorGuidancePanel.test.tsx > OrchestratorGuidancePanel > should show error toast on failed submit
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

 âœ“ |@sudocode-ai/local-ui| tests/hooks/useIssues.test.ts (17 tests) 3413ms
   âœ“ useIssues > should fetch and return issues  697ms
   âœ“ useIssues > should handle error state  304ms
   âœ“ useIssues > should create issue  359ms
   âœ“ useIssue > should handle error when fetching single issue  366ms
stdout | tests/components/workflows/OrchestratorGuidancePanel.test.tsx > OrchestratorGuidancePanel > should disable input when disabled prop is true
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/workflows/OrchestratorGuidancePanel.test.tsx > OrchestratorGuidancePanel > should not submit when disabled
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/workflows/OrchestratorGuidancePanel.test.tsx > OrchestratorGuidancePanel > should show loading state while submitting
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/workflows/OrchestratorGuidancePanel.test.tsx > OrchestratorGuidancePanel > should show loading state while submitting
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/workflows/OrchestratorGuidancePanel.test.tsx > OrchestratorGuidancePanel > should not submit with whitespace-only message
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/workflows/OrchestratorGuidancePanel.test.tsx > OrchestratorGuidancePanel > should not submit with whitespace-only message
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/EntityMention.test.tsx > Entity Mention Rendering > should render basic issue mention as badge
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/workflows/OrchestratorGuidancePanel.test.tsx > OrchestratorGuidancePanel > should trim message before submitting
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/workflows/OrchestratorGuidancePanel.test.tsx > OrchestratorGuidancePanel > should trim message before submitting
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/workflows/OrchestratorGuidancePanel.test.tsx > OrchestratorGuidancePanel > should show hint text about keyboard shortcuts
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/workflows/OrchestratorGuidancePanel.test.tsx > OrchestratorGuidancePanel > should apply custom className
[WebSocket] Connecting to: ws://localhost:3000/ws

 âœ“ |@sudocode-ai/local-ui| tests/components/workflows/OrchestratorGuidancePanel.test.tsx (17 tests) 12528ms
   âœ“ OrchestratorGuidancePanel > should render the guidance panel with input  670ms
   âœ“ OrchestratorGuidancePanel > should have disabled send button when message is empty  880ms
   âœ“ OrchestratorGuidancePanel > should enable send button when message has content  1988ms
   âœ“ OrchestratorGuidancePanel > should call createFollowUp API when submit button is clicked  1173ms
   âœ“ OrchestratorGuidancePanel > should submit on Enter key press  1115ms
   âœ“ OrchestratorGuidancePanel > should not submit on Shift+Enter (allows newline)  551ms
   âœ“ OrchestratorGuidancePanel > should clear input and show success toast on successful submit  843ms
   âœ“ OrchestratorGuidancePanel > should show error toast on failed submit  1986ms
   âœ“ OrchestratorGuidancePanel > should show loading state while submitting  1052ms
   âœ“ OrchestratorGuidancePanel > should trim message before submitting  1441ms
stdout | tests/components/EntityMention.test.tsx > Entity Mention Rendering > should render spec mention as badge
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/EntityMention.test.tsx > Entity Mention Rendering > should render spec mention as badge
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/EntityMention.test.tsx > Entity Mention Rendering > should render mention with display text
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/EntityMention.test.tsx > Entity Mention Rendering > should render mention with relationship type
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/EntityMention.test.tsx > Entity Mention Rendering > should render multiple mentions
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/integration/workflows.test.tsx > Workflow Integration Tests > WorkflowDetailPage - Viewing Workflow > should display workflow details
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/EntityMention.test.tsx > Entity Mention Rendering > should create clickable links to entity pages
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/EntityMention.test.tsx > Entity Mention Rendering > should not render escaped mentions
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/EntityMention.test.tsx > Entity Mention Rendering > should not render escaped mentions
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

 âœ“ |@sudocode-ai/local-ui| tests/components/executions/AgentConfigPanel-contextual-actions.test.tsx (16 tests) 12911ms
   âœ“ AgentConfigPanel - Contextual Actions > Action Visibility > should not show actions by default (disableContextualActions defaults to true)  2866ms
   âœ“ AgentConfigPanel - Contextual Actions > Action Visibility > should not show actions when no execution is provided  622ms
   âœ“ AgentConfigPanel - Contextual Actions > Action Visibility > should show commit action when execution has uncommitted files and actions are enabled  944ms
   âœ“ AgentConfigPanel - Contextual Actions > Action Visibility > should show file count badge on commit button  635ms
   âœ“ AgentConfigPanel - Contextual Actions > Action Visibility > should show sync action for worktree executions  558ms
   âœ“ AgentConfigPanel - Contextual Actions > Action Visibility > should show cleanup action for worktree executions  423ms
   âœ“ AgentConfigPanel - Contextual Actions > Action Visibility > should not show commit action when there are no uncommitted files  595ms
   âœ“ AgentConfigPanel - Contextual Actions > Action Interactions > should call fetchSyncPreview when sync button is clicked  1209ms
   âœ“ AgentConfigPanel - Contextual Actions > Action States > should disable all actions when panel is disabled  993ms
   âœ“ AgentConfigPanel - Contextual Actions > Action States > should disable all actions when execution is running  767ms
   âœ“ AgentConfigPanel - Contextual Actions > Action States > should enable actions when panel is not disabled  829ms
   âœ“ AgentConfigPanel - Contextual Actions > Multiple Executions > should update actions when execution changes  670ms
   âœ“ AgentConfigPanel - Contextual Actions > Multiple Executions > should clear actions when execution becomes null  571ms
   âœ“ AgentConfigPanel - Contextual Actions > Layout and Styling > should render actions in a flex container  525ms
   âœ“ AgentConfigPanel - Contextual Actions > Layout and Styling > should render action buttons with correct styling  502ms
stdout | tests/components/EntityMention.test.tsx > Entity Mention Rendering > should render mentions within complex markdown
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/integration/workflows.test.tsx > Workflow Integration Tests > WorkflowDetailPage - Viewing Workflow > should show error for non-existent workflow
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/integration/workflows.test.tsx > Workflow Integration Tests > WorkflowDetailPage - Lifecycle Actions > should pause a running workflow
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/EntityMention.test.tsx > Entity Mention Rendering > should handle empty content gracefully
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/EntityMention.test.tsx > Entity Mention Rendering > should handle content with no entity mentions
[WebSocket] Connecting to: ws://localhost:3000/ws

 âœ“ |@sudocode-ai/local-ui| tests/components/EntityMention.test.tsx (10 tests) 11691ms
   âœ“ Entity Mention Rendering > should render basic issue mention as badge  3720ms
   âœ“ Entity Mention Rendering > should render spec mention as badge  1729ms
   âœ“ Entity Mention Rendering > should render mention with display text  546ms
   âœ“ Entity Mention Rendering > should render mention with relationship type  596ms
   âœ“ Entity Mention Rendering > should render multiple mentions  1533ms
   âœ“ Entity Mention Rendering > should create clickable links to entity pages  884ms
   âœ“ Entity Mention Rendering > should not render escaped mentions  572ms
   âœ“ Entity Mention Rendering > should render mentions within complex markdown  1031ms
   âœ“ Entity Mention Rendering > should handle content with no entity mentions  842ms
 âœ“ |@sudocode-ai/local-ui| tests/components/projects/ProjectSwitcher.test.tsx (11 tests) 10905ms
   âœ“ ProjectSwitcher > should show "Open Project" button when no project is selected  1094ms
   âœ“ ProjectSwitcher > should navigate to /projects when "Open Project" is clicked  520ms
   âœ“ ProjectSwitcher > should show loading state for recent projects  1647ms
   âœ“ ProjectSwitcher > should display recent projects in dropdown  1699ms
   âœ“ ProjectSwitcher > should show "Manage Projects" option in dropdown  916ms
   âœ“ ProjectSwitcher > should navigate to /projects when "Manage Projects" is clicked  1152ms
   âœ“ ProjectSwitcher > should open closed project before switching  1233ms
   âœ“ ProjectSwitcher > should not open project if already open  1091ms
   âœ“ ProjectSwitcher > should navigate to issues page when switching projects  1355ms
stdout | tests/integration/workflows.test.tsx > Workflow Integration Tests > WorkflowDetailPage - Lifecycle Actions > should pause a running workflow
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/integration/workflows.test.tsx > Workflow Integration Tests > WorkflowDetailPage - Lifecycle Actions > should pause a running workflow
[WebSocket] Unsubscribed from: test-project-123:issue:*
[WebSocket] Subscribed to: test-project-123:workflow:*
[WebSocket] Subscribed to: test-project-123:issue:*

stdout | tests/integration/workflows.test.tsx > Workflow Integration Tests > WorkflowDetailPage - Lifecycle Actions > should pause a running workflow
[WebSocket] Message received: unsubscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/integration/workflows.test.tsx > Workflow Integration Tests > WorkflowDetailPage - Lifecycle Actions > should resume a paused workflow
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/integration/workflows.test.tsx > Workflow Integration Tests > WorkflowDetailPage - Lifecycle Actions > should resume a paused workflow
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/integration/workflows.test.tsx > Workflow Integration Tests > WorkflowDetailPage - Lifecycle Actions > should resume a paused workflow
[WebSocket] Unsubscribed from: test-project-123:issue:*
[WebSocket] Subscribed to: test-project-123:workflow:*
[WebSocket] Subscribed to: test-project-123:issue:*

stdout | tests/integration/workflows.test.tsx > Workflow Integration Tests > WorkflowDetailPage - Lifecycle Actions > should resume a paused workflow
[WebSocket] Message received: unsubscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/integration/workflows.test.tsx > Workflow Integration Tests > WorkflowDetailPage - Lifecycle Actions > should cancel a workflow
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/integration/workflows.test.tsx > Workflow Integration Tests > WorkflowDetailPage - Lifecycle Actions > should cancel a workflow
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/integration/workflows.test.tsx > Workflow Integration Tests > WorkflowDetailPage - Lifecycle Actions > should cancel a workflow
[WebSocket] Unsubscribed from: test-project-123:issue:*
[WebSocket] Subscribed to: test-project-123:workflow:*
[WebSocket] Subscribed to: test-project-123:issue:*

stdout | tests/integration/workflows.test.tsx > Workflow Integration Tests > WorkflowDetailPage - Lifecycle Actions > should cancel a workflow
[WebSocket] Message received: unsubscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/integration/workflows.test.tsx > Workflow Integration Tests > WorkflowDetailPage - Lifecycle Actions > should start a pending workflow
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/DeleteExecutionDialog.test.tsx > DeleteExecutionDialog > should not render when isOpen is false
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/integration/workflows.test.tsx > Workflow Integration Tests > WorkflowDetailPage - Lifecycle Actions > should start a pending workflow
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/integration/workflows.test.tsx > Workflow Integration Tests > WorkflowDetailPage - Lifecycle Actions > should start a pending workflow
[WebSocket] Unsubscribed from: test-project-123:issue:*
[WebSocket] Subscribed to: test-project-123:workflow:*
[WebSocket] Subscribed to: test-project-123:issue:*

stdout | tests/integration/workflows.test.tsx > Workflow Integration Tests > WorkflowDetailPage - Lifecycle Actions > should start a pending workflow
[WebSocket] Message received: unsubscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/integration/workflows.test.tsx > Workflow Integration Tests > API Integration > should call get API for workflow detail
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/integration/workflows.test.tsx > Workflow Integration Tests > API Integration > should call issues API to enrich workflow steps
[WebSocket] Connecting to: ws://localhost:3000/ws

 â¯ |@sudocode-ai/local-ui| tests/integration/workflows.test.tsx (12 tests | 4 failed) 10939ms
   Ã— Workflow Integration Tests > WorkflowsPage - Listing Workflows > should show loading state when data is loading 425ms
     â†’ [vitest] No "repositoryApi" export is defined on the "@/lib/api" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

   Ã— Workflow Integration Tests > WorkflowsPage - Listing Workflows > should call list API on mount 26ms
     â†’ [vitest] No "repositoryApi" export is defined on the "@/lib/api" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

   âœ“ Workflow Integration Tests > WorkflowDetailPage - Viewing Workflow > should display workflow details  2005ms
   âœ“ Workflow Integration Tests > WorkflowDetailPage - Viewing Workflow > should show error for non-existent workflow  371ms
   âœ“ Workflow Integration Tests > WorkflowDetailPage - Lifecycle Actions > should pause a running workflow  2753ms
   âœ“ Workflow Integration Tests > WorkflowDetailPage - Lifecycle Actions > should resume a paused workflow  2356ms
   âœ“ Workflow Integration Tests > WorkflowDetailPage - Lifecycle Actions > should cancel a workflow  1199ms
   âœ“ Workflow Integration Tests > WorkflowDetailPage - Lifecycle Actions > should start a pending workflow  980ms
   Ã— Workflow Integration Tests > API Integration > should call list API on workflows page load 90ms
     â†’ [vitest] No "repositoryApi" export is defined on the "@/lib/api" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

   âœ“ Workflow Integration Tests > API Integration > should call get API for workflow detail  364ms
   âœ“ Workflow Integration Tests > API Integration > should call issues API to enrich workflow steps 197ms
   Ã— Workflow Integration Tests > API Integration > should handle API errors gracefully 169ms
     â†’ [vitest] No "repositoryApi" export is defined on the "@/lib/api" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

stdout | tests/components/executions/DeleteExecutionDialog.test.tsx > DeleteExecutionDialog > should render when isOpen is true
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/DeleteExecutionDialog.test.tsx > DeleteExecutionDialog > should call onConfirm with false, false when Delete button is clicked without checkboxes
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/DeleteExecutionDialog.test.tsx > DeleteExecutionDialog > should call onClose when Cancel button is clicked
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/DeleteExecutionDialog.test.tsx > DeleteExecutionDialog > should disable buttons when isDeleting is true
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/DeleteExecutionDialog.test.tsx > DeleteExecutionDialog > should return null when executionId is null
[WebSocket] Connecting to: ws://localhost:3000/ws

 âœ“ |@sudocode-ai/local-ui| tests/components/executions/CleanupWorktreeDialog.test.tsx (15 tests) 6544ms
   âœ“ CleanupWorktreeDialog > should render dialog when open  1320ms
   âœ“ CleanupWorktreeDialog > should display worktree path  576ms
   âœ“ CleanupWorktreeDialog > should display worktree branch name  306ms
   âœ“ CleanupWorktreeDialog > should have delete branch checkbox checked by default  430ms
   âœ“ CleanupWorktreeDialog > should toggle delete branch checkbox  923ms
   âœ“ CleanupWorktreeDialog > should call onConfirm with deleteBranch=true when confirmed with checkbox checked  752ms
   âœ“ CleanupWorktreeDialog > should call onConfirm with deleteBranch=false when confirmed with checkbox unchecked  575ms
   âœ“ CleanupWorktreeDialog > should call onClose when cancel is clicked  689ms
stdout | tests/components/executions/DeleteExecutionDialog.test.tsx > DeleteExecutionDialog > should show branch deletion checkbox when branch was created by execution
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/DeleteExecutionDialog.test.tsx > DeleteExecutionDialog > should not show branch deletion checkbox when branch was not created by execution
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/DeleteExecutionDialog.test.tsx > DeleteExecutionDialog > should not show branch deletion checkbox for detached HEAD
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/DeleteExecutionDialog.test.tsx > DeleteExecutionDialog > should call onConfirm with true, false when branch checkbox is checked
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/DeleteExecutionDialog.test.tsx > DeleteExecutionDialog > should call onConfirm with true, false when branch checkbox is checked
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/DeleteExecutionDialog.test.tsx > DeleteExecutionDialog > should call onConfirm with false, true when worktree checkbox is checked
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/DeleteExecutionDialog.test.tsx > DeleteExecutionDialog > should call onConfirm with false, true when worktree checkbox is checked
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/DeleteExecutionDialog.test.tsx > DeleteExecutionDialog > should call onConfirm with true, true when both checkboxes are checked
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/DeleteExecutionDialog.test.tsx > DeleteExecutionDialog > should call onConfirm with true, true when both checkboxes are checked
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

 âœ“ |@sudocode-ai/local-ui| tests/hooks/useFeedbackPositions.test.tsx (11 tests) 1351ms
   âœ“ useFeedbackPositions > should update positions when feedback changes  325ms
stdout | tests/components/executions/DeleteExecutionDialog.test.tsx > DeleteExecutionDialog > should disable checkboxes when isDeleting is true
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/DeleteExecutionDialog.test.tsx > DeleteExecutionDialog > should show worktree checkbox when hasWorktree is true
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/DeleteExecutionDialog.test.tsx > DeleteExecutionDialog > should not show worktree checkbox when hasWorktree is false
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/DeleteExecutionDialog.test.tsx > DeleteExecutionDialog > should call onClose when pressing Escape
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/DeleteExecutionDialog.test.tsx > DeleteExecutionDialog > LocalStorage Persistence > should load saved deleteBranch preference from localStorage
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionView.test.tsx > ExecutionView > should display loading state initially
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/DeleteExecutionDialog.test.tsx > DeleteExecutionDialog > LocalStorage Persistence > should load saved deleteWorktree preference from localStorage
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/DeleteExecutionDialog.test.tsx > DeleteExecutionDialog > LocalStorage Persistence > should save deleteBranch preference to localStorage when changed
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionView.test.tsx > ExecutionView > should load and call onHeaderDataChange with execution metadata
[WebSocket] Connecting to: ws://localhost:3000/ws

 âœ“ |@sudocode-ai/local-ui| tests/components/executions/SyncPreviewDialog.test.tsx (29 tests) 14952ms
   âœ“ SyncPreviewDialog > Rendering > should render dialog when open  1952ms
   âœ“ SyncPreviewDialog > Header Summary > should display file count and diff stats in header  496ms
   âœ“ SyncPreviewDialog > Header Summary > should display commit count in header  438ms
   âœ“ SyncPreviewDialog > Header Summary > should handle singular file count  466ms
   âœ“ SyncPreviewDialog > Conflicts > should show code conflicts with error state  303ms
   âœ“ SyncPreviewDialog > Conflicts > should allow sync when only JSONL conflicts exist (auto-resolvable)  471ms
   âœ“ SyncPreviewDialog > Conflicts > should show Open in IDE button for code conflicts  329ms
   âœ“ SyncPreviewDialog > Warnings > should display general warnings  651ms
   âœ“ SyncPreviewDialog > Mode Selection > should show all three sync mode options  493ms
   âœ“ SyncPreviewDialog > Mode Selection > should hide commit message input when stage mode selected  1356ms
   âœ“ SyncPreviewDialog > Mode Selection > should disable squash and preserve options when there are no commits  1157ms
   âœ“ SyncPreviewDialog > Mode Selection > should show "Requires committed changes" message when there are no commits  964ms
   âœ“ SyncPreviewDialog > Mode Selection > should have include uncommitted checkbox checked by default in stage mode  533ms
   âœ“ SyncPreviewDialog > Mode Selection > should allow unchecking include uncommitted checkbox  806ms
   âœ“ SyncPreviewDialog > Actions > should call onClose when Cancel clicked  379ms
   âœ“ SyncPreviewDialog > Actions > should call onConfirmSync with squash mode and options  533ms
   âœ“ SyncPreviewDialog > Actions > should show Stage Changes button when stage mode selected  630ms
   âœ“ SyncPreviewDialog > Actions > should call onConfirmSync with stage mode and options (includeUncommitted defaults to true)  768ms
   âœ“ SyncPreviewDialog > Actions > should disable confirm button when previewing  389ms
stdout | tests/components/executions/DeleteExecutionDialog.test.tsx > DeleteExecutionDialog > LocalStorage Persistence > should save deleteBranch preference to localStorage when changed
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/DeleteExecutionDialog.test.tsx > DeleteExecutionDialog > LocalStorage Persistence > should save deleteWorktree preference to localStorage when changed
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionView.test.tsx > ExecutionView > should display error when loading fails
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionView.test.tsx > ExecutionView > should call onStatusChange with running status
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/DeleteWorktreeDialog.test.tsx > DeleteWorktreeDialog > should not render when isOpen is false
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionView.test.tsx > ExecutionView > should call onStatusChange with completed status
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionView.test.tsx > ExecutionView > should call onStatusChange with failed status and display error message
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/DeleteExecutionDialog.test.tsx > DeleteExecutionDialog > LocalStorage Persistence > should save deleteWorktree preference to localStorage when changed
[WebSocket] Connected

stdout | tests/components/executions/DeleteExecutionDialog.test.tsx > DeleteExecutionDialog > LocalStorage Persistence > should save deleteWorktree preference to localStorage when changed
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/ExecutionView.test.tsx > ExecutionView > should expose canCancel=true via onHeaderDataChange when execution is running
[WebSocket] Connecting to: ws://localhost:3000/ws

 âœ“ |@sudocode-ai/local-ui| tests/components/executions/DeleteExecutionDialog.test.tsx (20 tests) 10461ms
   âœ“ DeleteExecutionDialog > should not render when isOpen is false  837ms
   âœ“ DeleteExecutionDialog > should render when isOpen is true  2001ms
   âœ“ DeleteExecutionDialog > should call onConfirm with false, false when Delete button is clicked without checkboxes  579ms
   âœ“ DeleteExecutionDialog > should disable buttons when isDeleting is true  601ms
   âœ“ DeleteExecutionDialog > should call onConfirm with true, false when branch checkbox is checked  565ms
   âœ“ DeleteExecutionDialog > should call onConfirm with false, true when worktree checkbox is checked  607ms
   âœ“ DeleteExecutionDialog > should call onConfirm with true, true when both checkboxes are checked  656ms
   âœ“ DeleteExecutionDialog > should disable checkboxes when isDeleting is true  440ms
   âœ“ DeleteExecutionDialog > LocalStorage Persistence > should load saved deleteBranch preference from localStorage  724ms
   âœ“ DeleteExecutionDialog > LocalStorage Persistence > should save deleteBranch preference to localStorage when changed  674ms
   âœ“ DeleteExecutionDialog > LocalStorage Persistence > should save deleteWorktree preference to localStorage when changed  939ms
stdout | tests/components/executions/ExecutionView.test.tsx > ExecutionView > should expose canCancel=false via onHeaderDataChange when execution is completed
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/DeleteWorktreeDialog.test.tsx > DeleteWorktreeDialog > should render when isOpen is true
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/hooks/useAgUiStream.test.ts > useAgUiStream > Connection Management > should auto-connect by default
[SSE]. Connecting to SSE stream {
  executionId: [32m'test-exec-1'[39m,
  projectId: [1mnull[22m,
  url: [32m'/api/executions/test-exec-1/stream'[39m,
  timestamp: [32m'2025-12-19T06:32:25.278Z'[39m
}

stdout | tests/hooks/useAgUiStream.test.ts > useAgUiStream > Connection Management > should auto-connect by default
[SSE]. SSE connection established { executionId: [32m'test-exec-1'[39m, timestamp: [32m'2025-12-19T06:32:25.318Z'[39m }

stdout | tests/components/executions/ExecutionView.test.tsx > ExecutionView > should show follow-up panel when execution is completed
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/DeleteWorktreeDialog.test.tsx > DeleteWorktreeDialog > should call onConfirm with false when Delete button is clicked without branch checkbox
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/hooks/useAgUiStream.test.ts > useAgUiStream > Connection Management > should connect manually
[SSE]. Connecting to SSE stream {
  executionId: [32m'test-exec-1'[39m,
  projectId: [1mnull[22m,
  url: [32m'/api/executions/test-exec-1/stream'[39m,
  timestamp: [32m'2025-12-19T06:32:25.826Z'[39m
}

stdout | tests/components/executions/ExecutionView.test.tsx > ExecutionView > should show follow-up panel when execution failed
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/hooks/useAgUiStream.test.ts > useAgUiStream > Connection Management > should connect manually
[SSE]. SSE connection established { executionId: [32m'test-exec-1'[39m, timestamp: [32m'2025-12-19T06:32:25.855Z'[39m }

stdout | tests/hooks/useAgUiStream.test.ts > useAgUiStream > Connection Management > should disconnect
[SSE]. Connecting to SSE stream {
  executionId: [32m'test-exec-1'[39m,
  projectId: [1mnull[22m,
  url: [32m'/api/executions/test-exec-1/stream'[39m,
  timestamp: [32m'2025-12-19T06:32:25.983Z'[39m
}

stdout | tests/hooks/useAgUiStream.test.ts > useAgUiStream > Connection Management > should disconnect
[SSE]. SSE connection established { executionId: [32m'test-exec-1'[39m, timestamp: [32m'2025-12-19T06:32:25.983Z'[39m }

stdout | tests/components/executions/ExecutionView.test.tsx > ExecutionView > should cancel execution when onCancel handler is called
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/hooks/useAgUiStream.test.ts > useAgUiStream > Connection Management > should use correct endpoint URL
[SSE]. Connecting to SSE stream {
  executionId: [32m'test-exec-123'[39m,
  projectId: [1mnull[22m,
  url: [32m'/api/executions/test-exec-123/stream'[39m,
  timestamp: [32m'2025-12-19T06:32:26.099Z'[39m
}

stdout | tests/hooks/useAgUiStream.test.ts > useAgUiStream > Connection Management > should use correct endpoint URL
[SSE]. SSE connection established { executionId: [32m'test-exec-123'[39m, timestamp: [32m'2025-12-19T06:32:26.141Z'[39m }

stdout | tests/hooks/useAgUiStream.test.ts > useAgUiStream > Connection Management > should use custom endpoint if provided
[SSE]. Connecting to SSE stream {
  executionId: [32m'test-exec-1'[39m,
  projectId: [1mnull[22m,
  url: [32m'/custom/endpoint'[39m,
  timestamp: [32m'2025-12-19T06:32:26.297Z'[39m
}

stdout | tests/hooks/useAgUiStream.test.ts > useAgUiStream > Connection Management > should use custom endpoint if provided
[SSE]. SSE connection established { executionId: [32m'test-exec-1'[39m, timestamp: [32m'2025-12-19T06:32:26.351Z'[39m }

stdout | tests/hooks/useAgUiStream.test.ts > useAgUiStream > RUN Events > should handle RUN_STARTED event
[SSE]. Connecting to SSE stream {
  executionId: [32m'test-exec-1'[39m,
  projectId: [1mnull[22m,
  url: [32m'/api/executions/test-exec-1/stream'[39m,
  timestamp: [32m'2025-12-19T06:32:26.353Z'[39m
}

stdout | tests/hooks/useAgUiStream.test.ts > useAgUiStream > RUN Events > should handle RUN_STARTED event
[SSE]. SSE connection established { executionId: [32m'test-exec-1'[39m, timestamp: [32m'2025-12-19T06:32:26.380Z'[39m }

stdout | tests/hooks/useAgUiStream.test.ts > useAgUiStream > RUN Events > should handle RUN_FINISHED event
[SSE]. Connecting to SSE stream {
  executionId: [32m'test-exec-1'[39m,
  projectId: [1mnull[22m,
  url: [32m'/api/executions/test-exec-1/stream'[39m,
  timestamp: [32m'2025-12-19T06:32:26.444Z'[39m
}

stdout | tests/hooks/useAgUiStream.test.ts > useAgUiStream > RUN Events > should handle RUN_FINISHED event
[SSE]. SSE connection established { executionId: [32m'test-exec-1'[39m, timestamp: [32m'2025-12-19T06:32:26.445Z'[39m }

stdout | tests/components/executions/ExecutionView.test.tsx > ExecutionView > should cancel execution when onCancel handler is called
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/ExecutionView.test.tsx > ExecutionView > should show follow-up panel when execution is stopped
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionView.test.tsx > ExecutionView > should show follow-up panel when execution is cancelled
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionView.test.tsx > ExecutionView > should show follow-up panel for non-worktree executions
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/hooks/useAgUiStream.test.ts > useAgUiStream > RUN Events > should handle RUN_ERROR event
[SSE]. Connecting to SSE stream {
  executionId: [32m'test-exec-1'[39m,
  projectId: [1mnull[22m,
  url: [32m'/api/executions/test-exec-1/stream'[39m,
  timestamp: [32m'2025-12-19T06:32:26.559Z'[39m
}

stdout | tests/hooks/useAgUiStream.test.ts > useAgUiStream > RUN Events > should handle RUN_ERROR event
[SSE]. SSE connection established { executionId: [32m'test-exec-1'[39m, timestamp: [32m'2025-12-19T06:32:26.585Z'[39m }

stdout | tests/hooks/useAgUiStream.test.ts > useAgUiStream > STEP Events > should handle STEP_STARTED event
[SSE]. Connecting to SSE stream {
  executionId: [32m'test-exec-1'[39m,
  projectId: [1mnull[22m,
  url: [32m'/api/executions/test-exec-1/stream'[39m,
  timestamp: [32m'2025-12-19T06:32:26.633Z'[39m
}

stdout | tests/hooks/useAgUiStream.test.ts > useAgUiStream > STEP Events > should handle STEP_STARTED event
[SSE]. SSE connection established { executionId: [32m'test-exec-1'[39m, timestamp: [32m'2025-12-19T06:32:26.634Z'[39m }

stdout | tests/hooks/useAgUiStream.test.ts > useAgUiStream > STEP Events > should handle STEP_FINISHED event
[SSE]. Connecting to SSE stream {
  executionId: [32m'test-exec-1'[39m,
  projectId: [1mnull[22m,
  url: [32m'/api/executions/test-exec-1/stream'[39m,
  timestamp: [32m'2025-12-19T06:32:26.730Z'[39m
}

stdout | tests/hooks/useAgUiStream.test.ts > useAgUiStream > STEP Events > should handle STEP_FINISHED event
[SSE]. SSE connection established { executionId: [32m'test-exec-1'[39m, timestamp: [32m'2025-12-19T06:32:26.734Z'[39m }

stdout | tests/hooks/useAgUiStream.test.ts > useAgUiStream > TEXT_MESSAGE Events > should buffer streaming text messages
[SSE]. Connecting to SSE stream {
  executionId: [32m'test-exec-1'[39m,
  projectId: [1mnull[22m,
  url: [32m'/api/executions/test-exec-1/stream'[39m,
  timestamp: [32m'2025-12-19T06:32:26.827Z'[39m
}

stdout | tests/hooks/useAgUiStream.test.ts > useAgUiStream > TEXT_MESSAGE Events > should buffer streaming text messages
[SSE]. SSE connection established { executionId: [32m'test-exec-1'[39m, timestamp: [32m'2025-12-19T06:32:26.829Z'[39m }

stdout | tests/components/executions/ExecutionView.test.tsx > ExecutionView > should create follow-up execution when continue button clicked
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/hooks/useAgUiStream.test.ts > useAgUiStream > TOOL_CALL Events > should track tool calls from start to result
[SSE]. Connecting to SSE stream {
  executionId: [32m'test-exec-1'[39m,
  projectId: [1mnull[22m,
  url: [32m'/api/executions/test-exec-1/stream'[39m,
  timestamp: [32m'2025-12-19T06:32:26.901Z'[39m
}

stdout | tests/hooks/useAgUiStream.test.ts > useAgUiStream > TOOL_CALL Events > should track tool calls from start to result
[SSE]. SSE connection established { executionId: [32m'test-exec-1'[39m, timestamp: [32m'2025-12-19T06:32:26.905Z'[39m }

stdout | tests/components/executions/DeleteWorktreeDialog.test.tsx > DeleteWorktreeDialog > should call onClose when Cancel button is clicked
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/hooks/useAgUiStream.test.ts > useAgUiStream > STATE Events > should handle STATE_SNAPSHOT event
[SSE]. Connecting to SSE stream {
  executionId: [32m'test-exec-1'[39m,
  projectId: [1mnull[22m,
  url: [32m'/api/executions/test-exec-1/stream'[39m,
  timestamp: [32m'2025-12-19T06:32:27.101Z'[39m
}

stdout | tests/hooks/useAgUiStream.test.ts > useAgUiStream > STATE Events > should handle STATE_SNAPSHOT event
[SSE]. SSE connection established { executionId: [32m'test-exec-1'[39m, timestamp: [32m'2025-12-19T06:32:27.106Z'[39m }

stdout | tests/hooks/useAgUiStream.test.ts > useAgUiStream > STATE Events > should handle STATE_DELTA event with replace operation
[SSE]. Connecting to SSE stream {
  executionId: [32m'test-exec-1'[39m,
  projectId: [1mnull[22m,
  url: [32m'/api/executions/test-exec-1/stream'[39m,
  timestamp: [32m'2025-12-19T06:32:27.161Z'[39m
}

stdout | tests/hooks/useAgUiStream.test.ts > useAgUiStream > STATE Events > should handle STATE_DELTA event with replace operation
[SSE]. SSE connection established { executionId: [32m'test-exec-1'[39m, timestamp: [32m'2025-12-19T06:32:27.162Z'[39m }

stdout | tests/hooks/useAgUiStream.test.ts > useAgUiStream > Cleanup > should cleanup on unmount
[SSE]. Connecting to SSE stream {
  executionId: [32m'test-exec-1'[39m,
  projectId: [1mnull[22m,
  url: [32m'/api/executions/test-exec-1/stream'[39m,
  timestamp: [32m'2025-12-19T06:32:27.224Z'[39m
}

stdout | tests/hooks/useAgUiStream.test.ts > useAgUiStream > Cleanup > should cleanup on unmount
[SSE]. SSE connection established { executionId: [32m'test-exec-1'[39m, timestamp: [32m'2025-12-19T06:32:27.230Z'[39m }

stdout | tests/hooks/useAgUiStream.test.ts > useAgUiStream > Cleanup > should clear state when executionId changes
[SSE]. Connecting to SSE stream {
  executionId: [32m'test-exec-1'[39m,
  projectId: [1mnull[22m,
  url: [32m'/api/executions/test-exec-1/stream'[39m,
  timestamp: [32m'2025-12-19T06:32:27.308Z'[39m
}

stdout | tests/hooks/useAgUiStream.test.ts > useAgUiStream > Cleanup > should clear state when executionId changes
[SSE]. SSE connection established { executionId: [32m'test-exec-1'[39m, timestamp: [32m'2025-12-19T06:32:27.310Z'[39m }

stdout | tests/hooks/useAgUiStream.test.ts > useAgUiStream > Cleanup > should clear state when executionId changes
[SSE]. Connecting to SSE stream {
  executionId: [32m'test-exec-2'[39m,
  projectId: [1mnull[22m,
  url: [32m'/api/executions/test-exec-2/stream'[39m,
  timestamp: [32m'2025-12-19T06:32:27.389Z'[39m
}

stdout | tests/hooks/useAgUiStream.test.ts > useAgUiStream > Cleanup > should clear state when executionId changes
[SSE]. SSE connection established { executionId: [32m'test-exec-2'[39m, timestamp: [32m'2025-12-19T06:32:27.390Z'[39m }

 âœ“ |@sudocode-ai/local-ui| tests/hooks/useAgUiStream.test.ts (18 tests) 2229ms
   âœ“ useAgUiStream > Connection Management > should auto-connect by default  332ms
stdout | tests/components/executions/DeleteWorktreeDialog.test.tsx > DeleteWorktreeDialog > should disable buttons when isDeleting is true
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/DeleteWorktreeDialog.test.tsx > DeleteWorktreeDialog > should return null when worktreePath is null
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/DeleteWorktreeDialog.test.tsx > DeleteWorktreeDialog > should show branch deletion checkbox when branch was created by execution
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/DeleteWorktreeDialog.test.tsx > DeleteWorktreeDialog > should not show branch deletion checkbox when branch was not created by execution
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/DeleteWorktreeDialog.test.tsx > DeleteWorktreeDialog > should not show branch deletion checkbox for detached HEAD
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionView.test.tsx > ExecutionView > should create follow-up execution when continue button clicked
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/ExecutionView.test.tsx > ExecutionView > should display ExecutionMonitor for running execution
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionView.test.tsx > ExecutionView > should reload execution chain when monitor completes
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/DeleteWorktreeDialog.test.tsx > DeleteWorktreeDialog > should call onConfirm with true when checkbox is checked and Delete is clicked
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionView.test.tsx > ExecutionView > should display ExecutionMonitor for preparing status
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionView.test.tsx > ExecutionView > should show Cleanup Worktree button when worktree exists
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionView.test.tsx > ExecutionView > should not show Cleanup Worktree button when worktree does not exist
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/DeleteWorktreeDialog.test.tsx > DeleteWorktreeDialog > should disable checkbox when isDeleting is true
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionView.test.tsx > ExecutionView > should open CleanupWorktreeDialog when Cleanup Worktree button clicked
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/DeleteWorktreeDialog.test.tsx > DeleteWorktreeDialog > should call onClose when pressing Escape
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/DeleteWorktreeDialog.test.tsx > DeleteWorktreeDialog > LocalStorage Persistence > should load saved deleteBranch preference from localStorage
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/DeleteWorktreeDialog.test.tsx > DeleteWorktreeDialog > LocalStorage Persistence > should save deleteBranch preference to localStorage when changed
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionView.test.tsx > ExecutionView > should cleanup worktree when dialog confirmed
[WebSocket] Connecting to: ws://localhost:3000/ws

 âœ“ |@sudocode-ai/local-ui| tests/components/executions/DeleteWorktreeDialog.test.tsx (14 tests) 6704ms
   âœ“ DeleteWorktreeDialog > should not render when isOpen is false  690ms
   âœ“ DeleteWorktreeDialog > should render when isOpen is true  982ms
   âœ“ DeleteWorktreeDialog > should call onConfirm with false when Delete button is clicked without branch checkbox  1250ms
   âœ“ DeleteWorktreeDialog > should call onClose when Cancel button is clicked  864ms
   âœ“ DeleteWorktreeDialog > should disable buttons when isDeleting is true  358ms
   âœ“ DeleteWorktreeDialog > should call onConfirm with true when checkbox is checked and Delete is clicked  1091ms
   âœ“ DeleteWorktreeDialog > LocalStorage Persistence > should save deleteBranch preference to localStorage when changed  491ms
stdout | tests/components/executions/ExecutionView.test.tsx > ExecutionView > should display user prompts for both root and follow-up executions
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionView.test.tsx > ExecutionView > should auto-scroll to bottom when execution is running and user is at bottom
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionView.test.tsx > ExecutionView > should disable auto-scroll when user manually scrolls up
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionView.test.tsx > ExecutionView > should re-enable auto-scroll when user scrolls back to bottom
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionView.test.tsx > ExecutionView > should show scroll to bottom FAB when auto-scroll is disabled
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionView.test.tsx > ExecutionView > Todo Accumulation > should accumulate tool calls from single execution
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionView.test.tsx > ExecutionView > Todo Accumulation > should accumulate tool calls from multiple executions in chain
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionView.test.tsx > ExecutionView > Todo Accumulation > should render single TodoTracker at bottom of chain
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionView.test.tsx > ExecutionView > Todo Accumulation > should not render TodoTracker when no tool calls
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionView.test.tsx > ExecutionView > Todo Accumulation > should update TodoTracker when execution completes and reloads
[WebSocket] Connecting to: ws://localhost:3000/ws

 âœ“ |@sudocode-ai/local-ui| tests/components/executions/ExecutionView.test.tsx (36 tests | 4 skipped) 9603ms
   âœ“ ExecutionView > should display loading state initially  1056ms
   âœ“ ExecutionView > should load and call onHeaderDataChange with execution metadata  330ms
   âœ“ ExecutionView > should call onStatusChange with completed status  446ms
   âœ“ ExecutionView > should call onStatusChange with failed status and display error message  322ms
   âœ“ ExecutionView > should expose canCancel=false via onHeaderDataChange when execution is completed  417ms
   âœ“ ExecutionView > should show follow-up panel when execution is completed  630ms
   âœ“ ExecutionView > should show follow-up panel when execution failed  301ms
   âœ“ ExecutionView > should cancel execution when onCancel handler is called  355ms
   âœ“ ExecutionView > should create follow-up execution when continue button clicked  1529ms
   âœ“ ExecutionView > should reload execution chain when monitor completes  451ms
   âœ“ ExecutionView > should show Cleanup Worktree button when worktree exists  343ms
   âœ“ ExecutionView > should open CleanupWorktreeDialog when Cleanup Worktree button clicked  766ms
   âœ“ ExecutionView > should cleanup worktree when dialog confirmed  327ms
stdout | tests/components/executions/InlineExecutionView.test.tsx > InlineExecutionView > loading state > should show loading state initially
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/InlineExecutionView.test.tsx > InlineExecutionView > error state > should show error message when API call fails
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/InlineExecutionView.test.tsx > InlineExecutionView > error state > should show error when no executions found
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/InlineExecutionView.test.tsx > InlineExecutionView > successful rendering > should render execution header with basic info
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/InlineExecutionView.test.tsx > InlineExecutionView > successful rendering > should show time ago format for timestamp
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/InlineExecutionView.test.tsx > InlineExecutionView > expand/collapse functionality > should be expanded by default
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/InlineExecutionView.test.tsx > InlineExecutionView > navigation > should navigate to execution page when clicking execution ID
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/InlineExecutionView.test.tsx > InlineExecutionView > navigation > should navigate to execution page when clicking execution ID
[WebSocket] Connected
[WebSocket] Resubscribed to: test-project-123:execution:exec-001
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/executions/InlineExecutionView.test.tsx > InlineExecutionView > navigation > should navigate to execution page when clicking execution ID
[WebSocket] Message received: subscribed projectId: [90mundefined[39m

stdout | tests/components/executions/InlineExecutionView.test.tsx > InlineExecutionView > status badges > should show running status
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/InlineExecutionView.test.tsx > InlineExecutionView > status badges > should show failed status
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/InlineExecutionView.test.tsx > InlineExecutionView > status badges > should show cancelled status
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/InlineExecutionView.test.tsx > InlineExecutionView > status badges > should show completed status
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/InlineExecutionView.test.tsx > InlineExecutionView > most recent timestamp > should use the most recent timestamp from all executions
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/InlineExecutionView.test.tsx > InlineExecutionView > most recent timestamp > should prioritize completed_at over created_at
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/InlineExecutionView.test.tsx > InlineExecutionView > actions menu > should render actions menu button
[WebSocket] Connecting to: ws://localhost:3000/ws

 âœ“ |@sudocode-ai/local-ui| tests/components/executions/InlineExecutionView.test.tsx (20 tests | 6 skipped) 5526ms
   âœ“ InlineExecutionView > loading state > should show loading state initially  477ms
   âœ“ InlineExecutionView > error state > should show error when no executions found  745ms
   âœ“ InlineExecutionView > successful rendering > should render execution header with basic info  541ms
   âœ“ InlineExecutionView > successful rendering > should show time ago format for timestamp  437ms
   âœ“ InlineExecutionView > expand/collapse functionality > should be expanded by default  452ms
   âœ“ InlineExecutionView > navigation > should navigate to execution page when clicking execution ID  1366ms
   âœ“ InlineExecutionView > status badges > should show completed status  543ms
stdout | tests/components/executions/ExecutionHistory.test.tsx > ExecutionHistory > should display loading state initially
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionHistory.test.tsx > ExecutionHistory > should display error state when fetch fails
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionHistory.test.tsx > ExecutionHistory > should display empty state when no executions exist
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionHistory.test.tsx > ExecutionHistory > should display list of executions
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/ActivityTimeline.test.tsx > ActivityTimeline > empty state > should show "No activity yet" when items array is empty
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionHistory.test.tsx > ExecutionHistory > should sort executions by created date, newest first
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionHistory.test.tsx > ExecutionHistory > should navigate to execution detail on click
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/ActivityTimeline.test.tsx > ActivityTimeline > feedback rendering > should render feedback items
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/ActivityTimeline.test.tsx > ActivityTimeline > feedback rendering > should render feedback type badge with correct color for comment
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/ActivityTimeline.test.tsx > ActivityTimeline > feedback rendering > should render feedback type badge with correct color for suggestion
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionHistory.test.tsx > ExecutionHistory > should navigate to execution detail on click
[WebSocket] Connected
[WebSocket] Message received: pong projectId: [90mundefined[39m

stdout | tests/components/issues/ActivityTimeline.test.tsx > ActivityTimeline > feedback rendering > should render feedback type badge with correct color for request
[WebSocket] Connecting to: ws://localhost:3000/ws

 âœ“ |@sudocode-ai/local-ui| tests/components/executions/CodeChangesPanel.test.tsx (46 tests) 7406ms
   âœ“ CodeChangesPanel > Loading State > should display loading state  557ms
   âœ“ CodeChangesPanel > Available Changes - File List > should display file list with status badges  1490ms
   âœ“ CodeChangesPanel > Available Changes - File List > should not display statistics for files with zero changes  496ms
   âœ“ CodeChangesPanel > Available Changes - Summary > should display summary statistics in expanded state  301ms
   âœ“ CodeChangesPanel > Uncommitted Changes > should display both committed and uncommitted sections  413ms
   âœ“ CodeChangesPanel > Deleted Resources > should use singular form for 1 additional commit  339ms
   âœ“ CodeChangesPanel > Diff Mode Behavior > Inline Mode (default) > should explicitly work in inline mode when diffMode="inline"  300ms
stdout | tests/components/executions/ExecutionHistory.test.tsx > ExecutionHistory > should display different status badges correctly
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionHistory.test.tsx > ExecutionHistory > should display different status badges correctly
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionHistory.test.tsx > ExecutionHistory > should display different status badges correctly
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/ActivityTimeline.test.tsx > ActivityTimeline > feedback rendering > should show dismissed badge when feedback is dismissed
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionHistory.test.tsx > ExecutionHistory > should display different status badges correctly
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionHistory.test.tsx > ExecutionHistory > should display different status badges correctly
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionHistory.test.tsx > ExecutionHistory > should display different status badges correctly
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/ActivityTimeline.test.tsx > ActivityTimeline > feedback rendering > should show agent name when present
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionHistory.test.tsx > ExecutionHistory > should display different status badges correctly
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionHistory.test.tsx > ExecutionHistory > should use completedAt timestamp if available
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionHistory.test.tsx > ExecutionHistory > should fallback to startedAt if completedAt is not available
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionHistory.test.tsx > ExecutionHistory > should fallback to createdAt if neither completedAt nor startedAt are available
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/ActivityTimeline.test.tsx > ActivityTimeline > feedback rendering > should render anchor info when present
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionHistory.test.tsx > ExecutionHistory > should not display files changed if none exist
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionHistory.test.tsx > ExecutionHistory > should not display error if none exists
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/ActivityTimeline.test.tsx > ActivityTimeline > outbound vs inbound feedback > should style outbound feedback with purple icon (feedback FROM current entity)
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/issues/ActivityTimeline.test.tsx > ActivityTimeline > outbound vs inbound feedback > should style inbound feedback with blue icon (feedback TO current entity)
[WebSocket] Connecting to: ws://localhost:3000/ws

stdout | tests/components/executions/ExecutionHistory.test.tsx > ExecutionHistory > should refetch executions when issueId changes
[WebSocket] Connecting to: ws://localhost:3000/ws

 âœ“ |@sudocode-ai/local-ui| tests/components/executions/ExecutionHistory.test.tsx (13 tests) 3090ms
   âœ“ ExecutionHistory > should display loading state initially  398ms
   âœ“ ExecutionHistory > should display list of executions  431ms
   âœ“ ExecutionHistory > should navigate to execution detail on click  951ms
   âœ“ ExecutionHistory > should display different status badges correctly  509ms
stdout | tests/components/issues/ActivityTimeline.test.tsx > ActivityTimeline > outbound vs inbound feedback > should show arrow and target entity for outbound feedback
[WebSocket] Connecting to: ws://localhost:3000/ws

